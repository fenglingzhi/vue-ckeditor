{"version":3,"sources":["webpack:///webpack/bootstrap e8fb5020e6425f827881","webpack:///./core/ckeditor_base.js","webpack:///./core/loader.js","webpack:///./core/event.js","webpack:///./core/editor_basic.js","webpack:///./core/env.js","webpack:///./core/ckeditor_basic.js","webpack:///./core/log.js","webpack:///./core/dom.js","webpack:///./core/tools.js","webpack:///./core/dtd.js","webpack:///./core/dom/event.js","webpack:///./core/dom/domobject.js","webpack:///./core/dom/node.js","webpack:///./core/dom/window.js","webpack:///./core/dom/document.js","webpack:///./core/dom/nodelist.js","webpack:///./core/dom/element.js","webpack:///./core/dom/documentfragment.js","webpack:///./core/dom/walker.js","webpack:///./core/dom/range.js","webpack:///./core/dom/iterator.js","webpack:///./core/command.js","webpack:///./core/config.js","webpack:///./core/filter.js","webpack:///./core/focusmanager.js","webpack:///./core/keystrokehandler.js","webpack:///./core/lang.js","webpack:///./core/scriptloader.js","webpack:///./core/resourcemanager.js","webpack:///./core/plugins.js","webpack:///./core/ui.js","webpack:///./core/editor.js","webpack:///./core/htmlparser.js","webpack:///./core/htmlparser/basicwriter.js","webpack:///./core/htmlparser/node.js","webpack:///./core/htmlparser/comment.js","webpack:///./core/htmlparser/text.js","webpack:///./core/htmlparser/cdata.js","webpack:///./core/htmlparser/fragment.js","webpack:///./core/htmlparser/filter.js","webpack:///./core/htmldataprocessor.js","webpack:///./core/htmlparser/element.js","webpack:///./core/template.js","webpack:///./core/ckeditor.js","webpack:///./core/creators/inline.js","webpack:///./core/creators/themedui.js","webpack:///./core/editable.js","webpack:///./core/selection.js","webpack:///./core/style.js","webpack:///./core/dom/comment.js","webpack:///./core/dom/elementpath.js","webpack:///./core/dom/text.js","webpack:///./core/dom/rangelist.js","webpack:///./core/skin.js","webpack:///./core/_bootstrap.js","webpack:///./config.js","webpack:///./lang/zh-cn.js"],"names":[],"mappings":"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","file":"init.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap e8fb5020e6425f827881\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Contains the first and essential part of the {@link CKEDITOR}\n *\t\tobject definition.\n */\n\n// #### Compressed Code\n// Compressed code in ckeditor.js must be be updated on changes in the script.\n// The Closure Compiler online service should be used when updating this manually:\n// http://closure-compiler.appspot.com/\n\n// #### Raw code\n// ATTENTION: read the above \"Compressed Code\" notes when changing this code.\n\nif ( !window.CKEDITOR ) {\n\t/**\n\t * This is the API entry point. The entire CKEditor code runs under this object.\n\t * @class CKEDITOR\n\t * @singleton\n\t */\n\twindow.CKEDITOR = ( function() {\n\t\tvar basePathSrcPattern = /(^|.*[\\\\\\/])ckeditor\\.js(?:\\?.*|;.*)?$/i;\n\n\t\tvar CKEDITOR = {\n\n\t\t\t/**\n\t\t\t * A constant string unique for each release of CKEditor. Its value\n\t\t\t * is used, by default, to build the URL for all resources loaded\n\t\t\t * by the editor code, guaranteeing clean cache results when\n\t\t\t * upgrading.\n\t\t\t *\n\t\t\t * **Note:** There is [a known issue where \"icons.png\" does not include\n\t\t\t * timestamp](http://dev.ckeditor.com/ticket/10685) and might get cached.\n\t\t\t * We are working on having it fixed.\n\t\t\t *\n\t\t\t *\t\talert( CKEDITOR.timestamp ); // e.g. '87dm'\n\t\t\t */\n\t\t\ttimestamp: '',\t\t\t\t// %REMOVE_LINE%\n\t\t\t/*\t\t\t\t\t\t\t// %REMOVE_LINE%\n\t\t\t// The production implementation contains a fixed timestamp, unique\n\t\t\t// for each release and generated by the releaser.\n\t\t\t// (Base 36 value of each component of YYMMDDHH - 4 chars total - e.g. 87bm == 08071122)\n\t\t\ttimestamp: '%TIMESTAMP%',\n\t\t\t// %REMOVE_LINE% */\n\n\t\t\t/**\n\t\t\t * Contains the CKEditor version number.\n\t\t\t *\n\t\t\t *\t\talert( CKEDITOR.version ); // e.g. 'CKEditor 3.4.1'\n\t\t\t */\n\t\t\tversion: '%VERSION%',\n\n\t\t\t/**\n\t\t\t * Contains the CKEditor revision number.\n\t\t\t * The revision number is incremented automatically, following each\n\t\t\t * modification to the CKEditor source code.\n\t\t\t *\n\t\t\t *\t\talert( CKEDITOR.revision ); // e.g. '3975'\n\t\t\t */\n\t\t\trevision: '%REV%',\n\n\t\t\t/**\n\t\t\t * A 3-digit random integer, valid for the entire life of the CKEDITOR object.\n\t\t\t *\n\t\t\t *\t\talert( CKEDITOR.rnd ); // e.g. 319\n\t\t\t *\n\t\t\t * @property {Number}\n\t\t\t */\n\t\t\trnd: Math.floor( Math.random() * ( 999 /*Max*/ - 100 /*Min*/ + 1 ) ) + 100 /*Min*/,\n\n\t\t\t/**\n\t\t\t * Private object used to hold core stuff. It should not be used outside of\n\t\t\t * the API code as properties defined here may change at any time\n\t\t\t * without notice.\n\t\t\t *\n\t\t\t * @private\n\t\t\t */\n\t\t\t_: {\n\t\t\t\tpending: [],\n\t\t\t\tbasePathSrcPattern: basePathSrcPattern\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Indicates the API loading status. The following statuses are available:\n\t\t\t *\n\t\t\t * * **unloaded**: the API is not yet loaded.\n\t\t\t * * **basic_loaded**: the basic API features are available.\n\t\t\t * * **basic_ready**: the basic API is ready to load the full core code.\n\t\t\t * * **loaded**: the API can be fully used.\n\t\t\t *\n\t\t\t * Example:\n\t\t\t *\n\t\t\t *\t\tif ( CKEDITOR.status == 'loaded' ) {\n\t\t\t *\t\t\t// The API can now be fully used.\n\t\t\t *\t\t\tdoSomething();\n\t\t\t *\t\t} else {\n\t\t\t *\t\t\t// Wait for the full core to be loaded and fire its loading.\n\t\t\t *\t\t\tCKEDITOR.on( 'load', doSomething );\n\t\t\t *\t\t\tCKEDITOR.loadFullCore && CKEDITOR.loadFullCore();\n\t\t\t *\t\t}\n\t\t\t */\n\t\t\tstatus: 'unloaded',\n\n\t\t\t/**\n\t\t\t * The full URL for the CKEditor installation directory.\n\t\t\t * It is possible to manually provide the base path by setting a\n\t\t\t * global variable named `CKEDITOR_BASEPATH`. This global variable\n\t\t\t * must be set **before** the editor script loading.\n\t\t\t *\n\t\t\t *\t\talert( CKEDITOR.basePath ); // e.g. 'http://www.example.com/ckeditor/'\n\t\t\t *\n\t\t\t * @property {String}\n\t\t\t */\n\t\t\tbasePath: ( function() {\n\t\t\t\t// Find out the editor directory path, based on its <script> tag.\n\t\t\t\tvar path = window.CKEDITOR_BASEPATH || '';\n\n\t\t\t\tif ( !path ) {\n\t\t\t\t\tvar scripts = document.getElementsByTagName( 'script' );\n\n\t\t\t\t\tfor ( var i = 0; i < scripts.length; i++ ) {\n\t\t\t\t\t\tvar match = scripts[ i ].src.match( basePathSrcPattern );\n\n\t\t\t\t\t\tif ( match ) {\n\t\t\t\t\t\t\tpath = match[ 1 ];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// In IE (only) the script.src string is the raw value entered in the\n\t\t\t\t// HTML source. Other browsers return the full resolved URL instead.\n\t\t\t\tif ( path.indexOf( ':/' ) == -1 && path.slice( 0, 2 ) != '//' ) {\n\t\t\t\t\t// Absolute path.\n\t\t\t\t\tif ( path.indexOf( '/' ) === 0 )\n\t\t\t\t\t\tpath = location.href.match( /^.*?:\\/\\/[^\\/]*/ )[ 0 ] + path;\n\t\t\t\t\t// Relative path.\n\t\t\t\t\telse\n\t\t\t\t\t\tpath = location.href.match( /^[^\\?]*\\/(?:)/ )[ 0 ] + path;\n\t\t\t\t}\n\n\t\t\t\tif ( !path )\n\t\t\t\t\tthrow 'The CKEditor installation path could not be automatically detected. Please set the global variable \"CKEDITOR_BASEPATH\" before creating editor instances.';\n\n\t\t\t\treturn path;\n\t\t\t} )(),\n\n\t\t\t/**\n\t\t\t * Gets the full URL for CKEditor resources. By default, URLs\n\t\t\t * returned by this function contain a querystring parameter (\"t\")\n\t\t\t * set to the {@link CKEDITOR#timestamp} value.\n\t\t\t *\n\t\t\t * It is possible to provide a custom implementation of this\n\t\t\t * function by setting a global variable named `CKEDITOR_GETURL`.\n\t\t\t * This global variable must be set **before** the editor script\n\t\t\t * loading. If the custom implementation returns nothing (`==null`), the\n\t\t\t * default implementation is used.\n\t\t\t *\n\t\t\t *\t\t// e.g. 'http://www.example.com/ckeditor/skins/default/editor.css?t=87dm'\n\t\t\t *\t\talert( CKEDITOR.getUrl( 'skins/default/editor.css' ) );\n\t\t\t *\n\t\t\t *\t\t// e.g. 'http://www.example.com/skins/default/editor.css?t=87dm'\n\t\t\t *\t\talert( CKEDITOR.getUrl( '/skins/default/editor.css' ) );\n\t\t\t *\n\t\t\t *\t\t// e.g. 'http://www.somesite.com/skins/default/editor.css?t=87dm'\n\t\t\t *\t\talert( CKEDITOR.getUrl( 'http://www.somesite.com/skins/default/editor.css' ) );\n\t\t\t *\n\t\t\t * @param {String} resource The resource whose full URL we want to get.\n\t\t\t * It may be a full, absolute, or relative URL.\n\t\t\t * @returns {String} The full URL.\n\t\t\t */\n\t\t\tgetUrl: function( resource ) {\n\t\t\t\t// If this is not a full or absolute path.\n\t\t\t\tif ( resource.indexOf( ':/' ) == -1 && resource.indexOf( '/' ) !== 0 )\n\t\t\t\t\tresource = this.basePath + resource;\n\n\t\t\t\t// Add the timestamp, except for directories.\n\t\t\t\tif ( this.timestamp && resource.charAt( resource.length - 1 ) != '/' && !( /[&?]t=/ ).test( resource ) )\n\t\t\t\t\tresource += ( resource.indexOf( '?' ) >= 0 ? '&' : '?' ) + 't=' + this.timestamp;\n\n\t\t\t\treturn resource;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Specify a function to execute when the DOM is fully loaded.\n\t\t\t *\n\t\t\t * If called after the DOM has been initialized, the function passed in will\n\t\t\t * be executed immediately.\n\t\t\t *\n\t\t\t * @method\n\t\t\t * @todo\n\t\t\t */\n\t\t\tdomReady: ( function() {\n\t\t\t\t// Based on the original jQuery code (available under the MIT license, see LICENSE.md).\n\n\t\t\t\tvar callbacks = [];\n\n\t\t\t\tfunction onReady() {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t// Cleanup functions for the document ready method\n\t\t\t\t\t\tif ( document.addEventListener ) {\n\t\t\t\t\t\t\tdocument.removeEventListener( 'DOMContentLoaded', onReady, false );\n\t\t\t\t\t\t\texecuteCallbacks();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Make sure body exists, at least, in case IE gets a little overzealous.\n\t\t\t\t\t\telse if ( document.attachEvent && document.readyState === 'complete' ) {\n\t\t\t\t\t\t\tdocument.detachEvent( 'onreadystatechange', onReady );\n\t\t\t\t\t\t\texecuteCallbacks();\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch ( er ) {}\n\t\t\t\t}\n\n\t\t\t\tfunction executeCallbacks() {\n\t\t\t\t\tvar i;\n\t\t\t\t\twhile ( ( i = callbacks.shift() ) )\n\t\t\t\t\t\ti();\n\t\t\t\t}\n\n\t\t\t\treturn function( fn ) {\n\t\t\t\t\tcallbacks.push( fn );\n\n\t\t\t\t\t// Catch cases where this is called after the\n\t\t\t\t\t// browser event has already occurred.\n\t\t\t\t\tif ( document.readyState === 'complete' )\n\t\t\t\t\t\t// Handle it asynchronously to allow scripts the opportunity to delay ready\n\t\t\t\t\t\tsetTimeout( onReady, 1 );\n\n\t\t\t\t\t// Run below once on demand only.\n\t\t\t\t\tif ( callbacks.length != 1 )\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t// For IE>8, Firefox, Opera and Webkit.\n\t\t\t\t\tif ( document.addEventListener ) {\n\t\t\t\t\t\t// Use the handy event callback\n\t\t\t\t\t\tdocument.addEventListener( 'DOMContentLoaded', onReady, false );\n\n\t\t\t\t\t\t// A fallback to window.onload, that will always work\n\t\t\t\t\t\twindow.addEventListener( 'load', onReady, false );\n\n\t\t\t\t\t}\n\t\t\t\t\t// If old IE event model is used\n\t\t\t\t\telse if ( document.attachEvent ) {\n\t\t\t\t\t\t// ensure firing before onload,\n\t\t\t\t\t\t// maybe late but safe also for iframes\n\t\t\t\t\t\tdocument.attachEvent( 'onreadystatechange', onReady );\n\n\t\t\t\t\t\t// A fallback to window.onload, that will always work\n\t\t\t\t\t\twindow.attachEvent( 'onload', onReady );\n\n\t\t\t\t\t\t// If IE and not a frame\n\t\t\t\t\t\t// continually check to see if the document is ready\n\t\t\t\t\t\t// use the trick by Diego Perini\n\t\t\t\t\t\t// http://javascript.nwbox.com/IEContentLoaded/\n\t\t\t\t\t\tvar toplevel = false;\n\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\ttoplevel = !window.frameElement;\n\t\t\t\t\t\t} catch ( e ) {}\n\n\t\t\t\t\t\tif ( document.documentElement.doScroll && toplevel ) {\n\t\t\t\t\t\t\tscrollCheck();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfunction scrollCheck() {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tdocument.documentElement.doScroll( 'left' );\n\t\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\t\tsetTimeout( scrollCheck, 1 );\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonReady();\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t} )()\n\t\t};\n\n\t\t// Make it possible to override the \"url\" function with a custom\n\t\t// implementation pointing to a global named CKEDITOR_GETURL.\n\t\tvar newGetUrl = window.CKEDITOR_GETURL;\n\t\tif ( newGetUrl ) {\n\t\t\tvar originalGetUrl = CKEDITOR.getUrl;\n\t\t\tCKEDITOR.getUrl = function( resource ) {\n\t\t\t\treturn newGetUrl.call( CKEDITOR, resource ) || originalGetUrl.call( CKEDITOR, resource );\n\t\t\t};\n\t\t}\n\n\t\treturn CKEDITOR;\n\t} )();\n}\n\n/**\n * Function called upon loading a custom configuration file that can\n * modify the editor instance configuration ({@link CKEDITOR.editor#config}).\n * It is usually defined inside the custom configuration files that can\n * include developer defined settings.\n *\n *\t\t// This is supposed to be placed in the config.js file.\n *\t\tCKEDITOR.editorConfig = function( config ) {\n *\t\t\t// Define changes to default configuration here. For example:\n *\t\t\tconfig.language = 'fr';\n *\t\t\tconfig.uiColor = '#AADC6E';\n *\t\t};\n *\n * @method editorConfig\n * @param {CKEDITOR.config} config A configuration object containing the\n * settings defined for a {@link CKEDITOR.editor} instance up to this\n * function call. Note that not all settings may still be available. See\n * [Configuration Loading Order](http://docs.cksource.com/CKEditor_3.x/Developers_Guide/Setting_Configurations#Configuration_Loading_Order)\n * for details.\n */\n\n// PACKAGER_RENAME( CKEDITOR )\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/ckeditor_base.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Defines the {@link CKEDITOR.loader} objects, which is used to\n *\t\tload core scripts and their dependencies from _source.\n */\n\nif ( typeof CKEDITOR == 'undefined' )\n\tCKEDITOR = {}; // jshint ignore:line\n\nif ( !CKEDITOR.loader ) {\n\t/**\n\t * Load core scripts and their dependencies from _source.\n\t *\n\t * @class\n\t * @singleton\n\t */\n\tCKEDITOR.loader = ( function() {\n\t\t// Table of script names and their dependencies.\n\t\tvar scripts = {\n\t\t\t'_bootstrap': [\n\t\t\t\t'config', 'creators/inline', 'creators/themedui', 'editable', 'ckeditor', 'plugins',\n\t\t\t\t'scriptloader', 'style', 'tools',\n\t\t\t\t// The following are entries that we want to force loading at the end to avoid dependence recursion.\n\t\t\t\t'dom/comment', 'dom/elementpath', 'dom/text', 'dom/rangelist', 'skin'\n\t\t\t],\n\t\t\t'ckeditor': [\n\t\t\t\t'ckeditor_basic', 'log', 'dom', 'dtd', 'dom/document', 'dom/element', 'dom/iterator', 'editor', 'event',\n\t\t\t\t'htmldataprocessor', 'htmlparser', 'htmlparser/element', 'htmlparser/fragment', 'htmlparser/filter',\n\t\t\t\t'htmlparser/basicwriter', 'template', 'tools'\n\t\t\t],\n\t\t\t'ckeditor_base': [],\n\t\t\t'ckeditor_basic': [ 'editor_basic', 'env', 'event' ],\n\t\t\t'command': [],\n\t\t\t'config': [ 'ckeditor_base' ],\n\t\t\t'dom': [],\n\t\t\t'dom/comment': [ 'dom/node' ],\n\t\t\t'dom/document': [ 'dom/node', 'dom/window' ],\n\t\t\t'dom/documentfragment': [ 'dom/element' ],\n\t\t\t'dom/element': [ 'dom', 'dom/document', 'dom/domobject', 'dom/node', 'dom/nodelist', 'tools' ],\n\t\t\t'dom/elementpath': [ 'dom/element' ],\n\t\t\t'dom/event': [],\n\t\t\t'dom/iterator': [ 'dom/range' ],\n\t\t\t'dom/node': [ 'dom/domobject', 'tools' ],\n\t\t\t'dom/nodelist': [ 'dom/node' ],\n\t\t\t'dom/domobject': [ 'dom/event' ],\n\t\t\t'dom/range': [ 'dom/document', 'dom/documentfragment', 'dom/element', 'dom/walker' ],\n\t\t\t'dom/rangelist': [ 'dom/range' ],\n\t\t\t'dom/text': [ 'dom/node', 'dom/domobject' ],\n\t\t\t'dom/walker': [ 'dom/node' ],\n\t\t\t'dom/window': [ 'dom/domobject' ],\n\t\t\t'dtd': [ 'tools' ],\n\t\t\t'editable': [ 'editor', 'tools' ],\n\t\t\t'editor': [\n\t\t\t\t'command', 'config', 'editor_basic', 'filter', 'focusmanager', 'keystrokehandler', 'lang',\n\t\t\t\t'plugins', 'tools', 'ui'\n\t\t\t],\n\t\t\t'editor_basic': [ 'event' ],\n\t\t\t'env': [],\n\t\t\t'event': [],\n\t\t\t'filter': [ 'dtd', 'tools' ],\n\t\t\t'focusmanager': [],\n\t\t\t'htmldataprocessor': [ 'htmlparser', 'htmlparser/basicwriter', 'htmlparser/fragment', 'htmlparser/filter' ],\n\t\t\t'htmlparser': [],\n\t\t\t'htmlparser/comment': [ 'htmlparser', 'htmlparser/node' ],\n\t\t\t'htmlparser/element': [ 'htmlparser', 'htmlparser/fragment', 'htmlparser/node' ],\n\t\t\t'htmlparser/fragment': [ 'htmlparser', 'htmlparser/comment', 'htmlparser/text', 'htmlparser/cdata' ],\n\t\t\t'htmlparser/text': [ 'htmlparser', 'htmlparser/node' ],\n\t\t\t'htmlparser/cdata': [ 'htmlparser', 'htmlparser/node' ],\n\t\t\t'htmlparser/filter': [ 'htmlparser' ],\n\t\t\t'htmlparser/basicwriter': [ 'htmlparser' ],\n\t\t\t'htmlparser/node': [ 'htmlparser' ],\n\t\t\t'keystrokehandler': [ 'event' ],\n\t\t\t'lang': [],\n\t\t\t'log': [ 'ckeditor_basic' ],\n\t\t\t'plugins': [ 'resourcemanager' ],\n\t\t\t'resourcemanager': [ 'scriptloader', 'tools' ],\n\t\t\t'scriptloader': [ 'dom/element', 'env' ],\n\t\t\t'selection': [ 'dom/range', 'dom/walker' ],\n\t\t\t'skin': [],\n\t\t\t'style': [ 'selection' ],\n\t\t\t'template': [],\n\t\t\t'tools': [ 'env' ],\n\t\t\t'ui': [],\n\t\t\t'creators/themedui': [],\n\t\t\t'creators/inline': []\n\t\t};\n\n\t\t// The production implementation contains a fixed timestamp generated by the releaser.\n\t\tvar timestamp = '%TIMESTAMP%';\n\t\t// The development implementation contains a current timestamp.\t\t\t\t\t// %REMOVE_LINE%\n\t\ttimestamp = ( CKEDITOR && CKEDITOR.timestamp ) || ( new Date() ).valueOf();\t\t// %REMOVE_LINE%\n\n\t\tvar getUrl = function( resource ) {\n\t\t\t\tif ( CKEDITOR && CKEDITOR.getUrl )\n\t\t\t\t\treturn CKEDITOR.getUrl( resource );\n\n\t\t\t\treturn CKEDITOR.basePath + resource + ( resource.indexOf( '?' ) >= 0 ? '&' : '?' ) + 't=' + timestamp;\n\t\t\t};\n\n\t\tvar pendingLoad = [];\n\n\t\treturn {\n\t\t\t/**\n\t\t\t * The list of loaded scripts in their loading order.\n\t\t\t *\n\t\t\t *\t\t// Alert the loaded script names.\n\t\t\t *\t\talert( CKEDITOR.loader.loadedScripts );\n\t\t\t */\n\t\t\tloadedScripts: [],\n\t\t\t/**\n\t\t\t * Table of script names and their dependencies.\n\t\t\t *\n\t\t\t * @property {Array}\n\t\t\t */\n\t\t\tscripts: scripts,\n\n\t\t\t/**\n\t\t\t * @todo\n\t\t\t */\n\t\t\t test:[],\n\t\t\tloadPending: function() {\n\t\t\t\tvar scriptName = pendingLoad.shift();\n\t\t\t\t\n\n\t\t\t\tif ( !scriptName )\n\t\t\t\t\treturn;\n\n\t\t\t\tvar scriptSrc = getUrl( 'core/' + scriptName + '.js' );\n\n\t\t\t\tvar script = document.createElement( 'script' );\n\t\t\t\tscript.type = 'text/javascript';\n\t\t\t\tscript.src = scriptSrc;\n\n\t\t\t\tfunction onScriptLoaded() {\n\t\t\t\t\t// Append this script to the list of loaded scripts.\n\t\t\t\t\tCKEDITOR.loader.loadedScripts.push( scriptName );\n\n\t\t\t\t\t// Load the next.\n\t\t\t\t\tCKEDITOR.loader.loadPending();\n\t\t\t\t}\n\n\t\t\t\t// We must guarantee the execution order of the scripts, so we\n\t\t\t\t// need to load them one by one. (#4145)\n\t\t\t\t// The following if/else block has been taken from the scriptloader core code.\n\t\t\t\tif ( typeof script.onreadystatechange !== 'undefined' ) {\n\t\t\t\t\t/** @ignore */\n\t\t\t\t\tscript.onreadystatechange = function() {\n\t\t\t\t\t\tif ( script.readyState == 'loaded' || script.readyState == 'complete' ) {\n\t\t\t\t\t\t\tscript.onreadystatechange = null;\n\t\t\t\t\t\t\tonScriptLoaded();\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\t/** @ignore */\n\t\t\t\t\tscript.onload = function() {\n\t\t\t\t\t\t// Some browsers, such as Safari, may call the onLoad function\n\t\t\t\t\t\t// immediately. Which will break the loading sequence. (#3661)\n\t\t\t\t\t\tsetTimeout( function() {\n\t\t\t\t\t\t\tonScriptLoaded( scriptName );\n\t\t\t\t\t\t}, 0 );\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// document.body.appendChild( script );\n\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Loads a specific script, including its dependencies. This is not a\n\t\t\t * synchronous loading, which means that the code to be loaded will\n\t\t\t * not necessarily be available after this call.\n\t\t\t *\n\t\t\t *\t\tCKEDITOR.loader.load( 'dom/element' );\n\t\t\t *\n\t\t\t * @param {String} scriptName\n\t\t\t * @param {Boolean} [defer=false]\n\t\t\t * @todo params\n\t\t\t */\n\t\t\tload: function( scriptName, defer ) {\n\t\t\t\t// Check if the script has already been loaded.\n\t\t\t\tif ( ( 's:' + scriptName ) in this.loadedScripts )\n\t\t\t\t\treturn;\n\t\t\t\t// Get the script dependencies list.\n\t\t\t\tvar dependencies = scripts[ scriptName ];\n\t\t\t\tif ( !dependencies )\n\t\t\t\t\tthrow 'The script name\"' + scriptName + '\" is not defined.';\n\n\t\t\t\t// Mark the script as loaded, even before really loading it, to\n\t\t\t\t// avoid cross references recursion.\n\t\t\t\t// Prepend script name with 's:' to avoid conflict with Array's methods.\n\t\t\t\tthis.loadedScripts[ 's:' + scriptName ] = true;\n\n\t\t\t\t// Load all dependencies first.\n\t\t\t\tfor ( var i = 0; i < dependencies.length; i++ )\n\t\t\t\t\tthis.load( dependencies[ i ], true );\n\n\t\t\t\tvar scriptSrc = getUrl( 'core/' + scriptName + '.js' );\n\n\t\t\t\t// Append the <script> element to the DOM.\n\t\t\t\t// If the page is fully loaded, we can't use document.write\n\t\t\t\t// but if the script is run while the body is loading then it's safe to use it\n\t\t\t\t// Unfortunately, Firefox <3.6 doesn't support document.readyState, so it won't get this improvement\n\t\t\t\tif ( document.body && ( !document.readyState || document.readyState == 'complete' ) ) {\n\t\t\t\t\tpendingLoad.push( scriptName );\n\n\t\t\t\t\tif ( !defer )\n\t\t\t\t\t\tthis.loadPending();\n\t\t\t\t} else {\n\t\t\t\t\t// Append this script to the list of loaded scripts.\n\t\t\t\t\tthis.loadedScripts.push( scriptName );\n\t\t\t\t\t// document.write( '<script src=\"' + scriptSrc + '\" type=\"text/javascript\"><\\/script>' );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} )();\n}\n\n// Check if any script has been defined for autoload.\nif ( CKEDITOR._autoLoad ) {\n\tCKEDITOR.loader.load( CKEDITOR._autoLoad );\n\tdelete CKEDITOR._autoLoad;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/loader.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Defines the {@link CKEDITOR.event} class, which serves as the\n *\t\tbase for classes and objects that require event handling features.\n */\n\nif ( !CKEDITOR.event ) {\n\t/**\n\t * Creates an event class instance. This constructor is rarely used, being\n\t * the {@link #implementOn} function used in class prototypes directly\n\t * instead.\n\t *\n\t * This is a base class for classes and objects that require event\n\t * handling features.\n\t *\n\t * Do not confuse this class with {@link CKEDITOR.dom.event} which is\n\t * instead used for DOM events. The CKEDITOR.event class implements the\n\t * internal event system used by the CKEditor to fire API related events.\n\t *\n\t * @class\n\t * @constructor Creates an event class instance.\n\t */\n\tCKEDITOR.event = function() {};\n\n\t/**\n\t * Implements the {@link CKEDITOR.event} features in an object.\n\t *\n\t *\t\tvar myObject = { message: 'Example' };\n\t *\t\tCKEDITOR.event.implementOn( myObject );\n\t *\n\t *\t\tmyObject.on( 'testEvent', function() {\n\t *\t\t\talert( this.message );\n\t *\t\t} );\n\t *\t\tmyObject.fire( 'testEvent' ); // 'Example'\n\t *\n\t * @static\n\t * @param {Object} targetObject The object into which implement the features.\n\t */\n\tCKEDITOR.event.implementOn = function( targetObject ) {//相当于类的静态方法，但是实例无法调用\n\t\tvar eventProto = CKEDITOR.event.prototype;\n\n\t\tfor ( var prop in eventProto ) {\n\t\t\tif ( targetObject[ prop ] == null )\n\t\t\t\ttargetObject[ prop ] = eventProto[ prop ];\n\t\t}\n\t};\n\n\tCKEDITOR.event.prototype = ( function() {\n\t\t// Returns the private events object for a given object.\n\t\tvar getPrivate = function( obj ) {\n\t\t\t\tvar _ = ( obj.getPrivate && obj.getPrivate() ) || obj._ || ( obj._ = {} );\n\t\t\t\treturn _.events || ( _.events = {} );\n\t\t\t};\n\n\t\tvar eventEntry = function( eventName ) {\n\t\t\t\tthis.name = eventName;\n\t\t\t\tthis.listeners = [];\n\t\t\t};\n\n\t\teventEntry.prototype = {\n\t\t\t// Get the listener index for a specified function.\n\t\t\t// Returns -1 if not found.\n\t\t\tgetListenerIndex: function( listenerFunction ) {\n\t\t\t\tfor ( var i = 0, listeners = this.listeners; i < listeners.length; i++ ) {\n\t\t\t\t\tif ( listeners[ i ].fn == listenerFunction )\n\t\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t};\n\n\t\t// Retrieve the event entry on the event host (create it if needed).\n\t\tfunction getEntry( name ) {\n\t\t\t// Get the event entry (create it if needed).\n\t\t\tvar events = getPrivate( this );\n\t\t\treturn events[ name ] || ( events[ name ] = new eventEntry( name ) );\n\t\t}\n\n\t\treturn {\n\t\t\t/**\n\t\t\t * Predefine some intrinsic properties on a specific event name.\n\t\t\t *\n\t\t\t * @param {String} name The event name\n\t\t\t * @param meta\n\t\t\t * @param [meta.errorProof=false] Whether the event firing should catch error thrown from a per listener call.\n\t\t\t */\n\t\t\tdefine: function( name, meta ) {\n\t\t\t\tvar entry = getEntry.call( this, name );\n\t\t\t\tCKEDITOR.tools.extend( entry, meta, true );\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Registers a listener to a specific event in the current object.\n\t\t\t *\n\t\t\t *\t\tsomeObject.on( 'someEvent', function() {\n\t\t\t *\t\t\talert( this == someObject );\t\t// true\n\t\t\t *\t\t} );\n\t\t\t *\n\t\t\t *\t\tsomeObject.on( 'someEvent', function() {\n\t\t\t *\t\t\talert( this == anotherObject );\t\t// true\n\t\t\t *\t\t}, anotherObject );\n\t\t\t *\n\t\t\t *\t\tsomeObject.on( 'someEvent', function( event ) {\n\t\t\t *\t\t\talert( event.listenerData );\t\t// 'Example'\n\t\t\t *\t\t}, null, 'Example' );\n\t\t\t *\n\t\t\t *\t\tsomeObject.on( 'someEvent', function() { ... } );\t\t\t\t\t\t// 2nd called\n\t\t\t *\t\tsomeObject.on( 'someEvent', function() { ... }, null, null, 100 );\t\t// 3rd called\n\t\t\t *\t\tsomeObject.on( 'someEvent', function() { ... }, null, null, 1 );\t\t// 1st called\n\t\t\t *\n\t\t\t * @param {String} eventName The event name to which listen.\n\t\t\t * @param {Function} listenerFunction The function listening to the\n\t\t\t * event. A single {@link CKEDITOR.eventInfo} object instanced\n\t\t\t * is passed to this function containing all the event data.\n\t\t\t * @param {Object} [scopeObj] The object used to scope the listener\n\t\t\t * call (the `this` object). If omitted, the current object is used.\n\t\t\t * @param {Object} [listenerData] Data to be sent as the\n\t\t\t * {@link CKEDITOR.eventInfo#listenerData} when calling the\n\t\t\t * listener.\n\t\t\t * @param {Number} [priority=10] The listener priority. Lower priority\n\t\t\t * listeners are called first. Listeners with the same priority\n\t\t\t * value are called in registration order.\n\t\t\t * @returns {Object} An object containing the `removeListener`\n\t\t\t * function, which can be used to remove the listener at any time.\n\t\t\t */\n\t\t\ton: function( eventName, listenerFunction, scopeObj, listenerData, priority ) {\n\t\t\t\t// Create the function to be fired for this listener.\n\t\t\t\tfunction listenerFirer( editor, publisherData, stopFn, cancelFn ) {\n\t\t\t\t\tvar ev = {\n\t\t\t\t\t\tname: eventName,\n\t\t\t\t\t\tsender: this,\n\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\tdata: publisherData,\n\t\t\t\t\t\tlistenerData: listenerData,\n\t\t\t\t\t\tstop: stopFn,\n\t\t\t\t\t\tcancel: cancelFn,\n\t\t\t\t\t\tremoveListener: removeListener\n\t\t\t\t\t};\n\n\t\t\t\t\tvar ret = listenerFunction.call( scopeObj, ev );\n\n\t\t\t\t\treturn ret === false ? false : ev.data;\n\t\t\t\t}\n\n\t\t\t\tfunction removeListener() {\n\t\t\t\t\tme.removeListener( eventName, listenerFunction );\n\t\t\t\t}\n\n\t\t\t\tvar event = getEntry.call( this, eventName );\n\n\t\t\t\tif ( event.getListenerIndex( listenerFunction ) < 0 ) {\n\t\t\t\t\t// Get the listeners.\n\t\t\t\t\tvar listeners = event.listeners;\n\n\t\t\t\t\t// Fill the scope.\n\t\t\t\t\tif ( !scopeObj )\n\t\t\t\t\t\tscopeObj = this;\n\n\t\t\t\t\t// Default the priority, if needed.\n\t\t\t\t\tif ( isNaN( priority ) )\n\t\t\t\t\t\tpriority = 10;\n\n\t\t\t\t\tvar me = this;\n\n\t\t\t\t\tlistenerFirer.fn = listenerFunction;\n\t\t\t\t\tlistenerFirer.priority = priority;\n\n\t\t\t\t\t// Search for the right position for this new listener, based on its\n\t\t\t\t\t// priority.\n\t\t\t\t\tfor ( var i = listeners.length - 1; i >= 0; i-- ) {\n\t\t\t\t\t\t// Find the item which should be before the new one.\n\t\t\t\t\t\tif ( listeners[ i ].priority <= priority ) {\n\t\t\t\t\t\t\t// Insert the listener in the array.\n\t\t\t\t\t\t\tlisteners.splice( i + 1, 0, listenerFirer );\n\t\t\t\t\t\t\treturn { removeListener: removeListener };\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// If no position has been found (or zero length), put it in\n\t\t\t\t\t// the front of list.\n\t\t\t\t\tlisteners.unshift( listenerFirer );\n\t\t\t\t}\n\n\t\t\t\treturn { removeListener: removeListener };\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Similiar with {@link #on} but the listener will be called only once upon the next event firing.\n\t\t\t *\n\t\t\t * @see CKEDITOR.event#on\n\t\t\t */\n\t\t\tonce: function() {\n\t\t\t\tvar args = Array.prototype.slice.call( arguments ),\n\t\t\t\t\tfn = args[ 1 ];\n\n\t\t\t\targs[ 1 ] = function( evt ) {\n\t\t\t\t\tevt.removeListener();\n\t\t\t\t\treturn fn.apply( this, arguments );\n\t\t\t\t};\n\n\t\t\t\treturn this.on.apply( this, args );\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * @static\n\t\t\t * @property {Boolean} useCapture\n\t\t\t * @todo\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * Register event handler under the capturing stage on supported target.\n\t\t\t */\n\t\t\tcapture: function() {\n\t\t\t\tCKEDITOR.event.useCapture = 1;\n\t\t\t\tvar retval = this.on.apply( this, arguments );\n\t\t\t\tCKEDITOR.event.useCapture = 0;\n\t\t\t\treturn retval;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Fires an specific event in the object. All registered listeners are\n\t\t\t * called at this point.\n\t\t\t *\n\t\t\t *\t\tsomeObject.on( 'someEvent', function() { ... } );\n\t\t\t *\t\tsomeObject.on( 'someEvent', function() { ... } );\n\t\t\t *\t\tsomeObject.fire( 'someEvent' );\t\t\t\t// Both listeners are called.\n\t\t\t *\n\t\t\t *\t\tsomeObject.on( 'someEvent', function( event ) {\n\t\t\t *\t\t\talert( event.data );\t\t\t\t\t// 'Example'\n\t\t\t *\t\t} );\n\t\t\t *\t\tsomeObject.fire( 'someEvent', 'Example' );\n\t\t\t *\n\t\t\t * @method\n\t\t\t * @param {String} eventName The event name to fire.\n\t\t\t * @param {Object} [data] Data to be sent as the\n\t\t\t * {@link CKEDITOR.eventInfo#data} when calling the listeners.\n\t\t\t * @param {CKEDITOR.editor} [editor] The editor instance to send as the\n\t\t\t * {@link CKEDITOR.eventInfo#editor} when calling the listener.\n\t\t\t * @returns {Boolean/Object} A boolean indicating that the event is to be\n\t\t\t * canceled, or data returned by one of the listeners.\n\t\t\t */\n\t\t\tfire: ( function() {\n\t\t\t\t// Create the function that marks the event as stopped.\n\t\t\t\tvar stopped = 0;\n\t\t\t\tvar stopEvent = function() {\n\t\t\t\t\t\tstopped = 1;\n\t\t\t\t\t};\n\n\t\t\t\t// Create the function that marks the event as canceled.\n\t\t\t\tvar canceled = 0;\n\t\t\t\tvar cancelEvent = function() {\n\t\t\t\t\t\tcanceled = 1;\n\t\t\t\t\t};\n\n\t\t\t\treturn function( eventName, data, editor ) {\n\t\t\t\t\t// Get the event entry.\n\t\t\t\t\tvar event = getPrivate( this )[ eventName ];\n\n\t\t\t\t\t// Save the previous stopped and cancelled states. We may\n\t\t\t\t\t// be nesting fire() calls.\n\t\t\t\t\tvar previousStopped = stopped,\n\t\t\t\t\t\tpreviousCancelled = canceled;\n\n\t\t\t\t\t// Reset the stopped and canceled flags.\n\t\t\t\t\tstopped = canceled = 0;\n\n\t\t\t\t\tif ( event ) {\n\t\t\t\t\t\tvar listeners = event.listeners;\n\n\t\t\t\t\t\tif ( listeners.length ) {\n\t\t\t\t\t\t\t// As some listeners may remove themselves from the\n\t\t\t\t\t\t\t// event, the original array length is dinamic. So,\n\t\t\t\t\t\t\t// let's make a copy of all listeners, so we are\n\t\t\t\t\t\t\t// sure we'll call all of them.\n\t\t\t\t\t\t\tlisteners = listeners.slice( 0 );\n\n\t\t\t\t\t\t\tvar retData;\n\t\t\t\t\t\t\t// Loop through all listeners.\n\t\t\t\t\t\t\tfor ( var i = 0; i < listeners.length; i++ ) {\n\t\t\t\t\t\t\t\t// Call the listener, passing the event data.\n\t\t\t\t\t\t\t\tif ( event.errorProof ) {\n\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\tretData = listeners[ i ].call( this, editor, data, stopEvent, cancelEvent );\n\t\t\t\t\t\t\t\t\t} catch ( er ) {}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tretData = listeners[ i ].call( this, editor, data, stopEvent, cancelEvent );\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif ( retData === false )\n\t\t\t\t\t\t\t\t\tcanceled = 1;\n\t\t\t\t\t\t\t\telse if ( typeof retData != 'undefined' )\n\t\t\t\t\t\t\t\t\tdata = retData;\n\n\t\t\t\t\t\t\t\t// No further calls is stopped or canceled.\n\t\t\t\t\t\t\t\tif ( stopped || canceled )\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar ret = canceled ? false : ( typeof data == 'undefined' ? true : data );\n\n\t\t\t\t\t// Restore the previous stopped and canceled states.\n\t\t\t\t\tstopped = previousStopped;\n\t\t\t\t\tcanceled = previousCancelled;\n\n\t\t\t\t\treturn ret;\n\t\t\t\t};\n\t\t\t} )(),\n\n\t\t\t/**\n\t\t\t * Fires an specific event in the object, releasing all listeners\n\t\t\t * registered to that event. The same listeners are not called again on\n\t\t\t * successive calls of it or of {@link #fire}.\n\t\t\t *\n\t\t\t *\t\tsomeObject.on( 'someEvent', function() { ... } );\n\t\t\t *\t\tsomeObject.fire( 'someEvent' );\t\t\t// Above listener called.\n\t\t\t *\t\tsomeObject.fireOnce( 'someEvent' );\t\t// Above listener called.\n\t\t\t *\t\tsomeObject.fire( 'someEvent' );\t\t\t// No listeners called.\n\t\t\t *\n\t\t\t * @param {String} eventName The event name to fire.\n\t\t\t * @param {Object} [data] Data to be sent as the\n\t\t\t * {@link CKEDITOR.eventInfo#data} when calling the listeners.\n\t\t\t * @param {CKEDITOR.editor} [editor] The editor instance to send as the\n\t\t\t * {@link CKEDITOR.eventInfo#editor} when calling the listener.\n\t\t\t * @returns {Boolean/Object} A booloan indicating that the event is to be\n\t\t\t * canceled, or data returned by one of the listeners.\n\t\t\t */\n\t\t\tfireOnce: function( eventName, data, editor ) {\n\t\t\t\tvar ret = this.fire( eventName, data, editor );\n\t\t\t\tdelete getPrivate( this )[ eventName ];\n\t\t\t\treturn ret;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Unregisters a listener function from being called at the specified\n\t\t\t * event. No errors are thrown if the listener has not been registered previously.\n\t\t\t *\n\t\t\t *\t\tvar myListener = function() { ... };\n\t\t\t *\t\tsomeObject.on( 'someEvent', myListener );\n\t\t\t *\t\tsomeObject.fire( 'someEvent' );\t\t\t\t\t// myListener called.\n\t\t\t *\t\tsomeObject.removeListener( 'someEvent', myListener );\n\t\t\t *\t\tsomeObject.fire( 'someEvent' );\t\t\t\t\t// myListener not called.\n\t\t\t *\n\t\t\t * @param {String} eventName The event name.\n\t\t\t * @param {Function} listenerFunction The listener function to unregister.\n\t\t\t */\n\t\t\tremoveListener: function( eventName, listenerFunction ) {\n\t\t\t\t// Get the event entry.\n\t\t\t\tvar event = getPrivate( this )[ eventName ];\n\n\t\t\t\tif ( event ) {\n\t\t\t\t\tvar index = event.getListenerIndex( listenerFunction );\n\t\t\t\t\tif ( index >= 0 )\n\t\t\t\t\t\tevent.listeners.splice( index, 1 );\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Remove all existing listeners on this object, for cleanup purpose.\n\t\t\t */\n\t\t\tremoveAllListeners: function() {\n\t\t\t\tvar events = getPrivate( this );\n\t\t\t\tfor ( var i in events )\n\t\t\t\t\tdelete events[ i ];\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Checks if there is any listener registered to a given event.\n\t\t\t *\n\t\t\t *\t\tvar myListener = function() { ... };\n\t\t\t *\t\tsomeObject.on( 'someEvent', myListener );\n\t\t\t *\t\talert( someObject.hasListeners( 'someEvent' ) );\t// true\n\t\t\t *\t\talert( someObject.hasListeners( 'noEvent' ) );\t\t// false\n\t\t\t *\n\t\t\t * @param {String} eventName The event name.\n\t\t\t * @returns {Boolean}\n\t\t\t */\n\t\t\thasListeners: function( eventName ) {\n\t\t\t\tvar event = getPrivate( this )[ eventName ];\n\t\t\t\treturn ( event && event.listeners.length > 0 );\n\t\t\t}\n\t\t};\n\t} )();\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/event.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\nif ( !CKEDITOR.editor ) {\n\t// Documented at editor.js.\n\tCKEDITOR.editor = function() {\n\t\t// Push this editor to the pending list. It'll be processed later once\n\t\t// the full editor code is loaded.\n\t\tCKEDITOR._.pending.push( [ this, arguments ] );\n\n\t\t// Call the CKEDITOR.event constructor to initialize this instance.\n\t\tCKEDITOR.event.call( this );\n\t};\n\n\t// Both fire and fireOnce will always pass this editor instance as the\n\t// \"editor\" param in CKEDITOR.event.fire. So, we override it to do that\n\t// automaticaly.\n\tCKEDITOR.editor.prototype.fire = function( eventName, data ) {\n\t\tif ( eventName in { instanceReady: 1, loaded: 1 } )\n\t\t\tthis[ eventName ] = true;\n\n\t\treturn CKEDITOR.event.prototype.fire.call( this, eventName, data, this );\n\t};\n\n\tCKEDITOR.editor.prototype.fireOnce = function( eventName, data ) {\n\t\tif ( eventName in { instanceReady: 1, loaded: 1 } )\n\t\t\tthis[ eventName ] = true;\n\n\t\treturn CKEDITOR.event.prototype.fireOnce.call( this, eventName, data, this );\n\t};\n\n\t// \"Inherit\" (copy actually) from CKEDITOR.event.\n\tCKEDITOR.event.implementOn( CKEDITOR.editor.prototype );\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/editor_basic.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Defines the {@link CKEDITOR.env} object which contains\n *\t\tenvironment and browser information.\n */\n\nif ( !CKEDITOR.env ) {\n\t/**\n\t * Environment and browser information.\n\t *\n\t * @class CKEDITOR.env\n\t * @singleton\n\t */\n\tCKEDITOR.env = ( function() {\n\t\tvar agent = navigator.userAgent.toLowerCase(),\n\t\t\tedge = agent.match( /edge[ \\/](\\d+.?\\d*)/ ),\n\t\t\ttrident = agent.indexOf( 'trident/' ) > -1,\n\t\t\tie = !!( edge || trident );\n\n\t\tvar env = {\n\t\t\t/**\n\t\t\t * Indicates that CKEditor is running in Internet Explorer.\n\t\t\t *\n\t\t\t *\t\tif ( CKEDITOR.env.ie )\n\t\t\t *\t\t\talert( 'I\\'m running in IE!' );\n\t\t\t *\n\t\t\t * **Note:** This property is also set to `true` if CKEditor is running\n\t\t\t * in {@link #edge Microsoft Edge}.\n\t\t\t *\n\t\t\t * @property {Boolean}\n\t\t\t */\n\t\t\tie: ie,\n\n\t\t\t/**\n\t\t\t * Indicates that CKEditor is running in Microsoft Edge.\n\t\t\t *\n\t\t\t *\t\tif ( CKEDITOR.env.edge )\n\t\t\t *\t\t\talert( 'I\\'m running in Edge!' );\n\t\t\t *\n\t\t\t * See also {@link #ie}.\n\t\t\t *\n\t\t\t * @since 4.5\n\t\t\t * @property {Boolean}\n\t\t\t */\n\t\t\tedge: !!edge,\n\n\t\t\t/**\n\t\t\t * Indicates that CKEditor is running in a WebKit-based browser, like Safari,\n\t\t\t * or Blink-based browser, like Chrome.\n\t\t\t *\n\t\t\t *\t\tif ( CKEDITOR.env.webkit )\n\t\t\t *\t\t\talert( 'I\\'m running in a WebKit browser!' );\n\t\t\t *\n\t\t\t * @property {Boolean}\n\t\t\t */\n\t\t\twebkit: !ie && ( agent.indexOf( ' applewebkit/' ) > -1 ),\n\n\t\t\t/**\n\t\t\t * Indicates that CKEditor is running in Adobe AIR.\n\t\t\t *\n\t\t\t *\t\tif ( CKEDITOR.env.air )\n\t\t\t *\t\t\talert( 'I\\'m on AIR!' );\n\t\t\t *\n\t\t\t * @property {Boolean}\n\t\t\t */\n\t\t\tair: ( agent.indexOf( ' adobeair/' ) > -1 ),\n\n\t\t\t/**\n\t\t\t * Indicates that CKEditor is running on Macintosh.\n\t\t\t *\n\t\t\t *\t\tif ( CKEDITOR.env.mac )\n\t\t\t *\t\t\talert( 'I love apples!'' );\n\t\t\t *\n\t\t\t * @property {Boolean}\n\t\t\t */\n\t\t\tmac: ( agent.indexOf( 'macintosh' ) > -1 ),\n\n\t\t\t/**\n\t\t\t * Indicates that CKEditor is running in a Quirks Mode environment.\n\t\t\t *\n\t\t\t *\t\tif ( CKEDITOR.env.quirks )\n\t\t\t *\t\t\talert( 'Nooooo!' );\n\t\t\t *\n\t\t\t * Internet Explorer 10 introduced the _New Quirks Mode_, which is similar to the _Quirks Mode_\n\t\t\t * implemented in other modern browsers and defined in the HTML5 specification. It can be handled\n\t\t\t * as the Standards mode, so the value of this property will be set to `false`.\n\t\t\t *\n\t\t\t * The _Internet Explorer 5 Quirks_ mode which is still available in Internet Explorer 10+\n\t\t\t * sets this value to `true` and {@link #version} to `7`.\n\t\t\t *\n\t\t\t * Read more: [IEBlog](http://blogs.msdn.com/b/ie/archive/2011/12/14/interoperable-html5-quirks-mode-in-ie10.aspx)\n\t\t\t *\n\t\t\t * @property {Boolean}\n\t\t\t */\n\t\t\tquirks: ( document.compatMode == 'BackCompat' && ( !document.documentMode || document.documentMode < 10 ) ),\n\n\t\t\t/**\n\t\t\t * Indicates that CKEditor is running in a mobile environemnt.\n\t\t\t *\n\t\t\t *\t\tif ( CKEDITOR.env.mobile )\n\t\t\t *\t\t\talert( 'I\\'m running with CKEditor today!' );\n\t\t\t *\n\t\t\t * @deprecated\n\t\t\t * @property {Boolean}\n\t\t\t */\n\t\t\tmobile: ( agent.indexOf( 'mobile' ) > -1 ),\n\n\t\t\t/**\n\t\t\t * Indicates that CKEditor is running on Apple iPhone/iPad/iPod devices.\n\t\t\t *\n\t\t\t *\t\tif ( CKEDITOR.env.iOS )\n\t\t\t *\t\t\talert( 'I like little apples!' );\n\t\t\t *\n\t\t\t * @property {Boolean}\n\t\t\t */\n\t\t\tiOS: /(ipad|iphone|ipod)/.test( agent ),\n\n\t\t\t/**\n\t\t\t * Indicates that the browser has a custom domain enabled. This has\n\t\t\t * been set with `document.domain`.\n\t\t\t *\n\t\t\t *\t\tif ( CKEDITOR.env.isCustomDomain() )\n\t\t\t *\t\t\talert( 'I\\'m in a custom domain!' );\n\t\t\t *\n\t\t\t * @returns {Boolean} `true` if a custom domain is enabled.\n\t\t\t * @deprecated\n\t\t\t */\n\t\t\tisCustomDomain: function() {\n\t\t\t\tif ( !this.ie )\n\t\t\t\t\treturn false;\n\n\t\t\t\tvar domain = document.domain,\n\t\t\t\t\thostname = window.location.hostname;\n\n\t\t\t\treturn domain != hostname && domain != ( '[' + hostname + ']' ); // IPv6 IP support (#5434)\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Indicates that the page is running under an encrypted connection.\n\t\t\t *\n\t\t\t *\t\tif ( CKEDITOR.env.secure )\n\t\t\t *\t\t\talert( 'I\\'m on SSL!' );\n\t\t\t *\n\t\t\t * @returns {Boolean} `true` if the page has an encrypted connection.\n\t\t\t */\n\t\t\tsecure: location.protocol == 'https:'\n\t\t};\n\n\t\t/**\n\t\t * Indicates that CKEditor is running in a Gecko-based browser, like\n\t\t * Firefox.\n\t\t *\n\t\t *\t\tif ( CKEDITOR.env.gecko )\n\t\t *\t\t\talert( 'I\\'m riding a gecko!' );\n\t\t *\n\t\t * @property {Boolean}\n\t\t */\n\t\tenv.gecko = ( navigator.product == 'Gecko' && !env.webkit && !env.ie );\n\n\t\t/**\n\t\t * Indicates that CKEditor is running in a Blink-based browser like Chrome.\n\t\t *\n\t\t *\t\tif ( CKEDITOR.env.chrome )\n\t\t *\t\t\talert( 'I\\'m running in Chrome!' );\n\t\t *\n\t\t * @property {Boolean} chrome\n\t\t */\n\n\t\t/**\n\t\t * Indicates that CKEditor is running in Safari (including the mobile version).\n\t\t *\n\t\t *\t\tif ( CKEDITOR.env.safari )\n\t\t *\t\t\talert( 'I\\'m on Safari!' );\n\t\t *\n\t\t * @property {Boolean} safari\n\t\t */\n\t\tif ( env.webkit ) {\n\t\t\tif ( agent.indexOf( 'chrome' ) > -1 )\n\t\t\t\tenv.chrome = true;\n\t\t\telse\n\t\t\t\tenv.safari = true;\n\t\t}\n\n\t\tvar version = 0;\n\n\t\t// Internet Explorer 6.0+\n\t\tif ( env.ie ) {\n\t\t\t// We use env.version for feature detection, so set it properly.\n\t\t\tif ( edge ) {\n\t\t\t\tversion = parseFloat( edge[ 1 ] );\n\t\t\t} else if ( env.quirks || !document.documentMode ) {\n\t\t\t\tversion = parseFloat( agent.match( /msie (\\d+)/ )[ 1 ] );\n\t\t\t} else {\n\t\t\t\tversion = document.documentMode;\n\t\t\t}\n\n\t\t\t// Deprecated features available just for backwards compatibility.\n\t\t\tenv.ie9Compat = version == 9;\n\t\t\tenv.ie8Compat = version == 8;\n\t\t\tenv.ie7Compat = version == 7;\n\t\t\tenv.ie6Compat = version < 7 || env.quirks;\n\n\t\t\t/**\n\t\t\t * Indicates that CKEditor is running in an IE6-like environment, which\n\t\t\t * includes IE6 itself as well as IE7, IE8 and IE9 in Quirks Mode.\n\t\t\t *\n\t\t\t * @deprecated\n\t\t\t * @property {Boolean} ie6Compat\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * Indicates that CKEditor is running in an IE7-like environment, which\n\t\t\t * includes IE7 itself and IE8's IE7 Document Mode.\n\t\t\t *\n\t\t\t * @deprecated\n\t\t\t * @property {Boolean} ie7Compat\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * Indicates that CKEditor is running in Internet Explorer 8 on\n\t\t\t * Standards Mode.\n\t\t\t *\n\t\t\t * @deprecated\n\t\t\t * @property {Boolean} ie8Compat\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * Indicates that CKEditor is running in Internet Explorer 9 on\n\t\t\t * Standards Mode.\n\t\t\t *\n\t\t\t * @deprecated\n\t\t\t * @property {Boolean} ie9Compat\n\t\t\t */\n\t\t}\n\n\t\t// Gecko.\n\t\tif ( env.gecko ) {\n\t\t\tvar geckoRelease = agent.match( /rv:([\\d\\.]+)/ );\n\t\t\tif ( geckoRelease ) {\n\t\t\t\tgeckoRelease = geckoRelease[ 1 ].split( '.' );\n\t\t\t\tversion = geckoRelease[ 0 ] * 10000 + ( geckoRelease[ 1 ] || 0 ) * 100 + ( geckoRelease[ 2 ] || 0 ) * 1;\n\t\t\t}\n\t\t}\n\n\t\t// Adobe AIR 1.0+\n\t\t// Checked before Safari because AIR have the WebKit rich text editor\n\t\t// features from Safari 3.0.4, but the version reported is 420.\n\t\tif ( env.air )\n\t\t\tversion = parseFloat( agent.match( / adobeair\\/(\\d+)/ )[ 1 ] );\n\n\t\t// WebKit 522+ (Safari 3+)\n\t\tif ( env.webkit )\n\t\t\tversion = parseFloat( agent.match( / applewebkit\\/(\\d+)/ )[ 1 ] );\n\n\t\t/**\n\t\t * Contains the browser version.\n\t\t *\n\t\t * For Gecko-based browsers (like Firefox) it contains the revision\n\t\t * number with first three parts concatenated with a padding zero\n\t\t * (e.g. for revision 1.9.0.2 we have 10900).\n\t\t *\n\t\t * For WebKit-based browsers (like Safari and Chrome) it contains the\n\t\t * WebKit build version (e.g. 522).\n\t\t *\n\t\t * For IE browsers, it matches the \"Document Mode\".\n\t\t *\n\t\t *\t\tif ( CKEDITOR.env.ie && CKEDITOR.env.version <= 6 )\n\t\t *\t\t\talert( 'Ouch!' );\n\t\t *\n\t\t * @property {Number}\n\t\t */\n\t\tenv.version = version;\n\n\t\t/**\n\t\t * Since CKEditor 4.5 this property is a blacklist of browsers incompatible with CKEditor. It means that it is\n\t\t * set to `false` only in browsers that are known to be incompatible. Before CKEditor 4.5 this\n\t\t * property was a whitelist of browsers that were known to be compatible with CKEditor.\n\t\t *\n\t\t * The reason for this change is the rising fragmentation of the browser market (especially the mobile segment).\n\t\t * It became too complicated to check in which new environments CKEditor is going to work.\n\t\t *\n\t\t * In order to enable CKEditor 4.4.x and below in unsupported environments see the\n\t\t * [Enabling CKEditor in Unsupported Environments](#!/guide/dev_unsupported_environments) article.\n\t\t *\n\t\t *\t\tif ( CKEDITOR.env.isCompatible )\n\t\t *\t\t\talert( 'Your browser is not known to be incompatible with CKEditor!' );\n\t\t *\n\t\t * @property {Boolean}\n\t\t */\n\t\tenv.isCompatible =\n\t\t\t// IE 7+ (IE 7 is not supported, but IE Compat Mode is and it is recognized as IE7).\n\t\t\t!( env.ie && version < 7 ) &&\n\t\t\t// Firefox 4.0+.\n\t\t\t!( env.gecko && version < 40000 ) &&\n\t\t\t// Chrome 6+, Safari 5.1+, iOS 5+.\n\t\t\t!( env.webkit && version < 534 );\n\n\t\t/**\n\t\t * Indicates that CKEditor is running in the HiDPI environment.\n\t\t *\n\t\t *\t\tif ( CKEDITOR.env.hidpi )\n\t\t *\t\t\talert( 'You are using a screen with high pixel density.' );\n\t\t *\n\t\t * @property {Boolean}\n\t\t */\n\t\tenv.hidpi = window.devicePixelRatio >= 2;\n\n\t\t/**\n\t\t * Indicates that CKEditor is running in a browser which uses a bogus\n\t\t * `<br>` filler in order to correctly display caret in empty blocks.\n\t\t *\n\t\t * @since 4.3\n\t\t * @property {Boolean}\n\t\t */\n\t\tenv.needsBrFiller = env.gecko || env.webkit || ( env.ie && version > 10 );\n\n\t\t/**\n\t\t * Indicates that CKEditor is running in a browser which needs a\n\t\t * non-breaking space filler in order to correctly display caret in empty blocks.\n\t\t *\n\t\t * @since 4.3\n\t\t * @property {Boolean}\n\t\t */\n\t\tenv.needsNbspFiller = env.ie && version < 11;\n\n\t\t/**\n\t\t * A CSS class that denotes the browser where CKEditor runs and is appended\n\t\t * to the HTML element that contains the editor. It makes it easier to apply\n\t\t * browser-specific styles to editor instances.\n\t\t *\n\t\t *\t\tmyDiv.className = CKEDITOR.env.cssClass;\n\t\t *\n\t\t * @property {String}\n\t\t */\n\t\tenv.cssClass = 'cke_browser_' + ( env.ie ? 'ie' : env.gecko ? 'gecko' : env.webkit ? 'webkit' : 'unknown' );\n\n\t\tif ( env.quirks )\n\t\t\tenv.cssClass += ' cke_browser_quirks';\n\n\t\tif ( env.ie )\n\t\t\tenv.cssClass += ' cke_browser_ie' + ( env.quirks ? '6 cke_browser_iequirks' : env.version );\n\n\t\tif ( env.air )\n\t\t\tenv.cssClass += ' cke_browser_air';\n\n\t\tif ( env.iOS )\n\t\t\tenv.cssClass += ' cke_browser_ios';\n\n\t\tif ( env.hidpi )\n\t\t\tenv.cssClass += ' cke_hidpi';\n\n\t\treturn env;\n\t} )();\n}\n\n// PACKAGER_RENAME( CKEDITOR.env )\n// PACKAGER_RENAME( CKEDITOR.env.ie )\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/env.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Contains the second part of the {@link CKEDITOR} object\n *\t\tdefinition, which defines the basic editor features to be available in\n *\t\tthe root ckeditor_basic.js file.\n */\n\nif ( CKEDITOR.status == 'unloaded' ) {\n\t( function() {\n\t\tCKEDITOR.event.implementOn( CKEDITOR );\n\n\t\t/**\n\t\t * Forces the full CKEditor core code, in the case only the basic code has been\n\t\t * loaded (`ckeditor_basic.js`). This method self-destroys (becomes undefined) in\n\t\t * the first call or as soon as the full code is available.\n\t\t *\n\t\t *\t\t// Check if the full core code has been loaded and load it.\n\t\t *\t\tif ( CKEDITOR.loadFullCore )\n\t\t *\t\t\tCKEDITOR.loadFullCore();\n\t\t *\n\t\t * @member CKEDITOR\n\t\t */\n\t\tCKEDITOR.loadFullCore = function() {\n\t\t\t// If the basic code is not ready, just mark it to be loaded.\n\t\t\tif ( CKEDITOR.status != 'basic_ready' ) {\n\t\t\t\tCKEDITOR.loadFullCore._load = 1;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Destroy this function.\n\t\t\tdelete CKEDITOR.loadFullCore;\n\n\t\t\t// Append the script to the head.\n\t\t\tvar script = document.createElement( 'script' );\n\t\t\tscript.type = 'text/javascript';\n\t\t\tscript.src = CKEDITOR.basePath + 'ckeditor.js';\n\t\t\tscript.src = CKEDITOR.basePath + 'ckeditor_source.js'; // %REMOVE_LINE%\n\n\t\t\tdocument.getElementsByTagName( 'head' )[ 0 ].appendChild( script );\n\t\t};\n\n\t\t/**\n\t\t * The time to wait (in seconds) to load the full editor code after the\n\t\t * page load, if the \"ckeditor_basic\" file is used. If set to zero, the\n\t\t * editor is loaded on demand, as soon as an instance is created.\n\t\t *\n\t\t * This value must be set on the page before the page load completion.\n\t\t *\n\t\t *\t\t// Loads the full source after five seconds.\n\t\t *\t\tCKEDITOR.loadFullCoreTimeout = 5;\n\t\t *\n\t\t * @property\n\t\t * @member CKEDITOR\n\t\t */\n\t\tCKEDITOR.loadFullCoreTimeout = 0;\n\n\t\t// Documented at ckeditor.js.\n\t\tCKEDITOR.add = function( editor ) {\n\t\t\t// For now, just put the editor in the pending list. It will be\n\t\t\t// processed as soon as the full code gets loaded.\n\t\t\tvar pending = this._.pending || ( this._.pending = [] );\n\t\t\tpending.push( editor );\n\t\t};\n\n\t\t( function() {\n\t\t\tvar onload = function() {\n\t\t\t\t\tvar loadFullCore = CKEDITOR.loadFullCore,\n\t\t\t\t\t\tloadFullCoreTimeout = CKEDITOR.loadFullCoreTimeout;\n\n\t\t\t\t\tif ( !loadFullCore )\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tCKEDITOR.status = 'basic_ready';\n\n\t\t\t\t\tif ( loadFullCore && loadFullCore._load )\n\t\t\t\t\t\tloadFullCore();\n\t\t\t\t\telse if ( loadFullCoreTimeout ) {\n\t\t\t\t\t\tsetTimeout( function() {\n\t\t\t\t\t\t\tif ( CKEDITOR.loadFullCore )\n\t\t\t\t\t\t\t\tCKEDITOR.loadFullCore();\n\t\t\t\t\t\t}, loadFullCoreTimeout * 1000 );\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\tCKEDITOR.domReady( onload );\n\t\t} )();\n\n\t\tCKEDITOR.status = 'basic_loaded';\n\t} )();\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/ckeditor_basic.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Defines {@link CKEDITOR#verbosity} and binary flags {@link CKEDITOR#VERBOSITY_WARN} and\n * {@link CKEDITOR#VERBOSITY_ERROR}. Defines also the {@link CKEDITOR#error} and {@link CKEDITOR#warn} functions\n * and the default handler for the {@link CKEDITOR#log} event.\n */\n\n/* global console */\n\n'use strict';\n\n/**\n * Warning reporting verbosity level. When {@link CKEDITOR#verbosity} is set to this value, only {@link CKEDITOR#warn}\n * messages will be output to the console. It is a binary flag so it might be combined with\n * the {@link CKEDITOR#VERBOSITY_ERROR} flag.\n *\n * @since 4.5.4\n * @readonly\n * @property {Number} [=1]\n * @member CKEDITOR\n */\nCKEDITOR.VERBOSITY_WARN = 1;\n\n/**\n * Error reporting verbosity level. When {@link CKEDITOR#verbosity} is set to this value, only {@link CKEDITOR#error}\n * messages will be output to the console. It is a binary flag so it might be combined with\n * the {@link CKEDITOR#VERBOSITY_WARN} flag.\n *\n * @since 4.5.4\n * @readonly\n * @property {Number} [=2]\n * @member CKEDITOR\n */\nCKEDITOR.VERBOSITY_ERROR = 2;\n\n/**\n * Verbosity of {@link CKEDITOR#error} and {@link CKEDITOR#warn} methods. Accepts binary flags\n * {@link CKEDITOR#VERBOSITY_WARN} and {@link CKEDITOR#VERBOSITY_ERROR}.\n *\n * \t\t\tCKEDITOR.verbosity = 0; // No console output after CKEDITOR.warn and CKEDITOR.error methods.\n * \t\t\tCKEDITOR.verbosity = CKEDITOR.VERBOSITY_WARN; // Console output after CKEDITOR.warn only.\n * \t\t\tCKEDITOR.verbosity = CKEDITOR.VERBOSITY_ERROR; // Console output after CKEDITOR.error only.\n * \t\t\tCKEDITOR.verbosity = CKEDITOR.VERBOSITY_WARN | CKEDITOR.VERBOSITY_ERROR; // Console output after both methods.\n *\n * Default value enables both {@link CKEDITOR#VERBOSITY_WARN} and {@link CKEDITOR#VERBOSITY_ERROR}.\n *\n * @since 4.5.4\n * @member CKEDITOR\n * @type {Number}\n */\nCKEDITOR.verbosity = CKEDITOR.VERBOSITY_WARN | CKEDITOR.VERBOSITY_ERROR;\n\n/**\n * Warning reporting function. When {@link CKEDITOR#verbosity} has the {@link CKEDITOR#VERBOSITY_WARN} flag set, it fires\n * the {@link CKEDITOR#log} event with type set to `warn`. Fired event contains also provided `errorCode` and `additionalData`.\n *\n * @since 4.5.4\n * @member CKEDITOR\n * @param {String} errorCode Error code describing reported problem.\n * @param {Object} [additionalData] Additional data associated with reported problem.\n */\nCKEDITOR.warn = function( errorCode, additionalData ) {\n\tif ( CKEDITOR.verbosity & CKEDITOR.VERBOSITY_WARN ) {\n\t\tCKEDITOR.fire( 'log', { type: 'warn', errorCode: errorCode, additionalData: additionalData } );\n\t}\n};\n\n/**\n * Error reporting function. When {@link CKEDITOR#verbosity} has {@link CKEDITOR#VERBOSITY_ERROR} flag set, it fires\n * {@link CKEDITOR#log} event with the type set to `error`. The fired event also contains the provided `errorCode` and\n * `additionalData`.\n *\n * @since 4.5.4\n * @member CKEDITOR\n * @param {String} errorCode Error code describing the reported problem.\n * @param {Object} [additionalData] Additional data associated with the reported problem.\n */\nCKEDITOR.error = function( errorCode, additionalData ) {\n\tif ( CKEDITOR.verbosity & CKEDITOR.VERBOSITY_ERROR ) {\n\t\tCKEDITOR.fire( 'log', { type: 'error', errorCode: errorCode, additionalData: additionalData } );\n\t}\n};\n\n/**\n * Fired by {@link CKEDITOR#warn} and {@link CKEDITOR#error} methods.\n * Default listener logs provided information to the console.\n *\n * This event can be used to provide a custom error/warning handler:\n *\n * \t\t\tCKEDTIOR.on( 'log', function( evt ) {\n *\t\t\t    \t// Cancel default listener.\n *\t\t\t\t\tevt.cancel();\n *\t\t\t\t\t// Log event data.\n *\t\t\t\t\tconsole.log( evt.data.type, evt.data.errorCode, evt.data.additionalData );\n * \t\t\t} );\n *\n * @since 4.5.4\n * @event log\n * @member CKEDITOR\n * @param data\n * @param {String} data.type Log type. Can be `error` or `warn`.\n * @param {String} data.errorCode Error code describing the reported problem.\n * @param {Object} [data.additionalData] Additional data associated with this log event.\n */\nCKEDITOR.on( 'log', function( evt ) {\n\tif ( !window.console || !window.console.log ) {\n\t\treturn;\n\t}\n\n\tvar type = console[ evt.data.type ] ? evt.data.type : 'log',\n\t\terrorCode = evt.data.errorCode,\n\t\tadditionalData = evt.data.additionalData,\n\t\tprefix = '[CKEDITOR] ',\n\t\terrorCodeLabel = 'Error code: ';\n\n\tif ( additionalData ) {\n\t\tconsole[ type ]( prefix + errorCodeLabel + errorCode + '.', additionalData );\n\t} else {\n\t\tconsole[ type ]( prefix + errorCodeLabel + errorCode + '.' );\n\t}\n\n\tconsole[ type ]( prefix + 'For more information about this error go to http://docs.ckeditor.com/#!/guide/dev_errors-section-' + errorCode );\n}, null, null, 999 );\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/log.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Defines the {@link CKEDITOR.dom} object, which contains DOM\n *\t\tmanipulation objects and function.\n */\n\nCKEDITOR.dom = {};\n\n// PACKAGER_RENAME( CKEDITOR.dom )\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/dom.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Defines the {@link CKEDITOR.tools} object that contains\n *\t\tutility functions.\n */\n\n( function() {\n\tvar functions = [],\n\t\tcssVendorPrefix =\n\t\t\tCKEDITOR.env.gecko ? '-moz-' :\n\t\t\tCKEDITOR.env.webkit ? '-webkit-' :\n\t\t\tCKEDITOR.env.ie ? '-ms-' :\n\t\t\t'',\n\t\tampRegex = /&/g,\n\t\tgtRegex = />/g,\n\t\tltRegex = /</g,\n\t\tquoteRegex = /\"/g,\n\t\ttokenCharset = 'abcdefghijklmnopqrstuvwxyz0123456789',\n\t\tTOKEN_COOKIE_NAME = 'ckCsrfToken',\n\t\tTOKEN_LENGTH = 40,\n\n\t\tallEscRegex = /&(lt|gt|amp|quot|nbsp|shy|#\\d{1,5});/g,\n\t\tnamedEntities = {\n\t\t\tlt: '<',\n\t\t\tgt: '>',\n\t\t\tamp: '&',\n\t\t\tquot: '\"',\n\t\t\tnbsp: '\\u00a0',\n\t\t\tshy: '\\u00ad'\n\t\t},\n\t\tallEscDecode = function( match, code ) {\n\t\t\tif ( code[ 0 ] == '#' ) {\n\t\t\t\treturn String.fromCharCode( parseInt( code.slice( 1 ), 10 ) );\n\t\t\t} else {\n\t\t\t\treturn namedEntities[ code ];\n\t\t\t}\n\t\t};\n\n\tCKEDITOR.on( 'reset', function() {\n\t\tfunctions = [];\n\t} );\n\n\t/**\n\t * Utility functions.\n\t *\n\t * @class\n\t * @singleton\n\t */\n\tCKEDITOR.tools = {\n\t\t/**\n\t\t * Compares the elements of two arrays.\n\t\t *\n\t\t *\t\tvar a = [ 1, 'a', 3 ];\n\t\t *\t\tvar b = [ 1, 3, 'a' ];\n\t\t *\t\tvar c = [ 1, 'a', 3 ];\n\t\t *\t\tvar d = [ 1, 'a', 3, 4 ];\n\t\t *\n\t\t *\t\talert( CKEDITOR.tools.arrayCompare( a, b ) );  // false\n\t\t *\t\talert( CKEDITOR.tools.arrayCompare( a, c ) );  // true\n\t\t *\t\talert( CKEDITOR.tools.arrayCompare( a, d ) );  // false\n\t\t *\n\t\t * @param {Array} arrayA An array to be compared.\n\t\t * @param {Array} arrayB The other array to be compared.\n\t\t * @returns {Boolean} `true` if the arrays have the same length and\n\t\t * their elements match.\n\t\t */\n\t\tarrayCompare: function( arrayA, arrayB ) {\n\t\t\tif ( !arrayA && !arrayB )\n\t\t\t\treturn true;\n\n\t\t\tif ( !arrayA || !arrayB || arrayA.length != arrayB.length )\n\t\t\t\treturn false;\n\n\t\t\tfor ( var i = 0; i < arrayA.length; i++ ) {\n\t\t\t\tif ( arrayA[ i ] != arrayB[ i ] )\n\t\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\t/**\n\t\t * Finds the index of the first element in an array for which the `compareFunction` returns `true`.\n\t\t *\n\t\t *\t\tCKEDITOR.tools.getIndex( [ 1, 2, 4, 3, 5 ], function( el ) {\n\t\t *\t\t\treturn el >= 3;\n\t\t *\t\t} ); // 2\n\t\t *\n\t\t * @since 4.5\n\t\t * @param {Array} array Array to search in.\n\t\t * @param {Function} compareFunction Compare function.\n\t\t * @returns {Number} The index of the first matching element or `-1` if none matches.\n\t\t */\n\t\tgetIndex: function( arr, compareFunction ) {\n\t\t\tfor ( var i = 0; i < arr.length; ++i ) {\n\t\t\t\tif ( compareFunction( arr[ i ] ) )\n\t\t\t\t\treturn i;\n\t\t\t}\n\t\t\treturn -1;\n\t\t},\n\n\t\t/**\n\t\t * Creates a deep copy of an object.\n\t\t *\n\t\t * **Note**: Recursive references are not supported.\n\t\t *\n\t\t *\t\tvar obj = {\n\t\t *\t\t\tname: 'John',\n\t\t *\t\t\tcars: {\n\t\t *\t\t\t\tMercedes: { color: 'blue' },\n\t\t *\t\t\t\tPorsche: { color: 'red' }\n\t\t *\t\t\t}\n\t\t *\t\t};\n\t\t *\t\tvar clone = CKEDITOR.tools.clone( obj );\n\t\t *\t\tclone.name = 'Paul';\n\t\t *\t\tclone.cars.Porsche.color = 'silver';\n\t\t *\n\t\t *\t\talert( obj.name );\t\t\t\t\t// 'John'\n\t\t *\t\talert( clone.name );\t\t\t\t// 'Paul'\n\t\t *\t\talert( obj.cars.Porsche.color );\t// 'red'\n\t\t *\t\talert( clone.cars.Porsche.color );\t// 'silver'\n\t\t *\n\t\t * @param {Object} object The object to be cloned.\n\t\t * @returns {Object} The object clone.\n\t\t */\n\t\tclone: function( obj ) {\n\t\t\tvar clone;\n\n\t\t\t// Array.\n\t\t\tif ( obj && ( obj instanceof Array ) ) {\n\t\t\t\tclone = [];\n\n\t\t\t\tfor ( var i = 0; i < obj.length; i++ )\n\t\t\t\t\tclone[ i ] = CKEDITOR.tools.clone( obj[ i ] );\n\n\t\t\t\treturn clone;\n\t\t\t}\n\n\t\t\t// \"Static\" types.\n\t\t\tif ( obj === null || ( typeof obj != 'object' ) || ( obj instanceof String ) || ( obj instanceof Number ) || ( obj instanceof Boolean ) || ( obj instanceof Date ) || ( obj instanceof RegExp ) )\n\t\t\t\treturn obj;\n\n\t\t\t// DOM objects and window.\n\t\t\tif ( obj.nodeType || obj.window === obj )\n\t\t\t\treturn obj;\n\n\t\t\t// Objects.\n\t\t\tclone = new obj.constructor();\n\n\t\t\tfor ( var propertyName in obj ) {\n\t\t\t\tvar property = obj[ propertyName ];\n\t\t\t\tclone[ propertyName ] = CKEDITOR.tools.clone( property );\n\t\t\t}\n\n\t\t\treturn clone;\n\t\t},\n\n\t\t/**\n\t\t * Turns the first letter of a string to upper-case.\n\t\t *\n\t\t * @param {String} str\n\t\t * @param {Boolean} [keepCase] Keep the case of 2nd to last letter.\n\t\t * @returns {String}\n\t\t */\n\t\tcapitalize: function( str, keepCase ) {\n\t\t\treturn str.charAt( 0 ).toUpperCase() + ( keepCase ? str.slice( 1 ) : str.slice( 1 ).toLowerCase() );\n\t\t},\n\n\t\t/**\n\t\t * Copies the properties from one object to another. By default, properties\n\t\t * already present in the target object **are not** overwritten.\n\t\t *\n\t\t *\t\t// Create the sample object.\n\t\t *\t\tvar myObject = {\n\t\t *\t\t\tprop1: true\n\t\t *\t\t};\n\t\t *\n\t\t *\t\t// Extend the above object with two properties.\n\t\t *\t\tCKEDITOR.tools.extend( myObject, {\n\t\t *\t\t\tprop2: true,\n\t\t *\t\t\tprop3: true\n\t\t *\t\t} );\n\t\t *\n\t\t *\t\t// Alert 'prop1', 'prop2' and 'prop3'.\n\t\t *\t\tfor ( var p in myObject )\n\t\t *\t\t\talert( p );\n\t\t *\n\t\t * @param {Object} target The object to be extended.\n\t\t * @param {Object...} source The object(s) from properties will be\n\t\t * copied. Any number of objects can be passed to this function.\n\t\t * @param {Boolean} [overwrite] If `true` is specified, it indicates that\n\t\t * properties already present in the target object could be\n\t\t * overwritten by subsequent objects.\n\t\t * @param {Object} [properties] Only properties within the specified names\n\t\t * list will be received from the source object.\n\t\t * @returns {Object} The extended object (target).\n\t\t */\n\t\textend: function( target ) {\n\t\t\tvar argsLength = arguments.length,\n\t\t\t\toverwrite, propertiesList;\n\n\t\t\tif ( typeof ( overwrite = arguments[ argsLength - 1 ] ) == 'boolean' )\n\t\t\t\targsLength--;\n\t\t\telse if ( typeof ( overwrite = arguments[ argsLength - 2 ] ) == 'boolean' ) {\n\t\t\t\tpropertiesList = arguments[ argsLength - 1 ];\n\t\t\t\targsLength -= 2;\n\t\t\t}\n\t\t\tfor ( var i = 1; i < argsLength; i++ ) {\n\t\t\t\tvar source = arguments[ i ];\n\t\t\t\tfor ( var propertyName in source ) {\n\t\t\t\t\t// Only copy existed fields if in overwrite mode.\n\t\t\t\t\tif ( overwrite === true || target[ propertyName ] == null ) {\n\t\t\t\t\t\t// Only copy  specified fields if list is provided.\n\t\t\t\t\t\tif ( !propertiesList || ( propertyName in propertiesList ) )\n\t\t\t\t\t\t\ttarget[ propertyName ] = source[ propertyName ];\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn target;\n\t\t},\n\n\t\t/**\n\t\t * Creates an object which is an instance of a class whose prototype is a\n\t\t * predefined object. All properties defined in the source object are\n\t\t * automatically inherited by the resulting object, including future\n\t\t * changes to it.\n\t\t *\n\t\t * @param {Object} source The source object to be used as the prototype for\n\t\t * the final object.\n\t\t * @returns {Object} The resulting copy.\n\t\t */\n\t\tprototypedCopy: function( source ) {\n\t\t\tvar copy = function() {};\n\t\t\tcopy.prototype = source;\n\t\t\treturn new copy();\n\t\t},\n\n\t\t/**\n\t\t * Makes fast (shallow) copy of an object.\n\t\t * This method is faster than {@link #clone} which does\n\t\t * a deep copy of an object (including arrays).\n\t\t *\n\t\t * @since 4.1\n\t\t * @param {Object} source The object to be copied.\n\t\t * @returns {Object} Copy of `source`.\n\t\t */\n\t\tcopy: function( source ) {\n\t\t\tvar obj = {},\n\t\t\t\tname;\n\n\t\t\tfor ( name in source )\n\t\t\t\tobj[ name ] = source[ name ];\n\n\t\t\treturn obj;\n\t\t},\n\n\t\t/**\n\t\t * Checks if an object is an Array.\n\t\t *\n\t\t *\t\talert( CKEDITOR.tools.isArray( [] ) );\t\t// true\n\t\t *\t\talert( CKEDITOR.tools.isArray( 'Test' ) );\t// false\n\t\t *\n\t\t * @param {Object} object The object to be checked.\n\t\t * @returns {Boolean} `true` if the object is an Array, otherwise `false`.\n\t\t */\n\t\tisArray: function( object ) {\n\t\t\treturn Object.prototype.toString.call( object ) == '[object Array]';\n\t\t},\n\n\t\t/**\n\t\t * Whether the object contains no properties of its own.\n\t\t *\n\t\t * @param object\n\t\t * @returns {Boolean}\n\t\t */\n\t\tisEmpty: function( object ) {\n\t\t\tfor ( var i in object ) {\n\t\t\t\tif ( object.hasOwnProperty( i ) )\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\n\t\t/**\n\t\t * Generates an object or a string containing vendor-specific and vendor-free CSS properties.\n\t\t *\n\t\t *\t\tCKEDITOR.tools.cssVendorPrefix( 'border-radius', '0', true );\n\t\t *\t\t// On Firefox: '-moz-border-radius:0;border-radius:0'\n\t\t *\t\t// On Chrome: '-webkit-border-radius:0;border-radius:0'\n\t\t *\n\t\t * @param {String} property The CSS property name.\n\t\t * @param {String} value The CSS value.\n\t\t * @param {Boolean} [asString=false] If `true`, then the returned value will be a CSS string.\n\t\t * @returns {Object/String} The object containing CSS properties or its stringified version.\n\t\t */\n\t\tcssVendorPrefix: function( property, value, asString ) {\n\t\t\tif ( asString )\n\t\t\t\treturn cssVendorPrefix + property + ':' + value + ';' + property + ':' + value;\n\n\t\t\tvar ret = {};\n\t\t\tret[ property ] = value;\n\t\t\tret[ cssVendorPrefix + property ] = value;\n\n\t\t\treturn ret;\n\t\t},\n\n\t\t/**\n\t\t * Transforms a CSS property name to its relative DOM style name.\n\t\t *\n\t\t *\t\talert( CKEDITOR.tools.cssStyleToDomStyle( 'background-color' ) );\t// 'backgroundColor'\n\t\t *\t\talert( CKEDITOR.tools.cssStyleToDomStyle( 'float' ) );\t\t\t\t// 'cssFloat'\n\t\t *\n\t\t * @method\n\t\t * @param {String} cssName The CSS property name.\n\t\t * @returns {String} The transformed name.\n\t\t */\n\t\tcssStyleToDomStyle: ( function() {\n\t\t\tvar test = document.createElement( 'div' ).style;\n\n\t\t\tvar cssFloat = ( typeof test.cssFloat != 'undefined' ) ? 'cssFloat' : ( typeof test.styleFloat != 'undefined' ) ? 'styleFloat' : 'float';\n\n\t\t\treturn function( cssName ) {\n\t\t\t\tif ( cssName == 'float' )\n\t\t\t\t\treturn cssFloat;\n\t\t\t\telse {\n\t\t\t\t\treturn cssName.replace( /-./g, function( match ) {\n\t\t\t\t\t\treturn match.substr( 1 ).toUpperCase();\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t};\n\t\t} )(),\n\n\t\t/**\n\t\t * Builds a HTML snippet from a set of `<style>/<link>`.\n\t\t *\n\t\t * @param {String/Array} css Each of which are URLs (absolute) of a CSS file or\n\t\t * a trunk of style text.\n\t\t * @returns {String}\n\t\t */\n\t\tbuildStyleHtml: function( css ) {\n\t\t\tcss = [].concat( css );\n\t\t\tvar item,\n\t\t\t\tretval = [];\n\t\t\tfor ( var i = 0; i < css.length; i++ ) {\n\t\t\t\tif ( ( item = css[ i ] ) ) {\n\t\t\t\t\t// Is CSS style text ?\n\t\t\t\t\tif ( /@import|[{}]/.test( item ) )\n\t\t\t\t\t\tretval.push( '<style>' + item + '</style>' );\n\t\t\t\t\telse\n\t\t\t\t\t\tretval.push( '<link type=\"text/css\" rel=stylesheet href=\"' + item + '\">' );\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn retval.join( '' );\n\t\t},\n\n\t\t/**\n\t\t * Replaces special HTML characters in a string with their relative HTML\n\t\t * entity values.\n\t\t *\n\t\t *\t\talert( CKEDITOR.tools.htmlEncode( 'A > B & C < D' ) ); // 'A &gt; B &amp; C &lt; D'\n\t\t *\n\t\t * @param {String} text The string to be encoded.\n\t\t * @returns {String} The encoded string.\n\t\t */\n\t\thtmlEncode: function( text ) {\n\t\t\t// Backwards compatibility - accept also non-string values (casting is done below).\n\t\t\t// Since 4.4.8 we return empty string for null and undefined because these values make no sense.\n\t\t\tif ( text === undefined || text === null ) {\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn String( text ).replace( ampRegex, '&amp;' ).replace( gtRegex, '&gt;' ).replace( ltRegex, '&lt;' );\n\t\t},\n\n\t\t/**\n\t\t * Decodes HTML entities that browsers tend to encode when used in text nodes.\n\t\t *\n\t\t *\t\talert( CKEDITOR.tools.htmlDecode( '&lt;a &amp; b &gt;' ) ); // '<a & b >'\n\t\t *\n\t\t * Read more about chosen entities in the [research](http://dev.ckeditor.com/ticket/13105#comment:8).\n\t\t *\n\t\t * @param {String} The string to be decoded.\n\t\t * @returns {String} The decoded string.\n\t\t */\n\t\thtmlDecode: function( text ) {\n\t\t\t// See:\n\t\t\t// * http://dev.ckeditor.com/ticket/13105#comment:8 and comment:9,\n\t\t\t// * http://jsperf.com/wth-is-going-on-with-jsperf JSPerf has some serious problems, but you can observe\n\t\t\t// that combined regexp tends to be quicker (except on V8). It will also not be prone to fail on '&amp;lt;'\n\t\t\t// (see http://dev.ckeditor.com/ticket/13105#DXWTF:CKEDITOR.tools.htmlEnDecodeAttr).\n\t\t\treturn text.replace( allEscRegex, allEscDecode );\n\t\t},\n\n\t\t/**\n\t\t * Replaces special HTML characters in HTMLElement attribute with their relative HTML entity values.\n\t\t *\n\t\t *\t\talert( CKEDITOR.tools.htmlEncodeAttr( '<a \" b >' ) ); // '&lt;a &quot; b &gt;'\n\t\t *\n\t\t * @param {String} The attribute value to be encoded.\n\t\t * @returns {String} The encoded value.\n\t\t */\n\t\thtmlEncodeAttr: function( text ) {\n\t\t\treturn CKEDITOR.tools.htmlEncode( text ).replace( quoteRegex, '&quot;' );\n\t\t},\n\n\t\t/**\n\t\t * Decodes HTML entities that browsers tend to encode when used in attributes.\n\t\t *\n\t\t *\t\talert( CKEDITOR.tools.htmlDecodeAttr( '&lt;a &quot; b&gt;' ) ); // '<a \" b>'\n\t\t *\n\t\t * Since CKEditor 4.5 this method simply executes {@link #htmlDecode} which covers\n\t\t * all necessary entities.\n\t\t *\n\t\t * @param {String} text The text to be decoded.\n\t\t * @returns {String} The decoded text.\n\t\t */\n\t\thtmlDecodeAttr: function( text ) {\n\t\t\treturn CKEDITOR.tools.htmlDecode( text );\n\t\t},\n\n\t\t/**\n\t\t * Transforms text to valid HTML: creates paragraphs, replaces tabs with non-breaking spaces etc.\n\t\t *\n\t\t * @since 4.5\n\t\t * @param {String} text Text to transform.\n\t\t * @param {Number} enterMode Editor {@link CKEDITOR.config#enterMode Enter mode}.\n\t\t * @returns {String} HTML generated from the text.\n\t\t */\n\t\ttransformPlainTextToHtml: function( text, enterMode ) {\n\t\t\tvar isEnterBrMode = enterMode == CKEDITOR.ENTER_BR,\n\t\t\t\t// CRLF -> LF\n\t\t\t\thtml = this.htmlEncode( text.replace( /\\r\\n/g, '\\n' ) );\n\n\t\t\t// Tab -> &nbsp x 4;\n\t\t\thtml = html.replace( /\\t/g, '&nbsp;&nbsp; &nbsp;' );\n\n\t\t\tvar paragraphTag = enterMode == CKEDITOR.ENTER_P ? 'p' : 'div';\n\n\t\t\t// Two line-breaks create one paragraphing block.\n\t\t\tif ( !isEnterBrMode ) {\n\t\t\t\tvar duoLF = /\\n{2}/g;\n\t\t\t\tif ( duoLF.test( html ) ) {\n\t\t\t\t\tvar openTag = '<' + paragraphTag + '>', endTag = '</' + paragraphTag + '>';\n\t\t\t\t\thtml = openTag + html.replace( duoLF, function() {\n\t\t\t\t\t\treturn endTag + openTag;\n\t\t\t\t\t} ) + endTag;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// One <br> per line-break.\n\t\t\thtml = html.replace( /\\n/g, '<br>' );\n\n\t\t\t// Compensate padding <br> at the end of block, avoid loosing them during insertion.\n\t\t\tif ( !isEnterBrMode ) {\n\t\t\t\thtml = html.replace( new RegExp( '<br>(?=</' + paragraphTag + '>)' ), function( match ) {\n\t\t\t\t\treturn CKEDITOR.tools.repeat( match, 2 );\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\t// Preserve spaces at the ends, so they won't be lost after insertion (merged with adjacent ones).\n\t\t\thtml = html.replace( /^ | $/g, '&nbsp;' );\n\n\t\t\t// Finally, preserve whitespaces that are to be lost.\n\t\t\thtml = html.replace( /(>|\\s) /g, function( match, before ) {\n\t\t\t\treturn before + '&nbsp;';\n\t\t\t} ).replace( / (?=<)/g, '&nbsp;' );\n\n\t\t\treturn html;\n\t\t},\n\n\t\t/**\n\t\t * Gets a unique number for this CKEDITOR execution session. It returns\n\t\t * consecutive numbers starting from 1.\n\t\t *\n\t\t *\t\talert( CKEDITOR.tools.getNextNumber() ); // (e.g.) 1\n\t\t *\t\talert( CKEDITOR.tools.getNextNumber() ); // 2\n\t\t *\n\t\t * @method\n\t\t * @returns {Number} A unique number.\n\t\t */\n\t\tgetNextNumber: ( function() {\n\t\t\tvar last = 0;\n\t\t\treturn function() {\n\t\t\t\treturn ++last;\n\t\t\t};\n\t\t} )(),\n\n\t\t/**\n\t\t * Gets a unique ID for CKEditor interface elements. It returns a\n\t\t * string with the \"cke_\" prefix and a consecutive number.\n\t\t *\n\t\t *\t\talert( CKEDITOR.tools.getNextId() ); // (e.g.) 'cke_1'\n\t\t *\t\talert( CKEDITOR.tools.getNextId() ); // 'cke_2'\n\t\t *\n\t\t * @returns {String} A unique ID.\n\t\t */\n\t\tgetNextId: function() {\n\t\t\treturn 'cke_' + this.getNextNumber();\n\t\t},\n\n\t\t/**\n\t\t * Gets a universally unique ID. It returns a random string\n\t\t * compliant with ISO/IEC 11578:1996, without dashes, with the \"e\" prefix to\n\t\t * make sure that the ID does not start with a number.\n\t\t *\n\t\t * @returns {String} A global unique ID.\n\t\t */\n\t\tgetUniqueId: function() {\n\t\t\tvar uuid = 'e'; // Make sure that id does not start with number.\n\t\t\tfor ( var i = 0; i < 8; i++ ) {\n\t\t\t\tuuid += Math.floor( ( 1 + Math.random() ) * 0x10000 ).toString( 16 ).substring( 1 );\n\t\t\t}\n\t\t\treturn uuid;\n\t\t},\n\n\t\t/**\n\t\t * Creates a function override.\n\t\t *\n\t\t *\t\tvar obj = {\n\t\t *\t\t\tmyFunction: function( name ) {\n\t\t *\t\t\t\talert( 'Name: ' + name );\n\t\t *\t\t\t}\n\t\t *\t\t};\n\t\t *\n\t\t *\t\tobj.myFunction = CKEDITOR.tools.override( obj.myFunction, function( myFunctionOriginal ) {\n\t\t *\t\t\treturn function( name ) {\n\t\t *\t\t\t\talert( 'Overriden name: ' + name );\n\t\t *\t\t\t\tmyFunctionOriginal.call( this, name );\n\t\t *\t\t\t};\n\t\t *\t\t} );\n\t\t *\n\t\t * @param {Function} originalFunction The function to be overridden.\n\t\t * @param {Function} functionBuilder A function that returns the new\n\t\t * function. The original function reference will be passed to this function.\n\t\t * @returns {Function} The new function.\n\t\t */\n\t\toverride: function( originalFunction, functionBuilder ) {\n\t\t\tvar newFn = functionBuilder( originalFunction );\n\t\t\tnewFn.prototype = originalFunction.prototype;\n\t\t\treturn newFn;\n\t\t},\n\n\t\t/**\n\t\t * Executes a function after a specified delay.\n\t\t *\n\t\t *\t\tCKEDITOR.tools.setTimeout( function() {\n\t\t *\t\t\talert( 'Executed after 2 seconds' );\n\t\t *\t\t}, 2000 );\n\t\t *\n\t\t * @param {Function} func The function to be executed.\n\t\t * @param {Number} [milliseconds=0] The amount of time (in milliseconds) to wait\n\t\t * to fire the function execution.\n\t\t * @param {Object} [scope=window] The object to store the function execution scope\n\t\t * (the `this` object).\n\t\t * @param {Object/Array} [args] A single object, or an array of objects, to\n\t\t * pass as argument to the function.\n\t\t * @param {Object} [ownerWindow=window] The window that will be used to set the\n\t\t * timeout.\n\t\t * @returns {Object} A value that can be used to cancel the function execution.\n\t\t */\n\t\tsetTimeout: function( func, milliseconds, scope, args, ownerWindow ) {\n\t\t\tif ( !ownerWindow )\n\t\t\t\townerWindow = window;\n\n\t\t\tif ( !scope )\n\t\t\t\tscope = ownerWindow;\n\n\t\t\treturn ownerWindow.setTimeout( function() {\n\t\t\t\tif ( args )\n\t\t\t\t\tfunc.apply( scope, [].concat( args ) );\n\t\t\t\telse\n\t\t\t\t\tfunc.apply( scope );\n\t\t\t}, milliseconds || 0 );\n\t\t},\n\n\t\t/**\n\t\t * Removes spaces from the start and the end of a string. The following\n\t\t * characters are removed: space, tab, line break, line feed.\n\t\t *\n\t\t *\t\talert( CKEDITOR.tools.trim( '  example ' ); // 'example'\n\t\t *\n\t\t * @method\n\t\t * @param {String} str The text from which the spaces will be removed.\n\t\t * @returns {String} The modified string without the boundary spaces.\n\t\t */\n\t\ttrim: ( function() {\n\t\t\t// We are not using \\s because we don't want \"non-breaking spaces\" to be caught.\n\t\t\tvar trimRegex = /(?:^[ \\t\\n\\r]+)|(?:[ \\t\\n\\r]+$)/g;\n\t\t\treturn function( str ) {\n\t\t\t\treturn str.replace( trimRegex, '' );\n\t\t\t};\n\t\t} )(),\n\n\t\t/**\n\t\t * Removes spaces from the start (left) of a string. The following\n\t\t * characters are removed: space, tab, line break, line feed.\n\t\t *\n\t\t *\t\talert( CKEDITOR.tools.ltrim( '  example ' ); // 'example '\n\t\t *\n\t\t * @method\n\t\t * @param {String} str The text from which the spaces will be removed.\n\t\t * @returns {String} The modified string excluding the removed spaces.\n\t\t */\n\t\tltrim: ( function() {\n\t\t\t// We are not using \\s because we don't want \"non-breaking spaces\" to be caught.\n\t\t\tvar trimRegex = /^[ \\t\\n\\r]+/g;\n\t\t\treturn function( str ) {\n\t\t\t\treturn str.replace( trimRegex, '' );\n\t\t\t};\n\t\t} )(),\n\n\t\t/**\n\t\t * Removes spaces from the end (right) of a string. The following\n\t\t * characters are removed: space, tab, line break, line feed.\n\t\t *\n\t\t *\t\talert( CKEDITOR.tools.ltrim( '  example ' ); // '  example'\n\t\t *\n\t\t * @method\n\t\t * @param {String} str The text from which spaces will be removed.\n\t\t * @returns {String} The modified string excluding the removed spaces.\n\t\t */\n\t\trtrim: ( function() {\n\t\t\t// We are not using \\s because we don't want \"non-breaking spaces\" to be caught.\n\t\t\tvar trimRegex = /[ \\t\\n\\r]+$/g;\n\t\t\treturn function( str ) {\n\t\t\t\treturn str.replace( trimRegex, '' );\n\t\t\t};\n\t\t} )(),\n\n\t\t/**\n\t\t * Returns the index of an element in an array.\n\t\t *\n\t\t *\t\tvar letters = [ 'a', 'b', 0, 'c', false ];\n\t\t *\t\talert( CKEDITOR.tools.indexOf( letters, '0' ) );\t\t// -1 because 0 !== '0'\n\t\t *\t\talert( CKEDITOR.tools.indexOf( letters, false ) );\t\t// 4 because 0 !== false\n\t\t *\n\t\t * @param {Array} array The array to be searched.\n\t\t * @param {Object/Function} value The element to be found. This can be an\n\t\t * evaluation function which receives a single parameter call for\n\t\t * each entry in the array, returning `true` if the entry matches.\n\t\t * @returns {Number} The (zero-based) index of the first entry that matches\n\t\t * the entry, or `-1` if not found.\n\t\t */\n\t\tindexOf: function( array, value ) {\n\t\t\tif ( typeof value == 'function' ) {\n\t\t\t\tfor ( var i = 0, len = array.length; i < len; i++ ) {\n\t\t\t\t\tif ( value( array[ i ] ) )\n\t\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t} else if ( array.indexOf )\n\t\t\t\treturn array.indexOf( value );\n\t\t\telse {\n\t\t\t\tfor ( i = 0, len = array.length; i < len; i++ ) {\n\t\t\t\t\tif ( array[ i ] === value )\n\t\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn -1;\n\t\t},\n\n\t\t/**\n\t\t * Returns the index of an element in an array.\n\t\t *\n\t\t *\t\tvar obj = { prop: true };\n\t\t *\t\tvar letters = [ 'a', 'b', 0, obj, false ];\n\t\t *\n\t\t *\t\talert( CKEDITOR.tools.indexOf( letters, '0' ) ); // null\n\t\t *\t\talert( CKEDITOR.tools.indexOf( letters, function( value ) {\n\t\t *\t\t\t// Return true when passed value has property 'prop'.\n\t\t *\t\t\treturn value && 'prop' in value;\n\t\t *\t\t} ) );\t\t\t\t\t\t\t\t\t\t\t// obj\n\t\t *\n\t\t * @param {Array} array The array to be searched.\n\t\t * @param {Object/Function} value The element to be found. Can be an\n\t\t * evaluation function which receives a single parameter call for\n\t\t * each entry in the array, returning `true` if the entry matches.\n\t\t * @returns Object The value that was found in an array.\n\t\t */\n\t\tsearch: function( array, value ) {\n\t\t\tvar index = CKEDITOR.tools.indexOf( array, value );\n\t\t\treturn index >= 0 ? array[ index ] : null;\n\t\t},\n\n\t\t/**\n\t\t * Creates a function that will always execute in the context of a\n\t\t * specified object.\n\t\t *\n\t\t *\t\tvar obj = { text: 'My Object' };\n\t\t *\n\t\t *\t\tfunction alertText() {\n\t\t *\t\t\talert( this.text );\n\t\t *\t\t}\n\t\t *\n\t\t *\t\tvar newFunc = CKEDITOR.tools.bind( alertText, obj );\n\t\t *\t\tnewFunc(); // Alerts 'My Object'.\n\t\t *\n\t\t * @param {Function} func The function to be executed.\n\t\t * @param {Object} obj The object to which the execution context will be bound.\n\t\t * @returns {Function} The function that can be used to execute the\n\t\t * `func` function in the context of `obj`.\n\t\t */\n\t\tbind: function( func, obj ) {\n\t\t\treturn function() {\n\t\t\t\treturn func.apply( obj, arguments );\n\t\t\t};\n\t\t},\n\n\t\t/**\n\t\t * Class creation based on prototype inheritance which supports of the\n\t\t * following features:\n\t\t *\n\t\t * * Static fields\n\t\t * * Private fields\n\t\t * * Public (prototype) fields\n\t\t * * Chainable base class constructor\n\t\t *\n\t\t * @param {Object} definition The class definition object.\n\t\t * @returns {Function} A class-like JavaScript function.\n\t\t */\n\t\tcreateClass: function( definition ) {\n\t\t\tvar $ = definition.$,\n\t\t\t\tbaseClass = definition.base,\n\t\t\t\tprivates = definition.privates || definition._,\n\t\t\t\tproto = definition.proto,\n\t\t\t\tstatics = definition.statics;\n\n\t\t\t// Create the constructor, if not present in the definition.\n\t\t\t!$ && ( $ = function() {\n\t\t\t\tbaseClass && this.base.apply( this, arguments );\n\t\t\t} );\n\n\t\t\tif ( privates ) {\n\t\t\t\tvar originalConstructor = $;\n\t\t\t\t$ = function() {\n\t\t\t\t\t// Create (and get) the private namespace.\n\t\t\t\t\tvar _ = this._ || ( this._ = {} );\n\n\t\t\t\t\t// Make some magic so \"this\" will refer to the main\n\t\t\t\t\t// instance when coding private functions.\n\t\t\t\t\tfor ( var privateName in privates ) {\n\t\t\t\t\t\tvar priv = privates[ privateName ];\n\n\t\t\t\t\t\t_[ privateName ] = ( typeof priv == 'function' ) ? CKEDITOR.tools.bind( priv, this ) : priv;\n\t\t\t\t\t}\n\n\t\t\t\t\toriginalConstructor.apply( this, arguments );\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif ( baseClass ) {\n\t\t\t\t$.prototype = this.prototypedCopy( baseClass.prototype );\n\t\t\t\t$.prototype.constructor = $;\n\t\t\t\t// Super references.\n\t\t\t\t$.base = baseClass;\n\t\t\t\t$.baseProto = baseClass.prototype;\n\t\t\t\t// Super constructor.\n\t\t\t\t$.prototype.base = function() {\n\t\t\t\t\tthis.base = baseClass.prototype.base;\n\t\t\t\t\tbaseClass.apply( this, arguments );\n\t\t\t\t\tthis.base = arguments.callee;\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif ( proto )\n\t\t\t\tthis.extend( $.prototype, proto, true );\n\n\t\t\tif ( statics )\n\t\t\t\tthis.extend( $, statics, true );\n\n\t\t\treturn $;\n\t\t},\n\n\t\t/**\n\t\t * Creates a function reference that can be called later using\n\t\t * {@link #callFunction}. This approach is especially useful to\n\t\t * make DOM attribute function calls to JavaScript-defined functions.\n\t\t *\n\t\t *\t\tvar ref = CKEDITOR.tools.addFunction( function() {\n\t\t *\t\t\talert( 'Hello!');\n\t\t *\t\t} );\n\t\t *\t\tCKEDITOR.tools.callFunction( ref ); // 'Hello!'\n\t\t *\n\t\t * @param {Function} fn The function to be executed on call.\n\t\t * @param {Object} [scope] The object to have the context on `fn` execution.\n\t\t * @returns {Number} A unique reference to be used in conjuction with\n\t\t * {@link #callFunction}.\n\t\t */\n\t\taddFunction: function( fn, scope ) {\n\t\t\treturn functions.push( function() {\n\t\t\t\treturn fn.apply( scope || this, arguments );\n\t\t\t} ) - 1;\n\t\t},\n\n\t\t/**\n\t\t * Removes the function reference created with {@link #addFunction}.\n\t\t *\n\t\t * @param {Number} ref The function reference created with\n\t\t * {@link #addFunction}.\n\t\t */\n\t\tremoveFunction: function( ref ) {\n\t\t\tfunctions[ ref ] = null;\n\t\t},\n\n\t\t/**\n\t\t * Executes a function based on the reference created with {@link #addFunction}.\n\t\t *\n\t\t *\t\tvar ref = CKEDITOR.tools.addFunction( function() {\n\t\t *\t\t\talert( 'Hello!');\n\t\t *\t\t} );\n\t\t *\t\tCKEDITOR.tools.callFunction( ref ); // 'Hello!'\n\t\t *\n\t\t * @param {Number} ref The function reference created with {@link #addFunction}.\n\t\t * @param {Mixed} params Any number of parameters to be passed to the executed function.\n\t\t * @returns {Mixed} The return value of the function.\n\t\t */\n\t\tcallFunction: function( ref ) {\n\t\t\tvar fn = functions[ ref ];\n\t\t\treturn fn && fn.apply( window, Array.prototype.slice.call( arguments, 1 ) );\n\t\t},\n\n\t\t/**\n\t\t * Appends the `px` length unit to the size value if it is missing.\n\t\t *\n\t\t *\t\tvar cssLength = CKEDITOR.tools.cssLength;\n\t\t *\t\tcssLength( 42 );\t\t// '42px'\n\t\t *\t\tcssLength( '42' );\t\t// '42px'\n\t\t *\t\tcssLength( '42px' );\t// '42px'\n\t\t *\t\tcssLength( '42%' );\t\t// '42%'\n\t\t *\t\tcssLength( 'bold' );\t// 'bold'\n\t\t *\t\tcssLength( false );\t\t// ''\n\t\t *\t\tcssLength( NaN );\t\t// ''\n\t\t *\n\t\t * @method\n\t\t * @param {Number/String/Boolean} length\n\t\t */\n\t\tcssLength: ( function() {\n\t\t\tvar pixelRegex = /^-?\\d+\\.?\\d*px$/,\n\t\t\t\tlengthTrimmed;\n\n\t\t\treturn function( length ) {\n\t\t\t\tlengthTrimmed = CKEDITOR.tools.trim( length + '' ) + 'px';\n\n\t\t\t\tif ( pixelRegex.test( lengthTrimmed ) )\n\t\t\t\t\treturn lengthTrimmed;\n\t\t\t\telse\n\t\t\t\t\treturn length || '';\n\t\t\t};\n\t\t} )(),\n\n\t\t/**\n\t\t * Converts the specified CSS length value to the calculated pixel length inside this page.\n\t\t *\n\t\t * **Note:** Percentage-based value is left intact.\n\t\t *\n\t\t * @method\n\t\t * @param {String} cssLength CSS length value.\n\t\t */\n\t\tconvertToPx: ( function() {\n\t\t\tvar calculator;\n\n\t\t\treturn function( cssLength ) {\n\t\t\t\tif ( !calculator ) {\n\t\t\t\t\tcalculator = CKEDITOR.dom.element.createFromHtml( '<div style=\"position:absolute;left:-9999px;' +\n\t\t\t\t\t\t'top:-9999px;margin:0px;padding:0px;border:0px;\"' +\n\t\t\t\t\t\t'></div>', CKEDITOR.document );\n\t\t\t\t\tCKEDITOR.document.getBody().append( calculator );\n\t\t\t\t}\n\n\t\t\t\tif ( !( /%$/ ).test( cssLength ) ) {\n\t\t\t\t\tcalculator.setStyle( 'width', cssLength );\n\t\t\t\t\treturn calculator.$.clientWidth;\n\t\t\t\t}\n\n\t\t\t\treturn cssLength;\n\t\t\t};\n\t\t} )(),\n\n\t\t/**\n\t\t * String specified by `str` repeats `times` times.\n\t\t *\n\t\t * @param {String} str\n\t\t * @param {Number} times\n\t\t * @returns {String}\n\t\t */\n\t\trepeat: function( str, times ) {\n\t\t\treturn new Array( times + 1 ).join( str );\n\t\t},\n\n\t\t/**\n\t\t * Returns the first successfully executed return value of a function that\n\t\t * does not throw any exception.\n\t\t *\n\t\t * @param {Function...} fn\n\t\t * @returns {Mixed}\n\t\t */\n\t\ttryThese: function() {\n\t\t\tvar returnValue;\n\t\t\tfor ( var i = 0, length = arguments.length; i < length; i++ ) {\n\t\t\t\tvar lambda = arguments[ i ];\n\t\t\t\ttry {\n\t\t\t\t\treturnValue = lambda();\n\t\t\t\t\tbreak;\n\t\t\t\t} catch ( e ) {}\n\t\t\t}\n\t\t\treturn returnValue;\n\t\t},\n\n\t\t/**\n\t\t * Generates a combined key from a series of params.\n\t\t *\n\t\t *\t\tvar key = CKEDITOR.tools.genKey( 'key1', 'key2', 'key3' );\n\t\t *\t\talert( key ); // 'key1-key2-key3'.\n\t\t *\n\t\t * @param {String} subKey One or more strings used as subkeys.\n\t\t * @returns {String}\n\t\t */\n\t\tgenKey: function() {\n\t\t\treturn Array.prototype.slice.call( arguments ).join( '-' );\n\t\t},\n\n\t\t/**\n\t\t * Creates a \"deferred\" function which will not run immediately,\n\t\t * but rather runs as soon as the interpreter’s call stack is empty.\n\t\t * Behaves much like `window.setTimeout` with a delay.\n\t\t *\n\t\t * **Note:** The return value of the original function will be lost.\n\t\t *\n\t\t * @param {Function} fn The callee function.\n\t\t * @returns {Function} The new deferred function.\n\t\t */\n\t\tdefer: function( fn ) {\n\t\t\treturn function() {\n\t\t\t\tvar args = arguments,\n\t\t\t\t\tself = this;\n\t\t\t\twindow.setTimeout( function() {\n\t\t\t\t\tfn.apply( self, args );\n\t\t\t\t}, 0 );\n\t\t\t};\n\t\t},\n\n\t\t/**\n\t\t * Normalizes CSS data in order to avoid differences in the style attribute.\n\t\t *\n\t\t * @param {String} styleText The style data to be normalized.\n\t\t * @param {Boolean} [nativeNormalize=false] Parse the data using the browser.\n\t\t * @returns {String} The normalized value.\n\t\t */\n\t\tnormalizeCssText: function( styleText, nativeNormalize ) {\n\t\t\tvar props = [],\n\t\t\t\tname,\n\t\t\t\tparsedProps = CKEDITOR.tools.parseCssText( styleText, true, nativeNormalize );\n\n\t\t\tfor ( name in parsedProps )\n\t\t\t\tprops.push( name + ':' + parsedProps[ name ] );\n\n\t\t\tprops.sort();\n\n\t\t\treturn props.length ? ( props.join( ';' ) + ';' ) : '';\n\t\t},\n\n\t\t/**\n\t\t * Finds and converts `rgb(x,x,x)` color definition to hexadecimal notation.\n\t\t *\n\t\t * @param {String} styleText The style data (or just a string containing RGB colors) to be converted.\n\t\t * @returns {String} The style data with RGB colors converted to hexadecimal equivalents.\n\t\t */\n\t\tconvertRgbToHex: function( styleText ) {\n\t\t\treturn styleText.replace( /(?:rgb\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\))/gi, function( match, red, green, blue ) {\n\t\t\t\tvar color = [ red, green, blue ];\n\t\t\t\t// Add padding zeros if the hex value is less than 0x10.\n\t\t\t\tfor ( var i = 0; i < 3; i++ )\n\t\t\t\t\tcolor[ i ] = ( '0' + parseInt( color[ i ], 10 ).toString( 16 ) ).slice( -2 );\n\t\t\t\treturn '#' + color.join( '' );\n\t\t\t} );\n\t\t},\n\n\t\t/**\n\t\t * Normalizes hexadecimal notation so that the color string is always 6 characters long and lowercase.\n\t\t *\n\t\t * @param {String} styleText The style data (or just a string containing hex colors) to be converted.\n\t\t * @returns {String} The style data with hex colors normalized.\n\t\t */\n\t\tnormalizeHex: function( styleText ) {\n\t\t\treturn styleText.replace( /#(([0-9a-f]{3}){1,2})($|;|\\s+)/gi, function( match, hexColor, hexColorPart, separator ) {\n\t\t\t\tvar normalizedHexColor = hexColor.toLowerCase();\n\t\t\t\tif ( normalizedHexColor.length == 3 ) {\n\t\t\t\t\tvar parts = normalizedHexColor.split( '' );\n\t\t\t\t\tnormalizedHexColor = [ parts[ 0 ], parts[ 0 ], parts[ 1 ], parts[ 1 ], parts[ 2 ], parts[ 2 ] ].join( '' );\n\t\t\t\t}\n\t\t\t\treturn '#' + normalizedHexColor + separator;\n\t\t\t} );\n\t\t},\n\n\t\t/**\n\t\t * Turns inline style text properties into one hash.\n\t\t *\n\t\t * @param {String} styleText The style data to be parsed.\n\t\t * @param {Boolean} [normalize=false] Normalize properties and values\n\t\t * (e.g. trim spaces, convert to lower case).\n\t\t * @param {Boolean} [nativeNormalize=false] Parse the data using the browser.\n\t\t * @returns {Object} The object containing parsed properties.\n\t\t */\n\t\tparseCssText: function( styleText, normalize, nativeNormalize ) {\n\t\t\tvar retval = {};\n\n\t\t\tif ( nativeNormalize ) {\n\t\t\t\t// Injects the style in a temporary span object, so the browser parses it,\n\t\t\t\t// retrieving its final format.\n\t\t\t\tvar temp = new CKEDITOR.dom.element( 'span' );\n\t\t\t\tstyleText = temp.setAttribute( 'style', styleText ).getAttribute( 'style' ) || '';\n\t\t\t}\n\n\t\t\t// Normalize colors.\n\t\t\tif ( styleText ) {\n\t\t\t\tstyleText = CKEDITOR.tools.normalizeHex( CKEDITOR.tools.convertRgbToHex( styleText ) );\n\t\t\t}\n\n\t\t\t// IE will leave a single semicolon when failed to parse the style text. (#3891)\n\t\t\tif ( !styleText || styleText == ';' )\n\t\t\t\treturn retval;\n\n\t\t\tstyleText.replace( /&quot;/g, '\"' ).replace( /\\s*([^:;\\s]+)\\s*:\\s*([^;]+)\\s*(?=;|$)/g, function( match, name, value ) {\n\t\t\t\tif ( normalize ) {\n\t\t\t\t\tname = name.toLowerCase();\n\t\t\t\t\t// Drop extra whitespacing from font-family.\n\t\t\t\t\tif ( name == 'font-family' )\n\t\t\t\t\t\tvalue = value.replace( /\\s*,\\s*/g, ',' );\n\t\t\t\t\tvalue = CKEDITOR.tools.trim( value );\n\t\t\t\t}\n\n\t\t\t\tretval[ name ] = value;\n\t\t\t} );\n\t\t\treturn retval;\n\t\t},\n\n\t\t/**\n\t\t * Serializes the `style name => value` hash to a style text.\n\t\t *\n\t\t *\t\tvar styleObj = CKEDITOR.tools.parseCssText( 'color: red; border: none' );\n\t\t *\t\tconsole.log( styleObj.color ); // -> 'red'\n\t\t *\t\tCKEDITOR.tools.writeCssText( styleObj ); // -> 'color:red; border:none'\n\t\t *\t\tCKEDITOR.tools.writeCssText( styleObj, true ); // -> 'border:none; color:red'\n\t\t *\n\t\t * @since 4.1\n\t\t * @param {Object} styles The object contaning style properties.\n\t\t * @param {Boolean} [sort] Whether to sort CSS properties.\n\t\t * @returns {String} The serialized style text.\n\t\t */\n\t\twriteCssText: function( styles, sort ) {\n\t\t\tvar name,\n\t\t\t\tstylesArr = [];\n\n\t\t\tfor ( name in styles )\n\t\t\t\tstylesArr.push( name + ':' + styles[ name ] );\n\n\t\t\tif ( sort )\n\t\t\t\tstylesArr.sort();\n\n\t\t\treturn stylesArr.join( '; ' );\n\t\t},\n\n\t\t/**\n\t\t * Compares two objects.\n\t\t *\n\t\t * **Note:** This method performs shallow, non-strict comparison.\n\t\t *\n\t\t * @since 4.1\n\t\t * @param {Object} left\n\t\t * @param {Object} right\n\t\t * @param {Boolean} [onlyLeft] Check only the properties that are present in the `left` object.\n\t\t * @returns {Boolean} Whether objects are identical.\n\t\t */\n\t\tobjectCompare: function( left, right, onlyLeft ) {\n\t\t\tvar name;\n\n\t\t\tif ( !left && !right )\n\t\t\t\treturn true;\n\t\t\tif ( !left || !right )\n\t\t\t\treturn false;\n\n\t\t\tfor ( name in left ) {\n\t\t\t\tif ( left[ name ] != right[ name ] )\n\t\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t\tif ( !onlyLeft ) {\n\t\t\t\tfor ( name in right ) {\n\t\t\t\t\tif ( left[ name ] != right[ name ] )\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\t/**\n\t\t * Returns an array of passed object's keys.\n\t\t *\n\t\t *\t\tconsole.log( CKEDITOR.tools.objectKeys( { foo: 1, bar: false } );\n\t\t *\t\t// -> [ 'foo', 'bar' ]\n\t\t *\n\t\t * @since 4.1\n\t\t * @param {Object} obj\n\t\t * @returns {Array} Object's keys.\n\t\t */\n\t\tobjectKeys: function( obj ) {\n\t\t\tvar keys = [];\n\t\t\tfor ( var i in obj )\n\t\t\t\tkeys.push( i );\n\n\t\t\treturn keys;\n\t\t},\n\n\t\t/**\n\t\t * Converts an array to an object by rewriting array items\n\t\t * to object properties.\n\t\t *\n\t\t *\t\tvar arr = [ 'foo', 'bar', 'foo' ];\n\t\t *\t\tconsole.log( CKEDITOR.tools.convertArrayToObject( arr ) );\n\t\t *\t\t// -> { foo: true, bar: true }\n\t\t *\t\tconsole.log( CKEDITOR.tools.convertArrayToObject( arr, 1 ) );\n\t\t *\t\t// -> { foo: 1, bar: 1 }\n\t\t *\n\t\t * @since 4.1\n\t\t * @param {Array} arr The array to be converted to an object.\n\t\t * @param [fillWith=true] Set each property of an object to `fillWith` value.\n\t\t */\n\t\tconvertArrayToObject: function( arr, fillWith ) {\n\t\t\tvar obj = {};\n\n\t\t\tif ( arguments.length == 1 )\n\t\t\t\tfillWith = true;\n\n\t\t\tfor ( var i = 0, l = arr.length; i < l; ++i )\n\t\t\t\tobj[ arr[ i ] ] = fillWith;\n\n\t\t\treturn obj;\n\t\t},\n\n\t\t/**\n\t\t * Tries to fix the `document.domain` of the current document to match the\n\t\t * parent window domain, avoiding \"Same Origin\" policy issues.\n\t\t * This is an Internet Explorer only requirement.\n\t\t *\n\t\t * @since 4.1.2\n\t\t * @returns {Boolean} `true` if the current domain is already good or if\n\t\t * it has been fixed successfully.\n\t\t */\n\t\tfixDomain: function() {\n\t\t\tvar domain;\n\n\t\t\twhile ( 1 ) {\n\t\t\t\ttry {\n\t\t\t\t\t// Try to access the parent document. It throws\n\t\t\t\t\t// \"access denied\" if restricted by the \"Same Origin\" policy.\n\t\t\t\t\tdomain = window.parent.document.domain;\n\t\t\t\t\tbreak;\n\t\t\t\t} catch ( e ) {\n\t\t\t\t\t// Calculate the value to set to document.domain.\n\t\t\t\t\tdomain = domain ?\n\n\t\t\t\t\t\t// If it is not the first pass, strip one part of the\n\t\t\t\t\t\t// name. E.g.  \"test.example.com\"  => \"example.com\"\n\t\t\t\t\t\tdomain.replace( /.+?(?:\\.|$)/, '' ) :\n\n\t\t\t\t\t\t// In the first pass, we'll handle the\n\t\t\t\t\t\t// \"document.domain = document.domain\" case.\n\t\t\t\t\t\tdocument.domain;\n\n\t\t\t\t\t// Stop here if there is no more domain parts available.\n\t\t\t\t\tif ( !domain )\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdocument.domain = domain;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn !!domain;\n\t\t},\n\n\t\t/**\n\t\t * Buffers `input` events (or any `input` calls)\n\t\t * and triggers `output` not more often than once per `minInterval`.\n\t\t *\n\t\t *\t\tvar buffer = CKEDITOR.tools.eventsBuffer( 200, function() {\n\t\t *\t\t\tconsole.log( 'foo!' );\n\t\t *\t\t} );\n\t\t *\n\t\t *\t\tbuffer.input();\n\t\t *\t\t// 'foo!' logged immediately.\n\t\t *\t\tbuffer.input();\n\t\t *\t\t// Nothing logged.\n\t\t *\t\tbuffer.input();\n\t\t *\t\t// Nothing logged.\n\t\t *\t\t// ... after 200ms a single 'foo!' will be logged.\n\t\t *\n\t\t * Can be easily used with events:\n\t\t *\n\t\t *\t\tvar buffer = CKEDITOR.tools.eventsBuffer( 200, function() {\n\t\t *\t\t\tconsole.log( 'foo!' );\n\t\t *\t\t} );\n\t\t *\n\t\t *\t\teditor.on( 'key', buffer.input );\n\t\t *\t\t// Note: There is no need to bind buffer as a context.\n\t\t *\n\t\t * @since 4.2.1\n\t\t * @param {Number} minInterval Minimum interval between `output` calls in milliseconds.\n\t\t * @param {Function} output Function that will be executed as `output`.\n\t\t * @param {Object} [scopeObj] The object used to scope the listener call (the `this` object).\n\t\t * @returns {Object}\n\t\t * @returns {Function} return.input Buffer's input method.\n\t\t * @returns {Function} return.reset Resets buffered events &mdash; `output` will not be executed\n\t\t * until next `input` is triggered.\n\t\t */\n\t\teventsBuffer: function( minInterval, output, scopeObj ) {\n\t\t\tvar scheduled,\n\t\t\t\tlastOutput = 0;\n\n\t\t\tfunction triggerOutput() {\n\t\t\t\tlastOutput = ( new Date() ).getTime();\n\t\t\t\tscheduled = false;\n\t\t\t\tif ( scopeObj ) {\n\t\t\t\t\toutput.call( scopeObj );\n\t\t\t\t} else {\n\t\t\t\t\toutput();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tinput: function() {\n\t\t\t\t\tif ( scheduled )\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tvar diff = ( new Date() ).getTime() - lastOutput;\n\n\t\t\t\t\t// If less than minInterval passed after last check,\n\t\t\t\t\t// schedule next for minInterval after previous one.\n\t\t\t\t\tif ( diff < minInterval )\n\t\t\t\t\t\tscheduled = setTimeout( triggerOutput, minInterval - diff );\n\t\t\t\t\telse\n\t\t\t\t\t\ttriggerOutput();\n\t\t\t\t},\n\n\t\t\t\treset: function() {\n\t\t\t\t\tif ( scheduled )\n\t\t\t\t\t\tclearTimeout( scheduled );\n\n\t\t\t\t\tscheduled = lastOutput = 0;\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\n\t\t/**\n\t\t * Enables HTML5 elements for older browsers (IE8) in the passed document.\n\t\t *\n\t\t * In IE8 this method can also be executed on a document fragment.\n\t\t *\n\t\t * **Note:** This method has to be used in the `<head>` section of the document.\n\t\t *\n\t\t * @since 4.3\n\t\t * @param {Object} doc Native `Document` or `DocumentFragment` in which the elements will be enabled.\n\t\t * @param {Boolean} [withAppend] Whether to append created elements to the `doc`.\n\t\t */\n\t\tenableHtml5Elements: function( doc, withAppend ) {\n\t\t\tvar els = 'abbr,article,aside,audio,bdi,canvas,data,datalist,details,figcaption,figure,footer,header,hgroup,main,mark,meter,nav,output,progress,section,summary,time,video'.split( ',' ),\n\t\t\t\ti = els.length,\n\t\t\t\tel;\n\n\t\t\twhile ( i-- ) {\n\t\t\t\tel = doc.createElement( els[ i ] );\n\t\t\t\tif ( withAppend )\n\t\t\t\t\tdoc.appendChild( el );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Checks if any of the `arr` items match the provided regular expression.\n\t\t *\n\t\t * @param {Array} arr The array whose items will be checked.\n\t\t * @param {RegExp} regexp The regular expression.\n\t\t * @returns {Boolean} Returns `true` for the first occurrence of the search pattern.\n\t\t * @since 4.4\n\t\t */\n\t\tcheckIfAnyArrayItemMatches: function( arr, regexp ) {\n\t\t\tfor ( var i = 0, l = arr.length; i < l; ++i ) {\n\t\t\t\tif ( arr[ i ].match( regexp ) )\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\n\t\t/**\n\t\t * Checks if any of the `obj` properties match the provided regular expression.\n\t\t *\n\t\t * @param obj The object whose properties will be checked.\n\t\t * @param {RegExp} regexp The regular expression.\n\t\t * @returns {Boolean} Returns `true` for the first occurrence of the search pattern.\n\t\t * @since 4.4\n\t\t */\n\t\tcheckIfAnyObjectPropertyMatches: function( obj, regexp ) {\n\t\t\tfor ( var i in obj ) {\n\t\t\t\tif ( i.match( regexp ) )\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\n\t\t/**\n\t\t * The data URI of a transparent image. May be used e.g. in HTML as an image source or in CSS in `url()`.\n\t\t *\n\t\t * @since 4.4\n\t\t * @readonly\n\t\t */\n\t\ttransparentImageData: 'data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==',\n\n\n\t\t/**\n\t\t * Returns the value of the cookie with a given name or `null` if the cookie is not found.\n\t\t *\n\t\t * @since 4.5.6\n\t\t * @param {String} name\n\t\t * @returns {String}\n\t\t */\n\t\tgetCookie: function( name ) {\n\t\t\tname = name.toLowerCase();\n\t\t\tvar parts = document.cookie.split( ';' );\n\t\t\tvar pair, key;\n\n\t\t\tfor ( var i = 0; i < parts.length; i++ ) {\n\t\t\t\tpair = parts[ i ].split( '=' );\n\t\t\t\tkey = decodeURIComponent( CKEDITOR.tools.trim( pair[ 0 ] ).toLowerCase() );\n\n\t\t\t\tif ( key === name ) {\n\t\t\t\t\treturn decodeURIComponent( pair.length > 1 ? pair[ 1 ] : '' );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\n\t\t/**\n\t\t * Sets the value of the cookie with a given name.\n\t\t *\n\t\t * @since 4.5.6\n\t\t * @param {String} name\n\t\t * @param {String} value\n\t\t */\n\t\tsetCookie: function( name, value ) {\n\t\t\tdocument.cookie = encodeURIComponent( name ) + '=' + encodeURIComponent( value ) + ';path=/';\n\t\t},\n\n\t\t/**\n\t\t * Returns the CSRF token value. The value is a hash stored in `document.cookie`\n\t\t * under the `ckCsrfToken` key. The CSRF token can be used to secure the communication\n\t\t * between the web browser and the server, i.e. for the file upload feature in the editor.\n\t\t *\n\t\t * @since 4.5.6\n\t\t * @returns {String}\n\t\t */\n\t\tgetCsrfToken: function() {\n\t\t\tvar token = CKEDITOR.tools.getCookie( TOKEN_COOKIE_NAME );\n\n\t\t\tif ( !token || token.length != TOKEN_LENGTH ) {\n\t\t\t\ttoken = generateToken( TOKEN_LENGTH );\n\t\t\t\tCKEDITOR.tools.setCookie( TOKEN_COOKIE_NAME, token );\n\t\t\t}\n\n\t\t\treturn token;\n\t\t},\n\n\t\t/**\n\t\t * Returns an escaped CSS selector. `CSS.escape()` is used if defined, leading digit is escaped otherwise.\n\t\t *\n\t\t * @since 4.5.10\n\t\t * @param {String} selector A CSS selector to escape.\n\t\t * @returns {String} An escaped selector.\n\t\t */\n\t\tescapeCss: function( selector ) {\n\t\t\t// Invalid input.\n\t\t\tif ( !selector ) {\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\t// CSS.escape() can be used.\n\t\t\tif ( window.CSS && CSS.escape ) {\n\t\t\t\treturn CSS.escape( selector );\n\t\t\t}\n\n\t\t\t// Simple leading digit escape.\n\t\t\tif ( !isNaN( parseInt( selector.charAt( 0 ), 10 ) ) ) {\n\t\t\t\treturn '\\\\3' + selector.charAt( 0 ) + ' ' + selector.substring( 1, selector.length );\n\t\t\t}\n\n\t\t\treturn selector;\n\t\t}\n\t};\n\n\t// Generates a CSRF token with a given length.\n\t//\n\t// @since 4.5.6\n\t// @param {Number} length\n\t// @returns {string}\n\tfunction generateToken( length ) {\n\t\tvar randValues = [];\n\t\tvar result = '';\n\n\t\tif ( window.crypto && window.crypto.getRandomValues ) {\n\t\t\trandValues = new Uint8Array( length );\n\t\t\twindow.crypto.getRandomValues( randValues );\n\t\t} else {\n\t\t\tfor ( var i = 0; i < length; i++ ) {\n\t\t\t\trandValues.push( Math.floor( Math.random() * 256 ) );\n\t\t\t}\n\t\t}\n\n\t\tfor ( var j = 0; j < randValues.length; j++ ) {\n\t\t\tvar character = tokenCharset.charAt( randValues[ j ] % tokenCharset.length );\n\t\t\tresult += Math.random() > 0.5 ? character.toUpperCase() : character;\n\t\t}\n\n\t\treturn result;\n\t}\n} )();\n\n// PACKAGER_RENAME( CKEDITOR.tools )\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/tools.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Defines the {@link CKEDITOR.dtd} object, which holds the DTD\n *\t\tmapping for XHTML 1.0 Transitional. This file was automatically\n *\t\tgenerated from the file: xhtml1-transitional.dtd.\n */\n\n/**\n * Holds and object representation of the HTML DTD to be used by the\n * editor in its internal operations.\n *\n * Each element in the DTD is represented by a property in this object. Each\n * property contains the list of elements that can be contained by the element.\n * Text is represented by the `#` property.\n *\n * Several special grouping properties are also available. Their names start\n * with the `$` character.\n *\n *\t\t// Check if <div> can be contained in a <p> element.\n *\t\talert( !!CKEDITOR.dtd[ 'p' ][ 'div' ] ); // false\n *\n *\t\t// Check if <p> can be contained in a <div> element.\n *\t\talert( !!CKEDITOR.dtd[ 'div' ][ 'p' ] ); // true\n *\n *\t\t// Check if <p> is a block element.\n *\t\talert( !!CKEDITOR.dtd.$block[ 'p' ] ); // true\n *\n * @class CKEDITOR.dtd\n * @singleton\n */\nCKEDITOR.dtd = ( function() {\n\t'use strict';\n\n\tvar X = CKEDITOR.tools.extend,\n\t\t// Subtraction rest of sets, from the first set.\n\t\tY = function( source, removed ) {\n\t\t\tvar substracted = CKEDITOR.tools.clone( source );\n\t\t\tfor ( var i = 1; i < arguments.length; i++ ) {\n\t\t\t\tremoved = arguments[ i ];\n\t\t\t\tfor ( var name in removed )\n\t\t\t\t\tdelete substracted[ name ];\n\t\t\t}\n\t\t\treturn substracted;\n\t\t};\n\n\t// Phrasing elements.\n\t// P = { a: 1, em: 1, strong: 1, small: 1, abbr: 1, dfn: 1, i: 1, b: 1, s: 1,\n\t//\t\tu: 1, code: 1, 'var': 1, samp: 1, kbd: 1, sup: 1, sub: 1, q: 1, cite: 1,\n\t//\t\tspan: 1, bdo: 1, bdi: 1, br: 1, wbr: 1, ins: 1, del: 1, img: 1, embed: 1,\n\t//\t\tobject: 1, iframe: 1, map: 1, area: 1, script: 1, noscript: 1, ruby: 1,\n\t//\t\tvideo: 1, audio: 1, input: 1, textarea: 1, select: 1, button: 1, label: 1,\n\t//\t\toutput: 1, keygen: 1, progress: 1, command: 1, canvas: 1, time: 1,\n\t//\t\tmeter: 1, detalist: 1 },\n\n\t// Flow elements.\n\t// F = { a: 1, p: 1, hr: 1, pre: 1, ul: 1, ol: 1, dl: 1, div: 1, h1: 1, h2: 1,\n\t//\t\th3: 1, h4: 1, h5: 1, h6: 1, hgroup: 1, address: 1, blockquote: 1, ins: 1,\n\t//\t\tdel: 1, object: 1, map: 1, noscript: 1, section: 1, nav: 1, article: 1,\n\t//\t\taside: 1, header: 1, footer: 1, video: 1, audio: 1, figure: 1, table: 1,\n\t//\t\tform: 1, fieldset: 1, menu: 1, canvas: 1, details:1 },\n\n\t// Text can be everywhere.\n\t// X( P, T );\n\t// Flow elements set consists of phrasing elements set.\n\t// X( F, P );\n\n\tvar P = {}, F = {},\n\t\t// Intersection of flow elements set and phrasing elements set.\n\t\tPF = {\n\t\t\ta: 1, abbr: 1, area: 1, audio: 1, b: 1, bdi: 1, bdo: 1, br: 1, button: 1, canvas: 1, cite: 1,\n\t\t\tcode: 1, command: 1, datalist: 1, del: 1, dfn: 1, em: 1, embed: 1, i: 1, iframe: 1, img: 1,\n\t\t\tinput: 1, ins: 1, kbd: 1, keygen: 1, label: 1, map: 1, mark: 1, meter: 1, noscript: 1, object: 1,\n\t\t\toutput: 1, progress: 1, q: 1, ruby: 1, s: 1, samp: 1, script: 1, select: 1, small: 1, span: 1,\n\t\t\tstrong: 1, sub: 1, sup: 1, textarea: 1, time: 1, u: 1, 'var': 1, video: 1, wbr: 1\n\t\t},\n\t\t// F - PF (Flow Only).\n\t\tFO = {\n\t\t\taddress: 1, article: 1, aside: 1, blockquote: 1, details: 1, div: 1, dl: 1, fieldset: 1,\n\t\t\tfigure: 1, footer: 1, form: 1, h1: 1, h2: 1, h3: 1, h4: 1, h5: 1, h6: 1, header: 1, hgroup: 1,\n\t\t\thr: 1, main: 1, menu: 1, nav: 1, ol: 1, p: 1, pre: 1, section: 1, table: 1, ul: 1\n\t\t},\n\t\t// Metadata elements.\n\t\tM = { command: 1, link: 1, meta: 1, noscript: 1, script: 1, style: 1 },\n\t\t// Empty.\n\t\tE = {},\n\t\t// Text.\n\t\tT = { '#': 1 },\n\n\t\t// Deprecated phrasing elements.\n\t\tDP = { acronym: 1, applet: 1, basefont: 1, big: 1, font: 1, isindex: 1, strike: 1, style: 1, tt: 1 }, // TODO remove \"style\".\n\t\t// Deprecated flow only elements.\n\t\tDFO = { center: 1, dir: 1, noframes: 1 };\n\n\t// Phrasing elements := PF + T + DP\n\tX( P, PF, T, DP );\n\t// Flow elements := FO + P + DFO\n\tX( F, FO, P, DFO );\n\n\tvar dtd = {\n\t\ta: Y( P, { a: 1, button: 1 } ), // Treat as normal inline element (not a transparent one).\n\t\tabbr: P,\n\t\taddress: F,\n\t\tarea: E,\n\t\tarticle: F,\n\t\taside: F,\n\t\taudio: X( { source: 1, track: 1 }, F ),\n\t\tb: P,\n\t\tbase: E,\n\t\tbdi: P,\n\t\tbdo: P,\n\t\tblockquote: F,\n\t\tbody: F,\n\t\tbr: E,\n\t\tbutton: Y( P, { a: 1, button: 1 } ),\n\t\tcanvas: P, // Treat as normal inline element (not a transparent one).\n\t\tcaption: F,\n\t\tcite: P,\n\t\tcode: P,\n\t\tcol: E,\n\t\tcolgroup: { col: 1 },\n\t\tcommand: E,\n\t\tdatalist: X( { option: 1 }, P ),\n\t\tdd: F,\n\t\tdel: P, // Treat as normal inline element (not a transparent one).\n\t\tdetails: X( { summary: 1 }, F ),\n\t\tdfn: P,\n\t\tdiv: F,\n\t\tdl: { dt: 1, dd: 1 },\n\t\tdt: F,\n\t\tem: P,\n\t\tembed: E,\n\t\tfieldset: X( { legend: 1 }, F ),\n\t\tfigcaption: F,\n\t\tfigure: X( { figcaption: 1 }, F ),\n\t\tfooter: F,\n\t\tform: F,\n\t\th1: P,\n\t\th2: P,\n\t\th3: P,\n\t\th4: P,\n\t\th5: P,\n\t\th6: P,\n\t\thead: X( { title: 1, base: 1 }, M ),\n\t\theader: F,\n\t\thgroup: { h1: 1, h2: 1, h3: 1, h4: 1, h5: 1, h6: 1 },\n\t\thr: E,\n\t\thtml: X( { head: 1, body: 1 }, F, M ), // Head and body are optional...\n\t\ti: P,\n\t\tiframe: T,\n\t\timg: E,\n\t\tinput: E,\n\t\tins: P, // Treat as normal inline element (not a transparent one).\n\t\tkbd: P,\n\t\tkeygen: E,\n\t\tlabel: P,\n\t\tlegend: P,\n\t\tli: F,\n\t\tlink: E,\n\t\t// Can't be a descendant of article, aside, footer, header, nav, but we don't need this\n\t\t// complication. As well as checking if it's used only once.\n\t\tmain: F,\n\t\tmap: F,\n\t\tmark: P, // Treat as normal inline element (not a transparent one).\n\t\tmenu: X( { li: 1 }, F ),\n\t\tmeta: E,\n\t\tmeter: Y( P, { meter: 1 } ),\n\t\tnav: F,\n\t\tnoscript: X( { link: 1, meta: 1, style: 1 }, P ), // Treat as normal inline element (not a transparent one).\n\t\tobject: X( { param: 1 }, P ), // Treat as normal inline element (not a transparent one).\n\t\tol: { li: 1 },\n\t\toptgroup: { option: 1 },\n\t\toption: T,\n\t\toutput: P,\n\t\tp: P,\n\t\tparam: E,\n\t\tpre: P,\n\t\tprogress: Y( P, { progress: 1 } ),\n\t\tq: P,\n\t\trp: P,\n\t\trt: P,\n\t\truby: X( { rp: 1, rt: 1 }, P ),\n\t\ts: P,\n\t\tsamp: P,\n\t\tscript: T,\n\t\tsection: F,\n\t\tselect: { optgroup: 1, option: 1 },\n\t\tsmall: P,\n\t\tsource: E,\n\t\tspan: P,\n\t\tstrong: P,\n\t\tstyle: T,\n\t\tsub: P,\n\t\tsummary: X( { h1: 1, h2: 1, h3: 1, h4: 1, h5: 1, h6: 1 }, P ),\n\t\tsup: P,\n\t\ttable: { caption: 1, colgroup: 1, thead: 1, tfoot: 1, tbody: 1, tr: 1 },\n\t\ttbody: { tr: 1 },\n\t\ttd: F,\n\t\ttextarea: T,\n\t\ttfoot: { tr: 1 },\n\t\tth: F,\n\t\tthead: { tr: 1 },\n\t\ttime: Y( P, { time: 1 } ),\n\t\ttitle: T,\n\t\ttr: { th: 1, td: 1 },\n\t\ttrack: E,\n\t\tu: P,\n\t\tul: { li: 1 },\n\t\t'var': P,\n\t\tvideo: X( { source: 1, track: 1 }, F ),\n\t\twbr: E,\n\n\t\t// Deprecated tags.\n\t\tacronym: P,\n\t\tapplet: X( { param: 1 }, F ),\n\t\tbasefont: E,\n\t\tbig: P,\n\t\tcenter: F,\n\t\tdialog: E,\n\t\tdir: { li: 1 },\n\t\tfont: P,\n\t\tisindex: E,\n\t\tnoframes: F,\n\t\tstrike: P,\n\t\ttt: P\n\t};\n\n\tX( dtd, {\n\t\t/**\n\t\t * List of block elements, like `<p>` or `<div>`.\n\t\t */\n\t\t$block: X( { audio: 1, dd: 1, dt: 1, figcaption: 1, li: 1, video: 1 }, FO, DFO ),\n\n\t\t/**\n\t\t * List of elements that contain other blocks, in which block-level operations should be limited,\n\t\t * this property is not intended to be checked directly, use {@link CKEDITOR.dom.elementPath#blockLimit} instead.\n\t\t *\n\t\t * Some examples of editor behaviors that are impacted by block limits:\n\t\t *\n\t\t * * Enter key never split a block-limit element;\n\t\t * * Style application is constraint by the block limit of the current selection.\n\t\t * * Pasted html will be inserted into the block limit of the current selection.\n\t\t *\n\t\t * **Note:** As an exception `<li>` is not considered as a block limit, as it's generally used as a text block.\n\t\t */\n\t\t$blockLimit: {\n\t\t\tarticle: 1, aside: 1, audio: 1, body: 1, caption: 1, details: 1, dir: 1, div: 1, dl: 1,\n\t\t\tfieldset: 1, figcaption: 1, figure: 1, footer: 1, form: 1, header: 1, hgroup: 1, main: 1, menu: 1, nav: 1,\n\t\t\tol: 1, section: 1, table: 1, td: 1, th: 1, tr: 1, ul: 1, video: 1\n\t\t},\n\n\t\t/**\n\t\t * List of elements that contain character data.\n\t\t */\n\t\t$cdata: { script: 1, style: 1 },\n\n\t\t/**\n\t\t * List of elements that are accepted as inline editing hosts.\n\t\t */\n\t\t$editable: {\n\t\t\taddress: 1, article: 1, aside: 1, blockquote: 1, body: 1, details: 1, div: 1, fieldset: 1,\n\t\t\tfigcaption: 1, footer: 1, form: 1, h1: 1, h2: 1, h3: 1, h4: 1, h5: 1, h6: 1, header: 1, hgroup: 1,\n\t\t\tmain: 1, nav: 1, p: 1, pre: 1, section: 1\n\t\t},\n\n\t\t/**\n\t\t * List of empty (self-closing) elements, like `<br>` or `<img>`.\n\t\t */\n\t\t$empty: {\n\t\t\tarea: 1, base: 1, basefont: 1, br: 1, col: 1, command: 1, dialog: 1, embed: 1, hr: 1, img: 1,\n\t\t\tinput: 1, isindex: 1, keygen: 1, link: 1, meta: 1, param: 1, source: 1, track: 1, wbr: 1\n\t\t},\n\n\t\t/**\n\t\t * List of inline (`<span>` like) elements.\n\t\t */\n\t\t$inline: P,\n\n\t\t/**\n\t\t * List of list root elements.\n\t\t */\n\t\t$list: { dl: 1, ol: 1, ul: 1 },\n\n\t\t/**\n\t\t * List of list item elements, like `<li>` or `<dd>`.\n\t\t */\n\t\t$listItem: { dd: 1, dt: 1, li: 1 },\n\n\t\t/**\n\t\t * List of elements which may live outside body.\n\t\t */\n\t\t$nonBodyContent: X( { body: 1, head: 1, html: 1 }, dtd.head ),\n\n\t\t/**\n\t\t * Elements that accept text nodes, but are not possible to edit into the browser.\n\t\t */\n\t\t$nonEditable: {\n\t\t\tapplet: 1, audio: 1, button: 1, embed: 1, iframe: 1, map: 1, object: 1, option: 1,\n\t\t\tparam: 1, script: 1, textarea: 1, video: 1\n\t\t},\n\n\t\t/**\n\t\t * Elements that are considered objects, therefore selected as a whole in the editor.\n\t\t */\n\t\t$object: {\n\t\t\tapplet: 1, audio: 1, button: 1, hr: 1, iframe: 1, img: 1, input: 1, object: 1, select: 1,\n\t\t\ttable: 1, textarea: 1, video: 1\n\t\t},\n\n\t\t/**\n\t\t * List of elements that can be ignored if empty, like `<b>` or `<span>`.\n\t\t */\n\t\t$removeEmpty: {\n\t\t\tabbr: 1, acronym: 1, b: 1, bdi: 1, bdo: 1, big: 1, cite: 1, code: 1, del: 1, dfn: 1,\n\t\t\tem: 1, font: 1, i: 1, ins: 1, label: 1, kbd: 1, mark: 1, meter: 1, output: 1, q: 1, ruby: 1, s: 1,\n\t\t\tsamp: 1, small: 1, span: 1, strike: 1, strong: 1, sub: 1, sup: 1, time: 1, tt: 1, u: 1, 'var': 1\n\t\t},\n\n\t\t/**\n\t\t * List of elements that have tabindex set to zero by default.\n\t\t */\n\t\t$tabIndex: { a: 1, area: 1, button: 1, input: 1, object: 1, select: 1, textarea: 1 },\n\n\t\t/**\n\t\t * List of elements used inside the `<table>` element, like `<tbody>` or `<td>`.\n\t\t */\n\t\t$tableContent: { caption: 1, col: 1, colgroup: 1, tbody: 1, td: 1, tfoot: 1, th: 1, thead: 1, tr: 1 },\n\n\t\t/**\n\t\t * List of \"transparent\" elements. See [W3C's definition of \"transparent\" element](http://dev.w3.org/html5/markup/terminology.html#transparent).\n\t\t */\n\t\t$transparent: { a: 1, audio: 1, canvas: 1, del: 1, ins: 1, map: 1, noscript: 1, object: 1, video: 1 },\n\n\t\t/**\n\t\t * List of elements that are not to exist standalone that must live under it's parent element.\n\t\t */\n\t\t$intermediate: {\n\t\t\tcaption: 1, colgroup: 1, dd: 1, dt: 1, figcaption: 1, legend: 1, li: 1, optgroup: 1,\n\t\t\toption: 1, rp: 1, rt: 1, summary: 1, tbody: 1, td: 1, tfoot: 1, th: 1, thead: 1, tr: 1\n\t\t}\n\t} );\n\n\treturn dtd;\n} )();\n\n// PACKAGER_RENAME( CKEDITOR.dtd )\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/dtd.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Defines the {@link CKEDITOR.dom.event} class, which\n *\t\trepresents the a native DOM event object.\n */\n\n/**\n * Represents a native DOM event object.\n *\n * @class\n * @constructor Creates an event class instance.\n * @param {Object} domEvent A native DOM event object.\n */\nCKEDITOR.dom.event = function( domEvent ) {\n\t/**\n\t * The native DOM event object represented by this class instance.\n\t *\n\t * @readonly\n\t */\n\tthis.$ = domEvent;\n};\n\nCKEDITOR.dom.event.prototype = {\n\t/**\n\t * Gets the key code associated to the event.\n\t *\n\t *\t\talert( event.getKey() ); // '65' is 'a' has been pressed\n\t *\n\t * @returns {Number} The key code.\n\t */\n\tgetKey: function() {\n\t\treturn this.$.keyCode || this.$.which;\n\t},\n\n\t/**\n\t * Gets a number represeting the combination of the keys pressed during the\n\t * event. It is the sum with the current key code and the {@link CKEDITOR#CTRL},\n\t * {@link CKEDITOR#SHIFT} and {@link CKEDITOR#ALT} constants.\n\t *\n\t *\t\talert( event.getKeystroke() == 65 );\t\t\t\t\t\t\t\t\t// 'a' key\n\t *\t\talert( event.getKeystroke() == CKEDITOR.CTRL + 65 );\t\t\t\t\t// CTRL + 'a' key\n\t *\t\talert( event.getKeystroke() == CKEDITOR.CTRL + CKEDITOR.SHIFT + 65 );\t// CTRL + SHIFT + 'a' key\n\t *\n\t * @returns {Number} The number representing the keys combination.\n\t */\n\tgetKeystroke: function() {\n\t\tvar keystroke = this.getKey();\n\n\t\tif ( this.$.ctrlKey || this.$.metaKey )\n\t\t\tkeystroke += CKEDITOR.CTRL;\n\n\t\tif ( this.$.shiftKey )\n\t\t\tkeystroke += CKEDITOR.SHIFT;\n\n\t\tif ( this.$.altKey )\n\t\t\tkeystroke += CKEDITOR.ALT;\n\n\t\treturn keystroke;\n\t},\n\n\t/**\n\t * Prevents the original behavior of the event to happen. It can optionally\n\t * stop propagating the event in the event chain.\n\t *\n\t *\t\tvar element = CKEDITOR.document.getById( 'myElement' );\n\t *\t\telement.on( 'click', function( ev ) {\n\t *\t\t\t// The DOM event object is passed by the 'data' property.\n\t *\t\t\tvar domEvent = ev.data;\n\t *\t\t\t// Prevent the click to chave any effect in the element.\n\t *\t\t\tdomEvent.preventDefault();\n\t *\t\t} );\n\t *\n\t * @param {Boolean} [stopPropagation=false] Stop propagating this event in the\n\t * event chain.\n\t */\n\tpreventDefault: function( stopPropagation ) {\n\t\tvar $ = this.$;\n\t\tif ( $.preventDefault )\n\t\t\t$.preventDefault();\n\t\telse\n\t\t\t$.returnValue = false;\n\n\t\tif ( stopPropagation )\n\t\t\tthis.stopPropagation();\n\t},\n\n\t/**\n\t * Stops this event propagation in the event chain.\n\t */\n\tstopPropagation: function() {\n\t\tvar $ = this.$;\n\t\tif ( $.stopPropagation )\n\t\t\t$.stopPropagation();\n\t\telse\n\t\t\t$.cancelBubble = true;\n\t},\n\n\t/**\n\t * Returns the DOM node where the event was targeted to.\n\t *\n\t *\t\tvar element = CKEDITOR.document.getById( 'myElement' );\n\t *\t\telement.on( 'click', function( ev ) {\n\t *\t\t\t// The DOM event object is passed by the 'data' property.\n\t *\t\t\tvar domEvent = ev.data;\n\t *\t\t\t// Add a CSS class to the event target.\n\t *\t\t\tdomEvent.getTarget().addClass( 'clicked' );\n\t *\t\t} );\n\t *\n\t * @returns {CKEDITOR.dom.node} The target DOM node.\n\t */\n\tgetTarget: function() {\n\t\tvar rawNode = this.$.target || this.$.srcElement;\n\t\treturn rawNode ? new CKEDITOR.dom.node( rawNode ) : null;\n\t},\n\n\t/**\n\t * Returns an integer value that indicates the current processing phase of an event.\n\t * For browsers that doesn't support event phase, {@link CKEDITOR#EVENT_PHASE_AT_TARGET} is always returned.\n\t *\n\t * @returns {Number} One of {@link CKEDITOR#EVENT_PHASE_CAPTURING},\n\t * {@link CKEDITOR#EVENT_PHASE_AT_TARGET}, or {@link CKEDITOR#EVENT_PHASE_BUBBLING}.\n\t */\n\tgetPhase: function() {\n\t\treturn this.$.eventPhase || 2;\n\t},\n\n\t/**\n\t * Retrieves the coordinates of the mouse pointer relative to the top-left\n\t * corner of the document, in mouse related event.\n\t *\n\t *\t\telement.on( 'mousemouse', function( ev ) {\n\t *\t\t\tvar pageOffset = ev.data.getPageOffset();\n\t *\t\t\talert( pageOffset.x );\t\t\t// page offset X\n\t *\t\t\talert( pageOffset.y );\t\t\t// page offset Y\n\t *     } );\n\t *\n\t * @returns {Object} The object contains the position.\n\t * @returns {Number} return.x\n\t * @returns {Number} return.y\n\t */\n\tgetPageOffset: function() {\n\t\tvar doc = this.getTarget().getDocument().$;\n\t\tvar pageX = this.$.pageX || this.$.clientX + ( doc.documentElement.scrollLeft || doc.body.scrollLeft );\n\t\tvar pageY = this.$.pageY || this.$.clientY + ( doc.documentElement.scrollTop || doc.body.scrollTop );\n\t\treturn { x: pageX, y: pageY };\n\t}\n};\n\n// For the followind constants, we need to go over the Unicode boundaries\n// (0x10FFFF) to avoid collision.\n\n/**\n * CTRL key (0x110000).\n *\n * @readonly\n * @property {Number} [=0x110000]\n * @member CKEDITOR\n */\nCKEDITOR.CTRL = 0x110000;\n\n/**\n * SHIFT key (0x220000).\n *\n * @readonly\n * @property {Number} [=0x220000]\n * @member CKEDITOR\n */\nCKEDITOR.SHIFT = 0x220000;\n\n/**\n * ALT key (0x440000).\n *\n * @readonly\n * @property {Number} [=0x440000]\n * @member CKEDITOR\n */\nCKEDITOR.ALT = 0x440000;\n\n/**\n * Capturing phase.\n *\n * @readonly\n * @property {Number} [=1]\n * @member CKEDITOR\n */\nCKEDITOR.EVENT_PHASE_CAPTURING = 1;\n\n/**\n * Event at target.\n *\n * @readonly\n * @property {Number} [=2]\n * @member CKEDITOR\n */\nCKEDITOR.EVENT_PHASE_AT_TARGET = 2;\n\n/**\n * Bubbling phase.\n *\n * @readonly\n * @property {Number} [=3]\n * @member CKEDITOR\n */\nCKEDITOR.EVENT_PHASE_BUBBLING = 3;\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/dom/event.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Defines the {@link CKEDITOR.editor} class, which is the base\n *\t\tfor other classes representing DOM objects.\n */\n\n/**\n * Represents a DOM object. This class is not intended to be used directly. It\n * serves as the base class for other classes representing specific DOM\n * objects.\n *\n * @class\n * @mixins CKEDITOR.event\n * @constructor Creates a domObject class instance.\n * @param {Object} nativeDomObject A native DOM object.\n */\nCKEDITOR.dom.domObject = function( nativeDomObject ) {\n\tif ( nativeDomObject ) {\n\t\t/**\n\t\t * The native DOM object represented by this class instance.\n\t\t *\n\t\t *\t\tvar element = new CKEDITOR.dom.element( 'span' );\n\t\t *\t\talert( element.$.nodeType ); // '1'\n\t\t *\n\t\t * @readonly\n\t\t * @property {Object}\n\t\t */\n\t\tthis.$ = nativeDomObject;\n\t}\n};\n\nCKEDITOR.dom.domObject.prototype = ( function() {\n\t// Do not define other local variables here. We want to keep the native\n\t// listener closures as clean as possible.\n\n\tvar getNativeListener = function( domObject, eventName ) {\n\t\t\treturn function( domEvent ) {\n\t\t\t\t// In FF, when reloading the page with the editor focused, it may\n\t\t\t\t// throw an error because the CKEDITOR global is not anymore\n\t\t\t\t// available. So, we check it here first. (#2923)\n\t\t\t\tif ( typeof CKEDITOR != 'undefined' )\n\t\t\t\t\tdomObject.fire( eventName, new CKEDITOR.dom.event( domEvent ) );\n\t\t\t};\n\t\t};\n\n\treturn {\n\n\t\t/**\n\t\t * Gets the private `_` object which is bound to the native\n\t\t * DOM object using {@link #getCustomData}.\n\t\t *\n\t\t *\t\tvar elementA = new CKEDITOR.dom.element( nativeElement );\n\t\t *\t\telementA.getPrivate().value = 1;\n\t\t *\t\t...\n\t\t *\t\tvar elementB = new CKEDITOR.dom.element( nativeElement );\n\t\t *\t\telementB.getPrivate().value; // 1\n\t\t *\n\t\t * @returns {Object} The private object.\n\t\t */\n\t\tgetPrivate: function() {\n\t\t\tvar priv;\n\n\t\t\t// Get the main private object from the custom data. Create it if not defined.\n\t\t\tif ( !( priv = this.getCustomData( '_' ) ) )\n\t\t\t\tthis.setCustomData( '_', ( priv = {} ) );\n\n\t\t\treturn priv;\n\t\t},\n\n\t\t// Docs inherited from event.\n\t\ton: function( eventName ) {\n\t\t\t// We customize the \"on\" function here. The basic idea is that we'll have\n\t\t\t// only one listener for a native event, which will then call all listeners\n\t\t\t// set to the event.\n\n\t\t\t// Get the listeners holder object.\n\t\t\tvar nativeListeners = this.getCustomData( '_cke_nativeListeners' );\n\n\t\t\tif ( !nativeListeners ) {\n\t\t\t\tnativeListeners = {};\n\t\t\t\tthis.setCustomData( '_cke_nativeListeners', nativeListeners );\n\t\t\t}\n\n\t\t\t// Check if we have a listener for that event.\n\t\t\tif ( !nativeListeners[ eventName ] ) {\n\t\t\t\tvar listener = nativeListeners[ eventName ] = getNativeListener( this, eventName );\n\n\t\t\t\tif ( this.$.addEventListener )\n\t\t\t\t\tthis.$.addEventListener( eventName, listener, !!CKEDITOR.event.useCapture );\n\t\t\t\telse if ( this.$.attachEvent )\n\t\t\t\t\tthis.$.attachEvent( 'on' + eventName, listener );\n\t\t\t}\n\n\t\t\t// Call the original implementation.\n\t\t\treturn CKEDITOR.event.prototype.on.apply( this, arguments );\n\t\t},\n\n\t\t// Docs inherited from event.\n\t\tremoveListener: function( eventName ) {\n\t\t\t// Call the original implementation.\n\t\t\tCKEDITOR.event.prototype.removeListener.apply( this, arguments );\n\n\t\t\t// If we don't have listeners for this event, clean the DOM up.\n\t\t\tif ( !this.hasListeners( eventName ) ) {\n\t\t\t\tvar nativeListeners = this.getCustomData( '_cke_nativeListeners' );\n\t\t\t\tvar listener = nativeListeners && nativeListeners[ eventName ];\n\t\t\t\tif ( listener ) {\n\t\t\t\t\tif ( this.$.removeEventListener )\n\t\t\t\t\t\tthis.$.removeEventListener( eventName, listener, false );\n\t\t\t\t\telse if ( this.$.detachEvent )\n\t\t\t\t\t\tthis.$.detachEvent( 'on' + eventName, listener );\n\n\t\t\t\t\tdelete nativeListeners[ eventName ];\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Removes any listener set on this object.\n\t\t *\n\t\t * To avoid memory leaks we must assure that there are no\n\t\t * references left after the object is no longer needed.\n\t\t */\n\t\tremoveAllListeners: function() {\n\t\t\tvar nativeListeners = this.getCustomData( '_cke_nativeListeners' );\n\t\t\tfor ( var eventName in nativeListeners ) {\n\t\t\t\tvar listener = nativeListeners[ eventName ];\n\t\t\t\tif ( this.$.detachEvent )\n\t\t\t\t\tthis.$.detachEvent( 'on' + eventName, listener );\n\t\t\t\telse if ( this.$.removeEventListener )\n\t\t\t\t\tthis.$.removeEventListener( eventName, listener, false );\n\n\t\t\t\tdelete nativeListeners[ eventName ];\n\t\t\t}\n\n\t\t\t// Remove events from events object so fire() method will not call\n\t\t\t// listeners (#11400).\n\t\t\tCKEDITOR.event.prototype.removeAllListeners.call( this );\n\t\t}\n\t};\n} )();\n\n( function( domObjectProto ) {\n\tvar customData = {};\n\n\tCKEDITOR.on( 'reset', function() {\n\t\tcustomData = {};\n\t} );\n\n\t/**\n\t * Determines whether the specified object is equal to the current object.\n\t *\n\t *\t\tvar doc = new CKEDITOR.dom.document( document );\n\t *\t\talert( doc.equals( CKEDITOR.document ) );\t// true\n\t *\t\talert( doc == CKEDITOR.document );\t\t\t// false\n\t *\n\t * @param {Object} object The object to compare with the current object.\n\t * @returns {Boolean} `true` if the object is equal.\n\t */\n\tdomObjectProto.equals = function( object ) {\n\t\t// Try/Catch to avoid IE permission error when object is from different document.\n\t\ttry {\n\t\t\treturn ( object && object.$ === this.$ );\n\t\t} catch ( er ) {\n\t\t\treturn false;\n\t\t}\n\t};\n\n\t/**\n\t * Sets a data slot value for this object. These values are shared by all\n\t * instances pointing to that same DOM object.\n\t *\n\t * **Note:** The created data slot is only guaranteed to be available on this unique DOM node,\n\t * thus any wish to continue access to it from other element clones (either created by\n\t * clone node or from `innerHtml`) will fail. For such usage please use\n\t * {@link CKEDITOR.dom.element#setAttribute} instead.\n\t *\n\t * **Note**: This method does not work on text nodes prior to Internet Explorer 9.\n\t *\n\t *\t\tvar element = new CKEDITOR.dom.element( 'span' );\n\t *\t\telement.setCustomData( 'hasCustomData', true );\n\t *\n\t * @param {String} key A key used to identify the data slot.\n\t * @param {Object} value The value to set to the data slot.\n\t * @returns {CKEDITOR.dom.domObject} This DOM object instance.\n\t * @chainable\n\t */\n\tdomObjectProto.setCustomData = function( key, value ) {\n\t\tvar expandoNumber = this.getUniqueId(),\n\t\t\tdataSlot = customData[ expandoNumber ] || ( customData[ expandoNumber ] = {} );\n\n\t\tdataSlot[ key ] = value;\n\n\t\treturn this;\n\t};\n\n\t/**\n\t * Gets the value set to a data slot in this object.\n\t *\n\t *\t\tvar element = new CKEDITOR.dom.element( 'span' );\n\t *\t\talert( element.getCustomData( 'hasCustomData' ) );\t\t// e.g. 'true'\n\t *\t\talert( element.getCustomData( 'nonExistingKey' ) );\t\t// null\n\t *\n\t * @param {String} key The key used to identify the data slot.\n\t * @returns {Object} This value set to the data slot.\n\t */\n\tdomObjectProto.getCustomData = function( key ) {\n\t\tvar expandoNumber = this.$[ 'data-cke-expando' ],\n\t\t\tdataSlot = expandoNumber && customData[ expandoNumber ];\n\n\t\treturn ( dataSlot && key in dataSlot ) ? dataSlot[ key ] : null;\n\t};\n\n\t/**\n\t * Removes the value in the data slot under the given `key`.\n\t *\n\t * @param {String} key\n\t * @returns {Object} Removed value or `null` if not found.\n\t */\n\tdomObjectProto.removeCustomData = function( key ) {\n\t\tvar expandoNumber = this.$[ 'data-cke-expando' ],\n\t\t\tdataSlot = expandoNumber && customData[ expandoNumber ],\n\t\t\tretval, hadKey;\n\n\t\tif ( dataSlot ) {\n\t\t\tretval = dataSlot[ key ];\n\t\t\thadKey = key in dataSlot;\n\t\t\tdelete dataSlot[ key ];\n\t\t}\n\n\t\treturn hadKey ? retval : null;\n\t};\n\n\t/**\n\t * Removes any data stored in this object.\n\t * To avoid memory leaks we must assure that there are no\n\t * references left after the object is no longer needed.\n\t */\n\tdomObjectProto.clearCustomData = function() {\n\t\t// Clear all event listeners\n\t\tthis.removeAllListeners();\n\n\t\tvar expandoNumber = this.$[ 'data-cke-expando' ];\n\t\texpandoNumber && delete customData[ expandoNumber ];\n\t};\n\n\t/**\n\t * Gets an ID that can be used to identify this DOM object in\n\t * the running session.\n\t *\n\t * **Note**: This method does not work on text nodes prior to Internet Explorer 9.\n\t *\n\t * @returns {Number} A unique ID.\n\t */\n\tdomObjectProto.getUniqueId = function() {\n\t\treturn this.$[ 'data-cke-expando' ] || ( this.$[ 'data-cke-expando' ] = CKEDITOR.tools.getNextNumber() );\n\t};\n\n\t// Implement CKEDITOR.event.\n\tCKEDITOR.event.implementOn( domObjectProto );\n\n} )( CKEDITOR.dom.domObject.prototype );\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/dom/domobject.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Defines the {@link CKEDITOR.dom.node} class which is the base\n *\t\tclass for classes that represent DOM nodes.\n */\n\n/**\n * Base class for classes representing DOM nodes. This constructor may return\n * an instance of a class that inherits from this class, like\n * {@link CKEDITOR.dom.element} or {@link CKEDITOR.dom.text}.\n *\n * @class\n * @extends CKEDITOR.dom.domObject\n * @constructor Creates a node class instance.\n * @param {Object} domNode A native DOM node.\n * @see CKEDITOR.dom.element\n * @see CKEDITOR.dom.text\n */\nCKEDITOR.dom.node = function( domNode ) {\n\tif ( domNode ) {\n\t\tvar type =\n\t\t\tdomNode.nodeType == CKEDITOR.NODE_DOCUMENT ? 'document' :\n\t\t\tdomNode.nodeType == CKEDITOR.NODE_ELEMENT ? 'element' :\n\t\t\tdomNode.nodeType == CKEDITOR.NODE_TEXT ? 'text' :\n\t\t\tdomNode.nodeType == CKEDITOR.NODE_COMMENT ? 'comment' :\n\t\t\tdomNode.nodeType == CKEDITOR.NODE_DOCUMENT_FRAGMENT ? 'documentFragment' :\n\t\t\t'domObject'; // Call the base constructor otherwise.\n\n\t\treturn new CKEDITOR.dom[ type ]( domNode );\n\t}\n\n\treturn this;\n};\n\nCKEDITOR.dom.node.prototype = new CKEDITOR.dom.domObject();\n\n/**\n * Element node type.\n *\n * @readonly\n * @property {Number} [=1]\n * @member CKEDITOR\n */\nCKEDITOR.NODE_ELEMENT = 1;\n\n/**\n * Document node type.\n *\n * @readonly\n * @property {Number} [=9]\n * @member CKEDITOR\n */\nCKEDITOR.NODE_DOCUMENT = 9;\n\n/**\n * Text node type.\n *\n * @readonly\n * @property {Number} [=3]\n * @member CKEDITOR\n */\nCKEDITOR.NODE_TEXT = 3;\n\n/**\n * Comment node type.\n *\n * @readonly\n * @property {Number} [=8]\n * @member CKEDITOR\n */\nCKEDITOR.NODE_COMMENT = 8;\n\n/**\n * Document fragment node type.\n *\n * @readonly\n * @property {Number} [=11]\n * @member CKEDITOR\n */\nCKEDITOR.NODE_DOCUMENT_FRAGMENT = 11;\n\n/**\n * Indicates that positions of both nodes are identical (this is the same node). See {@link CKEDITOR.dom.node#getPosition}.\n *\n * @readonly\n * @property {Number} [=0]\n * @member CKEDITOR\n */\nCKEDITOR.POSITION_IDENTICAL = 0;\n\n/**\n * Indicates that nodes are in different (detached) trees. See {@link CKEDITOR.dom.node#getPosition}.\n *\n * @readonly\n * @property {Number} [=1]\n * @member CKEDITOR\n */\nCKEDITOR.POSITION_DISCONNECTED = 1;\n\n/**\n * Indicates that the context node follows the other node. See {@link CKEDITOR.dom.node#getPosition}.\n *\n * @readonly\n * @property {Number} [=2]\n * @member CKEDITOR\n */\nCKEDITOR.POSITION_FOLLOWING = 2;\n\n/**\n * Indicates that the context node precedes the other node. See {@link CKEDITOR.dom.node#getPosition}.\n *\n * @readonly\n * @property {Number} [=4]\n * @member CKEDITOR\n */\nCKEDITOR.POSITION_PRECEDING = 4;\n\n/**\n * Indicates that the context node is a descendant of the other node. See {@link CKEDITOR.dom.node#getPosition}.\n *\n * @readonly\n * @property {Number} [=8]\n * @member CKEDITOR\n */\nCKEDITOR.POSITION_IS_CONTAINED = 8;\n\n/**\n * Indicates that the context node contains the other node. See {@link CKEDITOR.dom.node#getPosition}.\n *\n * @readonly\n * @property {Number} [=16]\n * @member CKEDITOR\n */\nCKEDITOR.POSITION_CONTAINS = 16;\n\nCKEDITOR.tools.extend( CKEDITOR.dom.node.prototype, {\n\t/**\n\t * Makes this node a child of another element.\n\t *\n\t *\t\tvar p = new CKEDITOR.dom.element( 'p' );\n\t *\t\tvar strong = new CKEDITOR.dom.element( 'strong' );\n\t *\t\tstrong.appendTo( p );\n\t *\n\t *\t\t// Result: '<p><strong></strong></p>'.\n\t *\n\t * @param {CKEDITOR.dom.element} element The target element to which this node will be appended.\n\t * @returns {CKEDITOR.dom.element} The target element.\n\t */\n\tappendTo: function( element, toStart ) {\n\t\telement.append( this, toStart );\n\t\treturn element;\n\t},\n\n\t/**\n\t * Clones this node.\n\t *\n\t * **Note**: Values set by {#setCustomData} will not be available in the clone.\n\t *\n\t * @param {Boolean} [includeChildren=false] If `true` then all node's\n\t * children will be cloned recursively.\n\t * @param {Boolean} [cloneId=false] Whether ID attributes should be cloned, too.\n\t * @returns {CKEDITOR.dom.node} Clone of this node.\n\t */\n\tclone: function( includeChildren, cloneId ) {\n\t\tvar $clone = this.$.cloneNode( includeChildren );\n\n\t\t// The \"id\" attribute should never be cloned to avoid duplication.\n\t\tremoveIds( $clone );\n\n\t\tvar node = new CKEDITOR.dom.node( $clone );\n\n\t\t// On IE8 we need to fixed HTML5 node name, see details below.\n\t\tif ( CKEDITOR.env.ie && CKEDITOR.env.version < 9 &&\n\t\t\t( this.type == CKEDITOR.NODE_ELEMENT || this.type == CKEDITOR.NODE_DOCUMENT_FRAGMENT ) ) {\n\t\t\trenameNodes( node );\n\t\t}\n\n\t\treturn node;\n\n\t\tfunction removeIds( node ) {\n\t\t\t// Reset data-cke-expando only when has been cloned (IE and only for some types of objects).\n\t\t\tif ( node[ 'data-cke-expando' ] )\n\t\t\t\tnode[ 'data-cke-expando' ] = false;\n\n\t\t\tif ( node.nodeType != CKEDITOR.NODE_ELEMENT && node.nodeType != CKEDITOR.NODE_DOCUMENT_FRAGMENT  )\n\t\t\t\treturn;\n\n\t\t\tif ( !cloneId && node.nodeType == CKEDITOR.NODE_ELEMENT )\n\t\t\t\tnode.removeAttribute( 'id', false );\n\n\t\t\tif ( includeChildren ) {\n\t\t\t\tvar childs = node.childNodes;\n\t\t\t\tfor ( var i = 0; i < childs.length; i++ )\n\t\t\t\t\tremoveIds( childs[ i ] );\n\t\t\t}\n\t\t}\n\n\t\t// IE8 rename HTML5 nodes by adding `:` at the begging of the tag name when the node is cloned,\n\t\t// so `<figure>` will be `<:figure>` after 'cloneNode'. We need to fix it (#13101).\n\t\tfunction renameNodes( node ) {\n\t\t\tif ( node.type != CKEDITOR.NODE_ELEMENT && node.type != CKEDITOR.NODE_DOCUMENT_FRAGMENT )\n\t\t\t\treturn;\n\n\t\t\tif ( node.type != CKEDITOR.NODE_DOCUMENT_FRAGMENT ) {\n\t\t\t\tvar name = node.getName();\n\t\t\t\tif ( name[ 0 ] == ':' ) {\n\t\t\t\t\tnode.renameNode( name.substring( 1 ) );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( includeChildren ) {\n\t\t\t\tfor ( var i = 0; i < node.getChildCount(); i++ )\n\t\t\t\t\trenameNodes( node.getChild( i ) );\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Checks if the node is preceded by any sibling.\n\t *\n\t * @returns {Boolean}\n\t */\n\thasPrevious: function() {\n\t\treturn !!this.$.previousSibling;\n\t},\n\n\t/**\n\t * Checks if the node is succeeded by any sibling.\n\t *\n\t * @returns {Boolean}\n\t */\n\thasNext: function() {\n\t\treturn !!this.$.nextSibling;\n\t},\n\n\t/**\n\t * Inserts this element after a node.\n\t *\n\t *\t\tvar em = new CKEDITOR.dom.element( 'em' );\n\t *\t\tvar strong = new CKEDITOR.dom.element( 'strong' );\n\t *\t\tstrong.insertAfter( em );\n\t *\n\t *\t\t// Result: '<em></em><strong></strong>'\n\t *\n\t * @param {CKEDITOR.dom.node} node The node that will precede this element.\n\t * @returns {CKEDITOR.dom.node} The node preceding this one after insertion.\n\t */\n\tinsertAfter: function( node ) {\n\t\tnode.$.parentNode.insertBefore( this.$, node.$.nextSibling );\n\t\treturn node;\n\t},\n\n\t/**\n\t * Inserts this element before a node.\n\t *\n\t *\t\tvar em = new CKEDITOR.dom.element( 'em' );\n\t *\t\tvar strong = new CKEDITOR.dom.element( 'strong' );\n\t *\t\tstrong.insertBefore( em );\n\t *\n\t *\t\t// result: '<strong></strong><em></em>'\n\t *\n\t * @param {CKEDITOR.dom.node} node The node that will succeed this element.\n\t * @returns {CKEDITOR.dom.node} The node being inserted.\n\t */\n\tinsertBefore: function( node ) {\n\t\tnode.$.parentNode.insertBefore( this.$, node.$ );\n\t\treturn node;\n\t},\n\n\t/**\n\t * Inserts a node before this node.\n\t *\n\t *\t\tvar em = new CKEDITOR.dom.element( 'em' );\n\t *\t\tvar strong = new CKEDITOR.dom.element( 'strong' );\n\t *\t\tstrong.insertBeforeMe( em );\n\t *\n\t *\t\t// result: '<em></em><strong></strong>'\n\t *\n\t * @param {CKEDITOR.dom.node} node The node that will preceed this element.\n\t * @returns {CKEDITOR.dom.node} The node being inserted.\n\t */\n\tinsertBeforeMe: function( node ) {\n\t\tthis.$.parentNode.insertBefore( node.$, this.$ );\n\t\treturn node;\n\t},\n\n\t/**\n\t * Retrieves a uniquely identifiable tree address for this node.\n\t * The tree address returned is an array of integers, with each integer\n\t * indicating a child index of a DOM node, starting from\n\t * `document.documentElement`.\n\t *\n\t * For example, assuming `<body>` is the second child\n\t * of `<html>` (`<head>` being the first),\n\t * and we would like to address the third child under the\n\t * fourth child of `<body>`, the tree address returned would be:\n\t * `[1, 3, 2]`.\n\t *\n\t * The tree address cannot be used for finding back the DOM tree node once\n\t * the DOM tree structure has been modified.\n\t *\n\t * @param {Boolean} [normalized=false] See {@link #getIndex}.\n\t * @returns {Array} The address.\n\t */\n\tgetAddress: function( normalized ) {\n\t\tvar address = [];\n\t\tvar $documentElement = this.getDocument().$.documentElement;\n\t\tvar node = this.$;\n\n\t\twhile ( node && node != $documentElement ) {\n\t\t\tvar parentNode = node.parentNode;\n\n\t\t\tif ( parentNode ) {\n\t\t\t\t// Get the node index. For performance, call getIndex\n\t\t\t\t// directly, instead of creating a new node object.\n\t\t\t\taddress.unshift( this.getIndex.call( { $: node }, normalized ) );\n\t\t\t}\n\n\t\t\tnode = parentNode;\n\t\t}\n\n\t\treturn address;\n\t},\n\n\t/**\n\t * Gets the document containing this element.\n\t *\n\t *\t\tvar element = CKEDITOR.document.getById( 'example' );\n\t *\t\talert( element.getDocument().equals( CKEDITOR.document ) ); // true\n\t *\n\t * @returns {CKEDITOR.dom.document} The document.\n\t */\n\tgetDocument: function() {\n\t\treturn new CKEDITOR.dom.document( this.$.ownerDocument || this.$.parentNode.ownerDocument );\n\t},\n\n\t/**\n\t * Gets the index of a node in an array of its `parent.childNodes`.\n\t * Returns `-1` if a node does not have a parent or when the `normalized` argument is set to `true`\n\t * and the text node is empty and will be removed during the normalization.\n\t *\n\t * Let us assume having the following `childNodes` array:\n\t *\n\t *\t\t[ emptyText, element1, text, text, element2, emptyText2 ]\n\t *\n\t *\t\temptyText.getIndex()\t\t\t// 0\n\t *\t\temptyText.getIndex( true )\t\t// -1\n\t *\t\telement1.getIndex();\t\t\t// 1\n\t *\t\telement1.getIndex( true );\t\t// 0\n\t *\t\telement2.getIndex();\t\t\t// 4\n\t *\t\telement2.getIndex( true );\t\t// 2\n\t *\t\temptyText2.getIndex();\t\t\t// 5\n\t *\t\temptyText2.getIndex( true );\t// -1\n\t *\n\t * @param {Boolean} normalized When `true`, adjacent text nodes are merged and empty text nodes are removed.\n\t * @returns {Number} Index of a node or `-1` if a node does not have a parent or is removed during the normalization.\n\t */\n\tgetIndex: function( normalized ) {\n\t\t// Attention: getAddress depends on this.$\n\t\t// getIndex is called on a plain object: { $ : node }\n\n\t\tvar current = this.$,\n\t\t\tindex = -1,\n\t\t\tisNormalizing;\n\n\t\tif ( !this.$.parentNode )\n\t\t\treturn -1;\n\n\t\t// The idea is - all empty text nodes will be virtually merged into their adjacent text nodes.\n\t\t// If an empty text node does not have an adjacent non-empty text node we can return -1 straight away,\n\t\t// because it and all its sibling text nodes will be merged into an empty text node and then totally ignored.\n\t\tif ( normalized && current.nodeType == CKEDITOR.NODE_TEXT && isEmpty( current ) ) {\n\t\t\tvar adjacent = getAdjacentNonEmptyTextNode( current ) || getAdjacentNonEmptyTextNode( current, true );\n\n\t\t\tif ( !adjacent )\n\t\t\t\treturn -1;\n\t\t}\n\n\t\tdo {\n\t\t\t// Bypass blank node and adjacent text nodes.\n\t\t\tif ( normalized && current != this.$ && current.nodeType == CKEDITOR.NODE_TEXT && ( isNormalizing || isEmpty( current ) ) )\n\t\t\t\tcontinue;\n\n\t\t\tindex++;\n\t\t\tisNormalizing = current.nodeType == CKEDITOR.NODE_TEXT;\n\t\t}\n\t\twhile ( ( current = current.previousSibling ) );\n\n\t\treturn index;\n\n\t\tfunction getAdjacentNonEmptyTextNode( node, lookForward ) {\n\t\t\tvar sibling = lookForward ? node.nextSibling : node.previousSibling;\n\n\t\t\tif ( !sibling || sibling.nodeType != CKEDITOR.NODE_TEXT ) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\t// If found a non-empty text node, then return it.\n\t\t\t// If not, then continue search.\n\t\t\treturn isEmpty( sibling ) ? getAdjacentNonEmptyTextNode( sibling, lookForward ) : sibling;\n\t\t}\n\n\t\t// Checks whether a text node is empty or is FCSeq string (which will be totally removed when normalizing).\n\t\tfunction isEmpty( textNode ) {\n\t\t\treturn !textNode.nodeValue || textNode.nodeValue == CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE;\n\t\t}\n\t},\n\n\t/**\n\t * @todo\n\t */\n\tgetNextSourceNode: function( startFromSibling, nodeType, guard ) {\n\t\t// If \"guard\" is a node, transform it in a function.\n\t\tif ( guard && !guard.call ) {\n\t\t\tvar guardNode = guard;\n\t\t\tguard = function( node ) {\n\t\t\t\treturn !node.equals( guardNode );\n\t\t\t};\n\t\t}\n\n\t\tvar node = ( !startFromSibling && this.getFirst && this.getFirst() ),\n\t\t\tparent;\n\n\t\t// Guarding when we're skipping the current element( no children or 'startFromSibling' ).\n\t\t// send the 'moving out' signal even we don't actually dive into.\n\t\tif ( !node ) {\n\t\t\tif ( this.type == CKEDITOR.NODE_ELEMENT && guard && guard( this, true ) === false )\n\t\t\t\treturn null;\n\t\t\tnode = this.getNext();\n\t\t}\n\n\t\twhile ( !node && ( parent = ( parent || this ).getParent() ) ) {\n\t\t\t// The guard check sends the \"true\" paramenter to indicate that\n\t\t\t// we are moving \"out\" of the element.\n\t\t\tif ( guard && guard( parent, true ) === false )\n\t\t\t\treturn null;\n\n\t\t\tnode = parent.getNext();\n\t\t}\n\n\t\tif ( !node )\n\t\t\treturn null;\n\n\t\tif ( guard && guard( node ) === false )\n\t\t\treturn null;\n\n\t\tif ( nodeType && nodeType != node.type )\n\t\t\treturn node.getNextSourceNode( false, nodeType, guard );\n\n\t\treturn node;\n\t},\n\n\t/**\n\t * @todo\n\t */\n\tgetPreviousSourceNode: function( startFromSibling, nodeType, guard ) {\n\t\tif ( guard && !guard.call ) {\n\t\t\tvar guardNode = guard;\n\t\t\tguard = function( node ) {\n\t\t\t\treturn !node.equals( guardNode );\n\t\t\t};\n\t\t}\n\n\t\tvar node = ( !startFromSibling && this.getLast && this.getLast() ),\n\t\t\tparent;\n\n\t\t// Guarding when we're skipping the current element( no children or 'startFromSibling' ).\n\t\t// send the 'moving out' signal even we don't actually dive into.\n\t\tif ( !node ) {\n\t\t\tif ( this.type == CKEDITOR.NODE_ELEMENT && guard && guard( this, true ) === false )\n\t\t\t\treturn null;\n\t\t\tnode = this.getPrevious();\n\t\t}\n\n\t\twhile ( !node && ( parent = ( parent || this ).getParent() ) ) {\n\t\t\t// The guard check sends the \"true\" paramenter to indicate that\n\t\t\t// we are moving \"out\" of the element.\n\t\t\tif ( guard && guard( parent, true ) === false )\n\t\t\t\treturn null;\n\n\t\t\tnode = parent.getPrevious();\n\t\t}\n\n\t\tif ( !node )\n\t\t\treturn null;\n\n\t\tif ( guard && guard( node ) === false )\n\t\t\treturn null;\n\n\t\tif ( nodeType && node.type != nodeType )\n\t\t\treturn node.getPreviousSourceNode( false, nodeType, guard );\n\n\t\treturn node;\n\t},\n\n\t/**\n\t * Gets the node that preceeds this element in its parent's child list.\n\t *\n\t *\t\tvar element = CKEDITOR.dom.element.createFromHtml( '<div><i>prev</i><b>Example</b></div>' );\n\t *\t\tvar first = element.getLast().getPrev();\n\t *\t\talert( first.getName() ); // 'i'\n\t *\n\t * @param {Function} [evaluator] Filtering the result node.\n\t * @returns {CKEDITOR.dom.node} The previous node or null if not available.\n\t */\n\tgetPrevious: function( evaluator ) {\n\t\tvar previous = this.$,\n\t\t\tretval;\n\t\tdo {\n\t\t\tprevious = previous.previousSibling;\n\n\t\t\t// Avoid returning the doc type node.\n\t\t\t// http://www.w3.org/TR/REC-DOM-Level-1/level-one-core.html#ID-412266927\n\t\t\tretval = previous && previous.nodeType != 10 && new CKEDITOR.dom.node( previous );\n\t\t}\n\t\twhile ( retval && evaluator && !evaluator( retval ) );\n\t\treturn retval;\n\t},\n\n\t/**\n\t * Gets the node that follows this element in its parent's child list.\n\t *\n\t *\t\tvar element = CKEDITOR.dom.element.createFromHtml( '<div><b>Example</b><i>next</i></div>' );\n\t *\t\tvar last = element.getFirst().getNext();\n\t *\t\talert( last.getName() ); // 'i'\n\t *\n\t * @param {Function} [evaluator] Filtering the result node.\n\t * @returns {CKEDITOR.dom.node} The next node or null if not available.\n\t */\n\tgetNext: function( evaluator ) {\n\t\tvar next = this.$,\n\t\t\tretval;\n\t\tdo {\n\t\t\tnext = next.nextSibling;\n\t\t\tretval = next && new CKEDITOR.dom.node( next );\n\t\t}\n\t\twhile ( retval && evaluator && !evaluator( retval ) );\n\t\treturn retval;\n\t},\n\n\t/**\n\t * Gets the parent element for this node.\n\t *\n\t *\t\tvar node = editor.document.getBody().getFirst();\n\t *\t\tvar parent = node.getParent();\n\t *\t\talert( parent.getName() ); // 'body'\n\t *\n\t * @param {Boolean} [allowFragmentParent=false] Consider also parent node that is of\n\t * fragment type {@link CKEDITOR#NODE_DOCUMENT_FRAGMENT}.\n\t * @returns {CKEDITOR.dom.element} The parent element.\n\t */\n\tgetParent: function( allowFragmentParent ) {\n\t\tvar parent = this.$.parentNode;\n\t\treturn ( parent && ( parent.nodeType == CKEDITOR.NODE_ELEMENT || allowFragmentParent && parent.nodeType == CKEDITOR.NODE_DOCUMENT_FRAGMENT ) ) ? new CKEDITOR.dom.node( parent ) : null;\n\t},\n\n\t/**\n\t * Returns an array containing node parents and the node itself. By default nodes are in _descending_ order.\n\t *\n\t *\t\t// Assuming that body has paragraph as the first child.\n\t *\t\tvar node = editor.document.getBody().getFirst();\n\t *\t\tvar parents = node.getParents();\n\t *\t\talert( parents[ 0 ].getName() + ',' + parents[ 2 ].getName() ); // 'html,p'\n\t *\n\t * @param {Boolean} [closerFirst=false] Determines the order of returned nodes.\n\t * @returns {Array} Returns an array of {@link CKEDITOR.dom.node}.\n\t */\n\tgetParents: function( closerFirst ) {\n\t\tvar node = this;\n\t\tvar parents = [];\n\n\t\tdo {\n\t\t\tparents[ closerFirst ? 'push' : 'unshift' ]( node );\n\t\t}\n\t\twhile ( ( node = node.getParent() ) );\n\n\t\treturn parents;\n\t},\n\n\t/**\n\t * @todo\n\t */\n\tgetCommonAncestor: function( node ) {\n\t\tif ( node.equals( this ) )\n\t\t\treturn this;\n\n\t\tif ( node.contains && node.contains( this ) )\n\t\t\treturn node;\n\n\t\tvar start = this.contains ? this : this.getParent();\n\n\t\tdo {\n\t\t\tif ( start.contains( node ) ) return start;\n\t\t}\n\t\twhile ( ( start = start.getParent() ) );\n\n\t\treturn null;\n\t},\n\n\t/**\n\t * Determines the position relation between this node and the given {@link CKEDITOR.dom.node} in the document.\n\t * This node can be preceding ({@link CKEDITOR#POSITION_PRECEDING}) or following ({@link CKEDITOR#POSITION_FOLLOWING})\n\t * the given node. This node can also contain ({@link CKEDITOR#POSITION_CONTAINS}) or be contained by\n\t * ({@link CKEDITOR#POSITION_IS_CONTAINED}) the given node. The function returns a bitmask of constants\n\t * listed above or {@link CKEDITOR#POSITION_IDENTICAL} if the given node is the same as this node.\n\t *\n\t * @param {CKEDITOR.dom.node} otherNode A node to check relation with.\n\t * @returns {Number} Position relation between this node and given node.\n\t */\n\tgetPosition: function( otherNode ) {\n\t\tvar $ = this.$;\n\t\tvar $other = otherNode.$;\n\n\t\tif ( $.compareDocumentPosition )\n\t\t\treturn $.compareDocumentPosition( $other );\n\n\t\t// IE and Safari have no support for compareDocumentPosition.\n\n\t\tif ( $ == $other )\n\t\t\treturn CKEDITOR.POSITION_IDENTICAL;\n\n\t\t// Only element nodes support contains and sourceIndex.\n\t\tif ( this.type == CKEDITOR.NODE_ELEMENT && otherNode.type == CKEDITOR.NODE_ELEMENT ) {\n\t\t\tif ( $.contains ) {\n\t\t\t\tif ( $.contains( $other ) )\n\t\t\t\t\treturn CKEDITOR.POSITION_CONTAINS + CKEDITOR.POSITION_PRECEDING;\n\n\t\t\t\tif ( $other.contains( $ ) )\n\t\t\t\t\treturn CKEDITOR.POSITION_IS_CONTAINED + CKEDITOR.POSITION_FOLLOWING;\n\t\t\t}\n\n\t\t\tif ( 'sourceIndex' in $ )\n\t\t\t\treturn ( $.sourceIndex < 0 || $other.sourceIndex < 0 ) ? CKEDITOR.POSITION_DISCONNECTED : ( $.sourceIndex < $other.sourceIndex ) ? CKEDITOR.POSITION_PRECEDING : CKEDITOR.POSITION_FOLLOWING;\n\n\t\t}\n\n\t\t// For nodes that don't support compareDocumentPosition, contains\n\t\t// or sourceIndex, their \"address\" is compared.\n\n\t\tvar addressOfThis = this.getAddress(),\n\t\t\taddressOfOther = otherNode.getAddress(),\n\t\t\tminLevel = Math.min( addressOfThis.length, addressOfOther.length );\n\n\t\t// Determinate preceding/following relationship.\n\t\tfor ( var i = 0; i < minLevel; i++ ) {\n\t\t\tif ( addressOfThis[ i ] != addressOfOther[ i ] ) {\n\t\t\t\treturn addressOfThis[ i ] < addressOfOther[ i ] ? CKEDITOR.POSITION_PRECEDING : CKEDITOR.POSITION_FOLLOWING;\n\t\t\t}\n\t\t}\n\n\t\t// Determinate contains/contained relationship.\n\t\treturn ( addressOfThis.length < addressOfOther.length ) ? CKEDITOR.POSITION_CONTAINS + CKEDITOR.POSITION_PRECEDING : CKEDITOR.POSITION_IS_CONTAINED + CKEDITOR.POSITION_FOLLOWING;\n\t},\n\n\t/**\n\t * Gets the closest ancestor node of this node, specified by its name or using an evaluator function.\n\t *\n\t *\t\t// Suppose we have the following HTML structure:\n\t *\t\t// <div id=\"outer\"><div id=\"inner\"><p><b>Some text</b></p></div></div>\n\t *\t\t// If node == <b>\n\t *\t\tascendant = node.getAscendant( 'div' );\t\t\t\t// ascendant == <div id=\"inner\">\n\t *\t\tascendant = node.getAscendant( 'b' );\t\t\t\t// ascendant == null\n\t *\t\tascendant = node.getAscendant( 'b', true );\t\t\t// ascendant == <b>\n\t *\t\tascendant = node.getAscendant( { div:1, p:1 } );\t// Searches for the first 'div' or 'p': ascendant == <div id=\"inner\">\n\t *\n\t *\t\t// Using custom evaluator:\n\t *\t\tascendant = node.getAscendant( function( el ) {\n\t *\t\t\treturn el.getId() == 'inner';\n\t *\t\t} );\n\t *\t\t// ascendant == <div id=\"inner\">\n\t *\n\t * @since 3.6.1\n\t * @param {String/Function/Object} query The name of the ancestor node to search or\n\t * an object with the node names to search for or an evaluator function.\n\t * @param {Boolean} [includeSelf] Whether to include the current\n\t * node in the search.\n\t * @returns {CKEDITOR.dom.node} The located ancestor node or `null` if not found.\n\t */\n\tgetAscendant: function( query, includeSelf ) {\n\t\tvar $ = this.$,\n\t\t\tevaluator,\n\t\t\tisCustomEvaluator;\n\n\t\tif ( !includeSelf ) {\n\t\t\t$ = $.parentNode;\n\t\t}\n\n\t\t// Custom checker provided in an argument.\n\t\tif ( typeof query == 'function' ) {\n\t\t\tisCustomEvaluator = true;\n\t\t\tevaluator = query;\n\t\t} else {\n\t\t\t// Predefined tag name checker.\n\t\t\tisCustomEvaluator = false;\n\t\t\tevaluator = function( $ ) {\n\t\t\t\tvar name = ( typeof $.nodeName == 'string' ? $.nodeName.toLowerCase() : '' );\n\n\t\t\t\treturn ( typeof query == 'string' ? name == query : name in query );\n\t\t\t};\n\t\t}\n\n\t\twhile ( $ ) {\n\t\t\t// For user provided checker we use CKEDITOR.dom.node.\n\t\t\tif ( evaluator( isCustomEvaluator ? new CKEDITOR.dom.node( $ ) : $ ) ) {\n\t\t\t\treturn new CKEDITOR.dom.node( $ );\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\t$ = $.parentNode;\n\t\t\t} catch ( e ) {\n\t\t\t\t$ = null;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t},\n\n\t/**\n\t * @todo\n\t */\n\thasAscendant: function( name, includeSelf ) {\n\t\tvar $ = this.$;\n\n\t\tif ( !includeSelf )\n\t\t\t$ = $.parentNode;\n\n\t\twhile ( $ ) {\n\t\t\tif ( $.nodeName && $.nodeName.toLowerCase() == name )\n\t\t\t\treturn true;\n\n\t\t\t$ = $.parentNode;\n\t\t}\n\t\treturn false;\n\t},\n\n\t/**\n\t * @todo\n\t */\n\tmove: function( target, toStart ) {\n\t\ttarget.append( this.remove(), toStart );\n\t},\n\n\t/**\n\t * Removes this node from the document DOM.\n\t *\n\t *\t\tvar element = CKEDITOR.document.getById( 'MyElement' );\n\t *\t\telement.remove();\n\t *\n\t * @param {Boolean} [preserveChildren=false] Indicates that the children\n\t * elements must remain in the document, removing only the outer tags.\n\t */\n\tremove: function( preserveChildren ) {\n\t\tvar $ = this.$;\n\t\tvar parent = $.parentNode;\n\n\t\tif ( parent ) {\n\t\t\tif ( preserveChildren ) {\n\t\t\t\t// Move all children before the node.\n\t\t\t\tfor ( var child;\n\t\t\t\t( child = $.firstChild ); ) {\n\t\t\t\t\tparent.insertBefore( $.removeChild( child ), $ );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tparent.removeChild( $ );\n\t\t}\n\n\t\treturn this;\n\t},\n\n\t/**\n\t * @todo\n\t */\n\treplace: function( nodeToReplace ) {\n\t\tthis.insertBefore( nodeToReplace );\n\t\tnodeToReplace.remove();\n\t},\n\n\t/**\n\t * @todo\n\t */\n\ttrim: function() {\n\t\tthis.ltrim();\n\t\tthis.rtrim();\n\t},\n\n\t/**\n\t * @todo\n\t */\n\tltrim: function() {\n\t\tvar child;\n\t\twhile ( this.getFirst && ( child = this.getFirst() ) ) {\n\t\t\tif ( child.type == CKEDITOR.NODE_TEXT ) {\n\t\t\t\tvar trimmed = CKEDITOR.tools.ltrim( child.getText() ),\n\t\t\t\t\toriginalLength = child.getLength();\n\n\t\t\t\tif ( !trimmed ) {\n\t\t\t\t\tchild.remove();\n\t\t\t\t\tcontinue;\n\t\t\t\t} else if ( trimmed.length < originalLength ) {\n\t\t\t\t\tchild.split( originalLength - trimmed.length );\n\n\t\t\t\t\t// IE BUG: child.remove() may raise JavaScript errors here. (#81)\n\t\t\t\t\tthis.$.removeChild( this.$.firstChild );\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t},\n\n\t/**\n\t * @todo\n\t */\n\trtrim: function() {\n\t\tvar child;\n\t\twhile ( this.getLast && ( child = this.getLast() ) ) {\n\t\t\tif ( child.type == CKEDITOR.NODE_TEXT ) {\n\t\t\t\tvar trimmed = CKEDITOR.tools.rtrim( child.getText() ),\n\t\t\t\t\toriginalLength = child.getLength();\n\n\t\t\t\tif ( !trimmed ) {\n\t\t\t\t\tchild.remove();\n\t\t\t\t\tcontinue;\n\t\t\t\t} else if ( trimmed.length < originalLength ) {\n\t\t\t\t\tchild.split( trimmed.length );\n\n\t\t\t\t\t// IE BUG: child.getNext().remove() may raise JavaScript errors here.\n\t\t\t\t\t// (#81)\n\t\t\t\t\tthis.$.lastChild.parentNode.removeChild( this.$.lastChild );\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\n\t\tif ( CKEDITOR.env.needsBrFiller ) {\n\t\t\tchild = this.$.lastChild;\n\n\t\t\tif ( child && child.type == 1 && child.nodeName.toLowerCase() == 'br' ) {\n\t\t\t\t// Use \"eChildNode.parentNode\" instead of \"node\" to avoid IE bug (#324).\n\t\t\t\tchild.parentNode.removeChild( child );\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Checks if this node is read-only (should not be changed).\n\t *\n\t *\t\t// For the following HTML:\n\t *\t\t// <b>foo</b><div contenteditable=\"false\"><i>bar</i></div>\n\t *\n\t *\t\telB.isReadOnly(); // -> false\n\t *\t\tfoo.isReadOnly(); // -> false\n\t *\t\telDiv.isReadOnly(); // -> true\n\t *\t\telI.isReadOnly(); // -> true\n\t *\n\t * This method works in two modes depending on browser support for the `element.isContentEditable` property and\n\t * the value of the `checkOnlyAttributes` parameter. The `element.isContentEditable` check is faster, but it is known\n\t * to malfunction in hidden or detached nodes. Additionally, when processing some detached DOM tree you may want to imitate\n\t * that this happens inside an editable container (like it would happen inside the {@link CKEDITOR.editable}). To do so,\n\t * you can temporarily attach this tree to an element with the `data-cke-editable` attribute and use the\n\t * `checkOnlyAttributes` mode.\n\t *\n\t * @since 3.5\n\t * @param {Boolean} [checkOnlyAttributes=false] If `true`, only attributes will be checked, native methods will not\n\t * be used. This parameter needs to be `true` to check hidden or detached elements. Introduced in 4.5.\n\t * @returns {Boolean}\n\t */\n\tisReadOnly: function( checkOnlyAttributes ) {\n\t\tvar element = this;\n\t\tif ( this.type != CKEDITOR.NODE_ELEMENT )\n\t\t\telement = this.getParent();\n\n\t\t// Prevent Edge crash (#13609, #13919).\n\t\tif ( CKEDITOR.env.edge && element && element.is( 'textarea', 'input' ) ) {\n\t\t\tcheckOnlyAttributes = true;\n\t\t}\n\n\t\tif ( !checkOnlyAttributes && element && typeof element.$.isContentEditable != 'undefined' ) {\n\t\t\treturn !( element.$.isContentEditable || element.data( 'cke-editable' ) );\n\t\t}\n\t\telse {\n\t\t\t// Degrade for old browsers which don't support \"isContentEditable\", e.g. FF3\n\n\t\t\twhile ( element ) {\n\t\t\t\tif ( element.data( 'cke-editable' ) ) {\n\t\t\t\t\treturn false;\n\t\t\t\t} else if ( element.hasAttribute( 'contenteditable' ) ) {\n\t\t\t\t\treturn element.getAttribute( 'contenteditable' ) == 'false';\n\t\t\t\t}\n\n\t\t\t\telement = element.getParent();\n\t\t\t}\n\n\t\t\t// Reached the root of DOM tree, no editable found.\n\t\t\treturn true;\n\t\t}\n\t}\n} );\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/dom/node.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Defines the {@link CKEDITOR.dom.document} class, which\n *\t\trepresents a DOM document.\n */\n\n/**\n * Represents a DOM window.\n *\n *\t\tvar document = new CKEDITOR.dom.window( window );\n *\n * @class\n * @extends CKEDITOR.dom.domObject\n * @constructor Creates a window class instance.\n * @param {Object} domWindow A native DOM window.\n */\nCKEDITOR.dom.window = function( domWindow ) {\n\tCKEDITOR.dom.domObject.call( this, domWindow );\n};\n\nCKEDITOR.dom.window.prototype = new CKEDITOR.dom.domObject();\n\nCKEDITOR.tools.extend( CKEDITOR.dom.window.prototype, {\n\t/**\n\t * Moves the selection focus to this window.\n\t *\n\t *\t\tvar win = new CKEDITOR.dom.window( window );\n\t *\t\twin.focus();\n\t */\n\tfocus: function() {\n\t\tthis.$.focus();\n\t},\n\n\t/**\n\t * Gets the width and height of this window's viewable area.\n\t *\n\t *\t\tvar win = new CKEDITOR.dom.window( window );\n\t *\t\tvar size = win.getViewPaneSize();\n\t *\t\talert( size.width );\n\t *\t\talert( size.height );\n\t *\n\t * @returns {Object} An object with the `width` and `height`\n\t * properties containing the size.\n\t */\n\tgetViewPaneSize: function() {\n\t\tvar doc = this.$.document,\n\t\t\tstdMode = doc.compatMode == 'CSS1Compat';\n\t\treturn {\n\t\t\twidth: ( stdMode ? doc.documentElement.clientWidth : doc.body.clientWidth ) || 0,\n\t\t\theight: ( stdMode ? doc.documentElement.clientHeight : doc.body.clientHeight ) || 0\n\t\t};\n\t},\n\n\t/**\n\t * Gets the current position of the window's scroll.\n\t *\n\t *\t\tvar win = new CKEDITOR.dom.window( window );\n\t *\t\tvar pos = win.getScrollPosition();\n\t *\t\talert( pos.x );\n\t *\t\talert( pos.y );\n\t *\n\t * @returns {Object} An object with the `x` and `y` properties\n\t * containing the scroll position.\n\t */\n\tgetScrollPosition: function() {\n\t\tvar $ = this.$;\n\n\t\tif ( 'pageXOffset' in $ ) {\n\t\t\treturn {\n\t\t\t\tx: $.pageXOffset || 0,\n\t\t\t\ty: $.pageYOffset || 0\n\t\t\t};\n\t\t} else {\n\t\t\tvar doc = $.document;\n\t\t\treturn {\n\t\t\t\tx: doc.documentElement.scrollLeft || doc.body.scrollLeft || 0,\n\t\t\t\ty: doc.documentElement.scrollTop || doc.body.scrollTop || 0\n\t\t\t};\n\t\t}\n\t},\n\n\t/**\n\t * Gets the frame element containing this window context.\n\t *\n\t * @returns {CKEDITOR.dom.element} The frame element or `null` if not in a frame context.\n\t */\n\tgetFrame: function() {\n\t\tvar iframe = this.$.frameElement;\n\t\treturn iframe ? new CKEDITOR.dom.element.get( iframe ) : null;\n\t}\n} );\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/dom/window.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Defines the {@link CKEDITOR.dom.document} class which\n *\t\trepresents a DOM document.\n */\n\n/**\n * Represents a DOM document.\n *\n *\t\tvar document = new CKEDITOR.dom.document( document );\n *\n * @class\n * @extends CKEDITOR.dom.domObject\n * @constructor Creates a document class instance.\n * @param {Object} domDocument A native DOM document.\n */\nCKEDITOR.dom.document = function( domDocument ) {\n\tCKEDITOR.dom.domObject.call( this, domDocument );\n};\n\n// PACKAGER_RENAME( CKEDITOR.dom.document )\n\nCKEDITOR.dom.document.prototype = new CKEDITOR.dom.domObject();\n\nCKEDITOR.tools.extend( CKEDITOR.dom.document.prototype, {\n\t/**\n\t * The node type. This is a constant value set to {@link CKEDITOR#NODE_DOCUMENT}.\n\t *\n\t * @readonly\n\t * @property {Number} [=CKEDITOR.NODE_DOCUMENT]\n\t */\n\ttype: CKEDITOR.NODE_DOCUMENT,\n\n\t/**\n\t * Appends a CSS file to the document.\n\t *\n\t *\t\tCKEDITOR.document.appendStyleSheet( '/mystyles.css' );\n\t *\n\t * @param {String} cssFileUrl The CSS file URL.\n\t */\n\tappendStyleSheet: function( cssFileUrl ) {\n\t\tif ( this.$.createStyleSheet )\n\t\t\tthis.$.createStyleSheet( cssFileUrl );\n\t\telse {\n\t\t\tvar link = new CKEDITOR.dom.element( 'link' );\n\t\t\tlink.setAttributes( {\n\t\t\t\trel: 'stylesheet',\n\t\t\t\ttype: 'text/css',\n\t\t\t\thref: cssFileUrl\n\t\t\t} );\n\n\t\t\tthis.getHead().append( link );\n\t\t}\n\t},\n\n\t/**\n\t * Creates a CSS stylesheet and inserts it into the document.\n\t *\n\t * @param cssStyleText {String} CSS style text.\n\t * @returns {Object} The created DOM native stylesheet object.\n\t */\n\tappendStyleText: function( cssStyleText ) {\n\t\tif ( this.$.createStyleSheet ) {\n\t\t\tvar styleSheet = this.$.createStyleSheet( '' );\n\t\t\tstyleSheet.cssText = cssStyleText;\n\t\t} else {\n\t\t\tvar style = new CKEDITOR.dom.element( 'style', this );\n\t\t\tstyle.append( new CKEDITOR.dom.text( cssStyleText, this ) );\n\t\t\tthis.getHead().append( style );\n\t\t}\n\n\t\treturn styleSheet || style.$.sheet;\n\t},\n\n\t/**\n\t * Creates a {@link CKEDITOR.dom.element} instance in this document.\n\t *\n\t * @param {String} name The name of the element.\n\t * @param {Object} [attributesAndStyles]\n\t * @param {Object} [attributesAndStyles.attributes] Attributes that will be set.\n\t * @param {Object} [attributesAndStyles.styles] Styles that will be set.\n\t * @returns {CKEDITOR.dom.element}\n\t */\n\tcreateElement: function( name, attribsAndStyles ) {\n\t\tvar element = new CKEDITOR.dom.element( name, this );\n\n\t\tif ( attribsAndStyles ) {\n\t\t\tif ( attribsAndStyles.attributes )\n\t\t\t\telement.setAttributes( attribsAndStyles.attributes );\n\n\t\t\tif ( attribsAndStyles.styles )\n\t\t\t\telement.setStyles( attribsAndStyles.styles );\n\t\t}\n\n\t\treturn element;\n\t},\n\n\t/**\n\t * Creates a {@link CKEDITOR.dom.text} instance in this document.\n\t *\n\t * @param {String} text Value of the text node.\n\t * @returns {CKEDITOR.dom.element}\n\t */\n\tcreateText: function( text ) {\n\t\treturn new CKEDITOR.dom.text( text, this );\n\t},\n\n\t/**\n\t * Moves the selection focus to this document's window.\n\t */\n\tfocus: function() {\n\t\tthis.getWindow().focus();\n\t},\n\n\t/**\n\t * Returns the element that is currently designated as the active element in the document.\n\t *\n\t * **Note:** Only one element can be active at a time in a document.\n\t * An active element does not necessarily have focus,\n\t * but an element with focus is always the active element in a document.\n\t *\n\t * @returns {CKEDITOR.dom.element} Active element or `null` if an IE8-9 bug is encountered.\n\t * See [#10030](http://dev.ckeditor.com/ticket/10030).\n\t */\n\tgetActive: function() {\n\t\tvar $active;\n\t\ttry {\n\t\t\t$active = this.$.activeElement;\n\t\t} catch ( e ) {\n\t\t\treturn null;\n\t\t}\n\t\treturn new CKEDITOR.dom.element( $active );\n\t},\n\n\t/**\n\t * Gets an element based on its ID.\n\t *\n\t *\t\tvar element = CKEDITOR.document.getById( 'myElement' );\n\t *\t\talert( element.getId() ); // 'myElement'\n\t *\n\t * @param {String} elementId The element ID.\n\t * @returns {CKEDITOR.dom.element} The element instance, or `null` if not found.\n\t */\n\tgetById: function( elementId ) {\n\t\tvar $ = this.$.getElementById( elementId );\n\t\treturn $ ? new CKEDITOR.dom.element( $ ) : null;\n\t},\n\n\t/**\n\t * Gets a node based on its address. See {@link CKEDITOR.dom.node#getAddress}.\n\t *\n\t * @param {Array} address\n\t * @param {Boolean} [normalized=false]\n\t */\n\tgetByAddress: function( address, normalized ) {\n\t\tvar $ = this.$.documentElement;\n\n\t\tfor ( var i = 0; $ && i < address.length; i++ ) {\n\t\t\tvar target = address[ i ];\n\n\t\t\tif ( !normalized ) {\n\t\t\t\t$ = $.childNodes[ target ];\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar currentIndex = -1;\n\n\t\t\tfor ( var j = 0; j < $.childNodes.length; j++ ) {\n\t\t\t\tvar candidate = $.childNodes[ j ];\n\n\t\t\t\tif ( normalized === true && candidate.nodeType == 3 && candidate.previousSibling && candidate.previousSibling.nodeType == 3 )\n\t\t\t\t\tcontinue;\n\n\t\t\t\tcurrentIndex++;\n\n\t\t\t\tif ( currentIndex == target ) {\n\t\t\t\t\t$ = candidate;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn $ ? new CKEDITOR.dom.node( $ ) : null;\n\t},\n\n\t/**\n\t * Gets elements list based on a given tag name.\n\t *\n\t * @param {String} tagName The element tag name.\n\t * @returns {CKEDITOR.dom.nodeList} The nodes list.\n\t */\n\tgetElementsByTag: function( tagName, namespace ) {\n\t\tif ( !( CKEDITOR.env.ie && ( document.documentMode <= 8 ) ) && namespace )\n\t\t\ttagName = namespace + ':' + tagName;\n\t\treturn new CKEDITOR.dom.nodeList( this.$.getElementsByTagName( tagName ) );\n\t},\n\n\t/**\n\t * Gets the `<head>` element for this document.\n\t *\n\t *\t\tvar element = CKEDITOR.document.getHead();\n\t *\t\talert( element.getName() ); // 'head'\n\t *\n\t * @returns {CKEDITOR.dom.element} The `<head>` element.\n\t */\n\tgetHead: function() {\n\t\tvar head = this.$.getElementsByTagName( 'head' )[ 0 ];\n\t\tif ( !head )\n\t\t\thead = this.getDocumentElement().append( new CKEDITOR.dom.element( 'head' ), true );\n\t\telse\n\t\t\thead = new CKEDITOR.dom.element( head );\n\n\t\treturn head;\n\t},\n\n\t/**\n\t * Gets the `<body>` element for this document.\n\t *\n\t *\t\tvar element = CKEDITOR.document.getBody();\n\t *\t\talert( element.getName() ); // 'body'\n\t *\n\t * @returns {CKEDITOR.dom.element} The `<body>` element.\n\t */\n\tgetBody: function() {\n\t\treturn new CKEDITOR.dom.element( this.$.body );\n\t},\n\n\t/**\n\t * Gets the DOM document element for this document.\n\t *\n\t * @returns {CKEDITOR.dom.element} The DOM document element.\n\t */\n\tgetDocumentElement: function() {\n\t\treturn new CKEDITOR.dom.element( this.$.documentElement );\n\t},\n\n\t/**\n\t * Gets the window object that stores this document.\n\t *\n\t * @returns {CKEDITOR.dom.window} The window object.\n\t */\n\tgetWindow: function() {\n\t\treturn new CKEDITOR.dom.window( this.$.parentWindow || this.$.defaultView );\n\t},\n\n\t/**\n\t * Defines the document content through `document.write`. Note that the\n\t * previous document content will be lost (cleaned).\n\t *\n\t *\t\tdocument.write(\n\t *\t\t\t'<html>' +\n\t *\t\t\t\t'<head><title>Sample Document</title></head>' +\n\t *\t\t\t\t'<body>Document content created by code.</body>' +\n\t *\t\t\t'</html>'\n\t *\t\t);\n\t *\n\t * @since 3.5\n\t * @param {String} html The HTML defining the document content.\n\t */\n\twrite: function( html ) {\n\t\t// Don't leave any history log in IE. (#5657)\n\t\tthis.$.open( 'text/html', 'replace' );\n\n\t\t// Support for custom document.domain in IE.\n\t\t//\n\t\t// The script must be appended because if placed before the\n\t\t// doctype, IE will go into quirks mode and mess with\n\t\t// the editable, e.g. by changing its default height.\n\t\tif ( CKEDITOR.env.ie )\n\t\t\thtml = html.replace( /(?:^\\s*<!DOCTYPE[^>]*?>)|^/i, '$&\\n<script data-cke-temp=\"1\">(' + CKEDITOR.tools.fixDomain + ')();</script>' );\n\n\t\tthis.$.write( html );\n\t\tthis.$.close();\n\t},\n\n\t/**\n\t * Wrapper for `querySelectorAll`. Returns a list of elements within this document that match\n\t * the specified `selector`.\n\t *\n\t * **Note:** The returned list is not a live collection (like the result of native `querySelectorAll`).\n\t *\n\t * @since 4.3\n\t * @param {String} selector\n\t * @returns {CKEDITOR.dom.nodeList}\n\t */\n\tfind: function( selector ) {\n\t\treturn new CKEDITOR.dom.nodeList( this.$.querySelectorAll( selector ) );\n\t},\n\n\t/**\n\t * Wrapper for `querySelector`. Returns the first element within this document that matches\n\t * the specified `selector`.\n\t *\n\t * @since 4.3\n\t * @param {String} selector\n\t * @returns {CKEDITOR.dom.element}\n\t */\n\tfindOne: function( selector ) {\n\t\tvar el = this.$.querySelector( selector );\n\n\t\treturn el ? new CKEDITOR.dom.element( el ) : null;\n\t},\n\n\t/**\n\t * Internet Explorer 8 only method. It returns a document fragment which has all HTML5 elements enabled.\n\t *\n\t * @since 4.3\n\t * @private\n\t * @returns DocumentFragment\n\t */\n\t_getHtml5ShivFrag: function() {\n\t\tvar $frag = this.getCustomData( 'html5ShivFrag' );\n\n\t\tif ( !$frag ) {\n\t\t\t$frag = this.$.createDocumentFragment();\n\t\t\tCKEDITOR.tools.enableHtml5Elements( $frag, true );\n\t\t\tthis.setCustomData( 'html5ShivFrag', $frag );\n\t\t}\n\n\t\treturn $frag;\n\t}\n} );\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/dom/document.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * Represents a list of {@link CKEDITOR.dom.node} objects.\n * It's a wrapper for native nodes list.\n *\n *\t\tvar nodeList = CKEDITOR.document.getBody().getChildren();\n *\t\talert( nodeList.count() ); // number [0;N]\n *\n * @class\n * @constructor Creates a document class instance.\n * @param {Object} nativeList\n */\nCKEDITOR.dom.nodeList = function( nativeList ) {\n\tthis.$ = nativeList;\n};\n\nCKEDITOR.dom.nodeList.prototype = {\n\t/**\n\t * Get count of nodes in this list.\n\t *\n\t * @returns {Number}\n\t */\n\tcount: function() {\n\t\treturn this.$.length;\n\t},\n\n\t/**\n\t * Get node from the list.\n\t *\n\t * @returns {CKEDITOR.dom.node}\n\t */\n\tgetItem: function( index ) {\n\t\tif ( index < 0 || index >= this.$.length )\n\t\t\treturn null;\n\n\t\tvar $node = this.$[ index ];\n\t\treturn $node ? new CKEDITOR.dom.node( $node ) : null;\n\t}\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/dom/nodelist.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Defines the {@link CKEDITOR.dom.element} class, which\n *\t\trepresents a DOM element.\n */\n\n/**\n * Represents a DOM element.\n *\n *\t\t// Create a new <span> element.\n *\t\tvar element = new CKEDITOR.dom.element( 'span' );\n *\n *\t\t// Create an element based on a native DOM element.\n *\t\tvar element = new CKEDITOR.dom.element( document.getElementById( 'myId' ) );\n *\n * @class\n * @extends CKEDITOR.dom.node\n * @constructor Creates an element class instance.\n * @param {Object/String} element A native DOM element or the element name for\n * new elements.\n * @param {CKEDITOR.dom.document} [ownerDocument] The document that will contain\n * the element in case of element creation.\n */\nCKEDITOR.dom.element = function( element, ownerDocument ) {\n\tif ( typeof element == 'string' )\n\t\telement = ( ownerDocument ? ownerDocument.$ : document ).createElement( element );\n\n\t// Call the base constructor (we must not call CKEDITOR.dom.node).\n\tCKEDITOR.dom.domObject.call( this, element );\n};\n\n// PACKAGER_RENAME( CKEDITOR.dom.element )\n/**\n * The the {@link CKEDITOR.dom.element} representing and element. If the\n * element is a native DOM element, it will be transformed into a valid\n * CKEDITOR.dom.element object.\n *\n *\t\tvar element = new CKEDITOR.dom.element( 'span' );\n *\t\talert( element == CKEDITOR.dom.element.get( element ) ); // true\n *\n *\t\tvar element = document.getElementById( 'myElement' );\n *\t\talert( CKEDITOR.dom.element.get( element ).getName() ); // (e.g.) 'p'\n *\n * @static\n * @param {String/Object} element Element's id or name or native DOM element.\n * @returns {CKEDITOR.dom.element} The transformed element.\n */\nCKEDITOR.dom.element.get = function( element ) {\n\tvar el = typeof element == 'string' ? document.getElementById( element ) || document.getElementsByName( element )[ 0 ] : element;\n\n\treturn el && ( el.$ ? el : new CKEDITOR.dom.element( el ) );\n};\n\nCKEDITOR.dom.element.prototype = new CKEDITOR.dom.node();\n\n/**\n * Creates an instance of the {@link CKEDITOR.dom.element} class based on the\n * HTML representation of an element.\n *\n *\t\tvar element = CKEDITOR.dom.element.createFromHtml( '<strong class=\"anyclass\">My element</strong>' );\n *\t\talert( element.getName() ); // 'strong'\n *\n * @static\n * @param {String} html The element HTML. It should define only one element in\n * the \"root\" level. The \"root\" element can have child nodes, but not siblings.\n * @returns {CKEDITOR.dom.element} The element instance.\n */\nCKEDITOR.dom.element.createFromHtml = function( html, ownerDocument ) {\n\tvar temp = new CKEDITOR.dom.element( 'div', ownerDocument );\n\ttemp.setHtml( html );\n\n\t// When returning the node, remove it from its parent to detach it.\n\treturn temp.getFirst().remove();\n};\n\n/**\n * Sets {@link CKEDITOR.dom.element#setCustomData custom data} on an element in a way that it is later\n * possible to {@link #clearAllMarkers clear all data} set on all elements sharing the same database.\n *\n * This mechanism is very useful when processing some portion of DOM. All markers can later be removed\n * by calling the {@link #clearAllMarkers} method, hence markers will not leak to second pass of this algorithm.\n *\n *\t\tvar database = {};\n *\t\tCKEDITOR.dom.element.setMarker( database, element1, 'foo', 'bar' );\n *\t\tCKEDITOR.dom.element.setMarker( database, element2, 'oof', [ 1, 2, 3 ] );\n *\n *\t\telement1.getCustomData( 'foo' ); // 'bar'\n *\t\telement2.getCustomData( 'oof' ); // [ 1, 2, 3 ]\n *\n *\t\tCKEDITOR.dom.element.clearAllMarkers( database );\n *\n *\t\telement1.getCustomData( 'foo' ); // null\n *\n * @static\n * @param {Object} database\n * @param {CKEDITOR.dom.element} element\n * @param {String} name\n * @param {Object} value\n * @returns {CKEDITOR.dom.element} The element.\n */\nCKEDITOR.dom.element.setMarker = function( database, element, name, value ) {\n\tvar id = element.getCustomData( 'list_marker_id' ) || ( element.setCustomData( 'list_marker_id', CKEDITOR.tools.getNextNumber() ).getCustomData( 'list_marker_id' ) ),\n\t\tmarkerNames = element.getCustomData( 'list_marker_names' ) || ( element.setCustomData( 'list_marker_names', {} ).getCustomData( 'list_marker_names' ) );\n\tdatabase[ id ] = element;\n\tmarkerNames[ name ] = 1;\n\n\treturn element.setCustomData( name, value );\n};\n\n/**\n * Removes all markers added using this database. See the {@link #setMarker} method for more information.\n *\n * @param {Object} database\n * @static\n */\nCKEDITOR.dom.element.clearAllMarkers = function( database ) {\n\tfor ( var i in database )\n\t\tCKEDITOR.dom.element.clearMarkers( database, database[ i ], 1 );\n};\n\n/**\n * Removes all markers added to this element and removes it from the database if\n * `removeFromDatabase` was passed. See the {@link #setMarker} method for more information.\n *\n *\t\tvar database = {};\n *\t\tCKEDITOR.dom.element.setMarker( database, element1, 'foo', 'bar' );\n *\t\tCKEDITOR.dom.element.setMarker( database, element2, 'oof', [ 1, 2, 3 ] );\n *\n *\t\telement1.getCustomData( 'foo' ); // 'bar'\n *\t\telement2.getCustomData( 'oof' ); // [ 1, 2, 3 ]\n *\n *\t\tCKEDITOR.dom.element.clearMarkers( database, element1, true );\n *\n *\t\telement1.getCustomData( 'foo' ); // null\n *\t\telement2.getCustomData( 'oof' ); // [ 1, 2, 3 ]\n *\n * @param {Object} database\n * @static\n */\nCKEDITOR.dom.element.clearMarkers = function( database, element, removeFromDatabase ) {\n\tvar names = element.getCustomData( 'list_marker_names' ),\n\t\tid = element.getCustomData( 'list_marker_id' );\n\tfor ( var i in names )\n\t\telement.removeCustomData( i );\n\telement.removeCustomData( 'list_marker_names' );\n\tif ( removeFromDatabase ) {\n\t\telement.removeCustomData( 'list_marker_id' );\n\t\tdelete database[ id ];\n\t}\n};\n\n( function() {\n\tvar elementsClassList = document.createElement( '_' ).classList,\n\t\tsupportsClassLists = typeof elementsClassList !== 'undefined' && String( elementsClassList.add ).match( /\\[Native code\\]/gi ) !== null,\n\t\trclass = /[\\n\\t\\r]/g;\n\n\tfunction hasClass( classNames, className ) {\n\t\t// Source: jQuery.\n\t\treturn ( ' ' + classNames + ' ' ).replace( rclass, ' ' ).indexOf( ' ' + className + ' ' ) > -1;\n\t}\n\n\tCKEDITOR.tools.extend( CKEDITOR.dom.element.prototype, {\n\t\t/**\n\t\t * The node type. This is a constant value set to {@link CKEDITOR#NODE_ELEMENT}.\n\t\t *\n\t\t * @readonly\n\t\t * @property {Number} [=CKEDITOR.NODE_ELEMENT]\n\t\t */\n\t\ttype: CKEDITOR.NODE_ELEMENT,\n\n\t\t/**\n\t\t * Adds a CSS class to the element. It appends the class to the\n\t\t * already existing names.\n\t\t *\n\t\t *\t\tvar element = new CKEDITOR.dom.element( 'div' );\n\t\t *\t\telement.addClass( 'classA' ); // <div class=\"classA\">\n\t\t *\t\telement.addClass( 'classB' ); // <div class=\"classA classB\">\n\t\t *\t\telement.addClass( 'classA' ); // <div class=\"classA classB\">\n\t\t *\n\t\t * **Note:** Since CKEditor 4.5 this method cannot be used with multiple classes (`'classA classB'`).\n\t\t *\n\t\t * @chainable\n\t\t * @method addClass\n\t\t * @param {String} className The name of the class to be added.\n\t\t */\n\t\taddClass: supportsClassLists ?\n\t\t\tfunction( className ) {\n\t\t\t\tthis.$.classList.add( className );\n\n\t\t\t\treturn this;\n\t\t\t} : function( className ) {\n\t\t\t\tvar c = this.$.className;\n\t\t\t\tif ( c ) {\n\t\t\t\t\tif ( !hasClass( c, className ) )\n\t\t\t\t\t\tc += ' ' + className;\n\t\t\t\t}\n\t\t\t\tthis.$.className = c || className;\n\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t/**\n\t\t * Removes a CSS class name from the elements classes. Other classes\n\t\t * remain untouched.\n\t\t *\n\t\t *\t\tvar element = new CKEDITOR.dom.element( 'div' );\n\t\t *\t\telement.addClass( 'classA' );\t\t// <div class=\"classA\">\n\t\t *\t\telement.addClass( 'classB' );\t\t// <div class=\"classA classB\">\n\t\t *\t\telement.removeClass( 'classA' );\t// <div class=\"classB\">\n\t\t *\t\telement.removeClass( 'classB' );\t// <div>\n\t\t *\n\t\t * @chainable\n\t\t * @method removeClass\n\t\t * @param {String} className The name of the class to remove.\n\t\t */\n\t\tremoveClass: supportsClassLists ?\n\t\t\tfunction( className ) {\n\t\t\t\tvar $ = this.$;\n\t\t\t\t$.classList.remove( className );\n\n\t\t\t\tif ( !$.className )\n\t\t\t\t\t$.removeAttribute( 'class' );\n\n\t\t\t\treturn this;\n\t\t\t} : function( className ) {\n\t\t\t\tvar c = this.getAttribute( 'class' );\n\t\t\t\tif ( c && hasClass( c, className ) ) {\n\t\t\t\t\tc = c\n\t\t\t\t\t\t.replace( new RegExp( '(?:^|\\\\s+)' + className + '(?=\\\\s|$)' ), '' )\n\t\t\t\t\t\t.replace( /^\\s+/, '' );\n\n\t\t\t\t\tif ( c )\n\t\t\t\t\t\tthis.setAttribute( 'class', c );\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.removeAttribute( 'class' );\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t/**\n\t\t * Checks if element has class name.\n\t\t *\n\t\t * @param {String} className\n\t\t * @returns {Boolean}\n\t\t */\n\t\thasClass: function( className ) {\n\t\t\treturn hasClass( this.$.className, className );\n\t\t},\n\n\t\t/**\n\t\t * Append a node as a child of this element.\n\t\t *\n\t\t *\t\tvar p = new CKEDITOR.dom.element( 'p' );\n\t\t *\n\t\t *\t\tvar strong = new CKEDITOR.dom.element( 'strong' );\n\t\t *\t\tp.append( strong );\n\t\t *\n\t\t *\t\tvar em = p.append( 'em' );\n\t\t *\n\t\t *\t\t// Result: '<p><strong></strong><em></em></p>'\n\t\t *\n\t\t * @param {CKEDITOR.dom.node/String} node The node or element name to be appended.\n\t\t * @param {Boolean} [toStart=false] Indicates that the element is to be appended at the start.\n\t\t * @returns {CKEDITOR.dom.node} The appended node.\n\t\t */\n\t\tappend: function( node, toStart ) {\n\t\t\tif ( typeof node == 'string' )\n\t\t\t\tnode = this.getDocument().createElement( node );\n\n\t\t\tif ( toStart )\n\t\t\t\tthis.$.insertBefore( node.$, this.$.firstChild );\n\t\t\telse\n\t\t\t\tthis.$.appendChild( node.$ );\n\n\t\t\treturn node;\n\t\t},\n\n\t\t/**\n\t\t * Append HTML as a child(ren) of this element.\n\t\t *\n\t\t * @param {String} html\n\t\t */\n\t\tappendHtml: function( html ) {\n\t\t\tif ( !this.$.childNodes.length )\n\t\t\t\tthis.setHtml( html );\n\t\t\telse {\n\t\t\t\tvar temp = new CKEDITOR.dom.element( 'div', this.getDocument() );\n\t\t\t\ttemp.setHtml( html );\n\t\t\t\ttemp.moveChildren( this );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Append text to this element.\n\t\t *\n\t\t *\t\tvar p = new CKEDITOR.dom.element( 'p' );\n\t\t *\t\tp.appendText( 'This is' );\n\t\t *\t\tp.appendText( ' some text' );\n\t\t *\n\t\t *\t\t// Result: '<p>This is some text</p>'\n\t\t *\n\t\t * @param {String} text The text to be appended.\n\t\t */\n\t\tappendText: function( text ) {\n\t\t\t// On IE8 it is impossible to append node to script tag, so we use its text.\n\t\t\t// On the contrary, on Safari the text property is unpredictable in links. (#13232)\n\t\t\tif ( this.$.text != null && CKEDITOR.env.ie && CKEDITOR.env.version < 9 )\n\t\t\t\tthis.$.text += text;\n\t\t\telse\n\t\t\t\tthis.append( new CKEDITOR.dom.text( text ) );\n\t\t},\n\n\t\t/**\n\t\t * Appends a `<br>` filler element to this element if the filler is not present already.\n\t\t * By default filler is appended only if {@link CKEDITOR.env#needsBrFiller} is `true`,\n\t\t * however when `force` is set to `true` filler will be appended regardless of the environment.\n\t\t *\n\t\t * @param {Boolean} [force] Append filler regardless of the environment.\n\t\t */\n\t\tappendBogus: function( force ) {\n\t\t\tif ( !force && !CKEDITOR.env.needsBrFiller )\n\t\t\t\treturn;\n\n\t\t\tvar lastChild = this.getLast();\n\n\t\t\t// Ignore empty/spaces text.\n\t\t\twhile ( lastChild && lastChild.type == CKEDITOR.NODE_TEXT && !CKEDITOR.tools.rtrim( lastChild.getText() ) )\n\t\t\t\tlastChild = lastChild.getPrevious();\n\t\t\tif ( !lastChild || !lastChild.is || !lastChild.is( 'br' ) ) {\n\t\t\t\tvar bogus = this.getDocument().createElement( 'br' );\n\n\t\t\t\tCKEDITOR.env.gecko && bogus.setAttribute( 'type', '_moz' );\n\n\t\t\t\tthis.append( bogus );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Breaks one of the ancestor element in the element position, moving\n\t\t * this element between the broken parts.\n\t\t *\n\t\t *\t\t// Before breaking:\n\t\t *\t\t//\t\t<b>This <i>is some<span /> sample</i> test text</b>\n\t\t *\t\t// If \"element\" is <span /> and \"parent\" is <i>:\n\t\t *\t\t//\t\t<b>This <i>is some</i><span /><i> sample</i> test text</b>\n\t\t *\t\telement.breakParent( parent );\n\t\t *\n\t\t *\t\t// Before breaking:\n\t\t *\t\t//\t\t<b>This <i>is some<span /> sample</i> test text</b>\n\t\t *\t\t// If \"element\" is <span /> and \"parent\" is <b>:\n\t\t *\t\t//\t\t<b>This <i>is some</i></b><span /><b><i> sample</i> test text</b>\n\t\t *\t\telement.breakParent( parent );\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} parent The anscestor element to get broken.\n\t\t * @param {Boolean} [cloneId=false] Whether to preserve ancestor ID attributes while breaking.\n\t\t */\n\t\tbreakParent: function( parent, cloneId ) {\n\t\t\tvar range = new CKEDITOR.dom.range( this.getDocument() );\n\n\t\t\t// We'll be extracting part of this element, so let's use our\n\t\t\t// range to get the correct piece.\n\t\t\trange.setStartAfter( this );\n\t\t\trange.setEndAfter( parent );\n\n\t\t\t// Extract it.\n\t\t\tvar docFrag = range.extractContents( false, cloneId || false ),\n\t\t\t\ttmpElement,\n\t\t\t\tcurrent;\n\n\t\t\t// Move the element outside the broken element.\n\t\t\trange.insertNode( this.remove() );\n\n\t\t\t// In case of Internet Explorer, we must check if there is no background-color\n\t\t\t// added to the element. In such case, we have to overwrite it to prevent \"switching it off\"\n\t\t\t// by a browser (#14667).\n\t\t\tif ( CKEDITOR.env.ie && !CKEDITOR.env.edge ) {\n\t\t\t\ttmpElement = new CKEDITOR.dom.element( 'div' );\n\n\t\t\t\twhile ( current = docFrag.getFirst() ) {\n\t\t\t\t\tif ( current.$.style.backgroundColor ) {\n\t\t\t\t\t\t// This is a necessary hack to make sure that IE will track backgroundColor CSS property, see\n\t\t\t\t\t\t// http://dev.ckeditor.com/ticket/14667#comment:8 for more details.\n\t\t\t\t\t\tcurrent.$.style.backgroundColor = current.$.style.backgroundColor;\n\t\t\t\t\t}\n\n\t\t\t\t\ttmpElement.append( current );\n\t\t\t\t}\n\n\t\t\t\t// Re-insert the extracted piece after the element.\n\t\t\t\ttmpElement.insertAfter( this );\n\t\t\t\ttmpElement.remove( true );\n\t\t\t} else {\n\t\t\t\t// Re-insert the extracted piece after the element.\n\t\t\t\tdocFrag.insertAfterNode( this );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Checks if this element contains given node.\n\t\t *\n\t\t * @method\n\t\t * @param {CKEDITOR.dom.node} node\n\t\t * @returns {Boolean}\n\t\t */\n\t\tcontains: !document.compareDocumentPosition ?\n\t\t\tfunction( node ) {\n\t\t\t\tvar $ = this.$;\n\n\t\t\t\treturn node.type != CKEDITOR.NODE_ELEMENT ? $.contains( node.getParent().$ ) : $ != node.$ && $.contains( node.$ );\n\t\t\t} : function( node ) {\n\t\t\t\treturn !!( this.$.compareDocumentPosition( node.$ ) & 16 );\n\t\t\t},\n\n\t\t/**\n\t\t * Moves the selection focus to this element.\n\t\t *\n\t\t *\t\tvar element = CKEDITOR.document.getById( 'myTextarea' );\n\t\t *\t\telement.focus();\n\t\t *\n\t\t * @method\n\t\t * @param  {Boolean} defer Whether to asynchronously defer the\n\t\t * execution by 100 ms.\n\t\t */\n\t\tfocus: ( function() {\n\t\t\tfunction exec() {\n\t\t\t\t// IE throws error if the element is not visible.\n\t\t\t\ttry {\n\t\t\t\t\tthis.$.focus();\n\t\t\t\t} catch ( e ) {}\n\t\t\t}\n\n\t\t\treturn function( defer ) {\n\t\t\t\tif ( defer )\n\t\t\t\t\tCKEDITOR.tools.setTimeout( exec, 100, this );\n\t\t\t\telse\n\t\t\t\t\texec.call( this );\n\t\t\t};\n\t\t} )(),\n\n\t\t/**\n\t\t * Gets the inner HTML of this element.\n\t\t *\n\t\t *\t\tvar element = CKEDITOR.dom.element.createFromHtml( '<div><b>Example</b></div>' );\n\t\t *\t\talert( element.getHtml() ); // '<b>Example</b>'\n\t\t *\n\t\t * @returns {String} The inner HTML of this element.\n\t\t */\n\t\tgetHtml: function() {\n\t\t\tvar retval = this.$.innerHTML;\n\t\t\t// Strip <?xml:namespace> tags in IE. (#3341).\n\t\t\treturn CKEDITOR.env.ie ? retval.replace( /<\\?[^>]*>/g, '' ) : retval;\n\t\t},\n\n\t\t/**\n\t\t * Gets the outer (inner plus tags) HTML of this element.\n\t\t *\n\t\t *\t\tvar element = CKEDITOR.dom.element.createFromHtml( '<div class=\"bold\"><b>Example</b></div>' );\n\t\t *\t\talert( element.getOuterHtml() ); // '<div class=\"bold\"><b>Example</b></div>'\n\t\t *\n\t\t * @returns {String} The outer HTML of this element.\n\t\t */\n\t\tgetOuterHtml: function() {\n\t\t\tif ( this.$.outerHTML ) {\n\t\t\t\t// IE includes the <?xml:namespace> tag in the outerHTML of\n\t\t\t\t// namespaced element. So, we must strip it here. (#3341)\n\t\t\t\treturn this.$.outerHTML.replace( /<\\?[^>]*>/, '' );\n\t\t\t}\n\n\t\t\tvar tmpDiv = this.$.ownerDocument.createElement( 'div' );\n\t\t\ttmpDiv.appendChild( this.$.cloneNode( true ) );\n\t\t\treturn tmpDiv.innerHTML;\n\t\t},\n\n\t\t/**\n\t\t * Retrieve the bounding rectangle of the current element, in pixels,\n\t\t * relative to the upper-left corner of the browser's client area.\n\t\t *\n\t\t * @returns {Object} The dimensions of the DOM element including\n\t\t * `left`, `top`, `right`, `bottom`, `width` and `height`.\n\t\t */\n\t\tgetClientRect: function() {\n\t\t\t// http://help.dottoro.com/ljvmcrrn.php\n\t\t\tvar rect = CKEDITOR.tools.extend( {}, this.$.getBoundingClientRect() );\n\n\t\t\t!rect.width && ( rect.width = rect.right - rect.left );\n\t\t\t!rect.height && ( rect.height = rect.bottom - rect.top );\n\n\t\t\treturn rect;\n\t\t},\n\n\t\t/**\n\t\t * Sets the inner HTML of this element.\n\t\t *\n\t\t *\t\tvar p = new CKEDITOR.dom.element( 'p' );\n\t\t *\t\tp.setHtml( '<b>Inner</b> HTML' );\n\t\t *\n\t\t *\t\t// Result: '<p><b>Inner</b> HTML</p>'\n\t\t *\n\t\t * @method\n\t\t * @param {String} html The HTML to be set for this element.\n\t\t * @returns {String} The inserted HTML.\n\t\t */\n\t\tsetHtml: ( CKEDITOR.env.ie && CKEDITOR.env.version < 9 ) ?\n\t\t\t// old IEs throws error on HTML manipulation (through the \"innerHTML\" property)\n\t\t\t// on the element which resides in an DTD invalid position,  e.g. <span><div></div></span>\n\t\t\t// fortunately it can be worked around with DOM manipulation.\n\t\t\tfunction( html ) {\n\t\t\t\ttry {\n\t\t\t\t\tvar $ = this.$;\n\n\t\t\t\t\t// Fix the case when setHtml is called on detached element.\n\t\t\t\t\t// HTML5 shiv used for document in which this element was created\n\t\t\t\t\t// won't affect that detached element. So get document fragment with\n\t\t\t\t\t// all HTML5 elements enabled and set innerHTML while this element is appended to it.\n\t\t\t\t\tif ( this.getParent() )\n\t\t\t\t\t\treturn ( $.innerHTML = html );\n\t\t\t\t\telse {\n\t\t\t\t\t\tvar $frag = this.getDocument()._getHtml5ShivFrag();\n\t\t\t\t\t\t$frag.appendChild( $ );\n\t\t\t\t\t\t$.innerHTML = html;\n\t\t\t\t\t\t$frag.removeChild( $ );\n\n\t\t\t\t\t\treturn html;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcatch ( e ) {\n\t\t\t\t\tthis.$.innerHTML = '';\n\n\t\t\t\t\tvar temp = new CKEDITOR.dom.element( 'body', this.getDocument() );\n\t\t\t\t\ttemp.$.innerHTML = html;\n\n\t\t\t\t\tvar children = temp.getChildren();\n\t\t\t\t\twhile ( children.count() )\n\t\t\t\t\t\tthis.append( children.getItem( 0 ) );\n\n\t\t\t\t\treturn html;\n\t\t\t\t}\n\t\t\t} : function( html ) {\n\t\t\t\treturn ( this.$.innerHTML = html );\n\t\t\t},\n\n\t\t/**\n\t\t * Sets the element contents as plain text.\n\t\t *\n\t\t *\t\tvar element = new CKEDITOR.dom.element( 'div' );\n\t\t *\t\telement.setText( 'A > B & C < D' );\n\t\t *\t\talert( element.innerHTML ); // 'A &gt; B &amp; C &lt; D'\n\t\t *\n\t\t * @param {String} text The text to be set.\n\t\t * @returns {String} The inserted text.\n\t\t */\n\t\tsetText: ( function() {\n\t\t\tvar supportsTextContent = document.createElement( 'p' );\n\t\t\tsupportsTextContent.innerHTML = 'x';\n\t\t\tsupportsTextContent = supportsTextContent.textContent;\n\n\t\t\treturn function( text ) {\n\t\t\t\tthis.$[ supportsTextContent ? 'textContent' : 'innerText' ] = text;\n\t\t\t};\n\t\t} )(),\n\n\t\t/**\n\t\t * Gets the value of an element attribute.\n\t\t *\n\t\t *\t\tvar element = CKEDITOR.dom.element.createFromHtml( '<input type=\"text\" />' );\n\t\t *\t\talert( element.getAttribute( 'type' ) ); // 'text'\n\t\t *\n\t\t * @method\n\t\t * @param {String} name The attribute name.\n\t\t * @returns {String} The attribute value or null if not defined.\n\t\t */\n\t\tgetAttribute: ( function() {\n\t\t\tvar standard = function( name ) {\n\t\t\t\t\treturn this.$.getAttribute( name, 2 );\n\t\t\t\t};\n\n\t\t\tif ( CKEDITOR.env.ie && ( CKEDITOR.env.ie7Compat || CKEDITOR.env.quirks ) ) {\n\t\t\t\treturn function( name ) {\n\t\t\t\t\tswitch ( name ) {\n\t\t\t\t\t\tcase 'class':\n\t\t\t\t\t\t\tname = 'className';\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'http-equiv':\n\t\t\t\t\t\t\tname = 'httpEquiv';\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'name':\n\t\t\t\t\t\t\treturn this.$.name;\n\n\t\t\t\t\t\tcase 'tabindex':\n\t\t\t\t\t\t\tvar tabIndex = standard.call( this, name );\n\n\t\t\t\t\t\t\t// IE returns tabIndex=0 by default for all\n\t\t\t\t\t\t\t// elements. For those elements,\n\t\t\t\t\t\t\t// getAtrribute( 'tabindex', 2 ) returns 32768\n\t\t\t\t\t\t\t// instead. So, we must make this check to give a\n\t\t\t\t\t\t\t// uniform result among all browsers.\n\t\t\t\t\t\t\tif ( tabIndex !== 0 && this.$.tabIndex === 0 )\n\t\t\t\t\t\t\t\ttabIndex = null;\n\n\t\t\t\t\t\t\treturn tabIndex;\n\n\t\t\t\t\t\tcase 'checked':\n\t\t\t\t\t\t\tvar attr = this.$.attributes.getNamedItem( name ),\n\t\t\t\t\t\t\t\tattrValue = attr.specified ? attr.nodeValue // For value given by parser.\n\t\t\t\t\t\t\t\t: this.$.checked; // For value created via DOM interface.\n\n\t\t\t\t\t\t\treturn attrValue ? 'checked' : null;\n\n\t\t\t\t\t\tcase 'hspace':\n\t\t\t\t\t\tcase 'value':\n\t\t\t\t\t\t\treturn this.$[ name ];\n\n\t\t\t\t\t\tcase 'style':\n\t\t\t\t\t\t\t// IE does not return inline styles via getAttribute(). See #2947.\n\t\t\t\t\t\t\treturn this.$.style.cssText;\n\n\t\t\t\t\t\tcase 'contenteditable':\n\t\t\t\t\t\tcase 'contentEditable':\n\t\t\t\t\t\t\treturn this.$.attributes.getNamedItem( 'contentEditable' ).specified ? this.$.getAttribute( 'contentEditable' ) : null;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn standard.call( this, name );\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn standard;\n\t\t\t}\n\t\t} )(),\n\n\t\t/**\n\t\t * Gets the values of all element attributes.\n\t\t *\n\t\t * @param {Array} exclude The names of attributes to be excluded from the returned object.\n\t\t * @return {Object} An object containing all element attributes with their values.\n\t\t */\n\t\tgetAttributes: function( exclude ) {\n\t\t\tvar attributes = {},\n\t\t\t\tattrDefs = this.$.attributes,\n\t\t\t\ti;\n\n\t\t\texclude = CKEDITOR.tools.isArray( exclude ) ? exclude : [];\n\n\t\t\tfor ( i = 0; i < attrDefs.length; i++ ) {\n\t\t\t\tif ( CKEDITOR.tools.indexOf( exclude, attrDefs[ i ].name ) === -1 ) {\n\t\t\t\t\tattributes[ attrDefs[ i ].name ] = attrDefs[ i ].value;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn attributes;\n\t\t},\n\n\t\t/**\n\t\t * Gets the nodes list containing all children of this element.\n\t\t *\n\t\t * @returns {CKEDITOR.dom.nodeList}\n\t\t */\n\t\tgetChildren: function() {\n\t\t\treturn new CKEDITOR.dom.nodeList( this.$.childNodes );\n\t\t},\n\n\t\t/**\n\t\t * Gets the current computed value of one of the element CSS style\n\t\t * properties.\n\t\t *\n\t\t *\t\tvar element = new CKEDITOR.dom.element( 'span' );\n\t\t *\t\talert( element.getComputedStyle( 'display' ) ); // 'inline'\n\t\t *\n\t\t * @method\n\t\t * @param {String} propertyName The style property name.\n\t\t * @returns {String} The property value.\n\t\t */\n\t\tgetComputedStyle: ( document.defaultView && document.defaultView.getComputedStyle ) ?\n\t\t\t\tfunction( propertyName ) {\n\t\t\t\t\tvar style = this.getWindow().$.getComputedStyle( this.$, null );\n\n\t\t\t\t\t// Firefox may return null if we call the above on a hidden iframe. (#9117)\n\t\t\t\t\treturn style ? style.getPropertyValue( propertyName ) : '';\n\t\t\t\t} : function( propertyName ) {\n\t\t\t\t\treturn this.$.currentStyle[ CKEDITOR.tools.cssStyleToDomStyle( propertyName ) ];\n\t\t\t\t},\n\n\t\t/**\n\t\t * Gets the DTD entries for this element.\n\t\t *\n\t\t * @returns {Object} An object containing the list of elements accepted\n\t\t * by this element.\n\t\t */\n\t\tgetDtd: function() {\n\t\t\tvar dtd = CKEDITOR.dtd[ this.getName() ];\n\n\t\t\tthis.getDtd = function() {\n\t\t\t\treturn dtd;\n\t\t\t};\n\n\t\t\treturn dtd;\n\t\t},\n\n\t\t/**\n\t\t * Gets all this element's descendants having given tag name.\n\t\t *\n\t\t * @method\n\t\t * @param {String} tagName\n\t\t */\n\t\tgetElementsByTag: CKEDITOR.dom.document.prototype.getElementsByTag,\n\n\t\t/**\n\t\t * Gets the computed tabindex for this element.\n\t\t *\n\t\t *\t\tvar element = CKEDITOR.document.getById( 'myDiv' );\n\t\t *\t\talert( element.getTabIndex() ); // (e.g.) '-1'\n\t\t *\n\t\t * @method\n\t\t * @returns {Number} The tabindex value.\n\t\t */\n\t\tgetTabIndex: function() {\n\t\t\tvar tabIndex = this.$.tabIndex;\n\n\t\t\t// IE returns tabIndex=0 by default for all elements. In\n\t\t\t// those cases we must check that the element really has\n\t\t\t// the tabindex attribute set to zero, or it is one of\n\t\t\t// those element that should have zero by default.\n\t\t\tif ( tabIndex === 0 && !CKEDITOR.dtd.$tabIndex[ this.getName() ] && parseInt( this.getAttribute( 'tabindex' ), 10 ) !== 0 )\n\t\t\t\treturn -1;\n\n\t\t\treturn tabIndex;\n\t\t},\n\n\t\t/**\n\t\t * Gets the text value of this element.\n\t\t *\n\t\t * Only in IE (which uses innerText), `<br>` will cause linebreaks,\n\t\t * and sucessive whitespaces (including line breaks) will be reduced to\n\t\t * a single space. This behavior is ok for us, for now. It may change\n\t\t * in the future.\n\t\t *\n\t\t *\t\tvar element = CKEDITOR.dom.element.createFromHtml( '<div>Sample <i>text</i>.</div>' );\n\t\t *\t\talert( <b>element.getText()</b> ); // 'Sample text.'\n\t\t *\n\t\t * @returns {String} The text value.\n\t\t */\n\t\tgetText: function() {\n\t\t\treturn this.$.textContent || this.$.innerText || '';\n\t\t},\n\n\t\t/**\n\t\t * Gets the window object that contains this element.\n\t\t *\n\t\t * @returns {CKEDITOR.dom.window} The window object.\n\t\t */\n\t\tgetWindow: function() {\n\t\t\treturn this.getDocument().getWindow();\n\t\t},\n\n\t\t/**\n\t\t * Gets the value of the `id` attribute of this element.\n\t\t *\n\t\t *\t\tvar element = CKEDITOR.dom.element.createFromHtml( '<p id=\"myId\"></p>' );\n\t\t *\t\talert( element.getId() ); // 'myId'\n\t\t *\n\t\t * @returns {String} The element id, or null if not available.\n\t\t */\n\t\tgetId: function() {\n\t\t\treturn this.$.id || null;\n\t\t},\n\n\t\t/**\n\t\t * Gets the value of the `name` attribute of this element.\n\t\t *\n\t\t *\t\tvar element = CKEDITOR.dom.element.createFromHtml( '<input name=\"myName\"></input>' );\n\t\t *\t\talert( <b>element.getNameAtt()</b> ); // 'myName'\n\t\t *\n\t\t * @returns {String} The element name, or null if not available.\n\t\t */\n\t\tgetNameAtt: function() {\n\t\t\treturn this.$.name || null;\n\t\t},\n\n\t\t/**\n\t\t * Gets the element name (tag name). The returned name is guaranteed to\n\t\t * be always full lowercased.\n\t\t *\n\t\t *\t\tvar element = new CKEDITOR.dom.element( 'span' );\n\t\t *\t\talert( element.getName() ); // 'span'\n\t\t *\n\t\t * @returns {String} The element name.\n\t\t */\n\t\tgetName: function() {\n\t\t\t// Cache the lowercased name inside a closure.\n\t\t\tvar nodeName = this.$.nodeName.toLowerCase();\n\n\t\t\tif ( CKEDITOR.env.ie && ( document.documentMode <= 8 ) ) {\n\t\t\t\tvar scopeName = this.$.scopeName;\n\t\t\t\tif ( scopeName != 'HTML' )\n\t\t\t\t\tnodeName = scopeName.toLowerCase() + ':' + nodeName;\n\t\t\t}\n\n\t\t\tthis.getName = function() {\n\t\t\t\treturn nodeName;\n\t\t\t};\n\n\t\t\treturn this.getName();\n\t\t},\n\n\t\t/**\n\t\t * Gets the value set to this element. This value is usually available\n\t\t * for form field elements.\n\t\t *\n\t\t * @returns {String} The element value.\n\t\t */\n\t\tgetValue: function() {\n\t\t\treturn this.$.value;\n\t\t},\n\n\t\t/**\n\t\t * Gets the first child node of this element.\n\t\t *\n\t\t *\t\tvar element = CKEDITOR.dom.element.createFromHtml( '<div><b>Example</b></div>' );\n\t\t *\t\tvar first = element.getFirst();\n\t\t *\t\talert( first.getName() ); // 'b'\n\t\t *\n\t\t * @param {Function} evaluator Filtering the result node.\n\t\t * @returns {CKEDITOR.dom.node} The first child node or null if not available.\n\t\t */\n\t\tgetFirst: function( evaluator ) {\n\t\t\tvar first = this.$.firstChild,\n\t\t\t\tretval = first && new CKEDITOR.dom.node( first );\n\t\t\tif ( retval && evaluator && !evaluator( retval ) )\n\t\t\t\tretval = retval.getNext( evaluator );\n\n\t\t\treturn retval;\n\t\t},\n\n\t\t/**\n\t\t * See {@link #getFirst}.\n\t\t *\n\t\t * @param {Function} evaluator Filtering the result node.\n\t\t * @returns {CKEDITOR.dom.node}\n\t\t */\n\t\tgetLast: function( evaluator ) {\n\t\t\tvar last = this.$.lastChild,\n\t\t\t\tretval = last && new CKEDITOR.dom.node( last );\n\t\t\tif ( retval && evaluator && !evaluator( retval ) )\n\t\t\t\tretval = retval.getPrevious( evaluator );\n\n\t\t\treturn retval;\n\t\t},\n\n\t\t/**\n\t\t * Gets CSS style value.\n\t\t *\n\t\t * @param {String} name The CSS property name.\n\t\t * @returns {String} Style value.\n\t\t */\n\t\tgetStyle: function( name ) {\n\t\t\treturn this.$.style[ CKEDITOR.tools.cssStyleToDomStyle( name ) ];\n\t\t},\n\n\t\t/**\n\t\t * Checks if the element name matches the specified criteria.\n\t\t *\n\t\t *\t\tvar element = new CKEDITOR.element( 'span' );\n\t\t *\t\talert( element.is( 'span' ) );\t\t\t// true\n\t\t *\t\talert( element.is( 'p', 'span' ) );\t\t// true\n\t\t *\t\talert( element.is( 'p' ) );\t\t\t\t// false\n\t\t *\t\talert( element.is( 'p', 'div' ) );\t\t// false\n\t\t *\t\talert( element.is( { p:1,span:1 } ) );\t// true\n\t\t *\n\t\t * @param {String.../Object} name One or more names to be checked, or a {@link CKEDITOR.dtd} object.\n\t\t * @returns {Boolean} `true` if the element name matches any of the names.\n\t\t */\n\t\tis: function() {\n\t\t\tvar name = this.getName();\n\n\t\t\t// Check against the specified DTD liternal.\n\t\t\tif ( typeof arguments[ 0 ] == 'object' )\n\t\t\t\treturn !!arguments[ 0 ][ name ];\n\n\t\t\t// Check for tag names\n\t\t\tfor ( var i = 0; i < arguments.length; i++ ) {\n\t\t\t\tif ( arguments[ i ] == name )\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\n\t\t/**\n\t\t * Decide whether one element is able to receive cursor.\n\t\t *\n\t\t * @param {Boolean} [textCursor=true] Only consider element that could receive text child.\n\t\t */\n\t\tisEditable: function( textCursor ) {\n\t\t\tvar name = this.getName();\n\n\t\t\tif ( this.isReadOnly() || this.getComputedStyle( 'display' ) == 'none' ||\n\t\t\t\tthis.getComputedStyle( 'visibility' ) == 'hidden' ||\n\t\t\t\tCKEDITOR.dtd.$nonEditable[ name ] ||\n\t\t\t\tCKEDITOR.dtd.$empty[ name ] ||\n\t\t\t\t( this.is( 'a' ) &&\n\t\t\t\t\t( this.data( 'cke-saved-name' ) || this.hasAttribute( 'name' ) ) &&\n\t\t\t\t\t!this.getChildCount()\n\t\t\t\t) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif ( textCursor !== false ) {\n\t\t\t\t// Get the element DTD (defaults to span for unknown elements).\n\t\t\t\tvar dtd = CKEDITOR.dtd[ name ] || CKEDITOR.dtd.span;\n\t\t\t\t// In the DTD # == text node.\n\t\t\t\treturn !!( dtd && dtd[ '#' ] );\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\t/**\n\t\t * Compare this element's inner html, tag name, attributes, etc. with other one.\n\t\t *\n\t\t * See [W3C's DOM Level 3 spec - node#isEqualNode](http://www.w3.org/TR/DOM-Level-3-Core/core.html#Node3-isEqualNode)\n\t\t * for more details.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} otherElement Element to compare.\n\t\t * @returns {Boolean}\n\t\t */\n\t\tisIdentical: function( otherElement ) {\n\t\t\t// do shallow clones, but with IDs\n\t\t\tvar thisEl = this.clone( 0, 1 ),\n\t\t\t\totherEl = otherElement.clone( 0, 1 );\n\n\t\t\t// Remove distractions.\n\t\t\tthisEl.removeAttributes( [ '_moz_dirty', 'data-cke-expando', 'data-cke-saved-href', 'data-cke-saved-name' ] );\n\t\t\totherEl.removeAttributes( [ '_moz_dirty', 'data-cke-expando', 'data-cke-saved-href', 'data-cke-saved-name' ] );\n\n\t\t\t// Native comparison available.\n\t\t\tif ( thisEl.$.isEqualNode ) {\n\t\t\t\t// Styles order matters.\n\t\t\t\tthisEl.$.style.cssText = CKEDITOR.tools.normalizeCssText( thisEl.$.style.cssText );\n\t\t\t\totherEl.$.style.cssText = CKEDITOR.tools.normalizeCssText( otherEl.$.style.cssText );\n\t\t\t\treturn thisEl.$.isEqualNode( otherEl.$ );\n\t\t\t} else {\n\t\t\t\tthisEl = thisEl.getOuterHtml();\n\t\t\t\totherEl = otherEl.getOuterHtml();\n\n\t\t\t\t// Fix tiny difference between link href in older IEs.\n\t\t\t\tif ( CKEDITOR.env.ie && CKEDITOR.env.version < 9 && this.is( 'a' ) ) {\n\t\t\t\t\tvar parent = this.getParent();\n\t\t\t\t\tif ( parent.type == CKEDITOR.NODE_ELEMENT ) {\n\t\t\t\t\t\tvar el = parent.clone();\n\t\t\t\t\t\tel.setHtml( thisEl ), thisEl = el.getHtml();\n\t\t\t\t\t\tel.setHtml( otherEl ), otherEl = el.getHtml();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn thisEl == otherEl;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Checks if this element is visible. May not work if the element is\n\t\t * child of an element with visibility set to `hidden`, but works well\n\t\t * on the great majority of cases.\n\t\t *\n\t\t * @returns {Boolean} True if the element is visible.\n\t\t */\n\t\tisVisible: function() {\n\t\t\tvar isVisible = ( this.$.offsetHeight || this.$.offsetWidth ) && this.getComputedStyle( 'visibility' ) != 'hidden',\n\t\t\t\telementWindow, elementWindowFrame;\n\n\t\t\t// Webkit and Opera report non-zero offsetHeight despite that\n\t\t\t// element is inside an invisible iframe. (#4542)\n\t\t\tif ( isVisible && CKEDITOR.env.webkit ) {\n\t\t\t\telementWindow = this.getWindow();\n\n\t\t\t\tif ( !elementWindow.equals( CKEDITOR.document.getWindow() ) && ( elementWindowFrame = elementWindow.$.frameElement ) )\n\t\t\t\t\tisVisible = new CKEDITOR.dom.element( elementWindowFrame ).isVisible();\n\n\t\t\t}\n\n\t\t\treturn !!isVisible;\n\t\t},\n\n\t\t/**\n\t\t * Whether it's an empty inline elements which has no visual impact when removed.\n\t\t *\n\t\t * @returns {Boolean}\n\t\t */\n\t\tisEmptyInlineRemoveable: function() {\n\t\t\tif ( !CKEDITOR.dtd.$removeEmpty[ this.getName() ] )\n\t\t\t\treturn false;\n\n\t\t\tvar children = this.getChildren();\n\t\t\tfor ( var i = 0, count = children.count(); i < count; i++ ) {\n\t\t\t\tvar child = children.getItem( i );\n\n\t\t\t\tif ( child.type == CKEDITOR.NODE_ELEMENT && child.data( 'cke-bookmark' ) )\n\t\t\t\t\tcontinue;\n\n\t\t\t\tif ( child.type == CKEDITOR.NODE_ELEMENT && !child.isEmptyInlineRemoveable() || child.type == CKEDITOR.NODE_TEXT && CKEDITOR.tools.trim( child.getText() ) )\n\t\t\t\t\treturn false;\n\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\n\t\t/**\n\t\t * Checks if the element has any defined attributes.\n\t\t *\n\t\t *\t\tvar element = CKEDITOR.dom.element.createFromHtml( '<div title=\"Test\">Example</div>' );\n\t\t *\t\talert( element.hasAttributes() ); // true\n\t\t *\n\t\t *\t\tvar element = CKEDITOR.dom.element.createFromHtml( '<div>Example</div>' );\n\t\t *\t\talert( element.hasAttributes() ); // false\n\t\t *\n\t\t * @method\n\t\t * @returns {Boolean} True if the element has attributes.\n\t\t */\n\t\thasAttributes: CKEDITOR.env.ie && ( CKEDITOR.env.ie7Compat || CKEDITOR.env.quirks ) ?\n\t\t\tfunction() {\n\t\t\t\tvar attributes = this.$.attributes;\n\n\t\t\t\tfor ( var i = 0; i < attributes.length; i++ ) {\n\t\t\t\t\tvar attribute = attributes[ i ];\n\n\t\t\t\t\tswitch ( attribute.nodeName ) {\n\t\t\t\t\t\tcase 'class':\n\t\t\t\t\t\t\t// IE has a strange bug. If calling removeAttribute('className'),\n\t\t\t\t\t\t\t// the attributes collection will still contain the \"class\"\n\t\t\t\t\t\t\t// attribute, which will be marked as \"specified\", even if the\n\t\t\t\t\t\t\t// outerHTML of the element is not displaying the class attribute.\n\t\t\t\t\t\t\t// Note : I was not able to reproduce it outside the editor,\n\t\t\t\t\t\t\t// but I've faced it while working on the TC of #1391.\n\t\t\t\t\t\t\tif ( this.getAttribute( 'class' ) ) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Attributes to be ignored.\n\t\t\t\t\t\t/* falls through */\n\t\t\t\t\t\tcase 'data-cke-expando':\n\t\t\t\t\t\t\tcontinue;\n\n\n\t\t\t\t\t\t/* falls through */\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tif ( attribute.specified ) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t} : function() {\n\t\t\t\tvar attrs = this.$.attributes,\n\t\t\t\t\tattrsNum = attrs.length;\n\n\t\t\t\t// The _moz_dirty attribute might get into the element after pasting (#5455)\n\t\t\t\tvar execludeAttrs = { 'data-cke-expando': 1, _moz_dirty: 1 };\n\n\t\t\t\treturn attrsNum > 0 && ( attrsNum > 2 || !execludeAttrs[ attrs[ 0 ].nodeName ] || ( attrsNum == 2 && !execludeAttrs[ attrs[ 1 ].nodeName ] ) );\n\t\t\t},\n\n\t\t/**\n\t\t * Checks if the specified attribute is defined for this element.\n\t\t *\n\t\t * @method\n\t\t * @param {String} name The attribute name.\n\t\t * @returns {Boolean} `true` if the specified attribute is defined.\n\t\t */\n\t\thasAttribute: ( function() {\n\t\t\tfunction ieHasAttribute( name ) {\n\t\t\t\tvar $attr = this.$.attributes.getNamedItem( name );\n\n\t\t\t\tif ( this.getName() == 'input' ) {\n\t\t\t\t\tswitch ( name ) {\n\t\t\t\t\t\tcase 'class':\n\t\t\t\t\t\t\treturn this.$.className.length > 0;\n\t\t\t\t\t\tcase 'checked':\n\t\t\t\t\t\t\treturn !!this.$.checked;\n\t\t\t\t\t\tcase 'value':\n\t\t\t\t\t\t\tvar type = this.getAttribute( 'type' );\n\t\t\t\t\t\t\treturn type == 'checkbox' || type == 'radio' ? this.$.value != 'on' : !!this.$.value;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( !$attr )\n\t\t\t\t\treturn false;\n\n\t\t\t\treturn $attr.specified;\n\t\t\t}\n\n\t\t\tif ( CKEDITOR.env.ie ) {\n\t\t\t\tif ( CKEDITOR.env.version < 8 ) {\n\t\t\t\t\treturn function( name ) {\n\t\t\t\t\t\t// On IE < 8 the name attribute cannot be retrieved\n\t\t\t\t\t\t// right after the element creation and setting the\n\t\t\t\t\t\t// name with setAttribute.\n\t\t\t\t\t\tif ( name == 'name' )\n\t\t\t\t\t\t\treturn !!this.$.name;\n\n\t\t\t\t\t\treturn ieHasAttribute.call( this, name );\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\treturn ieHasAttribute;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn function( name ) {\n\t\t\t\t\t// On other browsers specified property is deprecated and return always true,\n\t\t\t\t\t// but fortunately $.attributes contains only specified attributes.\n\t\t\t\t\treturn !!this.$.attributes.getNamedItem( name );\n\t\t\t\t};\n\t\t\t}\n\t\t} )(),\n\n\t\t/**\n\t\t * Hides this element (sets `display: none`).\n\t\t *\n\t\t *\t\tvar element = CKEDITOR.document.getById( 'myElement' );\n\t\t *\t\telement.hide();\n\t\t */\n\t\thide: function() {\n\t\t\tthis.setStyle( 'display', 'none' );\n\t\t},\n\n\t\t/**\n\t\t * Moves this element's children to the target element.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} target\n\t\t * @param {Boolean} [toStart=false] Insert moved children at the\n\t\t * beginning of the target element.\n\t\t */\n\t\tmoveChildren: function( target, toStart ) {\n\t\t\tvar $ = this.$;\n\t\t\ttarget = target.$;\n\n\t\t\tif ( $ == target )\n\t\t\t\treturn;\n\n\t\t\tvar child;\n\n\t\t\tif ( toStart ) {\n\t\t\t\twhile ( ( child = $.lastChild ) )\n\t\t\t\t\ttarget.insertBefore( $.removeChild( child ), target.firstChild );\n\t\t\t} else {\n\t\t\t\twhile ( ( child = $.firstChild ) )\n\t\t\t\t\ttarget.appendChild( $.removeChild( child ) );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Merges sibling elements that are identical to this one.\n\t\t *\n\t\t * Identical child elements are also merged. For example:\n\t\t *\n\t\t *\t\t<b><i></i></b><b><i></i></b> => <b><i></i></b>\n\t\t *\n\t\t * @method\n\t\t * @param {Boolean} [inlineOnly=true] Allow only inline elements to be merged.\n\t\t */\n\t\tmergeSiblings: ( function() {\n\t\t\tfunction mergeElements( element, sibling, isNext ) {\n\t\t\t\tif ( sibling && sibling.type == CKEDITOR.NODE_ELEMENT ) {\n\t\t\t\t\t// Jumping over bookmark nodes and empty inline elements, e.g. <b><i></i></b>,\n\t\t\t\t\t// queuing them to be moved later. (#5567)\n\t\t\t\t\tvar pendingNodes = [];\n\n\t\t\t\t\twhile ( sibling.data( 'cke-bookmark' ) || sibling.isEmptyInlineRemoveable() ) {\n\t\t\t\t\t\tpendingNodes.push( sibling );\n\t\t\t\t\t\tsibling = isNext ? sibling.getNext() : sibling.getPrevious();\n\t\t\t\t\t\tif ( !sibling || sibling.type != CKEDITOR.NODE_ELEMENT )\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( element.isIdentical( sibling ) ) {\n\t\t\t\t\t\t// Save the last child to be checked too, to merge things like\n\t\t\t\t\t\t// <b><i></i></b><b><i></i></b> => <b><i></i></b>\n\t\t\t\t\t\tvar innerSibling = isNext ? element.getLast() : element.getFirst();\n\n\t\t\t\t\t\t// Move pending nodes first into the target element.\n\t\t\t\t\t\twhile ( pendingNodes.length )\n\t\t\t\t\t\t\tpendingNodes.shift().move( element, !isNext );\n\n\t\t\t\t\t\tsibling.moveChildren( element, !isNext );\n\t\t\t\t\t\tsibling.remove();\n\n\t\t\t\t\t\t// Now check the last inner child (see two comments above).\n\t\t\t\t\t\tif ( innerSibling && innerSibling.type == CKEDITOR.NODE_ELEMENT )\n\t\t\t\t\t\t\tinnerSibling.mergeSiblings();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn function( inlineOnly ) {\n\t\t\t\t// Merge empty links and anchors also. (#5567)\n\t\t\t\tif ( !( inlineOnly === false || CKEDITOR.dtd.$removeEmpty[ this.getName() ] || this.is( 'a' ) ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tmergeElements( this, this.getNext(), true );\n\t\t\t\tmergeElements( this, this.getPrevious() );\n\t\t\t};\n\t\t} )(),\n\n\t\t/**\n\t\t * Shows this element (displays it).\n\t\t *\n\t\t *\t\tvar element = CKEDITOR.document.getById( 'myElement' );\n\t\t *\t\telement.show();\n\t\t */\n\t\tshow: function() {\n\t\t\tthis.setStyles( {\n\t\t\t\tdisplay: '',\n\t\t\t\tvisibility: ''\n\t\t\t} );\n\t\t},\n\n\t\t/**\n\t\t * Sets the value of an element attribute.\n\t\t *\n\t\t *\t\tvar element = CKEDITOR.document.getById( 'myElement' );\n\t\t *\t\telement.setAttribute( 'class', 'myClass' );\n\t\t *\t\telement.setAttribute( 'title', 'This is an example' );\n\t\t *\n\t\t * @method\n\t\t * @param {String} name The name of the attribute.\n\t\t * @param {String} value The value to be set to the attribute.\n\t\t * @returns {CKEDITOR.dom.element} This element instance.\n\t\t */\n\t\tsetAttribute: ( function() {\n\t\t\tvar standard = function( name, value ) {\n\t\t\t\t\tthis.$.setAttribute( name, value );\n\t\t\t\t\treturn this;\n\t\t\t\t};\n\n\t\t\tif ( CKEDITOR.env.ie && ( CKEDITOR.env.ie7Compat || CKEDITOR.env.quirks ) ) {\n\t\t\t\treturn function( name, value ) {\n\t\t\t\t\tif ( name == 'class' )\n\t\t\t\t\t\tthis.$.className = value;\n\t\t\t\t\telse if ( name == 'style' )\n\t\t\t\t\t\tthis.$.style.cssText = value;\n\t\t\t\t\telse if ( name == 'tabindex' ) // Case sensitive.\n\t\t\t\t\tthis.$.tabIndex = value;\n\t\t\t\t\telse if ( name == 'checked' )\n\t\t\t\t\t\tthis.$.checked = value;\n\t\t\t\t\telse if ( name == 'contenteditable' )\n\t\t\t\t\t\tstandard.call( this, 'contentEditable', value );\n\t\t\t\t\telse\n\t\t\t\t\t\tstandard.apply( this, arguments );\n\t\t\t\t\treturn this;\n\t\t\t\t};\n\t\t\t} else if ( CKEDITOR.env.ie8Compat && CKEDITOR.env.secure ) {\n\t\t\t\treturn function( name, value ) {\n\t\t\t\t\t// IE8 throws error when setting src attribute to non-ssl value. (#7847)\n\t\t\t\t\tif ( name == 'src' && value.match( /^http:\\/\\// ) ) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tstandard.apply( this, arguments );\n\t\t\t\t\t\t} catch ( e ) {}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstandard.apply( this, arguments );\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn standard;\n\t\t\t}\n\t\t} )(),\n\n\t\t/**\n\t\t * Sets the value of several element attributes.\n\t\t *\n\t\t *\t\tvar element = CKEDITOR.document.getById( 'myElement' );\n\t\t *\t\telement.setAttributes( {\n\t\t *\t\t\t'class':\t'myClass',\n\t\t *\t\t\ttitle:\t\t'This is an example'\n\t\t *\t\t} );\n\t\t *\n\t\t * @chainable\n\t\t * @param {Object} attributesPairs An object containing the names and\n\t\t * values of the attributes.\n\t\t * @returns {CKEDITOR.dom.element} This element instance.\n\t\t */\n\t\tsetAttributes: function( attributesPairs ) {\n\t\t\tfor ( var name in attributesPairs )\n\t\t\t\tthis.setAttribute( name, attributesPairs[ name ] );\n\t\t\treturn this;\n\t\t},\n\n\t\t/**\n\t\t * Sets the element value. This function is usually used with form\n\t\t * field element.\n\t\t *\n\t\t * @chainable\n\t\t * @param {String} value The element value.\n\t\t * @returns {CKEDITOR.dom.element} This element instance.\n\t\t */\n\t\tsetValue: function( value ) {\n\t\t\tthis.$.value = value;\n\t\t\treturn this;\n\t\t},\n\n\t\t/**\n\t\t * Removes an attribute from the element.\n\t\t *\n\t\t *\t\tvar element = CKEDITOR.dom.element.createFromHtml( '<div class=\"classA\"></div>' );\n\t\t *\t\telement.removeAttribute( 'class' );\n\t\t *\n\t\t * @method\n\t\t * @param {String} name The attribute name.\n\t\t */\n\t\tremoveAttribute: ( function() {\n\t\t\tvar standard = function( name ) {\n\t\t\t\t\tthis.$.removeAttribute( name );\n\t\t\t\t};\n\n\t\t\tif ( CKEDITOR.env.ie && ( CKEDITOR.env.ie7Compat || CKEDITOR.env.quirks ) ) {\n\t\t\t\treturn function( name ) {\n\t\t\t\t\tif ( name == 'class' )\n\t\t\t\t\t\tname = 'className';\n\t\t\t\t\telse if ( name == 'tabindex' )\n\t\t\t\t\t\tname = 'tabIndex';\n\t\t\t\t\telse if ( name == 'contenteditable' )\n\t\t\t\t\t\tname = 'contentEditable';\n\t\t\t\t\tstandard.call( this, name );\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn standard;\n\t\t\t}\n\t\t} )(),\n\n\t\t/**\n\t\t * Removes all element's attributes or just given ones.\n\t\t *\n\t\t * @param {Array} [attributes] The array with attributes names.\n\t\t */\n\t\tremoveAttributes: function( attributes ) {\n\t\t\tif ( CKEDITOR.tools.isArray( attributes ) ) {\n\t\t\t\tfor ( var i = 0; i < attributes.length; i++ ) {\n\t\t\t\t\tthis.removeAttribute( attributes[ i ] );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tattributes = attributes || this.getAttributes();\n\n\t\t\t\tfor ( var attr in attributes ) {\n\t\t\t\t\tattributes.hasOwnProperty( attr ) && this.removeAttribute( attr );\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Removes a style from the element.\n\t\t *\n\t\t *\t\tvar element = CKEDITOR.dom.element.createFromHtml( '<div style=\"display:none\"></div>' );\n\t\t *\t\telement.removeStyle( 'display' );\n\t\t *\n\t\t * @method\n\t\t * @param {String} name The style name.\n\t\t */\n\t\tremoveStyle: function( name ) {\n\t\t\t// Removes the specified property from the current style object.\n\t\t\tvar $ = this.$.style;\n\n\t\t\t// \"removeProperty\" need to be specific on the following styles.\n\t\t\tif ( !$.removeProperty && ( name == 'border' || name == 'margin' || name == 'padding' ) ) {\n\t\t\t\tvar names = expandedRules( name );\n\t\t\t\tfor ( var i = 0 ; i < names.length ; i++ )\n\t\t\t\t\tthis.removeStyle( names[ i ] );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$.removeProperty ? $.removeProperty( name ) : $.removeAttribute( CKEDITOR.tools.cssStyleToDomStyle( name ) );\n\n\t\t\t// Eventually remove empty style attribute.\n\t\t\tif ( !this.$.style.cssText )\n\t\t\t\tthis.removeAttribute( 'style' );\n\t\t},\n\n\t\t/**\n\t\t * Sets the value of an element style.\n\t\t *\n\t\t *\t\tvar element = CKEDITOR.document.getById( 'myElement' );\n\t\t *\t\telement.setStyle( 'background-color', '#ff0000' );\n\t\t *\t\telement.setStyle( 'margin-top', '10px' );\n\t\t *\t\telement.setStyle( 'float', 'right' );\n\t\t *\n\t\t * @param {String} name The name of the style. The CSS naming notation\n\t\t * must be used (e.g. `background-color`).\n\t\t * @param {String} value The value to be set to the style.\n\t\t * @returns {CKEDITOR.dom.element} This element instance.\n\t\t */\n\t\tsetStyle: function( name, value ) {\n\t\t\tthis.$.style[ CKEDITOR.tools.cssStyleToDomStyle( name ) ] = value;\n\t\t\treturn this;\n\t\t},\n\n\t\t/**\n\t\t * Sets the value of several element styles.\n\t\t *\n\t\t *\t\tvar element = CKEDITOR.document.getById( 'myElement' );\n\t\t *\t\telement.setStyles( {\n\t\t *\t\t\tposition:\t'absolute',\n\t\t *\t\t\tfloat:\t\t'right'\n\t\t *\t\t} );\n\t\t *\n\t\t * @param {Object} stylesPairs An object containing the names and\n\t\t * values of the styles.\n\t\t * @returns {CKEDITOR.dom.element} This element instance.\n\t\t */\n\t\tsetStyles: function( stylesPairs ) {\n\t\t\tfor ( var name in stylesPairs )\n\t\t\t\tthis.setStyle( name, stylesPairs[ name ] );\n\t\t\treturn this;\n\t\t},\n\n\t\t/**\n\t\t * Sets the opacity of an element.\n\t\t *\n\t\t *\t\tvar element = CKEDITOR.document.getById( 'myElement' );\n\t\t *\t\telement.setOpacity( 0.75 );\n\t\t *\n\t\t * @param {Number} opacity A number within the range `[0.0, 1.0]`.\n\t\t */\n\t\tsetOpacity: function( opacity ) {\n\t\t\tif ( CKEDITOR.env.ie && CKEDITOR.env.version < 9 ) {\n\t\t\t\topacity = Math.round( opacity * 100 );\n\t\t\t\tthis.setStyle( 'filter', opacity >= 100 ? '' : 'progid:DXImageTransform.Microsoft.Alpha(opacity=' + opacity + ')' );\n\t\t\t} else {\n\t\t\t\tthis.setStyle( 'opacity', opacity );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Makes the element and its children unselectable.\n\t\t *\n\t\t *\t\tvar element = CKEDITOR.document.getById( 'myElement' );\n\t\t *\t\telement.unselectable();\n\t\t *\n\t\t * @method\n\t\t */\n\t\tunselectable: function() {\n\t\t\t// CSS unselectable.\n\t\t\tthis.setStyles( CKEDITOR.tools.cssVendorPrefix( 'user-select', 'none' ) );\n\n\t\t\t// For IE/Opera which doesn't support for the above CSS style,\n\t\t\t// the unselectable=\"on\" attribute only specifies the selection\n\t\t\t// process cannot start in the element itself, and it doesn't inherit.\n\t\t\tif ( CKEDITOR.env.ie ) {\n\t\t\t\tthis.setAttribute( 'unselectable', 'on' );\n\n\t\t\t\tvar element,\n\t\t\t\t\telements = this.getElementsByTag( '*' );\n\n\t\t\t\tfor ( var i = 0, count = elements.count() ; i < count ; i++ ) {\n\t\t\t\t\telement = elements.getItem( i );\n\t\t\t\t\telement.setAttribute( 'unselectable', 'on' );\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Gets closest positioned (`position != static`) ancestor.\n\t\t *\n\t\t * @returns {CKEDITOR.dom.element} Positioned ancestor or `null`.\n\t\t */\n\t\tgetPositionedAncestor: function() {\n\t\t\tvar current = this;\n\t\t\twhile ( current.getName() != 'html' ) {\n\t\t\t\tif ( current.getComputedStyle( 'position' ) != 'static' )\n\t\t\t\t\treturn current;\n\n\t\t\t\tcurrent = current.getParent();\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\n\t\t/**\n\t\t * Gets this element's position in document.\n\t\t *\n\t\t * @param {CKEDITOR.dom.document} [refDocument]\n\t\t * @returns {Object} Element's position.\n\t\t * @returns {Number} return.x\n\t\t * @returns {Number} return.y\n\t\t * @todo refDocument\n\t\t */\n\t\tgetDocumentPosition: function( refDocument ) {\n\t\t\tvar x = 0,\n\t\t\t\ty = 0,\n\t\t\t\tdoc = this.getDocument(),\n\t\t\t\tbody = doc.getBody(),\n\t\t\t\tquirks = doc.$.compatMode == 'BackCompat';\n\n\t\t\tif ( document.documentElement.getBoundingClientRect &&\n\t\t\t\t( CKEDITOR.env.ie ? CKEDITOR.env.version !== 8 : true ) ) {\n\t\t\t\tvar box = this.$.getBoundingClientRect(),\n\t\t\t\t\t$doc = doc.$,\n\t\t\t\t\t$docElem = $doc.documentElement;\n\n\t\t\t\tvar clientTop = $docElem.clientTop || body.$.clientTop || 0,\n\t\t\t\t\tclientLeft = $docElem.clientLeft || body.$.clientLeft || 0,\n\t\t\t\t\tneedAdjustScrollAndBorders = true;\n\n\t\t\t\t// #3804: getBoundingClientRect() works differently on IE and non-IE\n\t\t\t\t// browsers, regarding scroll positions.\n\t\t\t\t//\n\t\t\t\t// On IE, the top position of the <html> element is always 0, no matter\n\t\t\t\t// how much you scrolled down.\n\t\t\t\t//\n\t\t\t\t// On other browsers, the top position of the <html> element is negative\n\t\t\t\t// scrollTop.\n\t\t\t\tif ( CKEDITOR.env.ie ) {\n\t\t\t\t\tvar inDocElem = doc.getDocumentElement().contains( this ),\n\t\t\t\t\t\tinBody = doc.getBody().contains( this );\n\n\t\t\t\t\tneedAdjustScrollAndBorders = ( quirks && inBody ) || ( !quirks && inDocElem );\n\t\t\t\t}\n\n\t\t\t\t// #12747.\n\t\t\t\tif ( needAdjustScrollAndBorders ) {\n\t\t\t\t\tvar scrollRelativeLeft,\n\t\t\t\t\t\tscrollRelativeTop;\n\n\t\t\t\t\t// See #12758 to know more about document.(documentElement|body).scroll(Left|Top) in Webkit.\n\t\t\t\t\tif ( CKEDITOR.env.webkit || ( CKEDITOR.env.ie && CKEDITOR.env.version >= 12 ) ) {\n\t\t\t\t\t\tscrollRelativeLeft = body.$.scrollLeft || $docElem.scrollLeft;\n\t\t\t\t\t\tscrollRelativeTop = body.$.scrollTop || $docElem.scrollTop;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar scrollRelativeElement = quirks ? body.$ : $docElem;\n\n\t\t\t\t\t\tscrollRelativeLeft = scrollRelativeElement.scrollLeft;\n\t\t\t\t\t\tscrollRelativeTop = scrollRelativeElement.scrollTop;\n\t\t\t\t\t}\n\n\t\t\t\t\tx = box.left + scrollRelativeLeft - clientLeft;\n\t\t\t\t\ty = box.top + scrollRelativeTop - clientTop;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar current = this,\n\t\t\t\t\tprevious = null,\n\t\t\t\t\toffsetParent;\n\t\t\t\twhile ( current && !( current.getName() == 'body' || current.getName() == 'html' ) ) {\n\t\t\t\t\tx += current.$.offsetLeft - current.$.scrollLeft;\n\t\t\t\t\ty += current.$.offsetTop - current.$.scrollTop;\n\n\t\t\t\t\t// Opera includes clientTop|Left into offsetTop|Left.\n\t\t\t\t\tif ( !current.equals( this ) ) {\n\t\t\t\t\t\tx += ( current.$.clientLeft || 0 );\n\t\t\t\t\t\ty += ( current.$.clientTop || 0 );\n\t\t\t\t\t}\n\n\t\t\t\t\tvar scrollElement = previous;\n\t\t\t\t\twhile ( scrollElement && !scrollElement.equals( current ) ) {\n\t\t\t\t\t\tx -= scrollElement.$.scrollLeft;\n\t\t\t\t\t\ty -= scrollElement.$.scrollTop;\n\t\t\t\t\t\tscrollElement = scrollElement.getParent();\n\t\t\t\t\t}\n\n\t\t\t\t\tprevious = current;\n\t\t\t\t\tcurrent = ( offsetParent = current.$.offsetParent ) ? new CKEDITOR.dom.element( offsetParent ) : null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( refDocument ) {\n\t\t\t\tvar currentWindow = this.getWindow(),\n\t\t\t\t\trefWindow = refDocument.getWindow();\n\n\t\t\t\tif ( !currentWindow.equals( refWindow ) && currentWindow.$.frameElement ) {\n\t\t\t\t\tvar iframePosition = ( new CKEDITOR.dom.element( currentWindow.$.frameElement ) ).getDocumentPosition( refDocument );\n\n\t\t\t\t\tx += iframePosition.x;\n\t\t\t\t\ty += iframePosition.y;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( !document.documentElement.getBoundingClientRect ) {\n\t\t\t\t// In Firefox, we'll endup one pixel before the element positions,\n\t\t\t\t// so we must add it here.\n\t\t\t\tif ( CKEDITOR.env.gecko && !quirks ) {\n\t\t\t\t\tx += this.$.clientLeft ? 1 : 0;\n\t\t\t\t\ty += this.$.clientTop ? 1 : 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn { x: x, y: y };\n\t\t},\n\n\t\t/**\n\t\t * Make any page element visible inside the browser viewport.\n\t\t *\n\t\t * @param {Boolean} [alignToTop=false]\n\t\t */\n\t\tscrollIntoView: function( alignToTop ) {\n\t\t\tvar parent = this.getParent();\n\t\t\tif ( !parent )\n\t\t\t\treturn;\n\n\t\t\t// Scroll the element into parent container from the inner out.\n\t\t\tdo {\n\t\t\t\t// Check ancestors that overflows.\n\t\t\t\tvar overflowed =\n\t\t\t\t\tparent.$.clientWidth && parent.$.clientWidth < parent.$.scrollWidth ||\n\t\t\t\t\tparent.$.clientHeight && parent.$.clientHeight < parent.$.scrollHeight;\n\n\t\t\t\t// Skip body element, which will report wrong clientHeight when containing\n\t\t\t\t// floated content. (#9523)\n\t\t\t\tif ( overflowed && !parent.is( 'body' ) )\n\t\t\t\t\tthis.scrollIntoParent( parent, alignToTop, 1 );\n\n\t\t\t\t// Walk across the frame.\n\t\t\t\tif ( parent.is( 'html' ) ) {\n\t\t\t\t\tvar win = parent.getWindow();\n\n\t\t\t\t\t// Avoid security error.\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar iframe = win.$.frameElement;\n\t\t\t\t\t\tiframe && ( parent = new CKEDITOR.dom.element( iframe ) );\n\t\t\t\t\t} catch ( er ) {}\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile ( ( parent = parent.getParent() ) );\n\t\t},\n\n\t\t/**\n\t\t * Make any page element visible inside one of the ancestors by scrolling the parent.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element/CKEDITOR.dom.window} parent The container to scroll into.\n\t\t * @param {Boolean} [alignToTop] Align the element's top side with the container's\n\t\t * when `true` is specified; align the bottom with viewport bottom when\n\t\t * `false` is specified. Otherwise scroll on either side with the minimum\n\t\t * amount to show the element.\n\t\t * @param {Boolean} [hscroll] Whether horizontal overflow should be considered.\n\t\t */\n\t\tscrollIntoParent: function( parent, alignToTop, hscroll ) {\n\t\t\t!parent && ( parent = this.getWindow() );\n\n\t\t\tvar doc = parent.getDocument();\n\t\t\tvar isQuirks = doc.$.compatMode == 'BackCompat';\n\n\t\t\t// On window <html> is scrolled while quirks scrolls <body>.\n\t\t\tif ( parent instanceof CKEDITOR.dom.window )\n\t\t\t\tparent = isQuirks ? doc.getBody() : doc.getDocumentElement();\n\n\t\t\t// Scroll the parent by the specified amount.\n\t\t\tfunction scrollBy( x, y ) {\n\t\t\t\t// Webkit doesn't support \"scrollTop/scrollLeft\"\n\t\t\t\t// on documentElement/body element.\n\t\t\t\tif ( /body|html/.test( parent.getName() ) )\n\t\t\t\t\tparent.getWindow().$.scrollBy( x, y );\n\t\t\t\telse {\n\t\t\t\t\tparent.$.scrollLeft += x;\n\t\t\t\t\tparent.$.scrollTop += y;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Figure out the element position relative to the specified window.\n\t\t\tfunction screenPos( element, refWin ) {\n\t\t\t\tvar pos = { x: 0, y: 0 };\n\n\t\t\t\tif ( !( element.is( isQuirks ? 'body' : 'html' ) ) ) {\n\t\t\t\t\tvar box = element.$.getBoundingClientRect();\n\t\t\t\t\tpos.x = box.left, pos.y = box.top;\n\t\t\t\t}\n\n\t\t\t\tvar win = element.getWindow();\n\t\t\t\tif ( !win.equals( refWin ) ) {\n\t\t\t\t\tvar outerPos = screenPos( CKEDITOR.dom.element.get( win.$.frameElement ), refWin );\n\t\t\t\t\tpos.x += outerPos.x, pos.y += outerPos.y;\n\t\t\t\t}\n\n\t\t\t\treturn pos;\n\t\t\t}\n\n\t\t\t// calculated margin size.\n\t\t\tfunction margin( element, side ) {\n\t\t\t\treturn parseInt( element.getComputedStyle( 'margin-' + side ) || 0, 10 ) || 0;\n\t\t\t}\n\n\t\t\tvar win = parent.getWindow();\n\n\t\t\tvar thisPos = screenPos( this, win ),\n\t\t\t\tparentPos = screenPos( parent, win ),\n\t\t\t\teh = this.$.offsetHeight,\n\t\t\t\tew = this.$.offsetWidth,\n\t\t\t\tch = parent.$.clientHeight,\n\t\t\t\tcw = parent.$.clientWidth,\n\t\t\t\tlt, br;\n\n\t\t\t// Left-top margins.\n\t\t\tlt = {\n\t\t\t\tx: thisPos.x - margin( this, 'left' ) - parentPos.x || 0,\n\t\t\t\ty: thisPos.y - margin( this, 'top' ) - parentPos.y || 0\n\t\t\t};\n\n\t\t\t// Bottom-right margins.\n\t\t\tbr = {\n\t\t\t\tx: thisPos.x + ew + margin( this, 'right' ) - ( ( parentPos.x ) + cw ) || 0,\n\t\t\t\ty: thisPos.y + eh + margin( this, 'bottom' ) - ( ( parentPos.y ) + ch ) || 0\n\t\t\t};\n\n\t\t\t// 1. Do the specified alignment as much as possible;\n\t\t\t// 2. Otherwise be smart to scroll only the minimum amount;\n\t\t\t// 3. Never cut at the top;\n\t\t\t// 4. DO NOT scroll when already visible.\n\t\t\tif ( lt.y < 0 || br.y > 0 )\n\t\t\t\tscrollBy( 0, alignToTop === true ? lt.y : alignToTop === false ? br.y : lt.y < 0 ? lt.y : br.y );\n\n\t\t\tif ( hscroll && ( lt.x < 0 || br.x > 0 ) )\n\t\t\t\tscrollBy( lt.x < 0 ? lt.x : br.x, 0 );\n\t\t},\n\n\t\t/**\n\t\t * Switch the `class` attribute to reflect one of the triple states of an\n\t\t * element in one of {@link CKEDITOR#TRISTATE_ON}, {@link CKEDITOR#TRISTATE_OFF}\n\t\t * or {@link CKEDITOR#TRISTATE_DISABLED}.\n\t\t *\n\t\t *\t\tlink.setState( CKEDITOR.TRISTATE_ON );\n\t\t *\t\t// <a class=\"cke_on\" aria-pressed=\"true\">...</a>\n\t\t *\t\tlink.setState( CKEDITOR.TRISTATE_OFF );\n\t\t *\t\t// <a class=\"cke_off\">...</a>\n\t\t *\t\tlink.setState( CKEDITOR.TRISTATE_DISABLED );\n\t\t *\t\t// <a class=\"cke_disabled\" aria-disabled=\"true\">...</a>\n\t\t *\n\t\t *\t\tspan.setState( CKEDITOR.TRISTATE_ON, 'cke_button' );\n\t\t *\t\t// <span class=\"cke_button_on\">...</span>\n\t\t *\n\t\t * @param {Number} state Indicate the element state. One of {@link CKEDITOR#TRISTATE_ON},\n\t\t * {@link CKEDITOR#TRISTATE_OFF}, {@link CKEDITOR#TRISTATE_DISABLED}.\n\t\t * @param [base='cke'] The prefix apply to each of the state class name.\n\t\t * @param [useAria=true] Whether toggle the ARIA state attributes besides of class name change.\n\t\t */\n\t\tsetState: function( state, base, useAria ) {\n\t\t\tbase = base || 'cke';\n\n\t\t\tswitch ( state ) {\n\t\t\t\tcase CKEDITOR.TRISTATE_ON:\n\t\t\t\t\tthis.addClass( base + '_on' );\n\t\t\t\t\tthis.removeClass( base + '_off' );\n\t\t\t\t\tthis.removeClass( base + '_disabled' );\n\t\t\t\t\tuseAria && this.setAttribute( 'aria-pressed', true );\n\t\t\t\t\tuseAria && this.removeAttribute( 'aria-disabled' );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase CKEDITOR.TRISTATE_DISABLED:\n\t\t\t\t\tthis.addClass( base + '_disabled' );\n\t\t\t\t\tthis.removeClass( base + '_off' );\n\t\t\t\t\tthis.removeClass( base + '_on' );\n\t\t\t\t\tuseAria && this.setAttribute( 'aria-disabled', true );\n\t\t\t\t\tuseAria && this.removeAttribute( 'aria-pressed' );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthis.addClass( base + '_off' );\n\t\t\t\t\tthis.removeClass( base + '_on' );\n\t\t\t\t\tthis.removeClass( base + '_disabled' );\n\t\t\t\t\tuseAria && this.removeAttribute( 'aria-pressed' );\n\t\t\t\t\tuseAria && this.removeAttribute( 'aria-disabled' );\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Returns the inner document of this `<iframe>` element.\n\t\t *\n\t\t * @returns {CKEDITOR.dom.document} The inner document.\n\t\t */\n\t\tgetFrameDocument: function() {\n\t\t\tvar $ = this.$;\n\n\t\t\ttry {\n\t\t\t\t// In IE, with custom document.domain, it may happen that\n\t\t\t\t// the iframe is not yet available, resulting in \"Access\n\t\t\t\t// Denied\" for the following property access.\n\t\t\t\t$.contentWindow.document;\n\t\t\t} catch ( e ) {\n\t\t\t\t// Trick to solve this issue, forcing the iframe to get ready\n\t\t\t\t// by simply setting its \"src\" property.\n\t\t\t\t$.src = $.src;\n\t\t\t}\n\n\t\t\treturn $ && new CKEDITOR.dom.document( $.contentWindow.document );\n\t\t},\n\n\t\t/**\n\t\t * Copy all the attributes from one node to the other, kinda like a clone\n\t\t * skipAttributes is an object with the attributes that must **not** be copied.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} dest The destination element.\n\t\t * @param {Object} skipAttributes A dictionary of attributes to skip.\n\t\t */\n\t\tcopyAttributes: function( dest, skipAttributes ) {\n\t\t\tvar attributes = this.$.attributes;\n\t\t\tskipAttributes = skipAttributes || {};\n\n\t\t\tfor ( var n = 0; n < attributes.length; n++ ) {\n\t\t\t\tvar attribute = attributes[ n ];\n\n\t\t\t\t// Lowercase attribute name hard rule is broken for\n\t\t\t\t// some attribute on IE, e.g. CHECKED.\n\t\t\t\tvar attrName = attribute.nodeName.toLowerCase(),\n\t\t\t\t\tattrValue;\n\n\t\t\t\t// We can set the type only once, so do it with the proper value, not copying it.\n\t\t\t\tif ( attrName in skipAttributes )\n\t\t\t\t\tcontinue;\n\n\t\t\t\tif ( attrName == 'checked' && ( attrValue = this.getAttribute( attrName ) ) )\n\t\t\t\t\tdest.setAttribute( attrName, attrValue );\n\t\t\t\t// IE contains not specified attributes in $.attributes so we need to check\n\t\t\t\t// if elements attribute is specified using hasAttribute.\n\t\t\t\telse if ( !CKEDITOR.env.ie || this.hasAttribute( attrName ) ) {\n\t\t\t\t\tattrValue = this.getAttribute( attrName );\n\t\t\t\t\tif ( attrValue === null )\n\t\t\t\t\t\tattrValue = attribute.nodeValue;\n\n\t\t\t\t\tdest.setAttribute( attrName, attrValue );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// The style:\n\t\t\tif ( this.$.style.cssText !== '' )\n\t\t\t\tdest.$.style.cssText = this.$.style.cssText;\n\t\t},\n\n\t\t/**\n\t\t * Changes the tag name of the current element.\n\t\t *\n\t\t * @param {String} newTag The new tag for the element.\n\t\t */\n\t\trenameNode: function( newTag ) {\n\t\t\t// If it's already correct exit here.\n\t\t\tif ( this.getName() == newTag )\n\t\t\t\treturn;\n\n\t\t\tvar doc = this.getDocument();\n\n\t\t\t// Create the new node.\n\t\t\tvar newNode = new CKEDITOR.dom.element( newTag, doc );\n\n\t\t\t// Copy all attributes.\n\t\t\tthis.copyAttributes( newNode );\n\n\t\t\t// Move children to the new node.\n\t\t\tthis.moveChildren( newNode );\n\n\t\t\t// Replace the node.\n\t\t\tthis.getParent( true ) && this.$.parentNode.replaceChild( newNode.$, this.$ );\n\t\t\tnewNode.$[ 'data-cke-expando' ] = this.$[ 'data-cke-expando' ];\n\t\t\tthis.$ = newNode.$;\n\t\t\t// Bust getName's cache. (#8663)\n\t\t\tdelete this.getName;\n\t\t},\n\n\t\t/**\n\t\t * Gets a DOM tree descendant under the current node.\n\t\t *\n\t\t *\t\tvar strong = p.getChild( 0 );\n\t\t *\n\t\t * @method\n\t\t * @param {Array/Number} indices The child index or array of child indices under the node.\n\t\t * @returns {CKEDITOR.dom.node} The specified DOM child under the current node. Null if child does not exist.\n\t\t */\n\t\tgetChild: ( function() {\n\t\t\tfunction getChild( rawNode, index ) {\n\t\t\t\tvar childNodes = rawNode.childNodes;\n\n\t\t\t\tif ( index >= 0 && index < childNodes.length )\n\t\t\t\t\treturn childNodes[ index ];\n\t\t\t}\n\n\t\t\treturn function( indices ) {\n\t\t\t\tvar rawNode = this.$;\n\n\t\t\t\tif ( !indices.slice )\n\t\t\t\t\trawNode = getChild( rawNode, indices );\n\t\t\t\telse {\n\t\t\t\t\tindices = indices.slice();\n\t\t\t\t\twhile ( indices.length > 0 && rawNode )\n\t\t\t\t\t\trawNode = getChild( rawNode, indices.shift() );\n\t\t\t\t}\n\n\t\t\t\treturn rawNode ? new CKEDITOR.dom.node( rawNode ) : null;\n\t\t\t};\n\t\t} )(),\n\n\t\t/**\n\t\t * Gets number of element's children.\n\t\t *\n\t\t * @returns {Number}\n\t\t */\n\t\tgetChildCount: function() {\n\t\t\treturn this.$.childNodes.length;\n\t\t},\n\n\t\t/**\n\t\t * Disables browser's context menu in this element.\n\t\t */\n\t\tdisableContextMenu: function() {\n\t\t\tthis.on( 'contextmenu', function( evt ) {\n\t\t\t\t// Cancel the browser context menu.\n\t\t\t\tif ( !evt.data.getTarget().getAscendant( enablesContextMenu, true ) )\n\t\t\t\t\tevt.data.preventDefault();\n\t\t\t} );\n\n\t\t\tfunction enablesContextMenu( node ) {\n\t\t\t\treturn node.type == CKEDITOR.NODE_ELEMENT && node.hasClass( 'cke_enable_context_menu' );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Gets element's direction. Supports both CSS `direction` prop and `dir` attr.\n\t\t */\n\t\tgetDirection: function( useComputed ) {\n\t\t\tif ( useComputed ) {\n\t\t\t\treturn this.getComputedStyle( 'direction' ) ||\n\t\t\t\t\t\tthis.getDirection() ||\n\t\t\t\t\t\tthis.getParent() && this.getParent().getDirection( 1 ) ||\n\t\t\t\t\t\tthis.getDocument().$.dir ||\n\t\t\t\t\t\t'ltr';\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn this.getStyle( 'direction' ) || this.getAttribute( 'dir' );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Gets, sets and removes custom data to be stored as HTML5 data-* attributes.\n\t\t *\n\t\t *\t\telement.data( 'extra-info', 'test' );\t// Appended the attribute data-extra-info=\"test\" to the element.\n\t\t *\t\talert( element.data( 'extra-info' ) );\t// 'test'\n\t\t *\t\telement.data( 'extra-info', false );\t// Remove the data-extra-info attribute from the element.\n\t\t *\n\t\t * @param {String} name The name of the attribute, excluding the `data-` part.\n\t\t * @param {String} [value] The value to set. If set to false, the attribute will be removed.\n\t\t */\n\t\tdata: function( name, value ) {\n\t\t\tname = 'data-' + name;\n\t\t\tif ( value === undefined )\n\t\t\t\treturn this.getAttribute( name );\n\t\t\telse if ( value === false )\n\t\t\t\tthis.removeAttribute( name );\n\t\t\telse\n\t\t\t\tthis.setAttribute( name, value );\n\n\t\t\treturn null;\n\t\t},\n\n\t\t/**\n\t\t * Retrieves an editor instance which is based on this element (if any).\n\t\t * It basically loops over {@link CKEDITOR#instances} in search for an instance\n\t\t * that uses the element.\n\t\t *\n\t\t *\t\tvar element = new CKEDITOR.dom.element( 'div' );\n\t\t *\t\telement.appendTo( CKEDITOR.document.getBody() );\n\t\t *\t\tCKEDITOR.replace( element );\n\t\t *\t\talert( element.getEditor().name ); // 'editor1'\n\t\t *\n\t\t * @returns {CKEDITOR.editor} An editor instance or null if nothing has been found.\n\t\t */\n\t\tgetEditor: function() {\n\t\t\tvar instances = CKEDITOR.instances,\n\t\t\t\tname, instance;\n\n\t\t\tfor ( name in instances ) {\n\t\t\t\tinstance = instances[ name ];\n\n\t\t\t\tif ( instance.element.equals( this ) && instance.elementMode != CKEDITOR.ELEMENT_MODE_APPENDTO )\n\t\t\t\t\treturn instance;\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\n\t\t/**\n\t\t * Returns list of elements within this element that match specified `selector`.\n\t\t *\n\t\t * **Notes:**\n\t\t *\n\t\t *\t* Not available in IE7.\n\t\t *\t* Returned list is not a live collection (like a result of native `querySelectorAll`).\n\t\t *\t* Unlike native `querySelectorAll` this method ensures selector contextualization. This is:\n\t\t *\n\t\t *\t\t\tHTML:\t\t'<body><div><i>foo</i></div></body>'\n\t\t *\t\t\tNative:\t\tdiv.querySelectorAll( 'body i' ) // ->\t\t[ <i>foo</i> ]\n\t\t *\t\t\tMethod:\t\tdiv.find( 'body i' ) // ->\t\t\t\t\t[]\n\t\t *\t\t\t\t\t\tdiv.find( 'i' ) // ->\t\t\t\t\t\t[ <i>foo</i> ]\n\t\t *\n\t\t * @since 4.3\n\t\t * @param {String} selector\n\t\t * @returns {CKEDITOR.dom.nodeList}\n\t\t */\n\t\tfind: function( selector ) {\n\t\t\tvar removeTmpId = createTmpId( this ),\n\t\t\t\tlist = new CKEDITOR.dom.nodeList(\n\t\t\t\t\tthis.$.querySelectorAll( getContextualizedSelector( this, selector ) )\n\t\t\t\t);\n\n\t\t\tremoveTmpId();\n\n\t\t\treturn list;\n\t\t},\n\n\t\t/**\n\t\t * Returns first element within this element that matches specified `selector`.\n\t\t *\n\t\t * **Notes:**\n\t\t *\n\t\t *\t* Not available in IE7.\n\t\t *\t* Unlike native `querySelectorAll` this method ensures selector contextualization. This is:\n\t\t *\n\t\t *\t\t\tHTML:\t\t'<body><div><i>foo</i></div></body>'\n\t\t *\t\t\tNative:\t\tdiv.querySelector( 'body i' ) // ->\t\t\t<i>foo</i>\n\t\t *\t\t\tMethod:\t\tdiv.findOne( 'body i' ) // ->\t\t\t\tnull\n\t\t *\t\t\t\t\t\tdiv.findOne( 'i' ) // ->\t\t\t\t\t<i>foo</i>\n\t\t *\n\t\t * @since 4.3\n\t\t * @param {String} selector\n\t\t * @returns {CKEDITOR.dom.element}\n\t\t */\n\t\tfindOne: function( selector ) {\n\t\t\tvar removeTmpId = createTmpId( this ),\n\t\t\t\tfound = this.$.querySelector( getContextualizedSelector( this, selector ) );\n\n\t\t\tremoveTmpId();\n\n\t\t\treturn found ? new CKEDITOR.dom.element( found ) : null;\n\t\t},\n\n\t\t/**\n\t\t * Traverse the DOM of this element (inclusive), executing a callback for\n\t\t * each node.\n\t\t *\n\t\t *\t\tvar element = CKEDITOR.dom.element.createFromHtml( '<div><p>foo<b>bar</b>bom</p></div>' );\n\t\t *\t\telement.forEach( function( node ) {\n\t\t *\t\t\tconsole.log( node );\n\t\t *\t\t} );\n\t\t *\t\t// Will log:\n\t\t *\t\t// 1. <div> element,\n\t\t *\t\t// 2. <p> element,\n\t\t *\t\t// 3. \"foo\" text node,\n\t\t *\t\t// 4. <b> element,\n\t\t *\t\t// 5. \"bar\" text node,\n\t\t *\t\t// 6. \"bom\" text node.\n\t\t *\n\t\t * @since 4.3\n\t\t * @param {Function} callback Function to be executed on every node.\n\t\t * If `callback` returns `false` descendants of the node will be ignored.\n\t\t * @param {CKEDITOR.htmlParser.node} callback.node Node passed as argument.\n\t\t * @param {Number} [type] If specified `callback` will be executed only on\n\t\t * nodes of this type.\n\t\t * @param {Boolean} [skipRoot] Don't execute `callback` on this element.\n\t\t */\n\t\tforEach: function( callback, type, skipRoot ) {\n\t\t\tif ( !skipRoot && ( !type || this.type == type ) )\n\t\t\t\t\tvar ret = callback( this );\n\n\t\t\t// Do not filter children if callback returned false.\n\t\t\tif ( ret === false )\n\t\t\t\treturn;\n\n\t\t\tvar children = this.getChildren(),\n\t\t\t\tnode,\n\t\t\t\ti = 0;\n\n\t\t\t// We do not cache the size, because the live list of nodes may be changed by the callback.\n\t\t\tfor ( ; i < children.count(); i++ ) {\n\t\t\t\tnode = children.getItem( i );\n\t\t\t\tif ( node.type == CKEDITOR.NODE_ELEMENT )\n\t\t\t\t\tnode.forEach( callback, type );\n\t\t\t\telse if ( !type || node.type == type )\n\t\t\t\t\tcallback( node );\n\t\t\t}\n\t\t}\n\t} );\n\n\tfunction createTmpId( element ) {\n\t\tvar hadId = true;\n\n\t\tif ( !element.$.id ) {\n\t\t\telement.$.id = 'cke_tmp_' + CKEDITOR.tools.getNextNumber();\n\t\t\thadId = false;\n\t\t}\n\n\t\treturn function() {\n\t\t\tif ( !hadId )\n\t\t\t\telement.removeAttribute( 'id' );\n\t\t};\n\t}\n\n\tfunction getContextualizedSelector( element, selector ) {\n\t\tvar id = CKEDITOR.tools.escapeCss( element.$.id );\n\t\treturn '#' + id + ' ' + selector.split( /,\\s*/ ).join( ', #' + id + ' ' );\n\t}\n\n\tvar sides = {\n\t\twidth: [ 'border-left-width', 'border-right-width', 'padding-left', 'padding-right' ],\n\t\theight: [ 'border-top-width', 'border-bottom-width', 'padding-top', 'padding-bottom' ]\n\t};\n\n\t// Generate list of specific style rules, applicable to margin/padding/border.\n\tfunction expandedRules( style ) {\n\t\tvar sides = [ 'top', 'left', 'right', 'bottom' ], components;\n\n\t\tif ( style == 'border' )\n\t\t\t\tcomponents = [ 'color', 'style', 'width' ];\n\n\t\tvar styles = [];\n\t\tfor ( var i = 0 ; i < sides.length ; i++ ) {\n\n\t\t\tif ( components ) {\n\t\t\t\tfor ( var j = 0 ; j < components.length ; j++ )\n\t\t\t\t\tstyles.push( [ style, sides[ i ], components[ j ] ].join( '-' ) );\n\t\t\t} else {\n\t\t\t\tstyles.push( [ style, sides[ i ] ].join( '-' ) );\n\t\t\t}\n\t\t}\n\n\t\treturn styles;\n\t}\n\n\tfunction marginAndPaddingSize( type ) {\n\t\tvar adjustment = 0;\n\t\tfor ( var i = 0, len = sides[ type ].length; i < len; i++ )\n\t\t\tadjustment += parseInt( this.getComputedStyle( sides[ type ][ i ] ) || 0, 10 ) || 0;\n\t\treturn adjustment;\n\t}\n\n\t/**\n\t * Sets the element size considering the box model.\n\t *\n\t * @param {'width'/'height'} type The dimension to set.\n\t * @param {Number} size The length unit in px.\n\t * @param {Boolean} isBorderBox Apply the size based on the border box model.\n\t */\n\tCKEDITOR.dom.element.prototype.setSize = function( type, size, isBorderBox ) {\n\t\tif ( typeof size == 'number' ) {\n\t\t\tif ( isBorderBox && !( CKEDITOR.env.ie && CKEDITOR.env.quirks ) )\n\t\t\t\tsize -= marginAndPaddingSize.call( this, type );\n\n\t\t\tthis.setStyle( type, size + 'px' );\n\t\t}\n\t};\n\n\t/**\n\t * Gets the element size, possibly considering the box model.\n\t *\n\t * @param {'width'/'height'} type The dimension to get.\n\t * @param {Boolean} isBorderBox Get the size based on the border box model.\n\t */\n\tCKEDITOR.dom.element.prototype.getSize = function( type, isBorderBox ) {\n\t\tvar size = Math.max( this.$[ 'offset' + CKEDITOR.tools.capitalize( type ) ], this.$[ 'client' + CKEDITOR.tools.capitalize( type ) ] ) || 0;\n\n\t\tif ( isBorderBox )\n\t\t\tsize -= marginAndPaddingSize.call( this, type );\n\n\t\treturn size;\n\t};\n} )();\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/dom/element.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * DocumentFragment is a \"lightweight\" or \"minimal\" Document object. It is\n * commonly used to extract a portion of a document's tree or to create a new\n * fragment of a document. Various operations may take document fragment objects\n * as arguments and result in all the child nodes of the document fragment being\n * moved to the child list of this node.\n *\n * @class\n * @constructor Creates a document fragment class instance.\n * @param {CKEDITOR.dom.document/DocumentFragment} [nodeOrDoc=CKEDITOR.document]\n */\nCKEDITOR.dom.documentFragment = function( nodeOrDoc ) {\n\tnodeOrDoc = nodeOrDoc || CKEDITOR.document;\n\n\tif ( nodeOrDoc.type == CKEDITOR.NODE_DOCUMENT )\n\t\tthis.$ = nodeOrDoc.$.createDocumentFragment();\n\telse\n\t\tthis.$ = nodeOrDoc;\n};\n\nCKEDITOR.tools.extend( CKEDITOR.dom.documentFragment.prototype, CKEDITOR.dom.element.prototype, {\n\t/**\n\t * The node type. This is a constant value set to {@link CKEDITOR#NODE_DOCUMENT_FRAGMENT}.\n\t *\n\t * @readonly\n\t * @property {Number} [=CKEDITOR.NODE_DOCUMENT_FRAGMENT]\n\t */\n\ttype: CKEDITOR.NODE_DOCUMENT_FRAGMENT,\n\n\t/**\n\t * Inserts the document fragment content after the specified node.\n\t *\n\t * @param {CKEDITOR.dom.node} node\n\t */\n\tinsertAfterNode: function( node ) {\n\t\tnode = node.$;\n\t\tnode.parentNode.insertBefore( this.$, node.nextSibling );\n\t},\n\n\t/**\n\t * Gets HTML of this document fragment's children.\n\t *\n\t * @since 4.5\n\t * @returns {String} The HTML of this document fragment's children.\n\t */\n\tgetHtml: function() {\n\t\tvar container = new CKEDITOR.dom.element( 'div' );\n\n\t\tthis.clone( 1, 1 ).appendTo( container );\n\n\t\treturn container.getHtml().replace( /\\s*data-cke-expando=\".*?\"/g, '' );\n\t}\n}, true, {\n\t'append': 1, 'appendBogus': 1, 'clone': 1, 'getFirst': 1, 'getHtml': 1, 'getLast': 1, 'getParent': 1, 'getNext': 1, 'getPrevious': 1,\n\t'appendTo': 1, 'moveChildren': 1, 'insertBefore': 1, 'insertAfterNode': 1, 'replace': 1, 'trim': 1, 'type': 1,\n\t'ltrim': 1, 'rtrim': 1, 'getDocument': 1, 'getChildCount': 1, 'getChild': 1, 'getChildren': 1\n} );\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/dom/documentfragment.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n( function() {\n\t// This function is to be called under a \"walker\" instance scope.\n\tfunction iterate( rtl, breakOnFalse ) {\n\t\tvar range = this.range;\n\n\t\t// Return null if we have reached the end.\n\t\tif ( this._.end )\n\t\t\treturn null;\n\n\t\t// This is the first call. Initialize it.\n\t\tif ( !this._.start ) {\n\t\t\tthis._.start = 1;\n\n\t\t\t// A collapsed range must return null at first call.\n\t\t\tif ( range.collapsed ) {\n\t\t\t\tthis.end();\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\t// Move outside of text node edges.\n\t\t\trange.optimize();\n\t\t}\n\n\t\tvar node,\n\t\t\tstartCt = range.startContainer,\n\t\t\tendCt = range.endContainer,\n\t\t\tstartOffset = range.startOffset,\n\t\t\tendOffset = range.endOffset,\n\t\t\tguard,\n\t\t\tuserGuard = this.guard,\n\t\t\ttype = this.type,\n\t\t\tgetSourceNodeFn = ( rtl ? 'getPreviousSourceNode' : 'getNextSourceNode' );\n\n\t\t// Create the LTR guard function, if necessary.\n\t\tif ( !rtl && !this._.guardLTR ) {\n\t\t\t// The node that stops walker from moving up.\n\t\t\tvar limitLTR = endCt.type == CKEDITOR.NODE_ELEMENT ? endCt : endCt.getParent();\n\n\t\t\t// The node that stops the walker from going to next.\n\t\t\tvar blockerLTR = endCt.type == CKEDITOR.NODE_ELEMENT ? endCt.getChild( endOffset ) : endCt.getNext();\n\n\t\t\tthis._.guardLTR = function( node, movingOut ) {\n\t\t\t\treturn ( ( !movingOut || !limitLTR.equals( node ) ) && ( !blockerLTR || !node.equals( blockerLTR ) ) && ( node.type != CKEDITOR.NODE_ELEMENT || !movingOut || !node.equals( range.root ) ) );\n\t\t\t};\n\t\t}\n\n\t\t// Create the RTL guard function, if necessary.\n\t\tif ( rtl && !this._.guardRTL ) {\n\t\t\t// The node that stops walker from moving up.\n\t\t\tvar limitRTL = startCt.type == CKEDITOR.NODE_ELEMENT ? startCt : startCt.getParent();\n\n\t\t\t// The node that stops the walker from going to next.\n\t\t\tvar blockerRTL = startCt.type == CKEDITOR.NODE_ELEMENT ? startOffset ? startCt.getChild( startOffset - 1 ) : null : startCt.getPrevious();\n\n\t\t\tthis._.guardRTL = function( node, movingOut ) {\n\t\t\t\treturn ( ( !movingOut || !limitRTL.equals( node ) ) && ( !blockerRTL || !node.equals( blockerRTL ) ) && ( node.type != CKEDITOR.NODE_ELEMENT || !movingOut || !node.equals( range.root ) ) );\n\t\t\t};\n\t\t}\n\n\t\t// Define which guard function to use.\n\t\tvar stopGuard = rtl ? this._.guardRTL : this._.guardLTR;\n\n\t\t// Make the user defined guard function participate in the process,\n\t\t// otherwise simply use the boundary guard.\n\t\tif ( userGuard ) {\n\t\t\tguard = function( node, movingOut ) {\n\t\t\t\tif ( stopGuard( node, movingOut ) === false )\n\t\t\t\t\treturn false;\n\n\t\t\t\treturn userGuard( node, movingOut );\n\t\t\t};\n\t\t} else {\n\t\t\tguard = stopGuard;\n\t\t}\n\n\t\tif ( this.current )\n\t\t\tnode = this.current[ getSourceNodeFn ]( false, type, guard );\n\t\telse {\n\t\t\t// Get the first node to be returned.\n\t\t\tif ( rtl ) {\n\t\t\t\tnode = endCt;\n\n\t\t\t\tif ( node.type == CKEDITOR.NODE_ELEMENT ) {\n\t\t\t\t\tif ( endOffset > 0 )\n\t\t\t\t\t\tnode = node.getChild( endOffset - 1 );\n\t\t\t\t\telse\n\t\t\t\t\t\tnode = ( guard( node, true ) === false ) ? null : node.getPreviousSourceNode( true, type, guard );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnode = startCt;\n\n\t\t\t\tif ( node.type == CKEDITOR.NODE_ELEMENT ) {\n\t\t\t\t\tif ( !( node = node.getChild( startOffset ) ) )\n\t\t\t\t\t\tnode = ( guard( startCt, true ) === false ) ? null : startCt.getNextSourceNode( true, type, guard );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( node && guard( node ) === false )\n\t\t\t\tnode = null;\n\t\t}\n\n\t\twhile ( node && !this._.end ) {\n\t\t\tthis.current = node;\n\n\t\t\tif ( !this.evaluator || this.evaluator( node ) !== false ) {\n\t\t\t\tif ( !breakOnFalse )\n\t\t\t\t\treturn node;\n\t\t\t} else if ( breakOnFalse && this.evaluator ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tnode = node[ getSourceNodeFn ]( false, type, guard );\n\t\t}\n\n\t\tthis.end();\n\t\treturn this.current = null;\n\t}\n\n\tfunction iterateToLast( rtl ) {\n\t\tvar node,\n\t\t\tlast = null;\n\n\t\twhile ( ( node = iterate.call( this, rtl ) ) )\n\t\t\tlast = node;\n\n\t\treturn last;\n\t}\n\n\t/**\n\t * Utility class to \"walk\" the DOM inside range boundaries. If the\n\t * range starts or ends in the middle of the text node, this node will\n\t * be included as a whole. Outside changes to the range may break the walker.\n\t *\n\t * The walker may return nodes that are not totally included in the\n\t * range boundaries. Let us take the following range representation,\n\t * where the square brackets indicate the boundaries:\n\t *\n\t *\t\t[<p>Some <b>sample] text</b>\n\t *\n\t * While walking forward into the above range, the following nodes are\n\t * returned: `<p>`, `\"Some \"`, `<b>` and `\"sample\"`. Going\n\t * backwards instead we have: `\"sample\"` and `\"Some \"`. So note that the\n\t * walker always returns nodes when \"entering\" them, but not when\n\t * \"leaving\" them. The {@link #guard} function is instead called both when\n\t * entering and when leaving nodes.\n\t *\n\t * @class\n\t */\n\tCKEDITOR.dom.walker = CKEDITOR.tools.createClass( {\n\t\t/**\n\t\t * Creates a walker class instance.\n\t\t *\n\t\t * @constructor\n\t\t * @param {CKEDITOR.dom.range} range The range within which to walk.\n\t\t */\n\t\t$: function( range ) {\n\t\t\tthis.range = range;\n\n\t\t\t/**\n\t\t\t * A function executed for every matched node to check whether\n\t\t\t * it is to be considered in the walk or not. If not provided, all\n\t\t\t * matched nodes are considered good.\n\t\t\t *\n\t\t\t * If the function returns `false`, the node is ignored.\n\t\t\t *\n\t\t\t * @property {Function} evaluator\n\t\t\t */\n\t\t\t// this.evaluator = null;\n\n\t\t\t/**\n\t\t\t * A function executed for every node the walk passes by to check\n\t\t\t * whether the walk is to be finished. It is called both when\n\t\t\t * entering and when exiting nodes, as well as for the matched nodes.\n\t\t\t *\n\t\t\t * If this function returns `false`, the walking ends and no more\n\t\t\t * nodes are evaluated.\n\n\t\t\t * @property {Function} guard\n\t\t\t */\n\t\t\t// this.guard = null;\n\n\t\t\t/** @private */\n\t\t\tthis._ = {};\n\t\t},\n\n\t\t//\t\tstatics :\n\t\t//\t\t{\n\t\t//\t\t\t/* Creates a CKEDITOR.dom.walker instance to walk inside DOM boundaries set by nodes.\n\t\t//\t\t\t * @param {CKEDITOR.dom.node} startNode The node from which the walk\n\t\t//\t\t\t *\t\twill start.\n\t\t//\t\t\t * @param {CKEDITOR.dom.node} [endNode] The last node to be considered\n\t\t//\t\t\t *\t\tin the walk. No more nodes are retrieved after touching or\n\t\t//\t\t\t *\t\tpassing it. If not provided, the walker stops at the\n\t\t//\t\t\t *\t\t&lt;body&gt; closing boundary.\n\t\t//\t\t\t * @returns {CKEDITOR.dom.walker} A DOM walker for the nodes between the\n\t\t//\t\t\t *\t\tprovided nodes.\n\t\t//\t\t\t */\n\t\t//\t\t\tcreateOnNodes : function( startNode, endNode, startInclusive, endInclusive )\n\t\t//\t\t\t{\n\t\t//\t\t\t\tvar range = new CKEDITOR.dom.range();\n\t\t//\t\t\t\tif ( startNode )\n\t\t//\t\t\t\t\trange.setStartAt( startNode, startInclusive ? CKEDITOR.POSITION_BEFORE_START : CKEDITOR.POSITION_AFTER_END ) ;\n\t\t//\t\t\t\telse\n\t\t//\t\t\t\t\trange.setStartAt( startNode.getDocument().getBody(), CKEDITOR.POSITION_AFTER_START ) ;\n\t\t//\n\t\t//\t\t\t\tif ( endNode )\n\t\t//\t\t\t\t\trange.setEndAt( endNode, endInclusive ? CKEDITOR.POSITION_AFTER_END : CKEDITOR.POSITION_BEFORE_START ) ;\n\t\t//\t\t\t\telse\n\t\t//\t\t\t\t\trange.setEndAt( startNode.getDocument().getBody(), CKEDITOR.POSITION_BEFORE_END ) ;\n\t\t//\n\t\t//\t\t\t\treturn new CKEDITOR.dom.walker( range );\n\t\t//\t\t\t}\n\t\t//\t\t},\n\t\t//\n\t\tproto: {\n\t\t\t/**\n\t\t\t * Stops walking. No more nodes are retrieved if this function is called.\n\t\t\t */\n\t\t\tend: function() {\n\t\t\t\tthis._.end = 1;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Retrieves the next node (on the right).\n\t\t\t *\n\t\t\t * @returns {CKEDITOR.dom.node} The next node or `null` if no more\n\t\t\t * nodes are available.\n\t\t\t */\n\t\t\tnext: function() {\n\t\t\t\treturn iterate.call( this );\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Retrieves the previous node (on the left).\n\t\t\t *\n\t\t\t * @returns {CKEDITOR.dom.node} The previous node or `null` if no more\n\t\t\t * nodes are available.\n\t\t\t */\n\t\t\tprevious: function() {\n\t\t\t\treturn iterate.call( this, 1 );\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Checks all nodes on the right, executing the evaluation function.\n\t\t\t *\n\t\t\t * @returns {Boolean} `false` if the evaluator function returned\n\t\t\t * `false` for any of the matched nodes. Otherwise `true`.\n\t\t\t */\n\t\t\tcheckForward: function() {\n\t\t\t\treturn iterate.call( this, 0, 1 ) !== false;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Check all nodes on the left, executing the evaluation function.\n\t\t\t *\n\t\t\t * @returns {Boolean} `false` if the evaluator function returned\n\t\t\t * `false` for any of the matched nodes. Otherwise `true`.\n\t\t\t */\n\t\t\tcheckBackward: function() {\n\t\t\t\treturn iterate.call( this, 1, 1 ) !== false;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Executes a full walk forward (to the right), until no more nodes\n\t\t\t * are available, returning the last valid node.\n\t\t\t *\n\t\t\t * @returns {CKEDITOR.dom.node} The last node on the right or `null`\n\t\t\t * if no valid nodes are available.\n\t\t\t */\n\t\t\tlastForward: function() {\n\t\t\t\treturn iterateToLast.call( this );\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Executes a full walk backwards (to the left), until no more nodes\n\t\t\t * are available, returning the last valid node.\n\t\t\t *\n\t\t\t * @returns {CKEDITOR.dom.node} The last node on the left or `null`\n\t\t\t * if no valid nodes are available.\n\t\t\t */\n\t\t\tlastBackward: function() {\n\t\t\t\treturn iterateToLast.call( this, 1 );\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Resets the walker.\n\t\t\t */\n\t\t\treset: function() {\n\t\t\t\tdelete this.current;\n\t\t\t\tthis._ = {};\n\t\t\t}\n\n\t\t}\n\t} );\n\n\t// Anything whose display computed style is block, list-item, table,\n\t// table-row-group, table-header-group, table-footer-group, table-row,\n\t// table-column-group, table-column, table-cell, table-caption, or whose node\n\t// name is hr, br (when enterMode is br only) is a block boundary.\n\tvar blockBoundaryDisplayMatch = {\n\t\t\tblock: 1, 'list-item': 1, table: 1, 'table-row-group': 1,\n\t\t\t'table-header-group': 1, 'table-footer-group': 1, 'table-row': 1, 'table-column-group': 1,\n\t\t\t'table-column': 1, 'table-cell': 1, 'table-caption': 1\n\t\t},\n\t\toutOfFlowPositions = { absolute: 1, fixed: 1 };\n\n\t/**\n\t * Checks whether an element is displayed as a block.\n\t *\n\t * @member CKEDITOR.dom.element\n\t * @param [customNodeNames] Custom list of nodes which will extend\n\t * the default {@link CKEDITOR.dtd#$block} list.\n\t * @returns {Boolean}\n\t */\n\tCKEDITOR.dom.element.prototype.isBlockBoundary = function( customNodeNames ) {\n\t\t// Whether element is in normal page flow. Floated or positioned elements are out of page flow.\n\t\t// Don't consider floated or positioned formatting as block boundary, fall back to dtd check in that case. (#6297)\n\t\tvar inPageFlow = this.getComputedStyle( 'float' ) == 'none' && !( this.getComputedStyle( 'position' ) in outOfFlowPositions );\n\n\t\tif ( inPageFlow && blockBoundaryDisplayMatch[ this.getComputedStyle( 'display' ) ] )\n\t\t\treturn true;\n\n\t\t// Either in $block or in customNodeNames if defined.\n\t\treturn !!( this.is( CKEDITOR.dtd.$block ) || customNodeNames && this.is( customNodeNames ) );\n\t};\n\n\t/**\n\t * Returns a function which checks whether the node is a block boundary.\n\t * See {@link CKEDITOR.dom.element#isBlockBoundary}.\n\t *\n\t * @static\n\t * @param customNodeNames\n\t * @returns {Function}\n\t */\n\tCKEDITOR.dom.walker.blockBoundary = function( customNodeNames ) {\n\t\treturn function( node ) {\n\t\t\treturn !( node.type == CKEDITOR.NODE_ELEMENT && node.isBlockBoundary( customNodeNames ) );\n\t\t};\n\t};\n\n\t/**\n\t * @static\n\t * @todo\n\t */\n\tCKEDITOR.dom.walker.listItemBoundary = function() {\n\t\treturn this.blockBoundary( { br: 1 } );\n\t};\n\n\t/**\n\t * Returns a function which checks whether the node is a bookmark node or the bookmark node\n\t * inner content.\n\t *\n\t * @static\n\t * @param {Boolean} [contentOnly=false] Whether only test against the text content of\n\t * a bookmark node instead of the element itself (default).\n\t * @param {Boolean} [isReject=false] Whether to return `false` for the bookmark\n\t * node instead of `true` (default).\n\t * @returns {Function}\n\t */\n\tCKEDITOR.dom.walker.bookmark = function( contentOnly, isReject ) {\n\t\tfunction isBookmarkNode( node ) {\n\t\t\treturn ( node && node.getName && node.getName() == 'span' && node.data( 'cke-bookmark' ) );\n\t\t}\n\n\t\treturn function( node ) {\n\t\t\tvar isBookmark, parent;\n\t\t\t// Is bookmark inner text node?\n\t\t\tisBookmark = ( node && node.type != CKEDITOR.NODE_ELEMENT && ( parent = node.getParent() ) && isBookmarkNode( parent ) );\n\t\t\t// Is bookmark node?\n\t\t\tisBookmark = contentOnly ? isBookmark : isBookmark || isBookmarkNode( node );\n\t\t\treturn !!( isReject ^ isBookmark );\n\t\t};\n\t};\n\n\t/**\n\t * Returns a function which checks whether the node is a text node containing only whitespace characters.\n\t *\n\t * @static\n\t * @param {Boolean} [isReject=false]\n\t * @returns {Function}\n\t */\n\tCKEDITOR.dom.walker.whitespaces = function( isReject ) {\n\t\treturn function( node ) {\n\t\t\tvar isWhitespace;\n\t\t\tif ( node && node.type == CKEDITOR.NODE_TEXT ) {\n\t\t\t\t// Whitespace, as well as the Filling Char Sequence text node used in Webkit. (#9384, #13816)\n\t\t\t\tisWhitespace = !CKEDITOR.tools.trim( node.getText() ) ||\n\t\t\t\t\tCKEDITOR.env.webkit && node.getText() == CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE;\n\t\t\t}\n\n\t\t\treturn !!( isReject ^ isWhitespace );\n\t\t};\n\t};\n\n\t/**\n\t * Returns a function which checks whether the node is invisible in the WYSIWYG mode.\n\t *\n\t * @static\n\t * @param {Boolean} [isReject=false]\n\t * @returns {Function}\n\t */\n\tCKEDITOR.dom.walker.invisible = function( isReject ) {\n\t\tvar whitespace = CKEDITOR.dom.walker.whitespaces(),\n\t\t\t// #12221 (Chrome) plus #11111 (Safari).\n\t\t\toffsetWidth0 = CKEDITOR.env.webkit ? 1 : 0;\n\n\t\treturn function( node ) {\n\t\t\tvar invisible;\n\n\t\t\tif ( whitespace( node ) )\n\t\t\t\tinvisible = 1;\n\t\t\telse {\n\t\t\t\t// Visibility should be checked on element.\n\t\t\t\tif ( node.type == CKEDITOR.NODE_TEXT )\n\t\t\t\t\tnode = node.getParent();\n\n\t\t\t\t// Nodes that take no spaces in wysiwyg:\n\t\t\t\t// 1. White-spaces but not including NBSP.\n\t\t\t\t// 2. Empty inline elements, e.g. <b></b>.\n\t\t\t\t// 3. <br> elements (bogus, surrounded by text) (#12423).\n\t\t\t\tinvisible = node.$.offsetWidth <= offsetWidth0;\n\t\t\t}\n\n\t\t\treturn !!( isReject ^ invisible );\n\t\t};\n\t};\n\n\t/**\n\t * Returns a function which checks whether the node type is equal to the passed one.\n\t *\n\t * @static\n\t * @param {Number} type\n\t * @param {Boolean} [isReject=false]\n\t * @returns {Function}\n\t */\n\tCKEDITOR.dom.walker.nodeType = function( type, isReject ) {\n\t\treturn function( node ) {\n\t\t\treturn !!( isReject ^ ( node.type == type ) );\n\t\t};\n\t};\n\n\t/**\n\t * Returns a function which checks whether the node is a bogus (filler) node from\n\t * `contenteditable` element's point of view.\n\t *\n\t * @static\n\t * @param {Boolean} [isReject=false]\n\t * @returns {Function}\n\t */\n\tCKEDITOR.dom.walker.bogus = function( isReject ) {\n\t\tfunction nonEmpty( node ) {\n\t\t\treturn !isWhitespaces( node ) && !isBookmark( node );\n\t\t}\n\n\t\treturn function( node ) {\n\t\t\tvar isBogus = CKEDITOR.env.needsBrFiller ? node.is && node.is( 'br' ) : node.getText && tailNbspRegex.test( node.getText() );\n\n\t\t\tif ( isBogus ) {\n\t\t\t\tvar parent = node.getParent(),\n\t\t\t\t\tnext = node.getNext( nonEmpty );\n\n\t\t\t\tisBogus = parent.isBlockBoundary() && ( !next || next.type == CKEDITOR.NODE_ELEMENT && next.isBlockBoundary() );\n\t\t\t}\n\n\t\t\treturn !!( isReject ^ isBogus );\n\t\t};\n\t};\n\n\t/**\n\t * Returns a function which checks whether the node is a temporary element\n\t * (element with the `data-cke-temp` attribute) or its child.\n\t *\n\t * @since 4.3\n\t * @static\n\t * @param {Boolean} [isReject=false] Whether to return `false` for the\n\t * temporary element instead of `true` (default).\n\t * @returns {Function}\n\t */\n\tCKEDITOR.dom.walker.temp = function( isReject ) {\n\t\treturn function( node ) {\n\t\t\tif ( node.type != CKEDITOR.NODE_ELEMENT )\n\t\t\t\tnode = node.getParent();\n\n\t\t\tvar isTemp = node && node.hasAttribute( 'data-cke-temp' );\n\n\t\t\treturn !!( isReject ^ isTemp );\n\t\t};\n\t};\n\n\tvar tailNbspRegex = /^[\\t\\r\\n ]*(?:&nbsp;|\\xa0)$/,\n\t\tisWhitespaces = CKEDITOR.dom.walker.whitespaces(),\n\t\tisBookmark = CKEDITOR.dom.walker.bookmark(),\n\t\tisTemp = CKEDITOR.dom.walker.temp(),\n\t\ttoSkip = function( node ) {\n\t\t\treturn isBookmark( node ) ||\n\t\t\t\tisWhitespaces( node ) ||\n\t\t\t\tnode.type == CKEDITOR.NODE_ELEMENT && node.is( CKEDITOR.dtd.$inline ) && !node.is( CKEDITOR.dtd.$empty );\n\t\t};\n\n\t/**\n\t * Returns a function which checks whether the node should be ignored in terms of \"editability\".\n\t *\n\t * This includes:\n\t *\n\t * * whitespaces (see {@link CKEDITOR.dom.walker#whitespaces}),\n\t * * bookmarks (see {@link CKEDITOR.dom.walker#bookmark}),\n\t * * temporary elements (see {@link CKEDITOR.dom.walker#temp}).\n\t *\n\t * @since 4.3\n\t * @static\n\t * @param {Boolean} [isReject=false] Whether to return `false` for the\n\t * ignored element instead of `true` (default).\n\t * @returns {Function}\n\t */\n\tCKEDITOR.dom.walker.ignored = function( isReject ) {\n\t\treturn function( node ) {\n\t\t\tvar isIgnored = isWhitespaces( node ) || isBookmark( node ) || isTemp( node );\n\n\t\t\treturn !!( isReject ^ isIgnored );\n\t\t};\n\t};\n\n\tvar isIgnored = CKEDITOR.dom.walker.ignored();\n\n\t/**\n\t * Returns a function which checks whether the node is empty.\n\t *\n\t * @since 4.5\n\t * @static\n\t * @param {Boolean} [isReject=false] Whether to return `false` for the\n\t * ignored element instead of `true` (default).\n\t * @returns {Function}\n\t */\n\tCKEDITOR.dom.walker.empty = function( isReject ) {\n\t\treturn function( node ) {\n\t\t\tvar i = 0,\n\t\t\t\tl = node.getChildCount();\n\n\t\t\tfor ( ; i < l; ++i ) {\n\t\t\t\tif ( !isIgnored( node.getChild( i ) ) ) {\n\t\t\t\t\treturn !!isReject;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn !isReject;\n\t\t};\n\t};\n\n\tvar isEmpty = CKEDITOR.dom.walker.empty();\n\n\tfunction filterTextContainers( dtd ) {\n\t\tvar hash = {},\n\t\t\tname;\n\n\t\tfor ( name in dtd ) {\n\t\t\tif ( CKEDITOR.dtd[ name ][ '#' ] )\n\t\t\t\thash[ name ] = 1;\n\t\t}\n\t\treturn hash;\n\t}\n\n\t/**\n\t * A hash of element names which in browsers that {@link CKEDITOR.env#needsBrFiller do not need `<br>` fillers}\n\t * can be selection containers despite being empty.\n\t *\n\t * @since 4.5\n\t * @static\n\t * @property {Object} validEmptyBlockContainers\n\t */\n\tvar validEmptyBlocks = CKEDITOR.dom.walker.validEmptyBlockContainers = CKEDITOR.tools.extend(\n\t\tfilterTextContainers( CKEDITOR.dtd.$block ),\n\t\t{ caption: 1, td: 1, th: 1 }\n\t);\n\n\tfunction isEditable( node ) {\n\t\t// Skip temporary elements, bookmarks and whitespaces.\n\t\tif ( isIgnored( node ) )\n\t\t\treturn false;\n\n\t\tif ( node.type == CKEDITOR.NODE_TEXT )\n\t\t\treturn true;\n\n\t\tif ( node.type == CKEDITOR.NODE_ELEMENT ) {\n\t\t\t// All inline and non-editable elements are valid editable places.\n\t\t\t// Note: the <hr> is currently the only element in CKEDITOR.dtd.$empty and CKEDITOR.dtd.$block,\n\t\t\t// but generally speaking we need an intersection of these two sets.\n\t\t\t// Note: non-editable block has to be treated differently (should be selected entirely).\n\t\t\tif ( node.is( CKEDITOR.dtd.$inline ) || node.is( 'hr' ) || node.getAttribute( 'contenteditable' ) == 'false' )\n\t\t\t\treturn true;\n\n\t\t\t// Empty blocks are editable on IE.\n\t\t\tif ( !CKEDITOR.env.needsBrFiller && node.is( validEmptyBlocks ) && isEmpty( node ) )\n\t\t\t\treturn true;\n\t\t}\n\n\t\t// Skip all other nodes.\n\t\treturn false;\n\t}\n\n\t/**\n\t * Returns a function which checks whether the node can be a container or a sibling\n\t * of the selection end.\n\t *\n\t * This includes:\n\t *\n\t * * text nodes (but not whitespaces),\n\t * * inline elements,\n\t * * intersection of {@link CKEDITOR.dtd#$empty} and {@link CKEDITOR.dtd#$block} (currently\n\t * it is only `<hr>`),\n\t * * non-editable blocks (special case &mdash; such blocks cannot be containers nor\n\t * siblings, they need to be selected entirely),\n\t * * empty {@link #validEmptyBlockContainers blocks} which can contain text\n\t * ({@link CKEDITOR.env#needsBrFiller old IEs only}).\n\t *\n\t * @since 4.3\n\t * @static\n\t * @param {Boolean} [isReject=false] Whether to return `false` for the\n\t * ignored element instead of `true` (default).\n\t * @returns {Function}\n\t */\n\tCKEDITOR.dom.walker.editable = function( isReject ) {\n\t\treturn function( node ) {\n\t\t\treturn !!( isReject ^ isEditable( node ) );\n\t\t};\n\t};\n\n\t/**\n\t * Checks if there is a filler node at the end of an element, and returns it.\n\t *\n\t * @member CKEDITOR.dom.element\n\t * @returns {CKEDITOR.dom.node/Boolean} Bogus node or `false`.\n\t */\n\tCKEDITOR.dom.element.prototype.getBogus = function() {\n\t\t// Bogus are not always at the end, e.g. <p><a>text<br /></a></p> (#7070).\n\t\tvar tail = this;\n\t\tdo {\n\t\t\ttail = tail.getPreviousSourceNode();\n\t\t}\n\t\twhile ( toSkip( tail ) );\n\n\t\tif ( tail && ( CKEDITOR.env.needsBrFiller ? tail.is && tail.is( 'br' ) : tail.getText && tailNbspRegex.test( tail.getText() ) ) )\n\t\t\treturn tail;\n\n\t\treturn false;\n\t};\n\n} )();\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/dom/walker.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * Represents a delimited piece of content in a DOM Document.\n * It is contiguous in the sense that it can be characterized as selecting all\n * of the content between a pair of boundary-points.\n *\n * This class shares much of the W3C\n * [Document Object Model Range](http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html)\n * ideas and features, adding several range manipulation tools to it, but it's\n * not intended to be compatible with it.\n *\n *\t\t// Create a range for the entire contents of the editor document body.\n *\t\tvar range = new CKEDITOR.dom.range( editor.document );\n *\t\trange.selectNodeContents( editor.document.getBody() );\n *\t\t// Delete the contents.\n *\t\trange.deleteContents();\n *\n * Usually you will want to work on a ranges rooted in the editor's {@link CKEDITOR.editable editable}\n * element. Such ranges can be created with a shorthand method &ndash; {@link CKEDITOR.editor#createRange editor.createRange}.\n *\n *\t\tvar range = editor.createRange();\n *\t\trange.root.equals( editor.editable() ); // -> true\n *\n * Note that the {@link #root} of a range is an important property, which limits many\n * algorithms implemented in range's methods. Therefore it is crucial, especially\n * when using ranges inside inline editors, to specify correct root, so using\n * the {@link CKEDITOR.editor#createRange} method is highly recommended.\n *\n * ### Selection\n *\n * Range is only a logical representation of a piece of content in a DOM. It should not\n * be confused with a {@link CKEDITOR.dom.selection selection} which represents \"physically\n * marked\" content. It is possible to create unlimited number of various ranges, when\n * only one real selection may exist at a time in a document. Ranges are used to read position\n * of selection in the DOM and to move selection to new positions.\n *\n * The editor selection may be retrieved using the {@link CKEDITOR.editor#getSelection} method:\n *\n *\t\tvar sel = editor.getSelection(),\n *\t\t\tranges = sel.getRanges(); // CKEDITOR.dom.rangeList instance.\n *\n *\t\tvar range = ranges[ 0 ];\n *\t\trange.root; // -> editor's editable element.\n *\n * A range can also be selected:\n *\n *\t\tvar range = editor.createRange();\n *\t\trange.selectNodeContents( editor.editable() );\n *\t\tsel.selectRanges( [ range ] );\n *\n * @class\n * @constructor Creates a {@link CKEDITOR.dom.range} instance that can be used inside a specific DOM Document.\n * @param {CKEDITOR.dom.document/CKEDITOR.dom.element} root The document or element\n * within which the range will be scoped.\n * @todo global \"TODO\" - precise algorithms descriptions needed for the most complex methods like #enlarge.\n */\nCKEDITOR.dom.range = function( root ) {\n\t/**\n\t * Node within which the range begins.\n\t *\n\t *\t\tvar range = new CKEDITOR.dom.range( editor.document );\n\t *\t\trange.selectNodeContents( editor.document.getBody() );\n\t *\t\talert( range.startContainer.getName() ); // 'body'\n\t *\n\t * @readonly\n\t * @property {CKEDITOR.dom.element/CKEDITOR.dom.text}\n\t */\n\tthis.startContainer = null;\n\n\t/**\n\t * Offset within the starting node of the range.\n\t *\n\t *\t\tvar range = new CKEDITOR.dom.range( editor.document );\n\t *\t\trange.selectNodeContents( editor.document.getBody() );\n\t *\t\talert( range.startOffset ); // 0\n\t *\n\t * @readonly\n\t * @property {Number}\n\t */\n\tthis.startOffset = null;\n\n\t/**\n\t * Node within which the range ends.\n\t *\n\t *\t\tvar range = new CKEDITOR.dom.range( editor.document );\n\t *\t\trange.selectNodeContents( editor.document.getBody() );\n\t *\t\talert( range.endContainer.getName() ); // 'body'\n\t *\n\t * @readonly\n\t * @property {CKEDITOR.dom.element/CKEDITOR.dom.text}\n\t */\n\tthis.endContainer = null;\n\n\t/**\n\t * Offset within the ending node of the range.\n\t *\n\t *\t\tvar range = new CKEDITOR.dom.range( editor.document );\n\t *\t\trange.selectNodeContents( editor.document.getBody() );\n\t *\t\talert( range.endOffset ); // == editor.document.getBody().getChildCount()\n\t *\n\t * @readonly\n\t * @property {Number}\n\t */\n\tthis.endOffset = null;\n\n\t/**\n\t * Indicates that this is a collapsed range. A collapsed range has its\n\t * start and end boundaries at the very same point so nothing is contained\n\t * in it.\n\t *\n\t *\t\tvar range = new CKEDITOR.dom.range( editor.document );\n\t *\t\trange.selectNodeContents( editor.document.getBody() );\n\t *\t\talert( range.collapsed ); // false\n\t *\t\trange.collapse();\n\t *\t\talert( range.collapsed ); // true\n\t *\n\t * @readonly\n\t */\n\tthis.collapsed = true;\n\n\tvar isDocRoot = root instanceof CKEDITOR.dom.document;\n\t/**\n\t * The document within which the range can be used.\n\t *\n\t *\t\t// Selects the body contents of the range document.\n\t *\t\trange.selectNodeContents( range.document.getBody() );\n\t *\n\t * @readonly\n\t * @property {CKEDITOR.dom.document}\n\t */\n\tthis.document = isDocRoot ? root : root.getDocument();\n\n\t/**\n\t * The ancestor DOM element within which the range manipulation are limited.\n\t *\n\t * @readonly\n\t * @property {CKEDITOR.dom.element}\n\t */\n\tthis.root = isDocRoot ? root.getBody() : root;\n};\n\n( function() {\n\t// Updates the \"collapsed\" property for the given range object.\n\tfunction updateCollapsed( range ) {\n\t\trange.collapsed = ( range.startContainer && range.endContainer && range.startContainer.equals( range.endContainer ) && range.startOffset == range.endOffset );\n\t}\n\n\t// This is a shared function used to delete, extract and clone the range content.\n\t//\n\t// The outline of the algorithm:\n\t//\n\t// 1. Normalization. We handle special cases, split text nodes if we can, find boundary nodes (startNode and endNode).\n\t// 2. Gathering data.\n\t//   * We start by creating two arrays of boundary nodes parents. You can imagine these arrays as lines limiting\n\t//   the tree from the left and right and thus marking the part which is selected by the range. The both lines\n\t//   start in the same node which is the range.root and end in startNode and endNode.\n\t//   * Then we find min level and max levels. Level represents all nodes which are equally far from the range.root.\n\t//   Min level is the level at which the left and right boundaries diverged (the first diverged level). And max levels\n\t//   are how deep the start and end nodes are nested.\n\t// 3. Cloning/extraction.\n\t//   * We start iterating over start node parents (left branch) from min level and clone the parent (usually shallow clone,\n\t//   because we know that it's not fully selected) and its right siblings (deep clone, because they are fully selected).\n\t//   We iterate over siblings up to meeting end node parent or end of the siblings chain.\n\t//   * We clone level after level down to the startNode.\n\t//   * Then we do the same with end node parents (right branch), because it may contains notes we omit during the previous\n\t//   step, for example if the right branch is deeper then left branch. Things are more complicated here because we have to\n\t//   watch out for nodes that were already cloned.\n\t//   * ***Note:** Setting `cloneId` option to `false` for **extraction** works for partially selected elements only.\n\t//   See range.extractContents to know more.\n\t// 4. Clean up.\n\t//   * There are two things we need to do - updating the range position and perform the action of the \"mergeThen\"\n\t//   param (see range.deleteContents or range.extractContents).\n\t//   See comments in mergeAndUpdate because this is lots of fun too.\n\tfunction execContentsAction( range, action, docFrag, mergeThen, cloneId ) {\n\t\t'use strict';\n\n\t\trange.optimizeBookmark();\n\n\t\tvar isDelete = action === 0;\n\t\tvar isExtract = action == 1;\n\t\tvar isClone = action == 2;\n\t\tvar doClone = isClone || isExtract;\n\n\t\tvar startNode = range.startContainer;\n\t\tvar endNode = range.endContainer;\n\n\t\tvar startOffset = range.startOffset;\n\t\tvar endOffset = range.endOffset;\n\n\t\tvar cloneStartNode;\n\t\tvar cloneEndNode;\n\n\t\tvar doNotRemoveStartNode;\n\t\tvar doNotRemoveEndNode;\n\n\t\tvar cloneStartText;\n\t\tvar cloneEndText;\n\n\t\t// Handle here an edge case where we clone a range which is located in one text node.\n\t\t// This allows us to not think about startNode == endNode case later on.\n\t\t// We do that only when cloning, because in other cases we can safely split this text node\n\t\t// and hence we can easily handle this case as many others.\n\t\tif ( isClone && endNode.type == CKEDITOR.NODE_TEXT && startNode.equals( endNode ) ) {\n\t\t\tstartNode = range.document.createText( startNode.substring( startOffset, endOffset ) );\n\t\t\tdocFrag.append( startNode );\n\t\t\treturn;\n\t\t}\n\n\t\t// For text containers, we must simply split the node and point to the\n\t\t// second part. The removal will be handled by the rest of the code.\n\t\tif ( endNode.type == CKEDITOR.NODE_TEXT ) {\n\t\t\t// If Extract or Delete we can split the text node,\n\t\t\t// but if Clone (2), then we cannot modify the DOM (#11586) so we mark the text node for cloning.\n\t\t\tif ( !isClone ) {\n\t\t\t\tendNode = endNode.split( endOffset );\n\t\t\t} else {\n\t\t\t\tcloneEndText = true;\n\t\t\t}\n\t\t} else {\n\t\t\t// If there's no node after the range boundary we set endNode to the previous node\n\t\t\t// and mark it to be cloned.\n\t\t\tif ( endNode.getChildCount() > 0 ) {\n\t\t\t\t// If the offset points after the last node.\n\t\t\t\tif ( endOffset >= endNode.getChildCount() ) {\n\t\t\t\t\tendNode = endNode.getChild( endOffset - 1 );\n\t\t\t\t\tcloneEndNode = true;\n\t\t\t\t} else {\n\t\t\t\t\tendNode = endNode.getChild( endOffset );\n\t\t\t\t}\n\t\t\t}\n\t\t\t// The end container is empty (<h1>]</h1>), but we want to clone it, although not remove.\n\t\t\telse {\n\t\t\t\tcloneEndNode = true;\n\t\t\t\tdoNotRemoveEndNode = true;\n\t\t\t}\n\t\t}\n\n\t\t// For text containers, we must simply split the node. The removal will\n\t\t// be handled by the rest of the code .\n\t\tif ( startNode.type == CKEDITOR.NODE_TEXT ) {\n\t\t\t// If Extract or Delete we can split the text node,\n\t\t\t// but if Clone (2), then we cannot modify the DOM (#11586) so we mark\n\t\t\t// the text node for cloning.\n\t\t\tif ( !isClone ) {\n\t\t\t\tstartNode.split( startOffset );\n\t\t\t} else {\n\t\t\t\tcloneStartText = true;\n\t\t\t}\n\t\t} else {\n\t\t\t// If there's no node before the range boundary we set startNode to the next node\n\t\t\t// and mark it to be cloned.\n\t\t\tif ( startNode.getChildCount() > 0 ) {\n\t\t\t\tif ( startOffset === 0 ) {\n\t\t\t\t\tstartNode = startNode.getChild( startOffset );\n\t\t\t\t\tcloneStartNode = true;\n\t\t\t\t} else {\n\t\t\t\t\tstartNode = startNode.getChild( startOffset - 1 );\n\t\t\t\t}\n\t\t\t}\n\t\t\t// The start container is empty (<h1>[</h1>), but we want to clone it, although not remove.\n\t\t\telse {\n\t\t\t\tcloneStartNode = true;\n\t\t\t\tdoNotRemoveStartNode = true;\n\t\t\t}\n\t\t}\n\n\t\t\t// Get the parent nodes tree for the start and end boundaries.\n\t\tvar startParents = startNode.getParents(),\n\t\t\tendParents = endNode.getParents(),\n\t\t\t// Level at which start and end boundaries diverged.\n\t\t\tminLevel = findMinLevel(),\n\t\t\tmaxLevelLeft = startParents.length - 1,\n\t\t\tmaxLevelRight = endParents.length - 1,\n\t\t\t// Keeps the frag/element which is parent of the level that we are currently cloning.\n\t\t\tlevelParent = docFrag,\n\t\t\tnextLevelParent,\n\t\t\tleftNode,\n\t\t\trightNode,\n\t\t\tnextSibling,\n\t\t\t// Keeps track of the last connected level (on which left and right branches are connected)\n\t\t\t// Usually this is minLevel, but not always.\n\t\t\tlastConnectedLevel = -1;\n\n\t\t// THE LEFT BRANCH.\n\t\tfor ( var level = minLevel; level <= maxLevelLeft; level++ ) {\n\t\t\tleftNode = startParents[ level ];\n\t\t\tnextSibling = leftNode.getNext();\n\n\t\t\t// 1.\n\t\t\t// The first step is to handle partial selection of the left branch.\n\n\t\t\t// Max depth of the left branch. It means that ( leftSibling == endNode ).\n\t\t\t// We also check if the leftNode isn't only partially selected, because in this case\n\t\t\t// we want to make a shallow clone of it (the else part).\n\t\t\tif ( level == maxLevelLeft && !( leftNode.equals( endParents[ level ] ) && maxLevelLeft < maxLevelRight ) ) {\n\t\t\t\tif ( cloneStartNode ) {\n\t\t\t\t\tconsume( leftNode, levelParent, false, doNotRemoveStartNode );\n\t\t\t\t} else if ( cloneStartText ) {\n\t\t\t\t\tlevelParent.append( range.document.createText( leftNode.substring( startOffset ) ) );\n\t\t\t\t}\n\t\t\t} else if ( doClone ) {\n\t\t\t\tnextLevelParent = levelParent.append( leftNode.clone( 0, cloneId ) );\n\t\t\t}\n\n\t\t\t// 2.\n\t\t\t// The second step is to handle full selection of the content between the left branch and the right branch.\n\n\t\t\twhile ( nextSibling ) {\n\t\t\t\t// We can't clone entire endParent just like we can't clone entire startParent -\n\t\t\t\t// - they are not fully selected with the range. Partial endParent selection\n\t\t\t\t// will be cloned in the next loop.\n\t\t\t\tif ( nextSibling.equals( endParents[ level ] ) ) {\n\t\t\t\t\tlastConnectedLevel = level;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tnextSibling = consume( nextSibling, levelParent );\n\t\t\t}\n\n\t\t\tlevelParent = nextLevelParent;\n\t\t}\n\n\t\t// Reset levelParent, because we reset the level.\n\t\tlevelParent = docFrag;\n\n\t\t// THE RIGHT BRANCH.\n\t\tfor ( level = minLevel; level <= maxLevelRight; level++ ) {\n\t\t\trightNode = endParents[ level ];\n\t\t\tnextSibling = rightNode.getPrevious();\n\n\t\t\t// Do not process this node if it is shared with the left branch\n\t\t\t// because it was already processed.\n\t\t\t//\n\t\t\t// Note: Don't worry about text nodes selection - if the entire range was placed in a single text node\n\t\t\t// it was handled as a special case at the beginning. In other cases when startNode == endNode\n\t\t\t// or when on this level leftNode == rightNode (so rightNode.equals( startParents[ level ] ))\n\t\t\t// this node was handled by the previous loop.\n\t\t\tif ( !rightNode.equals( startParents[ level ] ) ) {\n\t\t\t\t// 1.\n\t\t\t\t// The first step is to handle partial selection of the right branch.\n\n\t\t\t\t// Max depth of the right branch. It means that ( rightNode == endNode ).\n\t\t\t\t// We also check if the rightNode isn't only partially selected, because in this case\n\t\t\t\t// we want to make a shallow clone of it (the else part).\n\t\t\t\tif ( level == maxLevelRight && !( rightNode.equals( startParents[ level ] ) && maxLevelRight < maxLevelLeft ) ) {\n\t\t\t\t\tif ( cloneEndNode ) {\n\t\t\t\t\t\tconsume( rightNode, levelParent, false, doNotRemoveEndNode );\n\t\t\t\t\t} else if ( cloneEndText ) {\n\t\t\t\t\t\tlevelParent.append( range.document.createText( rightNode.substring( 0, endOffset ) ) );\n\t\t\t\t\t}\n\t\t\t\t} else if ( doClone ) {\n\t\t\t\t\tnextLevelParent = levelParent.append( rightNode.clone( 0, cloneId ) );\n\t\t\t\t}\n\n\t\t\t\t// 2.\n\t\t\t\t// The second step is to handle all left (selected) siblings of the rightNode which\n\t\t\t\t// have not yet been handled. If the level branches were connected, the previous loop\n\t\t\t\t// already copied all siblings (except the current rightNode).\n\t\t\t\tif ( level > lastConnectedLevel ) {\n\t\t\t\t\twhile ( nextSibling ) {\n\t\t\t\t\t\tnextSibling = consume( nextSibling, levelParent, true );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlevelParent = nextLevelParent;\n\t\t\t} else if ( doClone ) {\n\t\t\t\t// If this is \"shared\" node and we are in cloning mode we have to update levelParent to\n\t\t\t\t// reflect that we visited the node (even though we didn't process it).\n\t\t\t\t// If we don't do that, in next iterations nodes will be appended to wrong parent.\n\t\t\t\t//\n\t\t\t\t// We can just take first child because the algorithm guarantees\n\t\t\t\t// that this will be the only child on this level. (#13568)\n\t\t\t\tlevelParent = levelParent.getChild( 0 );\n\t\t\t}\n\t\t}\n\n\t\t// Delete or Extract.\n\t\t// We need to update the range and if mergeThen was passed do it.\n\t\tif ( !isClone ) {\n\t\t\tmergeAndUpdate();\n\t\t}\n\n\t\t// Depending on an action:\n\t\t// * clones node and adds to new parent,\n\t\t// * removes node,\n\t\t// * moves node to the new parent.\n\t\tfunction consume( node, newParent, toStart, forceClone ) {\n\t\t\tvar nextSibling = toStart ? node.getPrevious() : node.getNext();\n\n\t\t\t// We do not clone if we are only deleting, so do nothing.\n\t\t\tif ( forceClone && isDelete ) {\n\t\t\t\treturn nextSibling;\n\t\t\t}\n\n\t\t\t// If cloning, just clone it.\n\t\t\tif ( isClone || forceClone ) {\n\t\t\t\tnewParent.append( node.clone( true, cloneId ), toStart );\n\t\t\t} else {\n\t\t\t\t// Both Delete and Extract will remove the node.\n\t\t\t\tnode.remove();\n\n\t\t\t\t// When Extracting, move the removed node to the docFrag.\n\t\t\t\tif ( isExtract ) {\n\t\t\t\t\tnewParent.append( node );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn nextSibling;\n\t\t}\n\n\t\t// Finds a level number on which both branches starts diverging.\n\t\t// If such level does not exist, return the last on which both branches have nodes.\n\t\tfunction findMinLevel() {\n\t\t\t// Compare them, to find the top most siblings.\n\t\t\tvar i, topStart, topEnd,\n\t\t\t\tmaxLevel = Math.min( startParents.length, endParents.length );\n\n\t\t\tfor ( i = 0; i < maxLevel; i++ ) {\n\t\t\t\ttopStart = startParents[ i ];\n\t\t\t\ttopEnd = endParents[ i ];\n\n\t\t\t\t// The compared nodes will match until we find the top most siblings (different nodes that have the same parent).\n\t\t\t\t// \"i\" will hold the index in the parents array for the top most element.\n\t\t\t\tif ( !topStart.equals( topEnd ) ) {\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// When startNode == endNode.\n\t\t\treturn i - 1;\n\t\t}\n\n\t\t// Executed only when deleting or extracting to update range position\n\t\t// and perform the merge operation.\n\t\tfunction mergeAndUpdate() {\n\t\t\tvar commonLevel = minLevel - 1,\n\t\t\t\tboundariesInEmptyNode = doNotRemoveStartNode && doNotRemoveEndNode && !startNode.equals( endNode );\n\n\t\t\t// If a node has been partially selected, collapse the range between\n\t\t\t// startParents[ minLevel + 1 ] and endParents[ minLevel + 1 ] (the first diverged elements).\n\t\t\t// Otherwise, simply collapse it to the start. (W3C specs).\n\t\t\t//\n\t\t\t// All clear, right?\n\t\t\t//\n\t\t\t// It took me few hours to truly understand a previous version of this condition.\n\t\t\t// Mine seems to be more straightforward (even if it doesn't look so) and I could leave you here\n\t\t\t// without additional comments, but I'm not that mean so here goes the explanation.\n\t\t\t//\n\t\t\t// We want to know if both ends of the range are anchored in the same element. Really. It's this simple.\n\t\t\t// But why? Because we need to differentiate situations like:\n\t\t\t//\n\t\t\t// <p>foo[<b>x</b>bar]y</p>\t\t(commonLevel = p, maxLL = \"foo\", maxLR = \"y\")\n\t\t\t// from:\n\t\t\t// <p>foo<b>x[</b>bar]y</p>\t\t(commonLevel = p, maxLL = \"x\", maxLR = \"y\")\n\t\t\t//\n\t\t\t// In the first case we can collapse the range to the left, because simply everything between range's\n\t\t\t// boundaries was removed.\n\t\t\t// In the second case we must place the range after </b>, because <b> was only **partially selected**.\n\t\t\t//\n\t\t\t// * <b> is our startParents[ commonLevel + 1 ]\n\t\t\t// * \"y\" is our endParents[ commonLevel + 1 ].\n\t\t\t//\n\t\t\t// By now \"bar\" is removed from the DOM so <b> is a direct sibling of \"y\":\n\t\t\t// <p>foo<b>x</b>y</p>\n\t\t\t//\n\t\t\t// Therefore it's enough to place the range between <b> and \"y\".\n\t\t\t//\n\t\t\t// Now, what does the comparison mean? Why not just taking startNode and endNode and checking\n\t\t\t// their parents? Because the tree is already changed and they may be gone. Plus, thanks to\n\t\t\t// cloneStartNode and cloneEndNode, that would be reaaaaly tricky.\n\t\t\t//\n\t\t\t// So we play with levels which can give us the same information:\n\t\t\t// * commonLevel - the level of common ancestor,\n\t\t\t// * maxLevel - 1 - the level of range boundary parent (range boundary is here like a bookmark span).\n\t\t\t// * commonLevel < maxLevel - 1 - whether the range boundary is not a child of common ancestor.\n\t\t\t//\n\t\t\t// There's also an edge case in which both range boundaries were placed in empty nodes like:\n\t\t\t// <p>[</p><p>]</p>\n\t\t\t// Those boundaries were not removed, but in this case start and end nodes are child of the common ancestor.\n\t\t\t// We handle this edge case separately.\n\t\t\tif ( commonLevel < ( maxLevelLeft - 1 ) || commonLevel < ( maxLevelRight - 1 ) || boundariesInEmptyNode ) {\n\t\t\t\tif ( boundariesInEmptyNode ) {\n\t\t\t\t\trange.moveToPosition( endNode, CKEDITOR.POSITION_BEFORE_START );\n\t\t\t\t} else if ( ( maxLevelRight == commonLevel + 1 ) && cloneEndNode ) {\n\t\t\t\t\t// The maxLevelRight + 1 element could be already removed so we use the fact that\n\t\t\t\t\t// we know that it was the last element in its parent.\n\t\t\t\t\trange.moveToPosition( endParents[ commonLevel ], CKEDITOR.POSITION_BEFORE_END );\n\t\t\t\t} else {\n\t\t\t\t\trange.moveToPosition( endParents[ commonLevel + 1 ], CKEDITOR.POSITION_BEFORE_START );\n\t\t\t\t}\n\n\t\t\t\t// Merge split parents.\n\t\t\t\tif ( mergeThen ) {\n\t\t\t\t\t// Find the first diverged node in the left branch.\n\t\t\t\t\tvar topLeft = startParents[ commonLevel + 1 ];\n\n\t\t\t\t\t// TopLeft may simply not exist if commonLevel == maxLevel or may be a text node.\n\t\t\t\t\tif ( topLeft && topLeft.type == CKEDITOR.NODE_ELEMENT ) {\n\t\t\t\t\t\tvar span = CKEDITOR.dom.element.createFromHtml( '<span ' +\n\t\t\t\t\t\t\t'data-cke-bookmark=\"1\" style=\"display:none\">&nbsp;</span>', range.document );\n\t\t\t\t\t\tspan.insertAfter( topLeft );\n\t\t\t\t\t\ttopLeft.mergeSiblings( false );\n\t\t\t\t\t\trange.moveToBookmark( { startNode: span } );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Collapse it to the start.\n\t\t\t\trange.collapse( true );\n\t\t\t}\n\t\t}\n\t}\n\n\tvar inlineChildReqElements = {\n\t\tabbr: 1, acronym: 1, b: 1, bdo: 1, big: 1, cite: 1, code: 1, del: 1,\n\t\tdfn: 1, em: 1, font: 1, i: 1, ins: 1, label: 1, kbd: 1, q: 1, samp: 1, small: 1, span: 1, strike: 1,\n\t\tstrong: 1, sub: 1, sup: 1, tt: 1, u: 1, 'var': 1\n\t};\n\n\t// Creates the appropriate node evaluator for the dom walker used inside\n\t// check(Start|End)OfBlock.\n\tfunction getCheckStartEndBlockEvalFunction() {\n\t\tvar skipBogus = false,\n\t\t\twhitespaces = CKEDITOR.dom.walker.whitespaces(),\n\t\t\tbookmarkEvaluator = CKEDITOR.dom.walker.bookmark( true ),\n\t\t\tisBogus = CKEDITOR.dom.walker.bogus();\n\n\t\treturn function( node ) {\n\t\t\t// First skip empty nodes\n\t\t\tif ( bookmarkEvaluator( node ) || whitespaces( node ) )\n\t\t\t\treturn true;\n\n\t\t\t// Skip the bogus node at the end of block.\n\t\t\tif ( isBogus( node ) && !skipBogus ) {\n\t\t\t\tskipBogus = true;\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t// If there's any visible text, then we're not at the start.\n\t\t\tif ( node.type == CKEDITOR.NODE_TEXT &&\n\t\t\t\t( node.hasAscendant( 'pre' ) ||\n\t\t\t\t\tCKEDITOR.tools.trim( node.getText() ).length ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// If there are non-empty inline elements (e.g. <img />), then we're not\n\t\t\t// at the start.\n\t\t\tif ( node.type == CKEDITOR.NODE_ELEMENT && !node.is( inlineChildReqElements ) )\n\t\t\t\treturn false;\n\n\t\t\treturn true;\n\t\t};\n\t}\n\n\tvar isBogus = CKEDITOR.dom.walker.bogus(),\n\t\tnbspRegExp = /^[\\t\\r\\n ]*(?:&nbsp;|\\xa0)$/,\n\t\teditableEval = CKEDITOR.dom.walker.editable(),\n\t\tnotIgnoredEval = CKEDITOR.dom.walker.ignored( true );\n\n\t// Evaluator for CKEDITOR.dom.element::checkBoundaryOfElement, reject any\n\t// text node and non-empty elements unless it's being bookmark text.\n\tfunction elementBoundaryEval( checkStart ) {\n\t\tvar whitespaces = CKEDITOR.dom.walker.whitespaces(),\n\t\t\tbookmark = CKEDITOR.dom.walker.bookmark( 1 );\n\n\t\treturn function( node ) {\n\t\t\t// First skip empty nodes.\n\t\t\tif ( bookmark( node ) || whitespaces( node ) )\n\t\t\t\treturn true;\n\n\t\t\t// Tolerant bogus br when checking at the end of block.\n\t\t\t// Reject any text node unless it's being bookmark\n\t\t\t// OR it's spaces.\n\t\t\t// Reject any element unless it's being invisible empty. (#3883)\n\t\t\treturn !checkStart && isBogus( node ) ||\n\t\t\t\tnode.type == CKEDITOR.NODE_ELEMENT &&\n\t\t\t\tnode.is( CKEDITOR.dtd.$removeEmpty );\n\t\t};\n\t}\n\n\tfunction getNextEditableNode( isPrevious ) {\n\t\treturn function() {\n\t\t\tvar first;\n\n\t\t\treturn this[ isPrevious ? 'getPreviousNode' : 'getNextNode' ]( function( node ) {\n\t\t\t\t// Cache first not ignorable node.\n\t\t\t\tif ( !first && notIgnoredEval( node ) )\n\t\t\t\t\tfirst = node;\n\n\t\t\t\t// Return true if found editable node, but not a bogus next to start of our lookup (first != bogus).\n\t\t\t\treturn editableEval( node ) && !( isBogus( node ) && node.equals( first ) );\n\t\t\t} );\n\t\t};\n\t}\n\n\tCKEDITOR.dom.range.prototype = {\n\t\t/**\n\t\t * Clones this range.\n\t\t *\n\t\t * @returns {CKEDITOR.dom.range}\n\t\t */\n\t\tclone: function() {\n\t\t\tvar clone = new CKEDITOR.dom.range( this.root );\n\n\t\t\tclone._setStartContainer( this.startContainer );\n\t\t\tclone.startOffset = this.startOffset;\n\t\t\tclone._setEndContainer( this.endContainer );\n\t\t\tclone.endOffset = this.endOffset;\n\t\t\tclone.collapsed = this.collapsed;\n\n\t\t\treturn clone;\n\t\t},\n\n\t\t/**\n\t\t * Makes the range collapsed by moving its start point (or end point if `toStart==true`)\n\t\t * to the second end.\n\t\t *\n\t\t * @param {Boolean} toStart Collapse range \"to start\".\n\t\t */\n\t\tcollapse: function( toStart ) {\n\t\t\tif ( toStart ) {\n\t\t\t\tthis._setEndContainer( this.startContainer );\n\t\t\t\tthis.endOffset = this.startOffset;\n\t\t\t} else {\n\t\t\t\tthis._setStartContainer( this.endContainer );\n\t\t\t\tthis.startOffset = this.endOffset;\n\t\t\t}\n\n\t\t\tthis.collapsed = true;\n\t\t},\n\n\t\t/**\n\t\t * Clones content nodes of the range and adds them to a document fragment, which is returned.\n\t\t *\n\t\t * @param {Boolean} [cloneId=true] Whether to preserve ID attributes in the clone.\n\t\t * @returns {CKEDITOR.dom.documentFragment} Document fragment containing a clone of range's content.\n\t\t */\n\t\tcloneContents: function( cloneId ) {\n\t\t\tvar docFrag = new CKEDITOR.dom.documentFragment( this.document );\n\n\t\t\tcloneId = typeof cloneId == 'undefined' ? true : cloneId;\n\n\t\t\tif ( !this.collapsed )\n\t\t\t\texecContentsAction( this, 2, docFrag, false, cloneId );\n\n\t\t\treturn docFrag;\n\t\t},\n\n\t\t/**\n\t\t * Deletes the content nodes of the range permanently from the DOM tree.\n\t\t *\n\t\t * @param {Boolean} [mergeThen] Merge any split elements result in DOM true due to partial selection.\n\t\t */\n\t\tdeleteContents: function( mergeThen ) {\n\t\t\tif ( this.collapsed )\n\t\t\t\treturn;\n\n\t\t\texecContentsAction( this, 0, null, mergeThen );\n\t\t},\n\n\t\t/**\n\t\t * The content nodes of the range are cloned and added to a document fragment,\n\t\t * meanwhile they are removed permanently from the DOM tree.\n\t\t *\n\t\t * **Note:** Setting the `cloneId` parameter to `false` works for **partially** selected elements only.\n\t\t * If an element with an ID attribute is **fully enclosed** in a range, it will keep the ID attribute\n\t\t * regardless of the `cloneId` parameter value, because it is not cloned &mdash; it is moved to the returned\n\t\t * document fragment.\n\t\t *\n\t\t * @param {Boolean} [mergeThen] Merge any split elements result in DOM true due to partial selection.\n\t\t * @param {Boolean} [cloneId=true] Whether to preserve ID attributes in the extracted content.\n\t\t * @returns {CKEDITOR.dom.documentFragment} Document fragment containing extracted content.\n\t\t */\n\t\textractContents: function( mergeThen, cloneId ) {\n\t\t\tvar docFrag = new CKEDITOR.dom.documentFragment( this.document );\n\n\t\t\tcloneId = typeof cloneId == 'undefined' ? true : cloneId;\n\n\t\t\tif ( !this.collapsed )\n\t\t\t\texecContentsAction( this, 1, docFrag, mergeThen, cloneId );\n\n\t\t\treturn docFrag;\n\t\t},\n\n\t\t/**\n\t\t * Creates a bookmark object, which can be later used to restore the\n\t\t * range by using the {@link #moveToBookmark} function.\n\t\t *\n\t\t * This is an \"intrusive\" way to create a bookmark. It includes `<span>` tags\n\t\t * in the range boundaries. The advantage of it is that it is possible to\n\t\t * handle DOM mutations when moving back to the bookmark.\n\t\t *\n\t\t * **Note:** The inclusion of nodes in the DOM is a design choice and\n\t\t * should not be changed as there are other points in the code that may be\n\t\t * using those nodes to perform operations.\n\t\t *\n\t\t * @param {Boolean} [serializable] Indicates that the bookmark nodes\n\t\t * must contain IDs, which can be used to restore the range even\n\t\t * when these nodes suffer mutations (like cloning or `innerHTML` change).\n\t\t * @returns {Object} And object representing a bookmark.\n\t\t * @returns {CKEDITOR.dom.node/String} return.startNode Node or element ID.\n\t\t * @returns {CKEDITOR.dom.node/String} return.endNode Node or element ID.\n\t\t * @returns {Boolean} return.serializable\n\t\t * @returns {Boolean} return.collapsed\n\t\t */\n\t\tcreateBookmark: function( serializable ) {\n\t\t\tvar startNode, endNode;\n\t\t\tvar baseId;\n\t\t\tvar clone;\n\t\t\tvar collapsed = this.collapsed;\n\n\t\t\tstartNode = this.document.createElement( 'span' );\n\t\t\tstartNode.data( 'cke-bookmark', 1 );\n\t\t\tstartNode.setStyle( 'display', 'none' );\n\n\t\t\t// For IE, it must have something inside, otherwise it may be\n\t\t\t// removed during DOM operations.\n\t\t\tstartNode.setHtml( '&nbsp;' );\n\n\t\t\tif ( serializable ) {\n\t\t\t\tbaseId = 'cke_bm_' + CKEDITOR.tools.getNextNumber();\n\t\t\t\tstartNode.setAttribute( 'id', baseId + ( collapsed ? 'C' : 'S' ) );\n\t\t\t}\n\n\t\t\t// If collapsed, the endNode will not be created.\n\t\t\tif ( !collapsed ) {\n\t\t\t\tendNode = startNode.clone();\n\t\t\t\tendNode.setHtml( '&nbsp;' );\n\n\t\t\t\tif ( serializable )\n\t\t\t\t\tendNode.setAttribute( 'id', baseId + 'E' );\n\n\t\t\t\tclone = this.clone();\n\t\t\t\tclone.collapse();\n\t\t\t\tclone.insertNode( endNode );\n\t\t\t}\n\n\t\t\tclone = this.clone();\n\t\t\tclone.collapse( true );\n\t\t\tclone.insertNode( startNode );\n\n\t\t\t// Update the range position.\n\t\t\tif ( endNode ) {\n\t\t\t\tthis.setStartAfter( startNode );\n\t\t\t\tthis.setEndBefore( endNode );\n\t\t\t} else {\n\t\t\t\tthis.moveToPosition( startNode, CKEDITOR.POSITION_AFTER_END );\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tstartNode: serializable ? baseId + ( collapsed ? 'C' : 'S' ) : startNode,\n\t\t\t\tendNode: serializable ? baseId + 'E' : endNode,\n\t\t\t\tserializable: serializable,\n\t\t\t\tcollapsed: collapsed\n\t\t\t};\n\t\t},\n\n\t\t/**\n\t\t * Creates a \"non intrusive\" and \"mutation sensible\" bookmark. This\n\t\t * kind of bookmark should be used only when the DOM is supposed to\n\t\t * remain stable after its creation.\n\t\t *\n\t\t * @param {Boolean} [normalized] Indicates that the bookmark must\n\t\t * be normalized. When normalized, the successive text nodes are\n\t\t * considered a single node. To successfully load a normalized\n\t\t * bookmark, the DOM tree must also be normalized before calling\n\t\t * {@link #moveToBookmark}.\n\t\t * @returns {Object} An object representing the bookmark.\n\t\t * @returns {Array} return.start Start container's address (see {@link CKEDITOR.dom.node#getAddress}).\n\t\t * @returns {Array} return.end Start container's address.\n\t\t * @returns {Number} return.startOffset\n\t\t * @returns {Number} return.endOffset\n\t\t * @returns {Boolean} return.collapsed\n\t\t * @returns {Boolean} return.normalized\n\t\t * @returns {Boolean} return.is2 This is \"bookmark2\".\n\t\t */\n\t\tcreateBookmark2: ( function() {\n\t\t\tvar isNotText = CKEDITOR.dom.walker.nodeType( CKEDITOR.NODE_TEXT, true );\n\n\t\t\t// Returns true for limit anchored in element and placed between text nodes.\n\t\t\t//\n\t\t\t//               v\n\t\t\t// <p>[text node] [text node]</p> -> true\n\t\t\t//\n\t\t\t//    v\n\t\t\t// <p> [text node]</p> -> false\n\t\t\t//\n\t\t\t//              v\n\t\t\t// <p>[text node][text node]</p> -> false (limit is anchored in text node)\n\t\t\tfunction betweenTextNodes( container, offset ) {\n\t\t\t\t// Not anchored in element or limit is on the edge.\n\t\t\t\tif ( container.type != CKEDITOR.NODE_ELEMENT || offset === 0 || offset == container.getChildCount() )\n\t\t\t\t\treturn 0;\n\n\t\t\t\treturn container.getChild( offset - 1 ).type == CKEDITOR.NODE_TEXT &&\n\t\t\t\t\tcontainer.getChild( offset ).type == CKEDITOR.NODE_TEXT;\n\t\t\t}\n\n\t\t\t// Sums lengths of all preceding text nodes.\n\t\t\tfunction getLengthOfPrecedingTextNodes( node ) {\n\t\t\t\tvar sum = 0;\n\n\t\t\t\twhile ( ( node = node.getPrevious() ) && node.type == CKEDITOR.NODE_TEXT )\n\t\t\t\t\tsum += node.getText().replace( CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE, '' ).length;\n\n\t\t\t\treturn sum;\n\t\t\t}\n\n\t\t\tfunction normalizeTextNodes( limit ) {\n\t\t\t\tvar container = limit.container,\n\t\t\t\t\toffset = limit.offset;\n\n\t\t\t\t// If limit is between text nodes move it to the end of preceding one,\n\t\t\t\t// because they will be merged.\n\t\t\t\tif ( betweenTextNodes( container, offset ) ) {\n\t\t\t\t\tcontainer = container.getChild( offset - 1 );\n\t\t\t\t\toffset = container.getLength();\n\t\t\t\t}\n\n\t\t\t\t// Now, if limit is anchored in element and has at least one node before it,\n\t\t\t\t// it may happen that some of them will be merged. Normalize the offset\n\t\t\t\t// by setting it to normalized index of its preceding, safe node.\n\t\t\t\t// (safe == one for which getIndex(true) does not return -1, so one which won't disappear).\n\t\t\t\tif ( container.type == CKEDITOR.NODE_ELEMENT && offset > 0 ) {\n\t\t\t\t\toffset = getPrecedingSafeNodeIndex( container, offset ) + 1;\n\t\t\t\t}\n\n\t\t\t\t// The last step - fix the offset inside text node by adding\n\t\t\t\t// lengths of preceding text nodes which will be merged with container.\n\t\t\t\tif ( container.type == CKEDITOR.NODE_TEXT ) {\n\t\t\t\t\tvar precedingLength = getLengthOfPrecedingTextNodes( container );\n\n\t\t\t\t\t// Normal case - text node is not empty.\n\t\t\t\t\tif ( container.getText() ) {\n\t\t\t\t\t\toffset += precedingLength;\n\n\t\t\t\t\t// Awful case - the text node is empty and thus will be totally lost.\n\t\t\t\t\t// In this case we are trying to normalize the limit to the left:\n\t\t\t\t\t// * either to the preceding text node,\n\t\t\t\t\t// * or to the \"gap\" after the preceding element.\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Find the closest non-text sibling.\n\t\t\t\t\t\tvar precedingContainer = container.getPrevious( isNotText );\n\n\t\t\t\t\t\t// If there are any characters on the left, that means that we can anchor\n\t\t\t\t\t\t// there, because this text node will not be lost.\n\t\t\t\t\t\tif ( precedingLength ) {\n\t\t\t\t\t\t\toffset = precedingLength;\n\n\t\t\t\t\t\t\tif ( precedingContainer ) {\n\t\t\t\t\t\t\t\t// The text node is the first node after the closest non-text sibling.\n\t\t\t\t\t\t\t\tcontainer = precedingContainer.getNext();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// But if there was no non-text sibling, then the text node is the first child.\n\t\t\t\t\t\t\t\tcontainer = container.getParent().getFirst();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// If there are no characters on the left, then anchor after the previous non-text node.\n\t\t\t\t\t\t// E.g. (see tests for a legend :D):\n\t\t\t\t\t\t// <b>x</b>(foo)({}bar) -> <b>x</b>[](foo)(bar)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcontainer = container.getParent();\n\t\t\t\t\t\t\toffset = precedingContainer ? ( precedingContainer.getIndex( true ) + 1 ) : 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlimit.container = container;\n\t\t\t\tlimit.offset = offset;\n\t\t\t}\n\n\t\t\tfunction normalizeFCSeq( limit, root ) {\n\t\t\t\tvar fcseq = root.getCustomData( 'cke-fillingChar' );\n\n\t\t\t\tif ( !fcseq ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar container = limit.container;\n\n\t\t\t\tif ( fcseq.equals( container ) ) {\n\t\t\t\t\tlimit.offset -= CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE.length;\n\n\t\t\t\t\t// == 0\t\thandles case when limit was at the end of FCS.\n\t\t\t\t\t//  < 0\t\thandles all cases where limit was somewhere in the middle or at the beginning.\n\t\t\t\t\t//  > 0\t\t(the \"else\" case) means cases where there are some more characters in the FCS node (FCSabc^def).\n\t\t\t\t\tif ( limit.offset <= 0 ) {\n\t\t\t\t\t\tlimit.offset = container.getIndex();\n\t\t\t\t\t\tlimit.container = container.getParent();\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// And here goes the funny part - all other cases are handled inside node.getAddress() and getIndex() thanks to\n\t\t\t\t// node.getIndex() being aware of FCS (handling it as an empty node).\n\t\t\t}\n\n\t\t\t// Finds a normalized index of a safe node preceding this one.\n\t\t\t// Safe == one that will not disappear, so one for which getIndex( true ) does not return -1.\n\t\t\t// Return -1 if there's no safe preceding node.\n\t\t\tfunction getPrecedingSafeNodeIndex( container, offset ) {\n\t\t\t\tvar index;\n\n\t\t\t\twhile ( offset-- ) {\n\t\t\t\t\tindex = container.getChild( offset ).getIndex( true );\n\n\t\t\t\t\tif ( index >= 0 )\n\t\t\t\t\t\treturn index;\n\t\t\t\t}\n\n\t\t\t\treturn -1;\n\t\t\t}\n\n\t\t\treturn function( normalized ) {\n\t\t\t\tvar collapsed = this.collapsed,\n\t\t\t\t\tbmStart = {\n\t\t\t\t\t\tcontainer: this.startContainer,\n\t\t\t\t\t\toffset: this.startOffset\n\t\t\t\t\t},\n\t\t\t\t\tbmEnd = {\n\t\t\t\t\t\tcontainer: this.endContainer,\n\t\t\t\t\t\toffset: this.endOffset\n\t\t\t\t\t};\n\n\t\t\t\tif ( normalized ) {\n\t\t\t\t\tnormalizeTextNodes( bmStart );\n\t\t\t\t\tnormalizeFCSeq( bmStart, this.root );\n\n\t\t\t\t\tif ( !collapsed ) {\n\t\t\t\t\t\tnormalizeTextNodes( bmEnd );\n\t\t\t\t\t\tnormalizeFCSeq( bmEnd, this.root );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\tstart: bmStart.container.getAddress( normalized ),\n\t\t\t\t\tend: collapsed ? null : bmEnd.container.getAddress( normalized ),\n\t\t\t\t\tstartOffset: bmStart.offset,\n\t\t\t\t\tendOffset: bmEnd.offset,\n\t\t\t\t\tnormalized: normalized,\n\t\t\t\t\tcollapsed: collapsed,\n\t\t\t\t\tis2: true // It's a createBookmark2 bookmark.\n\t\t\t\t};\n\t\t\t};\n\t\t} )(),\n\n\t\t/**\n\t\t * Moves this range to the given bookmark. See {@link #createBookmark} and {@link #createBookmark2}.\n\t\t *\n\t\t * If serializable bookmark passed, then its `<span>` markers will be removed.\n\t\t *\n\t\t * @param {Object} bookmark\n\t\t */\n\t\tmoveToBookmark: function( bookmark ) {\n\t\t\t// Created with createBookmark2().\n\t\t\tif ( bookmark.is2 ) {\n\t\t\t\t// Get the start information.\n\t\t\t\tvar startContainer = this.document.getByAddress( bookmark.start, bookmark.normalized ),\n\t\t\t\t\tstartOffset = bookmark.startOffset;\n\n\t\t\t\t// Get the end information.\n\t\t\t\tvar endContainer = bookmark.end && this.document.getByAddress( bookmark.end, bookmark.normalized ),\n\t\t\t\t\tendOffset = bookmark.endOffset;\n\n\t\t\t\t// Set the start boundary.\n\t\t\t\tthis.setStart( startContainer, startOffset );\n\n\t\t\t\t// Set the end boundary. If not available, collapse it.\n\t\t\t\tif ( endContainer )\n\t\t\t\t\tthis.setEnd( endContainer, endOffset );\n\t\t\t\telse\n\t\t\t\t\tthis.collapse( true );\n\t\t\t}\n\t\t\t// Created with createBookmark().\n\t\t\telse {\n\t\t\t\tvar serializable = bookmark.serializable,\n\t\t\t\t\tstartNode = serializable ? this.document.getById( bookmark.startNode ) : bookmark.startNode,\n\t\t\t\t\tendNode = serializable ? this.document.getById( bookmark.endNode ) : bookmark.endNode;\n\n\t\t\t\t// Set the range start at the bookmark start node position.\n\t\t\t\tthis.setStartBefore( startNode );\n\n\t\t\t\t// Remove it, because it may interfere in the setEndBefore call.\n\t\t\t\tstartNode.remove();\n\n\t\t\t\t// Set the range end at the bookmark end node position, or simply\n\t\t\t\t// collapse it if it is not available.\n\t\t\t\tif ( endNode ) {\n\t\t\t\t\tthis.setEndBefore( endNode );\n\t\t\t\t\tendNode.remove();\n\t\t\t\t} else {\n\t\t\t\t\tthis.collapse( true );\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Returns two nodes which are on the boundaries of this range.\n\t\t *\n\t\t * @returns {Object}\n\t\t * @returns {CKEDITOR.dom.node} return.startNode\n\t\t * @returns {CKEDITOR.dom.node} return.endNode\n\t\t * @todo precise desc/algorithm\n\t\t */\n\t\tgetBoundaryNodes: function() {\n\t\t\tvar startNode = this.startContainer,\n\t\t\t\tendNode = this.endContainer,\n\t\t\t\tstartOffset = this.startOffset,\n\t\t\t\tendOffset = this.endOffset,\n\t\t\t\tchildCount;\n\n\t\t\tif ( startNode.type == CKEDITOR.NODE_ELEMENT ) {\n\t\t\t\tchildCount = startNode.getChildCount();\n\t\t\t\tif ( childCount > startOffset ) {\n\t\t\t\t\tstartNode = startNode.getChild( startOffset );\n\t\t\t\t} else if ( childCount < 1 ) {\n\t\t\t\t\tstartNode = startNode.getPreviousSourceNode();\n\t\t\t\t}\n\t\t\t\t// startOffset > childCount but childCount is not 0\n\t\t\t\telse {\n\t\t\t\t\t// Try to take the node just after the current position.\n\t\t\t\t\tstartNode = startNode.$;\n\t\t\t\t\twhile ( startNode.lastChild )\n\t\t\t\t\t\tstartNode = startNode.lastChild;\n\t\t\t\t\tstartNode = new CKEDITOR.dom.node( startNode );\n\n\t\t\t\t\t// Normally we should take the next node in DFS order. But it\n\t\t\t\t\t// is also possible that we've already reached the end of\n\t\t\t\t\t// document.\n\t\t\t\t\tstartNode = startNode.getNextSourceNode() || startNode;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( endNode.type == CKEDITOR.NODE_ELEMENT ) {\n\t\t\t\tchildCount = endNode.getChildCount();\n\t\t\t\tif ( childCount > endOffset ) {\n\t\t\t\t\tendNode = endNode.getChild( endOffset ).getPreviousSourceNode( true );\n\t\t\t\t} else if ( childCount < 1 ) {\n\t\t\t\t\tendNode = endNode.getPreviousSourceNode();\n\t\t\t\t}\n\t\t\t\t// endOffset > childCount but childCount is not 0.\n\t\t\t\telse {\n\t\t\t\t\t// Try to take the node just before the current position.\n\t\t\t\t\tendNode = endNode.$;\n\t\t\t\t\twhile ( endNode.lastChild )\n\t\t\t\t\t\tendNode = endNode.lastChild;\n\t\t\t\t\tendNode = new CKEDITOR.dom.node( endNode );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Sometimes the endNode will come right before startNode for collapsed\n\t\t\t// ranges. Fix it. (#3780)\n\t\t\tif ( startNode.getPosition( endNode ) & CKEDITOR.POSITION_FOLLOWING )\n\t\t\t\tstartNode = endNode;\n\n\t\t\treturn { startNode: startNode, endNode: endNode };\n\t\t},\n\n\t\t/**\n\t\t * Find the node which fully contains the range.\n\t\t *\n\t\t * @param {Boolean} [includeSelf=false]\n\t\t * @param {Boolean} [ignoreTextNode=false] Whether ignore {@link CKEDITOR#NODE_TEXT} type.\n\t\t * @returns {CKEDITOR.dom.element}\n\t\t */\n\t\tgetCommonAncestor: function( includeSelf, ignoreTextNode ) {\n\t\t\tvar start = this.startContainer,\n\t\t\t\tend = this.endContainer,\n\t\t\t\tancestor;\n\n\t\t\tif ( start.equals( end ) ) {\n\t\t\t\tif ( includeSelf && start.type == CKEDITOR.NODE_ELEMENT && this.startOffset == this.endOffset - 1 )\n\t\t\t\t\tancestor = start.getChild( this.startOffset );\n\t\t\t\telse\n\t\t\t\t\tancestor = start;\n\t\t\t} else {\n\t\t\t\tancestor = start.getCommonAncestor( end );\n\t\t\t}\n\n\t\t\treturn ignoreTextNode && !ancestor.is ? ancestor.getParent() : ancestor;\n\t\t},\n\n\t\t/**\n\t\t * Transforms the {@link #startContainer} and {@link #endContainer} properties from text\n\t\t * nodes to element nodes, whenever possible. This is actually possible\n\t\t * if either of the boundary containers point to a text node, and its\n\t\t * offset is set to zero, or after the last char in the node.\n\t\t */\n\t\toptimize: function() {\n\t\t\tvar container = this.startContainer;\n\t\t\tvar offset = this.startOffset;\n\n\t\t\tif ( container.type != CKEDITOR.NODE_ELEMENT ) {\n\t\t\t\tif ( !offset )\n\t\t\t\t\tthis.setStartBefore( container );\n\t\t\t\telse if ( offset >= container.getLength() )\n\t\t\t\t\tthis.setStartAfter( container );\n\t\t\t}\n\n\t\t\tcontainer = this.endContainer;\n\t\t\toffset = this.endOffset;\n\n\t\t\tif ( container.type != CKEDITOR.NODE_ELEMENT ) {\n\t\t\t\tif ( !offset )\n\t\t\t\t\tthis.setEndBefore( container );\n\t\t\t\telse if ( offset >= container.getLength() )\n\t\t\t\t\tthis.setEndAfter( container );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Move the range out of bookmark nodes if they'd been the container.\n\t\t */\n\t\toptimizeBookmark: function() {\n\t\t\tvar startNode = this.startContainer,\n\t\t\t\tendNode = this.endContainer;\n\n\t\t\tif ( startNode.is && startNode.is( 'span' ) && startNode.data( 'cke-bookmark' ) )\n\t\t\t\tthis.setStartAt( startNode, CKEDITOR.POSITION_BEFORE_START );\n\t\t\tif ( endNode && endNode.is && endNode.is( 'span' ) && endNode.data( 'cke-bookmark' ) )\n\t\t\t\tthis.setEndAt( endNode, CKEDITOR.POSITION_AFTER_END );\n\t\t},\n\n\t\t/**\n\t\t * @param {Boolean} [ignoreStart=false]\n\t\t * @param {Boolean} [ignoreEnd=false]\n\t\t * @todo precise desc/algorithm\n\t\t */\n\t\ttrim: function( ignoreStart, ignoreEnd ) {\n\t\t\tvar startContainer = this.startContainer,\n\t\t\t\tstartOffset = this.startOffset,\n\t\t\t\tcollapsed = this.collapsed;\n\t\t\tif ( ( !ignoreStart || collapsed ) && startContainer && startContainer.type == CKEDITOR.NODE_TEXT ) {\n\t\t\t\t// If the offset is zero, we just insert the new node before\n\t\t\t\t// the start.\n\t\t\t\tif ( !startOffset ) {\n\t\t\t\t\tstartOffset = startContainer.getIndex();\n\t\t\t\t\tstartContainer = startContainer.getParent();\n\t\t\t\t}\n\t\t\t\t// If the offset is at the end, we'll insert it after the text\n\t\t\t\t// node.\n\t\t\t\telse if ( startOffset >= startContainer.getLength() ) {\n\t\t\t\t\tstartOffset = startContainer.getIndex() + 1;\n\t\t\t\t\tstartContainer = startContainer.getParent();\n\t\t\t\t}\n\t\t\t\t// In other case, we split the text node and insert the new\n\t\t\t\t// node at the split point.\n\t\t\t\telse {\n\t\t\t\t\tvar nextText = startContainer.split( startOffset );\n\n\t\t\t\t\tstartOffset = startContainer.getIndex() + 1;\n\t\t\t\t\tstartContainer = startContainer.getParent();\n\n\t\t\t\t\t// Check all necessity of updating the end boundary.\n\t\t\t\t\tif ( this.startContainer.equals( this.endContainer ) )\n\t\t\t\t\t\tthis.setEnd( nextText, this.endOffset - this.startOffset );\n\t\t\t\t\telse if ( startContainer.equals( this.endContainer ) )\n\t\t\t\t\t\tthis.endOffset += 1;\n\t\t\t\t}\n\n\t\t\t\tthis.setStart( startContainer, startOffset );\n\n\t\t\t\tif ( collapsed ) {\n\t\t\t\t\tthis.collapse( true );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar endContainer = this.endContainer;\n\t\t\tvar endOffset = this.endOffset;\n\n\t\t\tif ( !( ignoreEnd || collapsed ) && endContainer && endContainer.type == CKEDITOR.NODE_TEXT ) {\n\t\t\t\t// If the offset is zero, we just insert the new node before\n\t\t\t\t// the start.\n\t\t\t\tif ( !endOffset ) {\n\t\t\t\t\tendOffset = endContainer.getIndex();\n\t\t\t\t\tendContainer = endContainer.getParent();\n\t\t\t\t}\n\t\t\t\t// If the offset is at the end, we'll insert it after the text\n\t\t\t\t// node.\n\t\t\t\telse if ( endOffset >= endContainer.getLength() ) {\n\t\t\t\t\tendOffset = endContainer.getIndex() + 1;\n\t\t\t\t\tendContainer = endContainer.getParent();\n\t\t\t\t}\n\t\t\t\t// In other case, we split the text node and insert the new\n\t\t\t\t// node at the split point.\n\t\t\t\telse {\n\t\t\t\t\tendContainer.split( endOffset );\n\n\t\t\t\t\tendOffset = endContainer.getIndex() + 1;\n\t\t\t\t\tendContainer = endContainer.getParent();\n\t\t\t\t}\n\n\t\t\t\tthis.setEnd( endContainer, endOffset );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Expands the range so that partial units are completely contained.\n\t\t *\n\t\t * @param unit {Number} The unit type to expand with.\n\t\t * @param {Boolean} [excludeBrs=false] Whether include line-breaks when expanding.\n\t\t */\n\t\tenlarge: function( unit, excludeBrs ) {\n\t\t\tvar leadingWhitespaceRegex = new RegExp( /[^\\s\\ufeff]/ );\n\n\t\t\tswitch ( unit ) {\n\t\t\t\tcase CKEDITOR.ENLARGE_INLINE:\n\t\t\t\t\tvar enlargeInlineOnly = 1;\n\n\t\t\t\t/* falls through */\n\t\t\t\tcase CKEDITOR.ENLARGE_ELEMENT:\n\n\t\t\t\t\tif ( this.collapsed )\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t// Get the common ancestor.\n\t\t\t\t\tvar commonAncestor = this.getCommonAncestor();\n\n\t\t\t\t\tvar boundary = this.root;\n\n\t\t\t\t\t// For each boundary\n\t\t\t\t\t//\t\ta. Depending on its position, find out the first node to be checked (a sibling) or,\n\t\t\t\t\t//\t\t\tif not available, to be enlarge.\n\t\t\t\t\t//\t\tb. Go ahead checking siblings and enlarging the boundary as much as possible until the\n\t\t\t\t\t//\t\t\tcommon ancestor is not reached. After reaching the common ancestor, just save the\n\t\t\t\t\t//\t\t\tenlargeable node to be used later.\n\n\t\t\t\t\tvar startTop, endTop;\n\n\t\t\t\t\tvar enlargeable, sibling, commonReached;\n\n\t\t\t\t\t// Indicates that the node can be added only if whitespace\n\t\t\t\t\t// is available before it.\n\t\t\t\t\tvar needsWhiteSpace = false;\n\t\t\t\t\tvar isWhiteSpace;\n\t\t\t\t\tvar siblingText;\n\n\t\t\t\t\t// Process the start boundary.\n\n\t\t\t\t\tvar container = this.startContainer;\n\t\t\t\t\tvar offset = this.startOffset;\n\n\t\t\t\t\tif ( container.type == CKEDITOR.NODE_TEXT ) {\n\t\t\t\t\t\tif ( offset ) {\n\t\t\t\t\t\t\t// Check if there is any non-space text before the\n\t\t\t\t\t\t\t// offset. Otherwise, container is null.\n\t\t\t\t\t\t\tcontainer = !CKEDITOR.tools.trim( container.substring( 0, offset ) ).length && container;\n\n\t\t\t\t\t\t\t// If we found only whitespace in the node, it\n\t\t\t\t\t\t\t// means that we'll need more whitespace to be able\n\t\t\t\t\t\t\t// to expand. For example, <i> can be expanded in\n\t\t\t\t\t\t\t// \"A <i> [B]</i>\", but not in \"A<i> [B]</i>\".\n\t\t\t\t\t\t\tneedsWhiteSpace = !!container;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( container ) {\n\t\t\t\t\t\t\tif ( !( sibling = container.getPrevious() ) )\n\t\t\t\t\t\t\t\tenlargeable = container.getParent();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// If we have offset, get the node preceeding it as the\n\t\t\t\t\t\t// first sibling to be checked.\n\t\t\t\t\t\tif ( offset )\n\t\t\t\t\t\t\tsibling = container.getChild( offset - 1 ) || container.getLast();\n\n\t\t\t\t\t\t// If there is no sibling, mark the container to be\n\t\t\t\t\t\t// enlarged.\n\t\t\t\t\t\tif ( !sibling )\n\t\t\t\t\t\t\tenlargeable = container;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Ensures that enlargeable can be indeed enlarged, if not it will be nulled.\n\t\t\t\t\tenlargeable = getValidEnlargeable( enlargeable );\n\n\t\t\t\t\twhile ( enlargeable || sibling ) {\n\t\t\t\t\t\tif ( enlargeable && !sibling ) {\n\t\t\t\t\t\t\t// If we reached the common ancestor, mark the flag\n\t\t\t\t\t\t\t// for it.\n\t\t\t\t\t\t\tif ( !commonReached && enlargeable.equals( commonAncestor ) )\n\t\t\t\t\t\t\t\tcommonReached = true;\n\n\t\t\t\t\t\t\tif ( enlargeInlineOnly ? enlargeable.isBlockBoundary() : !boundary.contains( enlargeable ) )\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t// If we don't need space or this element breaks\n\t\t\t\t\t\t\t// the line, then enlarge it.\n\t\t\t\t\t\t\tif ( !needsWhiteSpace || enlargeable.getComputedStyle( 'display' ) != 'inline' ) {\n\t\t\t\t\t\t\t\tneedsWhiteSpace = false;\n\n\t\t\t\t\t\t\t\t// If the common ancestor has been reached,\n\t\t\t\t\t\t\t\t// we'll not enlarge it immediately, but just\n\t\t\t\t\t\t\t\t// mark it to be enlarged later if the end\n\t\t\t\t\t\t\t\t// boundary also enlarges it.\n\t\t\t\t\t\t\t\tif ( commonReached )\n\t\t\t\t\t\t\t\t\tstartTop = enlargeable;\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\tthis.setStartBefore( enlargeable );\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tsibling = enlargeable.getPrevious();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Check all sibling nodes preceeding the enlargeable\n\t\t\t\t\t\t// node. The node wil lbe enlarged only if none of them\n\t\t\t\t\t\t// blocks it.\n\t\t\t\t\t\twhile ( sibling ) {\n\t\t\t\t\t\t\t// This flag indicates that this node has\n\t\t\t\t\t\t\t// whitespaces at the end.\n\t\t\t\t\t\t\tisWhiteSpace = false;\n\n\t\t\t\t\t\t\tif ( sibling.type == CKEDITOR.NODE_COMMENT ) {\n\t\t\t\t\t\t\t\tsibling = sibling.getPrevious();\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t} else if ( sibling.type == CKEDITOR.NODE_TEXT ) {\n\t\t\t\t\t\t\t\tsiblingText = sibling.getText();\n\n\t\t\t\t\t\t\t\tif ( leadingWhitespaceRegex.test( siblingText ) )\n\t\t\t\t\t\t\t\t\tsibling = null;\n\n\t\t\t\t\t\t\t\tisWhiteSpace = /[\\s\\ufeff]$/.test( siblingText );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// #12221 (Chrome) plus #11111 (Safari).\n\t\t\t\t\t\t\t\tvar offsetWidth0 = CKEDITOR.env.webkit ? 1 : 0;\n\n\t\t\t\t\t\t\t\t// If this is a visible element.\n\t\t\t\t\t\t\t\t// We need to check for the bookmark attribute because IE insists on\n\t\t\t\t\t\t\t\t// rendering the display:none nodes we use for bookmarks. (#3363)\n\t\t\t\t\t\t\t\t// Line-breaks (br) are rendered with zero width, which we don't want to include. (#7041)\n\t\t\t\t\t\t\t\tif ( ( sibling.$.offsetWidth > offsetWidth0 || excludeBrs && sibling.is( 'br' ) ) && !sibling.data( 'cke-bookmark' ) ) {\n\t\t\t\t\t\t\t\t\t// We'll accept it only if we need\n\t\t\t\t\t\t\t\t\t// whitespace, and this is an inline\n\t\t\t\t\t\t\t\t\t// element with whitespace only.\n\t\t\t\t\t\t\t\t\tif ( needsWhiteSpace && CKEDITOR.dtd.$removeEmpty[ sibling.getName() ] ) {\n\t\t\t\t\t\t\t\t\t\t// It must contains spaces and inline elements only.\n\n\t\t\t\t\t\t\t\t\t\tsiblingText = sibling.getText();\n\n\t\t\t\t\t\t\t\t\t\tif ( leadingWhitespaceRegex.test( siblingText ) ) // Spaces + Zero Width No-Break Space (U+FEFF)\n\t\t\t\t\t\t\t\t\t\tsibling = null;\n\t\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\t\tvar allChildren = sibling.$.getElementsByTagName( '*' );\n\t\t\t\t\t\t\t\t\t\t\tfor ( var i = 0, child; child = allChildren[ i++ ]; ) {\n\t\t\t\t\t\t\t\t\t\t\t\tif ( !CKEDITOR.dtd.$removeEmpty[ child.nodeName.toLowerCase() ] ) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tsibling = null;\n\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tif ( sibling )\n\t\t\t\t\t\t\t\t\t\t\tisWhiteSpace = !!siblingText.length;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tsibling = null;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// A node with whitespaces has been found.\n\t\t\t\t\t\t\tif ( isWhiteSpace ) {\n\t\t\t\t\t\t\t\t// Enlarge the last enlargeable node, if we\n\t\t\t\t\t\t\t\t// were waiting for spaces.\n\t\t\t\t\t\t\t\tif ( needsWhiteSpace ) {\n\t\t\t\t\t\t\t\t\tif ( commonReached )\n\t\t\t\t\t\t\t\t\t\tstartTop = enlargeable;\n\t\t\t\t\t\t\t\t\telse if ( enlargeable )\n\t\t\t\t\t\t\t\t\t\tthis.setStartBefore( enlargeable );\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tneedsWhiteSpace = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( sibling ) {\n\t\t\t\t\t\t\t\tvar next = sibling.getPrevious();\n\n\t\t\t\t\t\t\t\tif ( !enlargeable && !next ) {\n\t\t\t\t\t\t\t\t\t// Set the sibling as enlargeable, so it's\n\t\t\t\t\t\t\t\t\t// parent will be get later outside this while.\n\t\t\t\t\t\t\t\t\tenlargeable = sibling;\n\t\t\t\t\t\t\t\t\tsibling = null;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tsibling = next;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// If sibling has been set to null, then we\n\t\t\t\t\t\t\t\t// need to stop enlarging.\n\t\t\t\t\t\t\t\tenlargeable = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( enlargeable )\n\t\t\t\t\t\t\tenlargeable = getValidEnlargeable( enlargeable.getParent() );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Process the end boundary. This is basically the same\n\t\t\t\t\t// code used for the start boundary, with small changes to\n\t\t\t\t\t// make it work in the oposite side (to the right). This\n\t\t\t\t\t// makes it difficult to reuse the code here. So, fixes to\n\t\t\t\t\t// the above code are likely to be replicated here.\n\n\t\t\t\t\tcontainer = this.endContainer;\n\t\t\t\t\toffset = this.endOffset;\n\n\t\t\t\t\t// Reset the common variables.\n\t\t\t\t\tenlargeable = sibling = null;\n\t\t\t\t\tcommonReached = needsWhiteSpace = false;\n\n\t\t\t\t\t// Function check if there are only whitespaces from the given starting point\n\t\t\t\t\t// (startContainer and startOffset) till the end on block.\n\t\t\t\t\t// Examples (\"[\" is the start point):\n\t\t\t\t\t//  - <p>foo[ </p>           - will return true,\n\t\t\t\t\t//  - <p><b>foo[ </b> </p>   - will return true,\n\t\t\t\t\t//  - <p>foo[ bar</p>        - will return false,\n\t\t\t\t\t//  - <p><b>foo[ </b>bar</p> - will return false,\n\t\t\t\t\t//  - <p>foo[ <b></b></p>    - will return false.\n\t\t\t\t\tfunction onlyWhiteSpaces( startContainer, startOffset ) {\n\t\t\t\t\t\t// We need to enlarge range if there is white space at the end of the block,\n\t\t\t\t\t\t// because it is not displayed in WYSIWYG mode and user can not select it. So\n\t\t\t\t\t\t// \"<p>foo[bar] </p>\" should be changed to \"<p>foo[bar ]</p>\". On the other hand\n\t\t\t\t\t\t// we should do nothing if we are not at the end of the block, so this should not\n\t\t\t\t\t\t// be changed: \"<p><i>[foo] </i>bar</p>\".\n\t\t\t\t\t\tvar walkerRange = new CKEDITOR.dom.range( boundary );\n\t\t\t\t\t\twalkerRange.setStart( startContainer, startOffset );\n\t\t\t\t\t\t// The guard will find the end of range so I put boundary here.\n\t\t\t\t\t\twalkerRange.setEndAt( boundary, CKEDITOR.POSITION_BEFORE_END );\n\n\t\t\t\t\t\tvar walker = new CKEDITOR.dom.walker( walkerRange ),\n\t\t\t\t\t\t\tnode;\n\n\t\t\t\t\t\twalker.guard = function( node ) {\n\t\t\t\t\t\t\t// Stop if you exit block.\n\t\t\t\t\t\t\treturn !( node.type == CKEDITOR.NODE_ELEMENT && node.isBlockBoundary() );\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\twhile ( ( node = walker.next() ) ) {\n\t\t\t\t\t\t\tif ( node.type != CKEDITOR.NODE_TEXT ) {\n\t\t\t\t\t\t\t\t// Stop if you enter to any node (walker.next() will return node only\n\t\t\t\t\t\t\t\t// it goes out, not if it is go into node).\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// Trim the first node to startOffset.\n\t\t\t\t\t\t\t\tif ( node != startContainer )\n\t\t\t\t\t\t\t\t\tsiblingText = node.getText();\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\tsiblingText = node.substring( startOffset );\n\n\t\t\t\t\t\t\t\t// Check if it is white space.\n\t\t\t\t\t\t\t\tif ( leadingWhitespaceRegex.test( siblingText ) )\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( container.type == CKEDITOR.NODE_TEXT ) {\n\t\t\t\t\t\t// Check if there is only white space after the offset.\n\t\t\t\t\t\tif ( CKEDITOR.tools.trim( container.substring( offset ) ).length ) {\n\t\t\t\t\t\t\t// If we found only whitespace in the node, it\n\t\t\t\t\t\t\t// means that we'll need more whitespace to be able\n\t\t\t\t\t\t\t// to expand. For example, <i> can be expanded in\n\t\t\t\t\t\t\t// \"A <i> [B]</i>\", but not in \"A<i> [B]</i>\".\n\t\t\t\t\t\t\tneedsWhiteSpace = true;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tneedsWhiteSpace = !container.getLength();\n\n\t\t\t\t\t\t\tif ( offset == container.getLength() ) {\n\t\t\t\t\t\t\t\t// If we are at the end of container and this is the last text node,\n\t\t\t\t\t\t\t\t// we should enlarge end to the parent.\n\t\t\t\t\t\t\t\tif ( !( sibling = container.getNext() ) )\n\t\t\t\t\t\t\t\t\tenlargeable = container.getParent();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// If we are in the middle on text node and there are only whitespaces\n\t\t\t\t\t\t\t\t// till the end of block, we should enlarge element.\n\t\t\t\t\t\t\t\tif ( onlyWhiteSpaces( container, offset ) )\n\t\t\t\t\t\t\t\t\tenlargeable = container.getParent();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Get the node right after the boudary to be checked\n\t\t\t\t\t\t// first.\n\t\t\t\t\t\tsibling = container.getChild( offset );\n\n\t\t\t\t\t\tif ( !sibling )\n\t\t\t\t\t\t\tenlargeable = container;\n\t\t\t\t\t}\n\n\t\t\t\t\twhile ( enlargeable || sibling ) {\n\t\t\t\t\t\tif ( enlargeable && !sibling ) {\n\t\t\t\t\t\t\tif ( !commonReached && enlargeable.equals( commonAncestor ) )\n\t\t\t\t\t\t\t\tcommonReached = true;\n\n\t\t\t\t\t\t\tif ( enlargeInlineOnly ? enlargeable.isBlockBoundary() : !boundary.contains( enlargeable ) )\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tif ( !needsWhiteSpace || enlargeable.getComputedStyle( 'display' ) != 'inline' ) {\n\t\t\t\t\t\t\t\tneedsWhiteSpace = false;\n\n\t\t\t\t\t\t\t\tif ( commonReached )\n\t\t\t\t\t\t\t\t\tendTop = enlargeable;\n\t\t\t\t\t\t\t\telse if ( enlargeable )\n\t\t\t\t\t\t\t\t\tthis.setEndAfter( enlargeable );\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tsibling = enlargeable.getNext();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\twhile ( sibling ) {\n\t\t\t\t\t\t\tisWhiteSpace = false;\n\n\t\t\t\t\t\t\tif ( sibling.type == CKEDITOR.NODE_TEXT ) {\n\t\t\t\t\t\t\t\tsiblingText = sibling.getText();\n\n\t\t\t\t\t\t\t\t// Check if there are not whitespace characters till the end of editable.\n\t\t\t\t\t\t\t\t// If so stop expanding.\n\t\t\t\t\t\t\t\tif ( !onlyWhiteSpaces( sibling, 0 ) )\n\t\t\t\t\t\t\t\t\tsibling = null;\n\n\t\t\t\t\t\t\t\tisWhiteSpace = /^[\\s\\ufeff]/.test( siblingText );\n\t\t\t\t\t\t\t} else if ( sibling.type == CKEDITOR.NODE_ELEMENT ) {\n\t\t\t\t\t\t\t\t// If this is a visible element.\n\t\t\t\t\t\t\t\t// We need to check for the bookmark attribute because IE insists on\n\t\t\t\t\t\t\t\t// rendering the display:none nodes we use for bookmarks. (#3363)\n\t\t\t\t\t\t\t\t// Line-breaks (br) are rendered with zero width, which we don't want to include. (#7041)\n\t\t\t\t\t\t\t\tif ( ( sibling.$.offsetWidth > 0 || excludeBrs && sibling.is( 'br' ) ) && !sibling.data( 'cke-bookmark' ) ) {\n\t\t\t\t\t\t\t\t\t// We'll accept it only if we need\n\t\t\t\t\t\t\t\t\t// whitespace, and this is an inline\n\t\t\t\t\t\t\t\t\t// element with whitespace only.\n\t\t\t\t\t\t\t\t\tif ( needsWhiteSpace && CKEDITOR.dtd.$removeEmpty[ sibling.getName() ] ) {\n\t\t\t\t\t\t\t\t\t\t// It must contains spaces and inline elements only.\n\n\t\t\t\t\t\t\t\t\t\tsiblingText = sibling.getText();\n\n\t\t\t\t\t\t\t\t\t\tif ( leadingWhitespaceRegex.test( siblingText ) )\n\t\t\t\t\t\t\t\t\t\t\tsibling = null;\n\t\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\t\tallChildren = sibling.$.getElementsByTagName( '*' );\n\t\t\t\t\t\t\t\t\t\t\tfor ( i = 0; child = allChildren[ i++ ]; ) {\n\t\t\t\t\t\t\t\t\t\t\t\tif ( !CKEDITOR.dtd.$removeEmpty[ child.nodeName.toLowerCase() ] ) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tsibling = null;\n\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tif ( sibling )\n\t\t\t\t\t\t\t\t\t\t\tisWhiteSpace = !!siblingText.length;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tsibling = null;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tisWhiteSpace = 1;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( isWhiteSpace ) {\n\t\t\t\t\t\t\t\tif ( needsWhiteSpace ) {\n\t\t\t\t\t\t\t\t\tif ( commonReached )\n\t\t\t\t\t\t\t\t\t\tendTop = enlargeable;\n\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\tthis.setEndAfter( enlargeable );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( sibling ) {\n\t\t\t\t\t\t\t\tnext = sibling.getNext();\n\n\t\t\t\t\t\t\t\tif ( !enlargeable && !next ) {\n\t\t\t\t\t\t\t\t\tenlargeable = sibling;\n\t\t\t\t\t\t\t\t\tsibling = null;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tsibling = next;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// If sibling has been set to null, then we\n\t\t\t\t\t\t\t\t// need to stop enlarging.\n\t\t\t\t\t\t\t\tenlargeable = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( enlargeable )\n\t\t\t\t\t\t\tenlargeable = getValidEnlargeable( enlargeable.getParent() );\n\t\t\t\t\t}\n\n\t\t\t\t\t// If the common ancestor can be enlarged by both boundaries, then include it also.\n\t\t\t\t\tif ( startTop && endTop ) {\n\t\t\t\t\t\tcommonAncestor = startTop.contains( endTop ) ? endTop : startTop;\n\n\t\t\t\t\t\tthis.setStartBefore( commonAncestor );\n\t\t\t\t\t\tthis.setEndAfter( commonAncestor );\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase CKEDITOR.ENLARGE_BLOCK_CONTENTS:\n\t\t\t\tcase CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS:\n\n\t\t\t\t\t// Enlarging the start boundary.\n\t\t\t\t\tvar walkerRange = new CKEDITOR.dom.range( this.root );\n\n\t\t\t\t\tboundary = this.root;\n\n\t\t\t\t\twalkerRange.setStartAt( boundary, CKEDITOR.POSITION_AFTER_START );\n\t\t\t\t\twalkerRange.setEnd( this.startContainer, this.startOffset );\n\n\t\t\t\t\tvar walker = new CKEDITOR.dom.walker( walkerRange ),\n\t\t\t\t\t\tblockBoundary, // The node on which the enlarging should stop.\n\t\t\t\t\t\ttailBr, // In case BR as block boundary.\n\t\t\t\t\t\tnotBlockBoundary = CKEDITOR.dom.walker.blockBoundary( ( unit == CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS ) ? { br: 1 } : null ),\n\t\t\t\t\t\tinNonEditable = null,\n\t\t\t\t\t\t// Record the encountered 'blockBoundary' for later use.\n\t\t\t\t\t\tboundaryGuard = function( node ) {\n\t\t\t\t\t\t\t// We should not check contents of non-editable elements. It may happen\n\t\t\t\t\t\t\t// that inline widget has display:table child which should not block range#enlarge.\n\t\t\t\t\t\t\t// When encoutered non-editable element...\n\t\t\t\t\t\t\tif ( node.type == CKEDITOR.NODE_ELEMENT && node.getAttribute( 'contenteditable' ) == 'false' ) {\n\t\t\t\t\t\t\t\tif ( inNonEditable ) {\n\t\t\t\t\t\t\t\t\t// ... in which we already were, reset it (because we're leaving it) and return.\n\t\t\t\t\t\t\t\t\tif ( inNonEditable.equals( node ) ) {\n\t\t\t\t\t\t\t\t\t\tinNonEditable = null;\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// ... which we're entering, remember it but check it (no return).\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tinNonEditable = node;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// When we are in non-editable element, do not check if current node is a block boundary.\n\t\t\t\t\t\t\t} else if ( inNonEditable ) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tvar retval = notBlockBoundary( node );\n\t\t\t\t\t\t\tif ( !retval )\n\t\t\t\t\t\t\t\tblockBoundary = node;\n\t\t\t\t\t\t\treturn retval;\n\t\t\t\t\t\t},\n\t\t\t\t\t\t// Record the encounted 'tailBr' for later use.\n\t\t\t\t\t\ttailBrGuard = function( node ) {\n\t\t\t\t\t\t\tvar retval = boundaryGuard( node );\n\t\t\t\t\t\t\tif ( !retval && node.is && node.is( 'br' ) )\n\t\t\t\t\t\t\t\ttailBr = node;\n\t\t\t\t\t\t\treturn retval;\n\t\t\t\t\t\t};\n\n\t\t\t\t\twalker.guard = boundaryGuard;\n\n\t\t\t\t\tenlargeable = walker.lastBackward();\n\n\t\t\t\t\t// It's the body which stop the enlarging if no block boundary found.\n\t\t\t\t\tblockBoundary = blockBoundary || boundary;\n\n\t\t\t\t\t// Start the range either after the end of found block (<p>...</p>[text)\n\t\t\t\t\t// or at the start of block (<p>[text...), by comparing the document position\n\t\t\t\t\t// with 'enlargeable' node.\n\t\t\t\t\tthis.setStartAt( blockBoundary, !blockBoundary.is( 'br' ) && ( !enlargeable && this.checkStartOfBlock() ||\n\t\t\t\t\t\tenlargeable && blockBoundary.contains( enlargeable ) ) ? CKEDITOR.POSITION_AFTER_START : CKEDITOR.POSITION_AFTER_END );\n\n\t\t\t\t\t// Avoid enlarging the range further when end boundary spans right after the BR. (#7490)\n\t\t\t\t\tif ( unit == CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS ) {\n\t\t\t\t\t\tvar theRange = this.clone();\n\t\t\t\t\t\twalker = new CKEDITOR.dom.walker( theRange );\n\n\t\t\t\t\t\tvar whitespaces = CKEDITOR.dom.walker.whitespaces(),\n\t\t\t\t\t\t\tbookmark = CKEDITOR.dom.walker.bookmark();\n\n\t\t\t\t\t\twalker.evaluator = function( node ) {\n\t\t\t\t\t\t\treturn !whitespaces( node ) && !bookmark( node );\n\t\t\t\t\t\t};\n\t\t\t\t\t\tvar previous = walker.previous();\n\t\t\t\t\t\tif ( previous && previous.type == CKEDITOR.NODE_ELEMENT && previous.is( 'br' ) )\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Enlarging the end boundary.\n\t\t\t\t\t// Set up new range and reset all flags (blockBoundary, inNonEditable, tailBr).\n\n\t\t\t\t\twalkerRange = this.clone();\n\t\t\t\t\twalkerRange.collapse();\n\t\t\t\t\twalkerRange.setEndAt( boundary, CKEDITOR.POSITION_BEFORE_END );\n\t\t\t\t\twalker = new CKEDITOR.dom.walker( walkerRange );\n\n\t\t\t\t\t// tailBrGuard only used for on range end.\n\t\t\t\t\twalker.guard = ( unit == CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS ) ? tailBrGuard : boundaryGuard;\n\t\t\t\t\tblockBoundary = inNonEditable = tailBr = null;\n\n\t\t\t\t\t// End the range right before the block boundary node.\n\t\t\t\t\tenlargeable = walker.lastForward();\n\n\t\t\t\t\t// It's the body which stop the enlarging if no block boundary found.\n\t\t\t\t\tblockBoundary = blockBoundary || boundary;\n\n\t\t\t\t\t// Close the range either before the found block start (text]<p>...</p>) or at the block end (...text]</p>)\n\t\t\t\t\t// by comparing the document position with 'enlargeable' node.\n\t\t\t\t\tthis.setEndAt( blockBoundary, ( !enlargeable && this.checkEndOfBlock() ||\n\t\t\t\t\t\tenlargeable && blockBoundary.contains( enlargeable ) ) ? CKEDITOR.POSITION_BEFORE_END : CKEDITOR.POSITION_BEFORE_START );\n\t\t\t\t\t// We must include the <br> at the end of range if there's\n\t\t\t\t\t// one and we're expanding list item contents\n\t\t\t\t\tif ( tailBr ) {\n\t\t\t\t\t\tthis.setEndAfter( tailBr );\n\t\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Ensures that returned element can be enlarged by selection, null otherwise.\n\t\t\t// @param {CKEDITOR.dom.element} enlargeable\n\t\t\t// @returns {CKEDITOR.dom.element/null}\n\t\t\tfunction getValidEnlargeable( enlargeable ) {\n\t\t\t\treturn enlargeable && enlargeable.type == CKEDITOR.NODE_ELEMENT && enlargeable.hasAttribute( 'contenteditable' ) ?\n\t\t\t\t\tnull : enlargeable;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Descrease the range to make sure that boundaries\n\t\t * always anchor beside text nodes or innermost element.\n\t\t *\n\t\t * @param {Number} mode The shrinking mode ({@link CKEDITOR#SHRINK_ELEMENT} or {@link CKEDITOR#SHRINK_TEXT}).\n\t\t *\n\t\t * * {@link CKEDITOR#SHRINK_ELEMENT} - Shrink the range boundaries to the edge of the innermost element.\n\t\t * * {@link CKEDITOR#SHRINK_TEXT} - Shrink the range boudaries to anchor by the side of enclosed text\n\t\t *     node, range remains if there's no text nodes on boundaries at all.\n\t\t *\n\t\t * @param {Boolean} selectContents Whether result range anchors at the inner OR outer boundary of the node.\n\t\t */\n\t\tshrink: function( mode, selectContents, shrinkOnBlockBoundary ) {\n\t\t\t// Unable to shrink a collapsed range.\n\t\t\tif ( !this.collapsed ) {\n\t\t\t\tmode = mode || CKEDITOR.SHRINK_TEXT;\n\n\t\t\t\tvar walkerRange = this.clone();\n\n\t\t\t\tvar startContainer = this.startContainer,\n\t\t\t\t\tendContainer = this.endContainer,\n\t\t\t\t\tstartOffset = this.startOffset,\n\t\t\t\t\tendOffset = this.endOffset;\n\n\t\t\t\t// Whether the start/end boundary is moveable.\n\t\t\t\tvar moveStart = 1,\n\t\t\t\t\tmoveEnd = 1;\n\n\t\t\t\tif ( startContainer && startContainer.type == CKEDITOR.NODE_TEXT ) {\n\t\t\t\t\tif ( !startOffset )\n\t\t\t\t\t\twalkerRange.setStartBefore( startContainer );\n\t\t\t\t\telse if ( startOffset >= startContainer.getLength() )\n\t\t\t\t\t\twalkerRange.setStartAfter( startContainer );\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Enlarge the range properly to avoid walker making\n\t\t\t\t\t\t// DOM changes caused by triming the text nodes later.\n\t\t\t\t\t\twalkerRange.setStartBefore( startContainer );\n\t\t\t\t\t\tmoveStart = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( endContainer && endContainer.type == CKEDITOR.NODE_TEXT ) {\n\t\t\t\t\tif ( !endOffset )\n\t\t\t\t\t\twalkerRange.setEndBefore( endContainer );\n\t\t\t\t\telse if ( endOffset >= endContainer.getLength() )\n\t\t\t\t\t\twalkerRange.setEndAfter( endContainer );\n\t\t\t\t\telse {\n\t\t\t\t\t\twalkerRange.setEndAfter( endContainer );\n\t\t\t\t\t\tmoveEnd = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar walker = new CKEDITOR.dom.walker( walkerRange ),\n\t\t\t\t\tisBookmark = CKEDITOR.dom.walker.bookmark();\n\n\t\t\t\twalker.evaluator = function( node ) {\n\t\t\t\t\treturn node.type == ( mode == CKEDITOR.SHRINK_ELEMENT ? CKEDITOR.NODE_ELEMENT : CKEDITOR.NODE_TEXT );\n\t\t\t\t};\n\n\t\t\t\tvar currentElement;\n\t\t\t\twalker.guard = function( node, movingOut ) {\n\t\t\t\t\tif ( isBookmark( node ) )\n\t\t\t\t\t\treturn true;\n\n\t\t\t\t\t// Stop when we're shrink in element mode while encountering a text node.\n\t\t\t\t\tif ( mode == CKEDITOR.SHRINK_ELEMENT && node.type == CKEDITOR.NODE_TEXT )\n\t\t\t\t\t\treturn false;\n\n\t\t\t\t\t// Stop when we've already walked \"through\" an element.\n\t\t\t\t\tif ( movingOut && node.equals( currentElement ) )\n\t\t\t\t\t\treturn false;\n\n\t\t\t\t\tif ( shrinkOnBlockBoundary === false && node.type == CKEDITOR.NODE_ELEMENT && node.isBlockBoundary() )\n\t\t\t\t\t\treturn false;\n\n\t\t\t\t\t// Stop shrinking when encountering an editable border.\n\t\t\t\t\tif ( node.type == CKEDITOR.NODE_ELEMENT && node.hasAttribute( 'contenteditable' ) )\n\t\t\t\t\t\treturn false;\n\n\t\t\t\t\tif ( !movingOut && node.type == CKEDITOR.NODE_ELEMENT )\n\t\t\t\t\t\tcurrentElement = node;\n\n\t\t\t\t\treturn true;\n\t\t\t\t};\n\n\t\t\t\tif ( moveStart ) {\n\t\t\t\t\tvar textStart = walker[ mode == CKEDITOR.SHRINK_ELEMENT ? 'lastForward' : 'next' ]();\n\t\t\t\t\ttextStart && this.setStartAt( textStart, selectContents ? CKEDITOR.POSITION_AFTER_START : CKEDITOR.POSITION_BEFORE_START );\n\t\t\t\t}\n\n\t\t\t\tif ( moveEnd ) {\n\t\t\t\t\twalker.reset();\n\t\t\t\t\tvar textEnd = walker[ mode == CKEDITOR.SHRINK_ELEMENT ? 'lastBackward' : 'previous' ]();\n\t\t\t\t\ttextEnd && this.setEndAt( textEnd, selectContents ? CKEDITOR.POSITION_BEFORE_END : CKEDITOR.POSITION_AFTER_END );\n\t\t\t\t}\n\n\t\t\t\treturn !!( moveStart || moveEnd );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Inserts a node at the start of the range. The range will be expanded\n\t\t * the contain the node.\n\t\t *\n\t\t * @param {CKEDITOR.dom.node} node\n\t\t */\n\t\tinsertNode: function( node ) {\n\t\t\tthis.optimizeBookmark();\n\t\t\tthis.trim( false, true );\n\n\t\t\tvar startContainer = this.startContainer;\n\t\t\tvar startOffset = this.startOffset;\n\n\t\t\tvar nextNode = startContainer.getChild( startOffset );\n\n\t\t\tif ( nextNode )\n\t\t\t\tnode.insertBefore( nextNode );\n\t\t\telse\n\t\t\t\tstartContainer.append( node );\n\n\t\t\t// Check if we need to update the end boundary.\n\t\t\tif ( node.getParent() && node.getParent().equals( this.endContainer ) )\n\t\t\t\tthis.endOffset++;\n\n\t\t\t// Expand the range to embrace the new node.\n\t\t\tthis.setStartBefore( node );\n\t\t},\n\n\t\t/**\n\t\t * Moves the range to given position according to specified node.\n\t\t *\n\t\t *\t\t// HTML: <p>Foo <b>bar</b></p>\n\t\t *\t\trange.moveToPosition( elB, CKEDITOR.POSITION_BEFORE_START );\n\t\t *\t\t// Range will be moved to: <p>Foo ^<b>bar</b></p>\n\t\t *\n\t\t * See also {@link #setStartAt} and {@link #setEndAt}.\n\t\t *\n\t\t * @param {CKEDITOR.dom.node} node The node according to which position will be set.\n\t\t * @param {Number} position One of {@link CKEDITOR#POSITION_BEFORE_START},\n\t\t * {@link CKEDITOR#POSITION_AFTER_START}, {@link CKEDITOR#POSITION_BEFORE_END},\n\t\t * {@link CKEDITOR#POSITION_AFTER_END}.\n\t\t */\n\t\tmoveToPosition: function( node, position ) {\n\t\t\tthis.setStartAt( node, position );\n\t\t\tthis.collapse( true );\n\t\t},\n\n\t\t/**\n\t\t * Moves the range to the exact position of the specified range.\n\t\t *\n\t\t * @param {CKEDITOR.dom.range} range\n\t\t */\n\t\tmoveToRange: function( range ) {\n\t\t\tthis.setStart( range.startContainer, range.startOffset );\n\t\t\tthis.setEnd( range.endContainer, range.endOffset );\n\t\t},\n\n\t\t/**\n\t\t * Select nodes content. Range will start and end inside this node.\n\t\t *\n\t\t * @param {CKEDITOR.dom.node} node\n\t\t */\n\t\tselectNodeContents: function( node ) {\n\t\t\tthis.setStart( node, 0 );\n\t\t\tthis.setEnd( node, node.type == CKEDITOR.NODE_TEXT ? node.getLength() : node.getChildCount() );\n\t\t},\n\n\t\t/**\n\t\t * Sets the start position of a range.\n\t\t *\n\t\t * @param {CKEDITOR.dom.node} startNode The node to start the range.\n\t\t * @param {Number} startOffset An integer greater than or equal to zero\n\t\t * representing the offset for the start of the range from the start\n\t\t * of `startNode`.\n\t\t */\n\t\tsetStart: function( startNode, startOffset ) {\n\t\t\t// W3C requires a check for the new position. If it is after the end\n\t\t\t// boundary, the range should be collapsed to the new start. It seams\n\t\t\t// we will not need this check for our use of this class so we can\n\t\t\t// ignore it for now.\n\n\t\t\t// Fixing invalid range start inside dtd empty elements.\n\t\t\tif ( startNode.type == CKEDITOR.NODE_ELEMENT && CKEDITOR.dtd.$empty[ startNode.getName() ] )\n\t\t\t\tstartOffset = startNode.getIndex(), startNode = startNode.getParent();\n\n\t\t\tthis._setStartContainer( startNode );\n\t\t\tthis.startOffset = startOffset;\n\n\t\t\tif ( !this.endContainer ) {\n\t\t\t\tthis._setEndContainer( startNode );\n\t\t\t\tthis.endOffset = startOffset;\n\t\t\t}\n\n\t\t\tupdateCollapsed( this );\n\t\t},\n\n\t\t/**\n\t\t * Sets the end position of a Range.\n\t\t *\n\t\t * @param {CKEDITOR.dom.node} endNode The node to end the range.\n\t\t * @param {Number} endOffset An integer greater than or equal to zero\n\t\t * representing the offset for the end of the range from the start\n\t\t * of `endNode`.\n\t\t */\n\t\tsetEnd: function( endNode, endOffset ) {\n\t\t\t// W3C requires a check for the new position. If it is before the start\n\t\t\t// boundary, the range should be collapsed to the new end. It seams we\n\t\t\t// will not need this check for our use of this class so we can ignore\n\t\t\t// it for now.\n\n\t\t\t// Fixing invalid range end inside dtd empty elements.\n\t\t\tif ( endNode.type == CKEDITOR.NODE_ELEMENT && CKEDITOR.dtd.$empty[ endNode.getName() ] )\n\t\t\t\tendOffset = endNode.getIndex() + 1, endNode = endNode.getParent();\n\n\t\t\tthis._setEndContainer( endNode );\n\t\t\tthis.endOffset = endOffset;\n\n\t\t\tif ( !this.startContainer ) {\n\t\t\t\tthis._setStartContainer( endNode );\n\t\t\t\tthis.startOffset = endOffset;\n\t\t\t}\n\n\t\t\tupdateCollapsed( this );\n\t\t},\n\n\t\t/**\n\t\t * Sets start of this range after the specified node.\n\t\t *\n\t\t *\t\t// Range: <p>foo<b>bar</b>^</p>\n\t\t *\t\trange.setStartAfter( textFoo );\n\t\t *\t\t// The range will be changed to:\n\t\t *\t\t// <p>foo[<b>bar</b>]</p>\n\t\t *\n\t\t * @param {CKEDITOR.dom.node} node\n\t\t */\n\t\tsetStartAfter: function( node ) {\n\t\t\tthis.setStart( node.getParent(), node.getIndex() + 1 );\n\t\t},\n\n\t\t/**\n\t\t * Sets start of this range after the specified node.\n\t\t *\n\t\t *\t\t// Range: <p>foo<b>bar</b>^</p>\n\t\t *\t\trange.setStartBefore( elB );\n\t\t *\t\t// The range will be changed to:\n\t\t *\t\t// <p>foo[<b>bar</b>]</p>\n\t\t *\n\t\t * @param {CKEDITOR.dom.node} node\n\t\t */\n\t\tsetStartBefore: function( node ) {\n\t\t\tthis.setStart( node.getParent(), node.getIndex() );\n\t\t},\n\n\t\t/**\n\t\t * Sets end of this range after the specified node.\n\t\t *\n\t\t *\t\t// Range: <p>foo^<b>bar</b></p>\n\t\t *\t\trange.setEndAfter( elB );\n\t\t *\t\t// The range will be changed to:\n\t\t *\t\t// <p>foo[<b>bar</b>]</p>\n\t\t *\n\t\t * @param {CKEDITOR.dom.node} node\n\t\t */\n\t\tsetEndAfter: function( node ) {\n\t\t\tthis.setEnd( node.getParent(), node.getIndex() + 1 );\n\t\t},\n\n\t\t/**\n\t\t * Sets end of this range before the specified node.\n\t\t *\n\t\t *\t\t// Range: <p>^foo<b>bar</b></p>\n\t\t *\t\trange.setStartAfter( textBar );\n\t\t *\t\t// The range will be changed to:\n\t\t *\t\t// <p>[foo<b>]bar</b></p>\n\t\t *\n\t\t * @param {CKEDITOR.dom.node} node\n\t\t */\n\t\tsetEndBefore: function( node ) {\n\t\t\tthis.setEnd( node.getParent(), node.getIndex() );\n\t\t},\n\n\t\t/**\n\t\t * Moves the start of this range to given position according to specified node.\n\t\t *\n\t\t *\t\t// HTML: <p>Foo <b>bar</b>^</p>\n\t\t *\t\trange.setStartAt( elB, CKEDITOR.POSITION_AFTER_START );\n\t\t *\t\t// The range will be changed to:\n\t\t *\t\t// <p>Foo <b>[bar</b>]</p>\n\t\t *\n\t\t * See also {@link #setEndAt} and {@link #moveToPosition}.\n\t\t *\n\t\t * @param {CKEDITOR.dom.node} node The node according to which position will be set.\n\t\t * @param {Number} position One of {@link CKEDITOR#POSITION_BEFORE_START},\n\t\t * {@link CKEDITOR#POSITION_AFTER_START}, {@link CKEDITOR#POSITION_BEFORE_END},\n\t\t * {@link CKEDITOR#POSITION_AFTER_END}.\n\t\t */\n\t\tsetStartAt: function( node, position ) {\n\t\t\tswitch ( position ) {\n\t\t\t\tcase CKEDITOR.POSITION_AFTER_START:\n\t\t\t\t\tthis.setStart( node, 0 );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase CKEDITOR.POSITION_BEFORE_END:\n\t\t\t\t\tif ( node.type == CKEDITOR.NODE_TEXT )\n\t\t\t\t\t\tthis.setStart( node, node.getLength() );\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.setStart( node, node.getChildCount() );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase CKEDITOR.POSITION_BEFORE_START:\n\t\t\t\t\tthis.setStartBefore( node );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase CKEDITOR.POSITION_AFTER_END:\n\t\t\t\t\tthis.setStartAfter( node );\n\t\t\t}\n\n\t\t\tupdateCollapsed( this );\n\t\t},\n\n\t\t/**\n\t\t * Moves the end of this range to given position according to specified node.\n\t\t *\n\t\t *\t\t// HTML: <p>^Foo <b>bar</b></p>\n\t\t *\t\trange.setEndAt( textBar, CKEDITOR.POSITION_BEFORE_START );\n\t\t *\t\t// The range will be changed to:\n\t\t *\t\t// <p>[Foo <b>]bar</b></p>\n\t\t *\n\t\t * See also {@link #setStartAt} and {@link #moveToPosition}.\n\t\t *\n\t\t * @param {CKEDITOR.dom.node} node The node according to which position will be set.\n\t\t * @param {Number} position One of {@link CKEDITOR#POSITION_BEFORE_START},\n\t\t * {@link CKEDITOR#POSITION_AFTER_START}, {@link CKEDITOR#POSITION_BEFORE_END},\n\t\t * {@link CKEDITOR#POSITION_AFTER_END}.\n\t\t */\n\t\tsetEndAt: function( node, position ) {\n\t\t\tswitch ( position ) {\n\t\t\t\tcase CKEDITOR.POSITION_AFTER_START:\n\t\t\t\t\tthis.setEnd( node, 0 );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase CKEDITOR.POSITION_BEFORE_END:\n\t\t\t\t\tif ( node.type == CKEDITOR.NODE_TEXT )\n\t\t\t\t\t\tthis.setEnd( node, node.getLength() );\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.setEnd( node, node.getChildCount() );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase CKEDITOR.POSITION_BEFORE_START:\n\t\t\t\t\tthis.setEndBefore( node );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase CKEDITOR.POSITION_AFTER_END:\n\t\t\t\t\tthis.setEndAfter( node );\n\t\t\t}\n\n\t\t\tupdateCollapsed( this );\n\t\t},\n\n\t\t/**\n\t\t * Wraps inline content found around the range's start or end boundary\n\t\t * with a block element.\n\t\t *\n\t\t *\t\t// Assuming the following range:\n\t\t *\t\t// <h1>foo</h1>ba^r<br />bom<p>foo</p>\n\t\t *\t\t// The result of executing:\n\t\t *\t\trange.fixBlock( true, 'p' );\n\t\t *\t\t// will be:\n\t\t *\t\t// <h1>foo</h1><p>ba^r<br />bom</p><p>foo</p>\n\t\t *\n\t\t * Non-collapsed range:\n\t\t *\n\t\t *\t\t// Assuming the following range:\n\t\t *\t\t// ba[r<p>foo</p>bo]m\n\t\t *\t\t// The result of executing:\n\t\t *\t\trange.fixBlock( false, 'p' );\n\t\t *\t\t// will be:\n\t\t *\t\t// ba[r<p>foo</p><p>bo]m</p>\n\t\t *\n\t\t * @param {Boolean} isStart Whether the start or end boundary of a range should be checked.\n\t\t * @param {String} blockTag The name of a block element in which content will be wrapped.\n\t\t * For example: `'p'`.\n\t\t * @returns {CKEDITOR.dom.element} Created block wrapper.\n\t\t */\n\t\tfixBlock: function( isStart, blockTag ) {\n\t\t\tvar bookmark = this.createBookmark(),\n\t\t\t\tfixedBlock = this.document.createElement( blockTag );\n\n\t\t\tthis.collapse( isStart );\n\n\t\t\tthis.enlarge( CKEDITOR.ENLARGE_BLOCK_CONTENTS );\n\n\t\t\tthis.extractContents().appendTo( fixedBlock );\n\t\t\tfixedBlock.trim();\n\n\t\t\tthis.insertNode( fixedBlock );\n\n\t\t\t// Bogus <br> could already exist in the range's container before fixBlock() was called. In such case it was\n\t\t\t// extracted and appended to the fixBlock. However, we are not sure that it's at the end of\n\t\t\t// the fixedBlock, because of FF's terrible bug. When creating a bookmark in an empty editable\n\t\t\t// FF moves the bogus <br> before that bookmark (<editable><br /><bm />[]</editable>).\n\t\t\t// So even if the initial range was placed before the bogus <br>, after creating the bookmark it\n\t\t\t// is placed before the bookmark.\n\t\t\t// Fortunately, getBogus() is able to skip the bookmark so it finds the bogus <br> in this case.\n\t\t\t// We remove incorrectly placed one and add a brand new one. (#13001)\n\t\t\tvar bogus = fixedBlock.getBogus();\n\t\t\tif ( bogus ) {\n\t\t\t\tbogus.remove();\n\t\t\t}\n\t\t\tfixedBlock.appendBogus();\n\n\t\t\tthis.moveToBookmark( bookmark );\n\n\t\t\treturn fixedBlock;\n\t\t},\n\n\t\t/**\n\t\t * @todo\n\t\t * @param {Boolean} [cloneId=false] Whether to preserve ID attributes in the result blocks.\n\t\t */\n\t\tsplitBlock: function( blockTag, cloneId ) {\n\t\t\tvar startPath = new CKEDITOR.dom.elementPath( this.startContainer, this.root ),\n\t\t\t\tendPath = new CKEDITOR.dom.elementPath( this.endContainer, this.root );\n\n\t\t\tvar startBlockLimit = startPath.blockLimit,\n\t\t\t\tendBlockLimit = endPath.blockLimit;\n\n\t\t\tvar startBlock = startPath.block,\n\t\t\t\tendBlock = endPath.block;\n\n\t\t\tvar elementPath = null;\n\t\t\t// Do nothing if the boundaries are in different block limits.\n\t\t\tif ( !startBlockLimit.equals( endBlockLimit ) )\n\t\t\t\treturn null;\n\n\t\t\t// Get or fix current blocks.\n\t\t\tif ( blockTag != 'br' ) {\n\t\t\t\tif ( !startBlock ) {\n\t\t\t\t\tstartBlock = this.fixBlock( true, blockTag );\n\t\t\t\t\tendBlock = new CKEDITOR.dom.elementPath( this.endContainer, this.root ).block;\n\t\t\t\t}\n\n\t\t\t\tif ( !endBlock )\n\t\t\t\t\tendBlock = this.fixBlock( false, blockTag );\n\t\t\t}\n\n\t\t\t// Get the range position.\n\t\t\tvar isStartOfBlock = startBlock && this.checkStartOfBlock(),\n\t\t\t\tisEndOfBlock = endBlock && this.checkEndOfBlock();\n\n\t\t\t// Delete the current contents.\n\t\t\t// TODO: Why is 2.x doing CheckIsEmpty()?\n\t\t\tthis.deleteContents();\n\n\t\t\tif ( startBlock && startBlock.equals( endBlock ) ) {\n\t\t\t\tif ( isEndOfBlock ) {\n\t\t\t\t\telementPath = new CKEDITOR.dom.elementPath( this.startContainer, this.root );\n\t\t\t\t\tthis.moveToPosition( endBlock, CKEDITOR.POSITION_AFTER_END );\n\t\t\t\t\tendBlock = null;\n\t\t\t\t} else if ( isStartOfBlock ) {\n\t\t\t\t\telementPath = new CKEDITOR.dom.elementPath( this.startContainer, this.root );\n\t\t\t\t\tthis.moveToPosition( startBlock, CKEDITOR.POSITION_BEFORE_START );\n\t\t\t\t\tstartBlock = null;\n\t\t\t\t} else {\n\t\t\t\t\tendBlock = this.splitElement( startBlock, cloneId || false );\n\n\t\t\t\t\t// In Gecko, the last child node must be a bogus <br>.\n\t\t\t\t\t// Note: bogus <br> added under <ul> or <ol> would cause\n\t\t\t\t\t// lists to be incorrectly rendered.\n\t\t\t\t\tif ( !startBlock.is( 'ul', 'ol' ) )\n\t\t\t\t\t\tstartBlock.appendBogus();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tpreviousBlock: startBlock,\n\t\t\t\tnextBlock: endBlock,\n\t\t\t\twasStartOfBlock: isStartOfBlock,\n\t\t\t\twasEndOfBlock: isEndOfBlock,\n\t\t\t\telementPath: elementPath\n\t\t\t};\n\t\t},\n\n\t\t/**\n\t\t * Branch the specified element from the collapsed range position and\n\t\t * place the caret between the two result branches.\n\t\t *\n\t\t * **Note:** The range must be collapsed and been enclosed by this element.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} element\n\t\t * @param {Boolean} [cloneId=false] Whether to preserve ID attributes in the result elements.\n\t\t * @returns {CKEDITOR.dom.element} Root element of the new branch after the split.\n\t\t */\n\t\tsplitElement: function( toSplit, cloneId ) {\n\t\t\tif ( !this.collapsed )\n\t\t\t\treturn null;\n\n\t\t\t// Extract the contents of the block from the selection point to the end\n\t\t\t// of its contents.\n\t\t\tthis.setEndAt( toSplit, CKEDITOR.POSITION_BEFORE_END );\n\t\t\tvar documentFragment = this.extractContents( false, cloneId || false );\n\n\t\t\t// Duplicate the element after it.\n\t\t\tvar clone = toSplit.clone( false, cloneId || false );\n\n\t\t\t// Place the extracted contents into the duplicated element.\n\t\t\tdocumentFragment.appendTo( clone );\n\t\t\tclone.insertAfter( toSplit );\n\t\t\tthis.moveToPosition( toSplit, CKEDITOR.POSITION_AFTER_END );\n\t\t\treturn clone;\n\t\t},\n\n\t\t/**\n\t\t * Recursively remove any empty path blocks at the range boundary.\n\t\t *\n\t\t * @method\n\t\t * @param {Boolean} atEnd Removal to perform at the end boundary,\n\t\t * otherwise to perform at the start.\n\t\t */\n\t\tremoveEmptyBlocksAtEnd: ( function() {\n\n\t\t\tvar whitespace = CKEDITOR.dom.walker.whitespaces(),\n\t\t\t\t\tbookmark = CKEDITOR.dom.walker.bookmark( false );\n\n\t\t\tfunction childEval( parent ) {\n\t\t\t\treturn function( node ) {\n\t\t\t\t\t// Whitespace, bookmarks, empty inlines.\n\t\t\t\t\tif ( whitespace( node ) || bookmark( node ) ||\n\t\t\t\t\t\t\tnode.type == CKEDITOR.NODE_ELEMENT &&\n\t\t\t\t\t\t\tnode.isEmptyInlineRemoveable() ) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t} else if ( parent.is( 'table' ) && node.is( 'caption' ) ) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn true;\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn function( atEnd ) {\n\n\t\t\t\tvar bm = this.createBookmark();\n\t\t\t\tvar path = this[ atEnd ? 'endPath' : 'startPath' ]();\n\t\t\t\tvar block = path.block || path.blockLimit, parent;\n\n\t\t\t\t// Remove any childless block, including list and table.\n\t\t\t\twhile ( block && !block.equals( path.root ) &&\n\t\t\t\t\t\t!block.getFirst( childEval( block ) ) ) {\n\t\t\t\t\tparent = block.getParent();\n\t\t\t\t\tthis[ atEnd ? 'setEndAt' : 'setStartAt' ]( block, CKEDITOR.POSITION_AFTER_END );\n\t\t\t\t\tblock.remove( 1 );\n\t\t\t\t\tblock = parent;\n\t\t\t\t}\n\n\t\t\t\tthis.moveToBookmark( bm );\n\t\t\t};\n\n\t\t} )(),\n\n\t\t/**\n\t\t * Gets {@link CKEDITOR.dom.elementPath} for the {@link #startContainer}.\n\t\t *\n\t\t * @returns {CKEDITOR.dom.elementPath}\n\t\t */\n\t\tstartPath: function() {\n\t\t\treturn new CKEDITOR.dom.elementPath( this.startContainer, this.root );\n\t\t},\n\n\t\t/**\n\t\t * Gets {@link CKEDITOR.dom.elementPath} for the {@link #endContainer}.\n\t\t *\n\t\t * @returns {CKEDITOR.dom.elementPath}\n\t\t */\n\t\tendPath: function() {\n\t\t\treturn new CKEDITOR.dom.elementPath( this.endContainer, this.root );\n\t\t},\n\n\t\t/**\n\t\t * Check whether a range boundary is at the inner boundary of a given\n\t\t * element.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} element The target element to check.\n\t\t * @param {Number} checkType The boundary to check for both the range\n\t\t * and the element. It can be {@link CKEDITOR#START} or {@link CKEDITOR#END}.\n\t\t * @returns {Boolean} `true` if the range boundary is at the inner\n\t\t * boundary of the element.\n\t\t */\n\t\tcheckBoundaryOfElement: function( element, checkType ) {\n\t\t\tvar checkStart = ( checkType == CKEDITOR.START );\n\n\t\t\t// Create a copy of this range, so we can manipulate it for our checks.\n\t\t\tvar walkerRange = this.clone();\n\n\t\t\t// Collapse the range at the proper size.\n\t\t\twalkerRange.collapse( checkStart );\n\n\t\t\t// Expand the range to element boundary.\n\t\t\twalkerRange[ checkStart ? 'setStartAt' : 'setEndAt' ]( element, checkStart ? CKEDITOR.POSITION_AFTER_START : CKEDITOR.POSITION_BEFORE_END );\n\n\t\t\t// Create the walker, which will check if we have anything useful\n\t\t\t// in the range.\n\t\t\tvar walker = new CKEDITOR.dom.walker( walkerRange );\n\t\t\twalker.evaluator = elementBoundaryEval( checkStart );\n\n\t\t\treturn walker[ checkStart ? 'checkBackward' : 'checkForward' ]();\n\t\t},\n\n\t\t/**\n\t\t * **Note:** Calls to this function may produce changes to the DOM. The range may\n\t\t * be updated to reflect such changes.\n\t\t *\n\t\t * @returns {Boolean}\n\t\t * @todo\n\t\t */\n\t\tcheckStartOfBlock: function() {\n\t\t\tvar startContainer = this.startContainer,\n\t\t\t\tstartOffset = this.startOffset;\n\n\t\t\t// [IE] Special handling for range start in text with a leading NBSP,\n\t\t\t// we it to be isolated, for bogus check.\n\t\t\tif ( CKEDITOR.env.ie && startOffset && startContainer.type == CKEDITOR.NODE_TEXT ) {\n\t\t\t\tvar textBefore = CKEDITOR.tools.ltrim( startContainer.substring( 0, startOffset ) );\n\t\t\t\tif ( nbspRegExp.test( textBefore ) )\n\t\t\t\t\tthis.trim( 0, 1 );\n\t\t\t}\n\n\t\t\t// Antecipate the trim() call here, so the walker will not make\n\t\t\t// changes to the DOM, which would not get reflected into this\n\t\t\t// range otherwise.\n\t\t\tthis.trim();\n\n\t\t\t// We need to grab the block element holding the start boundary, so\n\t\t\t// let's use an element path for it.\n\t\t\tvar path = new CKEDITOR.dom.elementPath( this.startContainer, this.root );\n\n\t\t\t// Creates a range starting at the block start until the range start.\n\t\t\tvar walkerRange = this.clone();\n\t\t\twalkerRange.collapse( true );\n\t\t\twalkerRange.setStartAt( path.block || path.blockLimit, CKEDITOR.POSITION_AFTER_START );\n\n\t\t\tvar walker = new CKEDITOR.dom.walker( walkerRange );\n\t\t\twalker.evaluator = getCheckStartEndBlockEvalFunction();\n\n\t\t\treturn walker.checkBackward();\n\t\t},\n\n\t\t/**\n\t\t * **Note:** Calls to this function may produce changes to the DOM. The range may\n\t\t * be updated to reflect such changes.\n\t\t *\n\t\t * @returns {Boolean}\n\t\t * @todo\n\t\t */\n\t\tcheckEndOfBlock: function() {\n\t\t\tvar endContainer = this.endContainer,\n\t\t\t\tendOffset = this.endOffset;\n\n\t\t\t// [IE] Special handling for range end in text with a following NBSP,\n\t\t\t// we it to be isolated, for bogus check.\n\t\t\tif ( CKEDITOR.env.ie && endContainer.type == CKEDITOR.NODE_TEXT ) {\n\t\t\t\tvar textAfter = CKEDITOR.tools.rtrim( endContainer.substring( endOffset ) );\n\t\t\t\tif ( nbspRegExp.test( textAfter ) )\n\t\t\t\t\tthis.trim( 1, 0 );\n\t\t\t}\n\n\t\t\t// Antecipate the trim() call here, so the walker will not make\n\t\t\t// changes to the DOM, which would not get reflected into this\n\t\t\t// range otherwise.\n\t\t\tthis.trim();\n\n\t\t\t// We need to grab the block element holding the start boundary, so\n\t\t\t// let's use an element path for it.\n\t\t\tvar path = new CKEDITOR.dom.elementPath( this.endContainer, this.root );\n\n\t\t\t// Creates a range starting at the block start until the range start.\n\t\t\tvar walkerRange = this.clone();\n\t\t\twalkerRange.collapse( false );\n\t\t\twalkerRange.setEndAt( path.block || path.blockLimit, CKEDITOR.POSITION_BEFORE_END );\n\n\t\t\tvar walker = new CKEDITOR.dom.walker( walkerRange );\n\t\t\twalker.evaluator = getCheckStartEndBlockEvalFunction();\n\n\t\t\treturn walker.checkForward();\n\t\t},\n\n\t\t/**\n\t\t * Traverse with {@link CKEDITOR.dom.walker} to retrieve the previous element before the range start.\n\t\t *\n\t\t * @param {Function} evaluator Function used as the walker's evaluator.\n\t\t * @param {Function} [guard] Function used as the walker's guard.\n\t\t * @param {CKEDITOR.dom.element} [boundary] A range ancestor element in which the traversal is limited,\n\t\t * default to the root editable if not defined.\n\t\t * @returns {CKEDITOR.dom.element/null} The returned node from the traversal.\n\t\t */\n\t\tgetPreviousNode: function( evaluator, guard, boundary ) {\n\t\t\tvar walkerRange = this.clone();\n\t\t\twalkerRange.collapse( 1 );\n\t\t\twalkerRange.setStartAt( boundary || this.root, CKEDITOR.POSITION_AFTER_START );\n\n\t\t\tvar walker = new CKEDITOR.dom.walker( walkerRange );\n\t\t\twalker.evaluator = evaluator;\n\t\t\twalker.guard = guard;\n\t\t\treturn walker.previous();\n\t\t},\n\n\t\t/**\n\t\t * Traverse with {@link CKEDITOR.dom.walker} to retrieve the next element before the range start.\n\t\t *\n\t\t * @param {Function} evaluator Function used as the walker's evaluator.\n\t\t * @param {Function} [guard] Function used as the walker's guard.\n\t\t * @param {CKEDITOR.dom.element} [boundary] A range ancestor element in which the traversal is limited,\n\t\t * default to the root editable if not defined.\n\t\t * @returns {CKEDITOR.dom.element/null} The returned node from the traversal.\n\t\t */\n\t\tgetNextNode: function( evaluator, guard, boundary ) {\n\t\t\tvar walkerRange = this.clone();\n\t\t\twalkerRange.collapse();\n\t\t\twalkerRange.setEndAt( boundary || this.root, CKEDITOR.POSITION_BEFORE_END );\n\n\t\t\tvar walker = new CKEDITOR.dom.walker( walkerRange );\n\t\t\twalker.evaluator = evaluator;\n\t\t\twalker.guard = guard;\n\t\t\treturn walker.next();\n\t\t},\n\n\t\t/**\n\t\t * Check if elements at which the range boundaries anchor are read-only,\n\t\t * with respect to `contenteditable` attribute.\n\t\t *\n\t\t * @returns {Boolean}\n\t\t */\n\t\tcheckReadOnly: ( function() {\n\t\t\tfunction checkNodesEditable( node, anotherEnd ) {\n\t\t\t\twhile ( node ) {\n\t\t\t\t\tif ( node.type == CKEDITOR.NODE_ELEMENT ) {\n\t\t\t\t\t\tif ( node.getAttribute( 'contentEditable' ) == 'false' && !node.data( 'cke-editable' ) )\n\t\t\t\t\t\t\treturn 0;\n\n\t\t\t\t\t\t// Range enclosed entirely in an editable element.\n\t\t\t\t\t\telse if ( node.is( 'html' ) || node.getAttribute( 'contentEditable' ) == 'true' && ( node.contains( anotherEnd ) || node.equals( anotherEnd ) ) )\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\t\t\t\t\tnode = node.getParent();\n\t\t\t\t}\n\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\treturn function() {\n\t\t\t\tvar startNode = this.startContainer,\n\t\t\t\t\tendNode = this.endContainer;\n\n\t\t\t\t// Check if elements path at both boundaries are editable.\n\t\t\t\treturn !( checkNodesEditable( startNode, endNode ) && checkNodesEditable( endNode, startNode ) );\n\t\t\t};\n\t\t} )(),\n\n\t\t/**\n\t\t * Moves the range boundaries to the first/end editing point inside an\n\t\t * element.\n\t\t *\n\t\t * For example, in an element tree like\n\t\t * `<p><b><i></i></b> Text</p>`, the start editing point is\n\t\t * `<p><b><i>^</i></b> Text</p>` (inside `<i>`).\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} el The element into which look for the\n\t\t * editing spot.\n\t\t * @param {Boolean} isMoveToEnd Whether move to the end editable position.\n\t\t * @returns {Boolean} Whether range was moved.\n\t\t */\n\t\tmoveToElementEditablePosition: function( el, isMoveToEnd ) {\n\n\t\t\tfunction nextDFS( node, childOnly ) {\n\t\t\t\tvar next;\n\n\t\t\t\tif ( node.type == CKEDITOR.NODE_ELEMENT && node.isEditable( false ) )\n\t\t\t\t\tnext = node[ isMoveToEnd ? 'getLast' : 'getFirst' ]( notIgnoredEval );\n\n\t\t\t\tif ( !childOnly && !next )\n\t\t\t\t\tnext = node[ isMoveToEnd ? 'getPrevious' : 'getNext' ]( notIgnoredEval );\n\n\t\t\t\treturn next;\n\t\t\t}\n\n\t\t\t// Handle non-editable element e.g. HR.\n\t\t\tif ( el.type == CKEDITOR.NODE_ELEMENT && !el.isEditable( false ) ) {\n\t\t\t\tthis.moveToPosition( el, isMoveToEnd ? CKEDITOR.POSITION_AFTER_END : CKEDITOR.POSITION_BEFORE_START );\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tvar found = 0;\n\n\t\t\twhile ( el ) {\n\t\t\t\t// Stop immediately if we've found a text node.\n\t\t\t\tif ( el.type == CKEDITOR.NODE_TEXT ) {\n\t\t\t\t\t// Put cursor before block filler.\n\t\t\t\t\tif ( isMoveToEnd && this.endContainer && this.checkEndOfBlock() && nbspRegExp.test( el.getText() ) )\n\t\t\t\t\t\tthis.moveToPosition( el, CKEDITOR.POSITION_BEFORE_START );\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.moveToPosition( el, isMoveToEnd ? CKEDITOR.POSITION_AFTER_END : CKEDITOR.POSITION_BEFORE_START );\n\t\t\t\t\tfound = 1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\t// If an editable element is found, move inside it, but not stop the searching.\n\t\t\t\tif ( el.type == CKEDITOR.NODE_ELEMENT ) {\n\t\t\t\t\tif ( el.isEditable() ) {\n\t\t\t\t\t\tthis.moveToPosition( el, isMoveToEnd ? CKEDITOR.POSITION_BEFORE_END : CKEDITOR.POSITION_AFTER_START );\n\t\t\t\t\t\tfound = 1;\n\t\t\t\t\t}\n\t\t\t\t\t// Put cursor before padding block br.\n\t\t\t\t\telse if ( isMoveToEnd && el.is( 'br' ) && this.endContainer && this.checkEndOfBlock() )\n\t\t\t\t\t\tthis.moveToPosition( el, CKEDITOR.POSITION_BEFORE_START );\n\t\t\t\t\t// Special case - non-editable block. Select entire element, because it does not make sense\n\t\t\t\t\t// to place collapsed selection next to it, because browsers can't handle that.\n\t\t\t\t\telse if ( el.getAttribute( 'contenteditable' ) == 'false' && el.is( CKEDITOR.dtd.$block ) ) {\n\t\t\t\t\t\tthis.setStartBefore( el );\n\t\t\t\t\t\tthis.setEndAfter( el );\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tel = nextDFS( el, found );\n\t\t\t}\n\n\t\t\treturn !!found;\n\t\t},\n\n\t\t/**\n\t\t * Moves the range boundaries to the closest editing point after/before an\n\t\t * element or the current range position (depends on whether the element was specified).\n\t\t *\n\t\t * For example, if the start element has `id=\"start\"`,\n\t\t * `<p><b>foo</b><span id=\"start\">start</start></p>`, the closest previous editing point is\n\t\t * `<p><b>foo</b>^<span id=\"start\">start</start></p>` (between `<b>` and `<span>`).\n\t\t *\n\t\t * See also: {@link #moveToElementEditablePosition}.\n\t\t *\n\t\t * @since 4.3\n\t\t * @param {CKEDITOR.dom.element} [element] The starting element. If not specified, the current range\n\t\t * position will be used.\n\t\t * @param {Boolean} [isMoveForward] Whether move to the end of editable. Otherwise, look back.\n\t\t * @returns {Boolean} Whether the range was moved.\n\t\t */\n\t\tmoveToClosestEditablePosition: function( element, isMoveForward ) {\n\t\t\t// We don't want to modify original range if there's no editable position.\n\t\t\tvar range,\n\t\t\t\tfound = 0,\n\t\t\t\tsibling,\n\t\t\t\tisElement,\n\t\t\t\tpositions = [ CKEDITOR.POSITION_AFTER_END, CKEDITOR.POSITION_BEFORE_START ];\n\n\t\t\tif ( element ) {\n\t\t\t\t// Set collapsed range at one of ends of element.\n\t\t\t\t// Can't clone this range, because this range might not be yet positioned (no containers => errors).\n\t\t\t\trange = new CKEDITOR.dom.range( this.root );\n\t\t\t\trange.moveToPosition( element, positions[ isMoveForward ? 0 : 1 ] );\n\t\t\t} else {\n\t\t\t\trange = this.clone();\n\t\t\t}\n\n\t\t\t// Start element isn't a block, so we can automatically place range\n\t\t\t// next to it.\n\t\t\tif ( element && !element.is( CKEDITOR.dtd.$block ) )\n\t\t\t\tfound = 1;\n\t\t\telse {\n\t\t\t\t// Look for first node that fulfills eval function and place range next to it.\n\t\t\t\tsibling = range[ isMoveForward ? 'getNextEditableNode' : 'getPreviousEditableNode' ]();\n\t\t\t\tif ( sibling ) {\n\t\t\t\t\tfound = 1;\n\t\t\t\t\tisElement = sibling.type == CKEDITOR.NODE_ELEMENT;\n\n\t\t\t\t\t// Special case - eval accepts block element only if it's a non-editable block,\n\t\t\t\t\t// which we want to select, not place collapsed selection next to it (which browsers\n\t\t\t\t\t// can't handle).\n\t\t\t\t\tif ( isElement && sibling.is( CKEDITOR.dtd.$block ) && sibling.getAttribute( 'contenteditable' ) == 'false' ) {\n\t\t\t\t\t\trange.setStartAt( sibling, CKEDITOR.POSITION_BEFORE_START );\n\t\t\t\t\t\trange.setEndAt( sibling, CKEDITOR.POSITION_AFTER_END );\n\t\t\t\t\t}\n\t\t\t\t\t// Handle empty blocks which can be selection containers on old IEs.\n\t\t\t\t\telse if ( !CKEDITOR.env.needsBrFiller && isElement && sibling.is( CKEDITOR.dom.walker.validEmptyBlockContainers ) ) {\n\t\t\t\t\t\trange.setEnd( sibling, 0 );\n\t\t\t\t\t\trange.collapse();\n\t\t\t\t\t} else {\n\t\t\t\t\t\trange.moveToPosition( sibling, positions[ isMoveForward ? 1 : 0 ] );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( found )\n\t\t\t\tthis.moveToRange( range );\n\n\t\t\treturn !!found;\n\t\t},\n\n\t\t/**\n\t\t * See {@link #moveToElementEditablePosition}.\n\t\t *\n\t\t * @returns {Boolean} Whether range was moved.\n\t\t */\n\t\tmoveToElementEditStart: function( target ) {\n\t\t\treturn this.moveToElementEditablePosition( target );\n\t\t},\n\n\t\t/**\n\t\t * See {@link #moveToElementEditablePosition}.\n\t\t *\n\t\t * @returns {Boolean} Whether range was moved.\n\t\t */\n\t\tmoveToElementEditEnd: function( target ) {\n\t\t\treturn this.moveToElementEditablePosition( target, true );\n\t\t},\n\n\t\t/**\n\t\t * Get the single node enclosed within the range if there's one.\n\t\t *\n\t\t * @returns {CKEDITOR.dom.node}\n\t\t */\n\t\tgetEnclosedNode: function() {\n\t\t\tvar walkerRange = this.clone();\n\n\t\t\t// Optimize and analyze the range to avoid DOM destructive nature of walker. (#5780)\n\t\t\twalkerRange.optimize();\n\t\t\tif ( walkerRange.startContainer.type != CKEDITOR.NODE_ELEMENT || walkerRange.endContainer.type != CKEDITOR.NODE_ELEMENT )\n\t\t\t\treturn null;\n\n\t\t\tvar walker = new CKEDITOR.dom.walker( walkerRange ),\n\t\t\t\tisNotBookmarks = CKEDITOR.dom.walker.bookmark( false, true ),\n\t\t\t\tisNotWhitespaces = CKEDITOR.dom.walker.whitespaces( true );\n\n\t\t\twalker.evaluator = function( node ) {\n\t\t\t\treturn isNotWhitespaces( node ) && isNotBookmarks( node );\n\t\t\t};\n\t\t\tvar node = walker.next();\n\t\t\twalker.reset();\n\t\t\treturn node && node.equals( walker.previous() ) ? node : null;\n\t\t},\n\n\t\t/**\n\t\t * Get the node adjacent to the range start or {@link #startContainer}.\n\t\t *\n\t\t * @returns {CKEDITOR.dom.node}\n\t\t */\n\t\tgetTouchedStartNode: function() {\n\t\t\tvar container = this.startContainer;\n\n\t\t\tif ( this.collapsed || container.type != CKEDITOR.NODE_ELEMENT )\n\t\t\t\treturn container;\n\n\t\t\treturn container.getChild( this.startOffset ) || container;\n\t\t},\n\n\t\t/**\n\t\t * Get the node adjacent to the range end or {@link #endContainer}.\n\t\t *\n\t\t * @returns {CKEDITOR.dom.node}\n\t\t */\n\t\tgetTouchedEndNode: function() {\n\t\t\tvar container = this.endContainer;\n\n\t\t\tif ( this.collapsed || container.type != CKEDITOR.NODE_ELEMENT )\n\t\t\t\treturn container;\n\n\t\t\treturn container.getChild( this.endOffset - 1 ) || container;\n\t\t},\n\n\t\t/**\n\t\t * Gets next node which can be a container of a selection.\n\t\t * This methods mimics a behavior of right/left arrow keys in case of\n\t\t * collapsed selection. It does not return an exact position (with offset) though,\n\t\t * but just a selection's container.\n\t\t *\n\t\t * Note: use this method on a collapsed range.\n\t\t *\n\t\t * @since 4.3\n\t\t * @returns {CKEDITOR.dom.element/CKEDITOR.dom.text}\n\t\t */\n\t\tgetNextEditableNode: getNextEditableNode(),\n\n\t\t/**\n\t\t * See {@link #getNextEditableNode}.\n\t\t *\n\t\t * @since 4.3\n\t\t * @returns {CKEDITOR.dom.element/CKEDITOR.dom.text}\n\t\t */\n\t\tgetPreviousEditableNode: getNextEditableNode( 1 ),\n\n\t\t/**\n\t\t * Scrolls the start of current range into view.\n\t\t */\n\t\tscrollIntoView: function() {\n\n\t\t\t// The reference element contains a zero-width space to avoid\n\t\t\t// a premature removal. The view is to be scrolled with respect\n\t\t\t// to this element.\n\t\t\tvar reference = new CKEDITOR.dom.element.createFromHtml( '<span>&nbsp;</span>', this.document ),\n\t\t\t\tafterCaretNode, startContainerText, isStartText;\n\n\t\t\tvar range = this.clone();\n\n\t\t\t// Work with the range to obtain a proper caret position.\n\t\t\trange.optimize();\n\n\t\t\t// Currently in a text node, so we need to split it into two\n\t\t\t// halves and put the reference between.\n\t\t\tif ( isStartText = range.startContainer.type == CKEDITOR.NODE_TEXT ) {\n\t\t\t\t// Keep the original content. It will be restored.\n\t\t\t\tstartContainerText = range.startContainer.getText();\n\n\t\t\t\t// Split the startContainer at the this position.\n\t\t\t\tafterCaretNode = range.startContainer.split( range.startOffset );\n\n\t\t\t\t// Insert the reference between two text nodes.\n\t\t\t\treference.insertAfter( range.startContainer );\n\t\t\t}\n\n\t\t\t// If not in a text node, simply insert the reference into the range.\n\t\t\telse {\n\t\t\t\trange.insertNode( reference );\n\t\t\t}\n\n\t\t\t// Scroll with respect to the reference element.\n\t\t\treference.scrollIntoView();\n\n\t\t\t// Get rid of split parts if \"in a text node\" case.\n\t\t\t// Revert the original text of the startContainer.\n\t\t\tif ( isStartText ) {\n\t\t\t\trange.startContainer.setText( startContainerText );\n\t\t\t\tafterCaretNode.remove();\n\t\t\t}\n\n\t\t\t// Get rid of the reference node. It is no longer necessary.\n\t\t\treference.remove();\n\t\t},\n\n\t\t/**\n\t\t * Setter for the {@link #startContainer}.\n\t\t *\n\t\t * @since 4.4.6\n\t\t * @private\n\t\t * @param {CKEDITOR.dom.element} startContainer\n\t\t */\n\t\t_setStartContainer: function( startContainer ) {\n\t\t\t// %REMOVE_START%\n\t\t\tvar isRootAscendantOrSelf = this.root.equals( startContainer ) || this.root.contains( startContainer );\n\n\t\t\tif ( !isRootAscendantOrSelf ) {\n\t\t\t\tCKEDITOR.warn( 'range-startcontainer', { startContainer: startContainer, root: this.root } );\n\t\t\t}\n\t\t\t// %REMOVE_END%\n\t\t\tthis.startContainer = startContainer;\n\t\t},\n\n\t\t/**\n\t\t * Setter for the {@link #endContainer}.\n\t\t *\n\t\t * @since 4.4.6\n\t\t * @private\n\t\t * @param {CKEDITOR.dom.element} endContainer\n\t\t */\n\t\t_setEndContainer: function( endContainer ) {\n\t\t\t// %REMOVE_START%\n\t\t\tvar isRootAscendantOrSelf = this.root.equals( endContainer ) || this.root.contains( endContainer );\n\n\t\t\tif ( !isRootAscendantOrSelf ) {\n\t\t\t\tCKEDITOR.warn( 'range-endcontainer', { endContainer: endContainer, root: this.root } );\n\t\t\t}\n\t\t\t// %REMOVE_END%\n\t\t\tthis.endContainer = endContainer;\n\t\t}\n\t};\n\n\n} )();\n\n/**\n * Indicates a position after start of a node.\n *\n *\t\t// When used according to an element:\n *\t\t// <element>^contents</element>\n *\n *\t\t// When used according to a text node:\n *\t\t// \"^text\" (range is anchored in the text node)\n *\n * It is used as a parameter of methods like: {@link CKEDITOR.dom.range#moveToPosition},\n * {@link CKEDITOR.dom.range#setStartAt} and {@link CKEDITOR.dom.range#setEndAt}.\n *\n * @readonly\n * @member CKEDITOR\n * @property {Number} [=1]\n */\nCKEDITOR.POSITION_AFTER_START = 1;\n\n/**\n * Indicates a position before end of a node.\n *\n *\t\t// When used according to an element:\n *\t\t// <element>contents^</element>\n *\n *\t\t// When used according to a text node:\n *\t\t// \"text^\" (range is anchored in the text node)\n *\n * It is used as a parameter of methods like: {@link CKEDITOR.dom.range#moveToPosition},\n * {@link CKEDITOR.dom.range#setStartAt} and {@link CKEDITOR.dom.range#setEndAt}.\n *\n * @readonly\n * @member CKEDITOR\n * @property {Number} [=2]\n */\nCKEDITOR.POSITION_BEFORE_END = 2;\n\n/**\n * Indicates a position before start of a node.\n *\n *\t\t// When used according to an element:\n *\t\t// ^<element>contents</element> (range is anchored in element's parent)\n *\n *\t\t// When used according to a text node:\n *\t\t// ^\"text\" (range is anchored in text node's parent)\n *\n * It is used as a parameter of methods like: {@link CKEDITOR.dom.range#moveToPosition},\n * {@link CKEDITOR.dom.range#setStartAt} and {@link CKEDITOR.dom.range#setEndAt}.\n *\n * @readonly\n * @member CKEDITOR\n * @property {Number} [=3]\n */\nCKEDITOR.POSITION_BEFORE_START = 3;\n\n/**\n * Indicates a position after end of a node.\n *\n *\t\t// When used according to an element:\n *\t\t// <element>contents</element>^ (range is anchored in element's parent)\n *\n *\t\t// When used according to a text node:\n *\t\t// \"text\"^ (range is anchored in text node's parent)\n *\n * It is used as a parameter of methods like: {@link CKEDITOR.dom.range#moveToPosition},\n * {@link CKEDITOR.dom.range#setStartAt} and {@link CKEDITOR.dom.range#setEndAt}.\n *\n * @readonly\n * @member CKEDITOR\n * @property {Number} [=4]\n */\nCKEDITOR.POSITION_AFTER_END = 4;\n\nCKEDITOR.ENLARGE_ELEMENT = 1;\nCKEDITOR.ENLARGE_BLOCK_CONTENTS = 2;\nCKEDITOR.ENLARGE_LIST_ITEM_CONTENTS = 3;\nCKEDITOR.ENLARGE_INLINE = 4;\n\n// Check boundary types.\n\n/**\n * See {@link CKEDITOR.dom.range#checkBoundaryOfElement}.\n *\n * @readonly\n * @member CKEDITOR\n * @property {Number} [=1]\n */\nCKEDITOR.START = 1;\n\n/**\n * See {@link CKEDITOR.dom.range#checkBoundaryOfElement}.\n *\n * @readonly\n * @member CKEDITOR\n * @property {Number} [=2]\n */\nCKEDITOR.END = 2;\n\n// Shrink range types.\n\n/**\n * See {@link CKEDITOR.dom.range#shrink}.\n *\n * @readonly\n * @member CKEDITOR\n * @property {Number} [=1]\n */\nCKEDITOR.SHRINK_ELEMENT = 1;\n\n/**\n * See {@link CKEDITOR.dom.range#shrink}.\n *\n * @readonly\n * @member CKEDITOR\n * @property {Number} [=2]\n */\nCKEDITOR.SHRINK_TEXT = 2;\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/dom/range.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @ignore\n * File overview: DOM iterator which iterates over list items, lines and paragraphs.\n */\n\n'use strict';\n\n( function() {\n\t/**\n\t * Represents the iterator class. It can be used to iterate\n\t * over all elements (or even text nodes in case of {@link #enlargeBr} set to `false`)\n\t * which establish \"paragraph-like\" spaces within the passed range.\n\t *\n\t *\t\t// <h1>[foo</h1><p>bar]</p>\n\t *\t\tvar iterator = range.createIterator();\n\t *\t\titerator.getNextParagraph(); // h1 element\n\t *\t\titerator.getNextParagraph(); // p element\n\t *\n\t *\t\t// <ul><li>[foo</li><li>bar]</li>\n\t *\t\t// With enforceRealBlocks set to false the iterator will return two list item elements.\n\t *\t\t// With enforceRealBlocks set to true the iterator will return two paragraphs and the DOM will be changed to:\n\t *\t\t// <ul><li><p>foo</p></li><li><p>bar</p></li>\n\t *\n\t * @class CKEDITOR.dom.iterator\n\t * @constructor Creates an iterator class instance.\n\t * @param {CKEDITOR.dom.range} range\n\t */\n\tfunction iterator( range ) {\n\t\tif ( arguments.length < 1 )\n\t\t\treturn;\n\n\t\t/**\n\t\t * @readonly\n\t\t * @property {CKEDITOR.dom.range}\n\t\t */\n\t\tthis.range = range;\n\n\t\t/**\n\t\t * @property {Boolean} [forceBrBreak=false]\n\t\t */\n\t\tthis.forceBrBreak = 0;\n\n\t\t// (#3730).\n\t\t/**\n\t\t * Whether to include `<br>` elements in the enlarged range. Should be\n\t\t * set to `false` when using the iterator in the {@link CKEDITOR#ENTER_BR} mode.\n\t\t *\n\t\t * @property {Boolean} [enlargeBr=true]\n\t\t */\n\t\tthis.enlargeBr = 1;\n\n\t\t/**\n\t\t * Whether the iterator should create a transformable block\n\t\t * if the current one contains text and cannot be transformed.\n\t\t * For example new blocks will be established in elements like\n\t\t * `<li>` or `<td>`.\n\t\t *\n\t\t * @property {Boolean} [enforceRealBlocks=false]\n\t\t */\n\t\tthis.enforceRealBlocks = 0;\n\n\t\tthis._ || ( this._ = {} );\n\t}\n\n\t/**\n\t * Default iterator's filter. It is set only for nested iterators.\n\t *\n\t * @since 4.3\n\t * @readonly\n\t * @property {CKEDITOR.filter} filter\n\t */\n\n\t/**\n\t * Iterator's active filter. It is set by the {@link #getNextParagraph} method\n\t * when it enters a nested editable.\n\t *\n\t * @since 4.3\n\t * @readonly\n\t * @property {CKEDITOR.filter} activeFilter\n\t */\n\n\tvar beginWhitespaceRegex = /^[\\r\\n\\t ]+$/,\n\t\t// Ignore bookmark nodes.(#3783)\n\t\tbookmarkGuard = CKEDITOR.dom.walker.bookmark( false, true ),\n\t\twhitespacesGuard = CKEDITOR.dom.walker.whitespaces( true ),\n\t\tskipGuard = function( node ) {\n\t\t\treturn bookmarkGuard( node ) && whitespacesGuard( node );\n\t\t},\n\t\tlistItemNames = { dd: 1, dt: 1, li: 1 };\n\n\titerator.prototype = {\n\t\t/**\n\t\t * Returns the next paragraph-like element or `null` if the end of a range is reached.\n\t\t *\n\t\t * @param {String} [blockTag='p'] Name of a block element which will be established by\n\t\t * the iterator in block-less elements (see {@link #enforceRealBlocks}).\n\t\t */\n\t\tgetNextParagraph: function( blockTag ) {\n\t\t\t// The block element to be returned.\n\t\t\tvar block;\n\n\t\t\t// The range object used to identify the paragraph contents.\n\t\t\tvar range;\n\n\t\t\t// Indicats that the current element in the loop is the last one.\n\t\t\tvar isLast;\n\n\t\t\t// Instructs to cleanup remaining BRs.\n\t\t\tvar removePreviousBr, removeLastBr;\n\n\t\t\tblockTag = blockTag || 'p';\n\n\t\t\t// We're iterating over nested editable.\n\t\t\tif ( this._.nestedEditable ) {\n\t\t\t\t// Get next block from nested iterator and returns it if was found.\n\t\t\t\tblock = this._.nestedEditable.iterator.getNextParagraph( blockTag );\n\t\t\t\tif ( block ) {\n\t\t\t\t\t// Inherit activeFilter from the nested iterator.\n\t\t\t\t\tthis.activeFilter = this._.nestedEditable.iterator.activeFilter;\n\t\t\t\t\treturn block;\n\t\t\t\t}\n\n\t\t\t\t// No block in nested iterator means that we reached the end of the nested editable.\n\t\t\t\t// Reset the active filter to the default filter (or undefined if this iterator didn't have it).\n\t\t\t\tthis.activeFilter = this.filter;\n\n\t\t\t\t// Try to find next nested editable or get back to parent (this) iterator.\n\t\t\t\tif ( startNestedEditableIterator( this, blockTag, this._.nestedEditable.container, this._.nestedEditable.remaining ) ) {\n\t\t\t\t\t// Inherit activeFilter from the nested iterator.\n\t\t\t\t\tthis.activeFilter = this._.nestedEditable.iterator.activeFilter;\n\t\t\t\t\treturn this._.nestedEditable.iterator.getNextParagraph( blockTag );\n\t\t\t\t} else {\n\t\t\t\t\tthis._.nestedEditable = null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Block-less range should be checked first.\n\t\t\tif ( !this.range.root.getDtd()[ blockTag ] )\n\t\t\t\treturn null;\n\n\t\t\t// This is the first iteration. Let's initialize it.\n\t\t\tif ( !this._.started )\n\t\t\t\trange = startIterator.call( this );\n\n\t\t\tvar currentNode = this._.nextNode,\n\t\t\t\tlastNode = this._.lastNode;\n\n\t\t\tthis._.nextNode = null;\n\t\t\twhile ( currentNode ) {\n\t\t\t\t// closeRange indicates that a paragraph boundary has been found,\n\t\t\t\t// so the range can be closed.\n\t\t\t\tvar closeRange = 0,\n\t\t\t\t\tparentPre = currentNode.hasAscendant( 'pre' );\n\n\t\t\t\t// includeNode indicates that the current node is good to be part\n\t\t\t\t// of the range. By default, any non-element node is ok for it.\n\t\t\t\tvar includeNode = ( currentNode.type != CKEDITOR.NODE_ELEMENT ),\n\t\t\t\t\tcontinueFromSibling = 0;\n\n\t\t\t\t// If it is an element node, let's check if it can be part of the range.\n\t\t\t\tif ( !includeNode ) {\n\t\t\t\t\tvar nodeName = currentNode.getName();\n\n\t\t\t\t\t// Non-editable block was found - return it and move to processing\n\t\t\t\t\t// its nested editables if they exist.\n\t\t\t\t\tif ( CKEDITOR.dtd.$block[ nodeName ] && currentNode.getAttribute( 'contenteditable' ) == 'false' ) {\n\t\t\t\t\t\tblock = currentNode;\n\n\t\t\t\t\t\t// Setup iterator for first of nested editables.\n\t\t\t\t\t\t// If there's no editable, then algorithm will move to next element after current block.\n\t\t\t\t\t\tstartNestedEditableIterator( this, blockTag, block );\n\n\t\t\t\t\t\t// Gets us straight to the end of getParagraph() because block variable is set.\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else if ( currentNode.isBlockBoundary( this.forceBrBreak && !parentPre && { br: 1 } ) ) {\n\t\t\t\t\t\t// <br> boundaries must be part of the range. It will\n\t\t\t\t\t\t// happen only if ForceBrBreak.\n\t\t\t\t\t\tif ( nodeName == 'br' )\n\t\t\t\t\t\t\tincludeNode = 1;\n\t\t\t\t\t\telse if ( !range && !currentNode.getChildCount() && nodeName != 'hr' ) {\n\t\t\t\t\t\t\t// If we have found an empty block, and haven't started\n\t\t\t\t\t\t\t// the range yet, it means we must return this block.\n\t\t\t\t\t\t\tblock = currentNode;\n\t\t\t\t\t\t\tisLast = currentNode.equals( lastNode );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// The range must finish right before the boundary,\n\t\t\t\t\t\t// including possibly skipped empty spaces. (#1603)\n\t\t\t\t\t\tif ( range ) {\n\t\t\t\t\t\t\trange.setEndAt( currentNode, CKEDITOR.POSITION_BEFORE_START );\n\n\t\t\t\t\t\t\t// The found boundary must be set as the next one at this\n\t\t\t\t\t\t\t// point. (#1717)\n\t\t\t\t\t\t\tif ( nodeName != 'br' ) {\n\t\t\t\t\t\t\t\tthis._.nextNode = currentNode;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcloseRange = 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// If we have child nodes, let's check them.\n\t\t\t\t\t\tif ( currentNode.getFirst() ) {\n\t\t\t\t\t\t\t// If we don't have a range yet, let's start it.\n\t\t\t\t\t\t\tif ( !range ) {\n\t\t\t\t\t\t\t\trange = this.range.clone();\n\t\t\t\t\t\t\t\trange.setStartAt( currentNode, CKEDITOR.POSITION_BEFORE_START );\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tcurrentNode = currentNode.getFirst();\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tincludeNode = 1;\n\t\t\t\t\t}\n\t\t\t\t} else if ( currentNode.type == CKEDITOR.NODE_TEXT ) {\n\t\t\t\t\t// Ignore normal whitespaces (i.e. not including &nbsp; or\n\t\t\t\t\t// other unicode whitespaces) before/after a block node.\n\t\t\t\t\tif ( beginWhitespaceRegex.test( currentNode.getText() ) )\n\t\t\t\t\t\tincludeNode = 0;\n\t\t\t\t}\n\n\t\t\t\t// The current node is good to be part of the range and we are\n\t\t\t\t// starting a new range, initialize it first.\n\t\t\t\tif ( includeNode && !range ) {\n\t\t\t\t\trange = this.range.clone();\n\t\t\t\t\trange.setStartAt( currentNode, CKEDITOR.POSITION_BEFORE_START );\n\t\t\t\t}\n\n\t\t\t\t// The last node has been found.\n\t\t\t\tisLast = ( ( !closeRange || includeNode ) && currentNode.equals( lastNode ) );\n\n\t\t\t\t// If we are in an element boundary, let's check if it is time\n\t\t\t\t// to close the range, otherwise we include the parent within it.\n\t\t\t\tif ( range && !closeRange ) {\n\t\t\t\t\twhile ( !currentNode.getNext( skipGuard ) && !isLast ) {\n\t\t\t\t\t\tvar parentNode = currentNode.getParent();\n\n\t\t\t\t\t\tif ( parentNode.isBlockBoundary( this.forceBrBreak && !parentPre && { br: 1 } ) ) {\n\t\t\t\t\t\t\tcloseRange = 1;\n\t\t\t\t\t\t\tincludeNode = 0;\n\t\t\t\t\t\t\tisLast = isLast || ( parentNode.equals( lastNode ) );\n\t\t\t\t\t\t\t// Make sure range includes bookmarks at the end of the block. (#7359)\n\t\t\t\t\t\t\trange.setEndAt( parentNode, CKEDITOR.POSITION_BEFORE_END );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcurrentNode = parentNode;\n\t\t\t\t\t\tincludeNode = 1;\n\t\t\t\t\t\tisLast = ( currentNode.equals( lastNode ) );\n\t\t\t\t\t\tcontinueFromSibling = 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Now finally include the node.\n\t\t\t\tif ( includeNode )\n\t\t\t\t\trange.setEndAt( currentNode, CKEDITOR.POSITION_AFTER_END );\n\n\t\t\t\tcurrentNode = this._getNextSourceNode( currentNode, continueFromSibling, lastNode );\n\t\t\t\tisLast = !currentNode;\n\n\t\t\t\t// We have found a block boundary. Let's close the range and move out of the\n\t\t\t\t// loop.\n\t\t\t\tif ( isLast || ( closeRange && range ) )\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// Now, based on the processed range, look for (or create) the block to be returned.\n\t\t\tif ( !block ) {\n\t\t\t\t// If no range has been found, this is the end.\n\t\t\t\tif ( !range ) {\n\t\t\t\t\tthis._.docEndMarker && this._.docEndMarker.remove();\n\t\t\t\t\tthis._.nextNode = null;\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tvar startPath = new CKEDITOR.dom.elementPath( range.startContainer, range.root );\n\t\t\t\tvar startBlockLimit = startPath.blockLimit,\n\t\t\t\t\tcheckLimits = { div: 1, th: 1, td: 1 };\n\t\t\t\tblock = startPath.block;\n\n\t\t\t\tif ( !block && startBlockLimit && !this.enforceRealBlocks && checkLimits[ startBlockLimit.getName() ] &&\n\t\t\t\t\trange.checkStartOfBlock() && range.checkEndOfBlock() && !startBlockLimit.equals( range.root ) ) {\n\t\t\t\t\tblock = startBlockLimit;\n\t\t\t\t} else if ( !block || ( this.enforceRealBlocks && block.is( listItemNames ) ) ) {\n\t\t\t\t\t// Create the fixed block.\n\t\t\t\t\tblock = this.range.document.createElement( blockTag );\n\n\t\t\t\t\t// Move the contents of the temporary range to the fixed block.\n\t\t\t\t\trange.extractContents().appendTo( block );\n\t\t\t\t\tblock.trim();\n\n\t\t\t\t\t// Insert the fixed block into the DOM.\n\t\t\t\t\trange.insertNode( block );\n\n\t\t\t\t\tremovePreviousBr = removeLastBr = true;\n\t\t\t\t} else if ( block.getName() != 'li' ) {\n\t\t\t\t\t// If the range doesn't includes the entire contents of the\n\t\t\t\t\t// block, we must split it, isolating the range in a dedicated\n\t\t\t\t\t// block.\n\t\t\t\t\tif ( !range.checkStartOfBlock() || !range.checkEndOfBlock() ) {\n\t\t\t\t\t\t// The resulting block will be a clone of the current one.\n\t\t\t\t\t\tblock = block.clone( false );\n\n\t\t\t\t\t\t// Extract the range contents, moving it to the new block.\n\t\t\t\t\t\trange.extractContents().appendTo( block );\n\t\t\t\t\t\tblock.trim();\n\n\t\t\t\t\t\t// Split the block. At this point, the range will be in the\n\t\t\t\t\t\t// right position for our intents.\n\t\t\t\t\t\tvar splitInfo = range.splitBlock();\n\n\t\t\t\t\t\tremovePreviousBr = !splitInfo.wasStartOfBlock;\n\t\t\t\t\t\tremoveLastBr = !splitInfo.wasEndOfBlock;\n\n\t\t\t\t\t\t// Insert the new block into the DOM.\n\t\t\t\t\t\trange.insertNode( block );\n\t\t\t\t\t}\n\t\t\t\t} else if ( !isLast ) {\n\t\t\t\t\t// LIs are returned as is, with all their children (due to the\n\t\t\t\t\t// nested lists). But, the next node is the node right after\n\t\t\t\t\t// the current range, which could be an <li> child (nested\n\t\t\t\t\t// lists) or the next sibling <li>.\n\n\t\t\t\t\tthis._.nextNode = ( block.equals( lastNode ) ? null : this._getNextSourceNode( range.getBoundaryNodes().endNode, 1, lastNode  ) );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( removePreviousBr ) {\n\t\t\t\tvar previousSibling = block.getPrevious();\n\t\t\t\tif ( previousSibling && previousSibling.type == CKEDITOR.NODE_ELEMENT ) {\n\t\t\t\t\tif ( previousSibling.getName() == 'br' )\n\t\t\t\t\t\tpreviousSibling.remove();\n\t\t\t\t\telse if ( previousSibling.getLast() && previousSibling.getLast().$.nodeName.toLowerCase() == 'br' )\n\t\t\t\t\t\tpreviousSibling.getLast().remove();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( removeLastBr ) {\n\t\t\t\tvar lastChild = block.getLast();\n\t\t\t\tif ( lastChild && lastChild.type == CKEDITOR.NODE_ELEMENT && lastChild.getName() == 'br' ) {\n\t\t\t\t\t// Remove br filler on browser which do not need it.\n\t\t\t\t\tif ( !CKEDITOR.env.needsBrFiller || lastChild.getPrevious( bookmarkGuard ) || lastChild.getNext( bookmarkGuard ) )\n\t\t\t\t\t\tlastChild.remove();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Get a reference for the next element. This is important because the\n\t\t\t// above block can be removed or changed, so we can rely on it for the\n\t\t\t// next interation.\n\t\t\tif ( !this._.nextNode ) {\n\t\t\t\tthis._.nextNode = ( isLast || block.equals( lastNode ) || !lastNode ) ? null : this._getNextSourceNode( block, 1, lastNode );\n\t\t\t}\n\n\t\t\treturn block;\n\t\t},\n\n\t\t/**\n\t\t * Gets the next element to check or `null` when the `lastNode` or the\n\t\t * {@link #range}'s {@link CKEDITOR.dom.range#root root} is reached. Bookmarks are skipped.\n\t\t *\n\t\t * @since 4.4.6\n\t\t * @private\n\t\t * @param {CKEDITOR.dom.node} node\n\t\t * @param {Boolean} startFromSibling\n\t\t * @param {CKEDITOR.dom.node} lastNode\n\t\t * @returns {CKEDITOR.dom.node}\n\t\t */\n\t\t_getNextSourceNode: function( node, startFromSibling, lastNode ) {\n\t\t\tvar rootNode = this.range.root,\n\t\t\t\tnext;\n\n\t\t\t// Here we are checking in guard function whether current element\n\t\t\t// reach lastNode(default behaviour) and root node to prevent against\n\t\t\t// getting out of editor instance root DOM object.\n\t\t\t// #12484\n\t\t\tfunction guardFunction( node ) {\n\t\t\t\treturn !( node.equals( lastNode ) || node.equals( rootNode ) );\n\t\t\t}\n\n\t\t\tnext = node.getNextSourceNode( startFromSibling, null, guardFunction );\n\t\t\twhile ( !bookmarkGuard( next ) ) {\n\t\t\t\tnext = next.getNextSourceNode( startFromSibling, null, guardFunction );\n\t\t\t}\n\t\t\treturn next;\n\t\t}\n\t};\n\n\t// @context CKEDITOR.dom.iterator\n\t// @returns Collapsed range which will be reused when during furter processing.\n\tfunction startIterator() {\n\t\tvar range = this.range.clone(),\n\t\t\t// Indicate at least one of the range boundaries is inside a preformat block.\n\t\t\ttouchPre,\n\n\t\t\t// (#12178)\n\t\t\t// Remember if following situation takes place:\n\t\t\t// * startAtInnerBoundary: <p>foo[</p>...\n\t\t\t// * endAtInnerBoundary: ...<p>]bar</p>\n\t\t\t// Because information about line break will be lost when shrinking range.\n\t\t\t// Note that we test only if path block exist, because we must properly shrink\n\t\t\t// range containing table and/or table cells.\n\t\t\t// Note: When range is collapsed there's no way it can be shrinked.\n\t\t\t// By checking if range is collapsed we also prevent #12308.\n\t\t\tstartPath = range.startPath(),\n\t\t\tendPath = range.endPath(),\n\t\t\tstartAtInnerBoundary = !range.collapsed && rangeAtInnerBlockBoundary( range, startPath.block ),\n\t\t\tendAtInnerBoundary = !range.collapsed && rangeAtInnerBlockBoundary( range, endPath.block, 1 );\n\n\t\t// Shrink the range to exclude harmful \"noises\" (#4087, #4450, #5435).\n\t\trange.shrink( CKEDITOR.SHRINK_ELEMENT, true );\n\n\t\tif ( startAtInnerBoundary )\n\t\t\trange.setStartAt( startPath.block, CKEDITOR.POSITION_BEFORE_END );\n\t\tif ( endAtInnerBoundary )\n\t\t\trange.setEndAt( endPath.block, CKEDITOR.POSITION_AFTER_START );\n\n\t\ttouchPre = range.endContainer.hasAscendant( 'pre', true ) || range.startContainer.hasAscendant( 'pre', true );\n\n\t\trange.enlarge( this.forceBrBreak && !touchPre || !this.enlargeBr ? CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS : CKEDITOR.ENLARGE_BLOCK_CONTENTS );\n\n\t\tif ( !range.collapsed ) {\n\t\t\tvar walker = new CKEDITOR.dom.walker( range.clone() ),\n\t\t\t\tignoreBookmarkTextEvaluator = CKEDITOR.dom.walker.bookmark( true, true );\n\t\t\t// Avoid anchor inside bookmark inner text.\n\t\t\twalker.evaluator = ignoreBookmarkTextEvaluator;\n\t\t\tthis._.nextNode = walker.next();\n\t\t\t// TODO: It's better to have walker.reset() used here.\n\t\t\twalker = new CKEDITOR.dom.walker( range.clone() );\n\t\t\twalker.evaluator = ignoreBookmarkTextEvaluator;\n\t\t\tvar lastNode = walker.previous();\n\t\t\tthis._.lastNode = lastNode.getNextSourceNode( true, null, range.root );\n\n\t\t\t// We may have an empty text node at the end of block due to [3770].\n\t\t\t// If that node is the lastNode, it would cause our logic to leak to the\n\t\t\t// next block.(#3887)\n\t\t\tif ( this._.lastNode && this._.lastNode.type == CKEDITOR.NODE_TEXT && !CKEDITOR.tools.trim( this._.lastNode.getText() ) && this._.lastNode.getParent().isBlockBoundary() ) {\n\t\t\t\tvar testRange = this.range.clone();\n\t\t\t\ttestRange.moveToPosition( this._.lastNode, CKEDITOR.POSITION_AFTER_END );\n\t\t\t\tif ( testRange.checkEndOfBlock() ) {\n\t\t\t\t\tvar path = new CKEDITOR.dom.elementPath( testRange.endContainer, testRange.root ),\n\t\t\t\t\t\tlastBlock = path.block || path.blockLimit;\n\t\t\t\t\tthis._.lastNode = lastBlock.getNextSourceNode( true );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// The end of document or range.root was reached, so we need a marker node inside.\n\t\t\tif ( !this._.lastNode || !range.root.contains( this._.lastNode ) ) {\n\t\t\t\tthis._.lastNode = this._.docEndMarker = range.document.createText( '' );\n\t\t\t\tthis._.lastNode.insertAfter( lastNode );\n\t\t\t}\n\n\t\t\t// Let's reuse this variable.\n\t\t\trange = null;\n\t\t}\n\n\t\tthis._.started = 1;\n\n\t\treturn range;\n\t}\n\n\t// Does a nested editables lookup inside editablesContainer.\n\t// If remainingEditables is set will lookup inside this array.\n\t// @param {CKEDITOR.dom.element} editablesContainer\n\t// @param {CKEDITOR.dom.element[]} [remainingEditables]\n\tfunction getNestedEditableIn( editablesContainer, remainingEditables ) {\n\t\tif ( remainingEditables == null )\n\t\t\tremainingEditables = findNestedEditables( editablesContainer );\n\n\t\tvar editable;\n\n\t\twhile ( ( editable = remainingEditables.shift() ) ) {\n\t\t\tif ( isIterableEditable( editable ) )\n\t\t\t\treturn { element: editable, remaining: remainingEditables };\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t// Checkes whether we can iterate over this editable.\n\tfunction isIterableEditable( editable ) {\n\t\t// Reject blockless editables.\n\t\treturn editable.getDtd().p;\n\t}\n\n\t// Finds nested editables within container. Does not return\n\t// editables nested in another editable (twice).\n\tfunction findNestedEditables( container ) {\n\t\tvar editables = [];\n\n\t\tcontainer.forEach( function( element ) {\n\t\t\tif ( element.getAttribute( 'contenteditable' ) == 'true' ) {\n\t\t\t\teditables.push( element );\n\t\t\t\treturn false; // Skip children.\n\t\t\t}\n\t\t}, CKEDITOR.NODE_ELEMENT, true );\n\n\t\treturn editables;\n\t}\n\n\t// Looks for a first nested editable after previousEditable (if passed) and creates\n\t// nested iterator for it.\n\tfunction startNestedEditableIterator( parentIterator, blockTag, editablesContainer, remainingEditables ) {\n\t\tvar editable = getNestedEditableIn( editablesContainer, remainingEditables );\n\n\t\tif ( !editable )\n\t\t\treturn 0;\n\n\t\tvar filter = CKEDITOR.filter.instances[ editable.element.data( 'cke-filter' ) ];\n\n\t\t// If current editable has a filter and this filter does not allow for block tag,\n\t\t// search for next nested editable in remaining ones.\n\t\tif ( filter && !filter.check( blockTag ) )\n\t\t\treturn startNestedEditableIterator( parentIterator, blockTag, editablesContainer, editable.remaining );\n\n\t\tvar range = new CKEDITOR.dom.range( editable.element );\n\t\trange.selectNodeContents( editable.element );\n\n\t\tvar iterator = range.createIterator();\n\t\t// This setting actually does not change anything in this case,\n\t\t// because entire range contents is selected, so there're no <br>s to be included.\n\t\t// But it seems right to copy it too.\n\t\titerator.enlargeBr = parentIterator.enlargeBr;\n\t\t// Inherit configuration from parent iterator.\n\t\titerator.enforceRealBlocks = parentIterator.enforceRealBlocks;\n\t\t// Set the activeFilter (which can be overriden when this iteator will start nested iterator)\n\t\t// and the default filter, which will make it possible to reset to\n\t\t// current iterator's activeFilter after leaving nested editable.\n\t\titerator.activeFilter = iterator.filter = filter;\n\n\t\tparentIterator._.nestedEditable = {\n\t\t\telement: editable.element,\n\t\t\tcontainer: editablesContainer,\n\t\t\tremaining: editable.remaining,\n\t\t\titerator: iterator\n\t\t};\n\n\t\treturn 1;\n\t}\n\n\t// Checks whether range starts or ends at inner block boundary.\n\t// See usage comments to learn more.\n\tfunction rangeAtInnerBlockBoundary( range, block, checkEnd ) {\n\t\tif ( !block )\n\t\t\treturn false;\n\n\t\tvar testRange = range.clone();\n\t\ttestRange.collapse( !checkEnd );\n\t\treturn testRange.checkBoundaryOfElement( block, checkEnd ? CKEDITOR.START : CKEDITOR.END );\n\t}\n\n\t/**\n\t * Creates a {@link CKEDITOR.dom.iterator} instance for this range.\n\t *\n\t * @member CKEDITOR.dom.range\n\t * @returns {CKEDITOR.dom.iterator}\n\t */\n\tCKEDITOR.dom.range.prototype.createIterator = function() {\n\t\treturn new iterator( this );\n\t};\n} )();\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/dom/iterator.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * Represents a command that can be executed on an editor instance.\n *\n *\t\tvar command = new CKEDITOR.command( editor, {\n *\t\t\texec: function( editor ) {\n *\t\t\t\talert( editor.document.getBody().getHtml() );\n *\t\t\t}\n *\t\t} );\n *\n * @class\n * @extends CKEDITOR.commandDefinition\n * @mixins CKEDITOR.event\n * @constructor Creates a command class instance.\n * @param {CKEDITOR.editor} editor The editor instance this command will be\n * related to.\n * @param {CKEDITOR.commandDefinition} commandDefinition The command\n * definition.\n */\nCKEDITOR.command = function( editor, commandDefinition ) {\n\t/**\n\t * Lists UI items that are associated to this command. This list can be\n\t * used to interact with the UI on command execution (by the execution code\n\t * itself, for example).\n\t *\n\t *\t\talert( 'Number of UI items associated to this command: ' + command.uiItems.length );\n\t */\n\tthis.uiItems = [];\n\n\t/**\n\t * Executes the command.\n\t *\n\t *\t\tcommand.exec(); // The command gets executed.\n\t *\n\t * **Note:** You should use the {@link CKEDITOR.editor#execCommand} method instead of calling\n\t * `command.exec()` directly.\n\t *\n\t * @param {Object} [data] Any data to pass to the command. Depends on the\n\t * command implementation and requirements.\n\t * @returns {Boolean} A boolean indicating that the command has been successfully executed.\n\t */\n\tthis.exec = function( data ) {\n\t\tif ( this.state == CKEDITOR.TRISTATE_DISABLED || !this.checkAllowed() )\n\t\t\treturn false;\n\n\t\tif ( this.editorFocus ) // Give editor focus if necessary (#4355).\n\t\t\teditor.focus();\n\n\t\tif ( this.fire( 'exec' ) === false )\n\t\t\treturn true;\n\n\t\treturn ( commandDefinition.exec.call( this, editor, data ) !== false );\n\t};\n\n\t/**\n\t * Explicitly update the status of the command, by firing the {@link CKEDITOR.command#event-refresh} event,\n\t * as well as invoke the {@link CKEDITOR.commandDefinition#refresh} method if defined, this method\n\t * is to allow different parts of the editor code to contribute in command status resolution.\n\t *\n\t * @param {CKEDITOR.editor} editor The editor instance.\n\t * @param {CKEDITOR.dom.elementPath} path\n\t */\n\tthis.refresh = function( editor, path ) {\n\t\t// Do nothing is we're on read-only and this command doesn't support it.\n\t\t// We don't need to disabled the command explicitely here, because this\n\t\t// is already done by the \"readOnly\" event listener.\n\t\tif ( !this.readOnly && editor.readOnly )\n\t\t\treturn true;\n\n\t\t// Disable commands that are not allowed in the current selection path context.\n\t\tif ( this.context && !path.isContextFor( this.context ) ) {\n\t\t\tthis.disable();\n\t\t\treturn true;\n\t\t}\n\n\t\t// Disable commands that are not allowed by the active filter.\n\t\tif ( !this.checkAllowed( true ) ) {\n\t\t\tthis.disable();\n\t\t\treturn true;\n\t\t}\n\n\t\t// Make the \"enabled\" state a default for commands enabled from start.\n\t\tif ( !this.startDisabled )\n\t\t\tthis.enable();\n\n\t\t// Disable commands which shouldn't be enabled in this mode.\n\t\tif ( this.modes && !this.modes[ editor.mode ] )\n\t\t\tthis.disable();\n\n\t\tif ( this.fire( 'refresh', { editor: editor, path: path } ) === false )\n\t\t\treturn true;\n\n\t\treturn ( commandDefinition.refresh && commandDefinition.refresh.apply( this, arguments ) !== false );\n\t};\n\n\tvar allowed;\n\n\t/**\n\t * Checks whether this command is allowed by the active allowed\n\t * content filter ({@link CKEDITOR.editor#activeFilter}). This means\n\t * that if command implements {@link CKEDITOR.feature} interface it will be tested\n\t * by the {@link CKEDITOR.filter#checkFeature} method.\n\t *\n\t * @since 4.1\n\t * @param {Boolean} [noCache] Skip cache for example due to active filter change. Since CKEditor 4.2.\n\t * @returns {Boolean} Whether this command is allowed.\n\t */\n\tthis.checkAllowed = function( noCache ) {\n\t\tif ( !noCache && typeof allowed == 'boolean' )\n\t\t\treturn allowed;\n\n\t\treturn allowed = editor.activeFilter.checkFeature( this );\n\t};\n\n\tCKEDITOR.tools.extend( this, commandDefinition, {\n\t\t/**\n\t\t * The editor modes within which the command can be executed. The\n\t\t * execution will have no action if the current mode is not listed\n\t\t * in this property.\n\t\t *\n\t\t *\t\t// Enable the command in both WYSIWYG and Source modes.\n\t\t *\t\tcommand.modes = { wysiwyg:1,source:1 };\n\t\t *\n\t\t *\t\t// Enable the command in Source mode only.\n\t\t *\t\tcommand.modes = { source:1 };\n\t\t *\n\t\t * @see CKEDITOR.editor#mode\n\t\t */\n\t\tmodes: { wysiwyg: 1 },\n\n\t\t/**\n\t\t * Indicates that the editor will get the focus before executing\n\t\t * the command.\n\t\t *\n\t\t *\t\t// Do not force the editor to have focus when executing the command.\n\t\t *\t\tcommand.editorFocus = false;\n\t\t *\n\t\t * @property {Boolean} [=true]\n\t\t */\n\t\teditorFocus: 1,\n\n\t\t/**\n\t\t * Indicates that this command is sensible to the selection context.\n\t\t * If `true`, the {@link CKEDITOR.command#method-refresh} method will be\n\t\t * called for this command on the {@link CKEDITOR.editor#event-selectionChange} event.\n\t\t *\n\t\t * @property {Boolean} [=false]\n\t\t */\n\t\tcontextSensitive: !!commandDefinition.context,\n\n\t\t/**\n\t\t * Indicates the editor state. Possible values are:\n\t\t *\n\t\t * * {@link CKEDITOR#TRISTATE_DISABLED}: the command is\n\t\t *     disabled. It's execution will have no effect. Same as {@link #disable}.\n\t\t * * {@link CKEDITOR#TRISTATE_ON}: the command is enabled\n\t\t *     and currently active in the editor (for context sensitive commands,\tfor example).\n\t\t * * {@link CKEDITOR#TRISTATE_OFF}: the command is enabled\n\t\t *     and currently inactive in the editor (for context sensitive\tcommands, for example).\n\t\t *\n\t\t * Do not set this property directly, using the {@link #setState} method instead.\n\t\t *\n\t\t *\t\tif ( command.state == CKEDITOR.TRISTATE_DISABLED )\n\t\t *\t\t\talert( 'This command is disabled' );\n\t\t *\n\t\t * @property {Number} [=CKEDITOR.TRISTATE_DISABLED]\n\t\t */\n\t\tstate: CKEDITOR.TRISTATE_DISABLED\n\t} );\n\n\t// Call the CKEDITOR.event constructor to initialize this instance.\n\tCKEDITOR.event.call( this );\n};\n\nCKEDITOR.command.prototype = {\n\t/**\n\t * Enables the command for execution. The command state (see\n\t * {@link CKEDITOR.command#property-state}) available before disabling it is restored.\n\t *\n\t *\t\tcommand.enable();\n\t *\t\tcommand.exec(); // Execute the command.\n\t */\n\tenable: function() {\n\t\tif ( this.state == CKEDITOR.TRISTATE_DISABLED && this.checkAllowed() )\n\t\t\tthis.setState( ( !this.preserveState || ( typeof this.previousState == 'undefined' ) ) ? CKEDITOR.TRISTATE_OFF : this.previousState );\n\t},\n\n\t/**\n\t * Disables the command for execution. The command state (see\n\t * {@link CKEDITOR.command#property-state}) will be set to {@link CKEDITOR#TRISTATE_DISABLED}.\n\t *\n\t *\t\tcommand.disable();\n\t *\t\tcommand.exec(); // \"false\" - Nothing happens.\n\t */\n\tdisable: function() {\n\t\tthis.setState( CKEDITOR.TRISTATE_DISABLED );\n\t},\n\n\t/**\n\t * Sets the command state.\n\t *\n\t *\t\tcommand.setState( CKEDITOR.TRISTATE_ON );\n\t *\t\tcommand.exec(); // Execute the command.\n\t *\t\tcommand.setState( CKEDITOR.TRISTATE_DISABLED );\n\t *\t\tcommand.exec(); // 'false' - Nothing happens.\n\t *\t\tcommand.setState( CKEDITOR.TRISTATE_OFF );\n\t *\t\tcommand.exec(); // Execute the command.\n\t *\n\t * @param {Number} newState The new state. See {@link #property-state}.\n\t * @returns {Boolean} Returns `true` if the command state changed.\n\t */\n\tsetState: function( newState ) {\n\t\t// Do nothing if there is no state change.\n\t\tif ( this.state == newState )\n\t\t\treturn false;\n\n\t\tif ( newState != CKEDITOR.TRISTATE_DISABLED && !this.checkAllowed() )\n\t\t\treturn false;\n\n\t\tthis.previousState = this.state;\n\n\t\t// Set the new state.\n\t\tthis.state = newState;\n\n\t\t// Fire the \"state\" event, so other parts of the code can react to the\n\t\t// change.\n\t\tthis.fire( 'state' );\n\n\t\treturn true;\n\t},\n\n\t/**\n\t * Toggles the on/off (active/inactive) state of the command. This is\n\t * mainly used internally by context sensitive commands.\n\t *\n\t *\t\tcommand.toggleState();\n\t */\n\ttoggleState: function() {\n\t\tif ( this.state == CKEDITOR.TRISTATE_OFF )\n\t\t\tthis.setState( CKEDITOR.TRISTATE_ON );\n\t\telse if ( this.state == CKEDITOR.TRISTATE_ON )\n\t\t\tthis.setState( CKEDITOR.TRISTATE_OFF );\n\t}\n};\n\nCKEDITOR.event.implementOn( CKEDITOR.command.prototype );\n\n/**\n * Indicates the previous command state.\n *\n *\t\talert( command.previousState );\n *\n * @property {Number} previousState\n * @see #state\n */\n\n/**\n * Fired when the command state changes.\n *\n *\t\tcommand.on( 'state', function() {\n *\t\t\t// Alerts the new state.\n *\t\t\talert( this.state );\n *\t\t} );\n *\n * @event state\n */\n\n /**\n * @event refresh\n * @todo\n */\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/command.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Defines the {@link CKEDITOR.config} object that stores the\n * default configuration settings.\n */\n\n/**\n * Used in conjunction with the {@link CKEDITOR.config#enterMode}\n * and {@link CKEDITOR.config#shiftEnterMode} configuration\n * settings to make the editor produce `<p>` tags when\n * using the <kbd>Enter</kbd> key.\n *\n * Read more in the [documentation](#!/guide/dev_enterkey) and see the\n * [SDK sample](http://sdk.ckeditor.com/samples/enterkey.html).\n *\n * @readonly\n * @property {Number} [=1]\n * @member CKEDITOR\n */\nCKEDITOR.ENTER_P = 1;\n\n/**\n * Used in conjunction with the {@link CKEDITOR.config#enterMode}\n * and {@link CKEDITOR.config#shiftEnterMode} configuration\n * settings to make the editor produce `<br>` tags when\n * using the <kbd>Enter</kbd> key.\n *\n * Read more in the [documentation](#!/guide/dev_enterkey) and see the\n * [SDK sample](http://sdk.ckeditor.com/samples/enterkey.html).\n *\n * @readonly\n * @property {Number} [=2]\n * @member CKEDITOR\n */\nCKEDITOR.ENTER_BR = 2;\n\n/**\n * Used in conjunction with the {@link CKEDITOR.config#enterMode}\n * and {@link CKEDITOR.config#shiftEnterMode} configuration\n * settings to make the editor produce `<div>` tags when\n * using the <kbd>Enter</kbd> key.\n *\n * Read more in the [documentation](#!/guide/dev_enterkey) and see the\n * [SDK sample](http://sdk.ckeditor.com/samples/enterkey.html).\n *\n * @readonly\n * @property {Number} [=3]\n * @member CKEDITOR\n */\nCKEDITOR.ENTER_DIV = 3;\n\n/**\n * Stores default configuration settings. Changes to this object are\n * reflected in all editor instances, if not specified otherwise for a particular\n * instance.\n *\n * Read more about setting CKEditor configuration in the\n * [documentation](#!/guide/dev_configuration).\n *\n * @class\n * @singleton\n */\nCKEDITOR.config = {\n\t/**\n\t * The URL path to the custom configuration file to be loaded. If not\n\t * overwritten with inline configuration, it defaults to the `config.js`\n\t * file present in the root of the CKEditor installation directory.\n\t *\n\t * CKEditor will recursively load custom configuration files defined inside\n\t * other custom configuration files.\n\t *\n\t * Read more about setting CKEditor configuration in the\n\t * [documentation](#!/guide/dev_configuration).\n\t *\n\t *\t\t// Load a specific configuration file.\n\t *\t\tCKEDITOR.replace( 'myfield', { customConfig: '/myconfig.js' } );\n\t *\n\t *\t\t// Do not load any custom configuration file.\n\t *\t\tCKEDITOR.replace( 'myfield', { customConfig: '' } );\n\t *\n\t * @cfg {String} [=\"<CKEditor folder>/config.js\"]\n\t */\n\tcustomConfig: 'config.js',\n\n\t/**\n\t * Whether the element replaced by the editor (usually a `<textarea>`)\n\t * is to be updated automatically when posting the form containing the editor.\n\t *\n\t * @cfg\n\t */\n\tautoUpdateElement: true,\n\n\t/**\n\t * The user interface language localization to use. If left empty, the editor\n\t * will automatically be localized to the user language. If the user language is not supported,\n\t * the language specified in the {@link CKEDITOR.config#defaultLanguage}\n\t * configuration setting is used.\n\t *\n\t * Read more in the [documentation](#!/guide/dev_uilanguage) and see the\n\t * [SDK sample](http://sdk.ckeditor.com/samples/uilanguages.html).\n\t *\n\t *\t\t// Load the German interface.\n\t *\t\tconfig.language = 'de';\n\t *\n\t * @cfg\n\t */\n\tlanguage: '',\n\n\t/**\n\t * The language to be used if the {@link CKEDITOR.config#language}\n\t * setting is left empty and it is not possible to localize the editor to the user language.\n\t *\n\t * Read more in the [documentation](#!/guide/dev_uilanguage) and see the\n\t * [SDK sample](http://sdk.ckeditor.com/samples/uilanguages.html).\n\t *\n\t *\t\tconfig.defaultLanguage = 'it';\n\t *\n\t * @cfg\n\t */\n\tdefaultLanguage: 'en',\n\n\t/**\n\t * The writing direction of the language which is used to create editor content.\n\t * Allowed values are:\n\t *\n\t * * `''` (an empty string) &ndash; Indicates that content direction will be the same as either\n\t *      the editor UI direction or the page element direction depending on the editor type:\n\t *     * [Classic editor](#!/guide/dev_framed) &ndash; The same as the user interface language direction.\n\t *     * [Inline editor](#!/guide/dev_inline)&ndash; The same as the editable element text direction.\n\t * * `'ltr'` &ndash; Indicates a Left-To-Right text direction (like in English).\n\t * * `'rtl'` &ndash; Indicates a Right-To-Left text direction (like in Arabic).\n\t *\n\t * See the [SDK sample](http://sdk.ckeditor.com/samples/language.html).\n\t *\n\t * Example:\n\t *\n\t *\t\tconfig.contentsLangDirection = 'rtl';\n\t *\n\t * @cfg\n\t */\n\tcontentsLangDirection: '',\n\n\t/**\n\t * Sets the behavior of the <kbd>Enter</kbd> key. It also determines other behavior\n\t * rules of the editor, like whether the `<br>` element is to be used\n\t * as a paragraph separator when indenting text.\n\t * The allowed values are the following constants that cause the behavior outlined below:\n\t *\n\t * * {@link CKEDITOR#ENTER_P} (1) &ndash; New `<p>` paragraphs are created.\n\t * * {@link CKEDITOR#ENTER_BR} (2) &ndash; Lines are broken with `<br>` elements.\n\t * * {@link CKEDITOR#ENTER_DIV} (3) &ndash; New `<div>` blocks are created.\n\t *\n\t * **Note**: It is recommended to use the {@link CKEDITOR#ENTER_P} setting because of\n\t * its semantic value and correctness. The editor is optimized for this setting.\n\t *\n\t * Read more in the [documentation](#!/guide/dev_enterkey) and see the\n\t * [SDK sample](http://sdk.ckeditor.com/samples/enterkey.html).\n\t *\n\t *\t\t// Not recommended.\n\t *\t\tconfig.enterMode = CKEDITOR.ENTER_BR;\n\t *\n\t * @cfg {Number} [=CKEDITOR.ENTER_P]\n\t */\n\tenterMode: CKEDITOR.ENTER_P,\n\n\t/**\n\t * Forces the use of {@link CKEDITOR.config#enterMode} as line break regardless\n\t * of the context. If, for example, {@link CKEDITOR.config#enterMode} is set\n\t * to {@link CKEDITOR#ENTER_P}, pressing the <kbd>Enter</kbd> key inside a\n\t * `<div>` element will create a new paragraph with a `<p>`\n\t * instead of a `<div>`.\n\t *\n\t * Read more in the [documentation](#!/guide/dev_enterkey) and see the\n\t * [SDK sample](http://sdk.ckeditor.com/samples/enterkey.html).\n\t *\n\t *\t\t// Not recommended.\n\t *\t\tconfig.forceEnterMode = true;\n\t *\n\t * @since 3.2.1\n\t * @cfg\n\t */\n\tforceEnterMode: false,\n\n\t/**\n\t * Similarly to the {@link CKEDITOR.config#enterMode} setting, it defines the behavior\n\t * of the <kbd>Shift+Enter</kbd> key combination.\n\t *\n\t * The allowed values are the following constants that cause the behavior outlined below:\n\t *\n\t * * {@link CKEDITOR#ENTER_P} (1) &ndash; New `<p>` paragraphs are created.\n\t * * {@link CKEDITOR#ENTER_BR} (2) &ndash; Lines are broken with `<br>` elements.\n\t * * {@link CKEDITOR#ENTER_DIV} (3) &ndash; New `<div>` blocks are created.\n\t *\n\t * Read more in the [documentation](#!/guide/dev_enterkey) and see the\n\t * [SDK sample](http://sdk.ckeditor.com/samples/enterkey.html).\n\t *\n\t * Example:\n\t *\n\t *\t\tconfig.shiftEnterMode = CKEDITOR.ENTER_P;\n\t *\n\t * @cfg {Number} [=CKEDITOR.ENTER_BR]\n\t */\n\tshiftEnterMode: CKEDITOR.ENTER_BR,\n\n\t/**\n\t * Sets the `DOCTYPE` to be used when loading the editor content as HTML.\n\t *\n\t *\t\t// Set the DOCTYPE to the HTML 4 (Quirks) mode.\n\t *\t\tconfig.docType = '<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\">';\n\t *\n\t * @cfg\n\t */\n\tdocType: '<!DOCTYPE html>',\n\n\t/**\n\t * Sets the `id` attribute to be used on the `body` element\n\t * of the editing area. This can be useful when you intend to reuse the original CSS\n\t * file you are using on your live website and want to assign the editor the same ID\n\t * as the section that will include the contents. In this way ID-specific CSS rules will\n\t * be enabled.\n\t *\n\t *\t\tconfig.bodyId = 'contents_id';\n\t *\n\t * @since 3.1\n\t * @cfg\n\t */\n\tbodyId: '',\n\n\t/**\n\t * Sets the `class` attribute to be used on the `body` element\n\t * of the editing area. This can be useful when you intend to reuse the original CSS\n\t * file you are using on your live website and want to assign the editor the same class\n\t * as the section that will include the contents. In this way class-specific CSS rules will\n\t * be enabled.\n\t *\n\t *\t\tconfig.bodyClass = 'contents';\n\t *\n\t * **Note:** The editor needs to load stylesheets containing contents styles. You can either\n\t * copy them to the `contents.css` file that the editor loads by default or set the {@link #contentsCss}\n\t * option.\n\t *\n\t * **Note:** This setting only applies to [classic editor](#!/guide/dev_framed) (the one that uses `iframe`).\n\t *\n\t * @since 3.1\n\t * @cfg\n\t */\n\tbodyClass: '',\n\n\t/**\n\t * Indicates whether the content to be edited is being input as a full HTML page.\n\t * A full page includes the `<html>`, `<head>`, and `<body>` elements.\n\t * The final output will also reflect this setting, including the\n\t * `<body>` content only if this setting is disabled.\n\t *\n\t * Read more in the [documentation](#!/guide/dev_fullpage) and see the\n\t * [SDK sample](http://sdk.ckeditor.com/samples/fullpage.html).\n\t *\n\t *\t\tconfig.fullPage = true;\n\t *\n\t * @since 3.1\n\t * @cfg\n\t */\n\tfullPage: false,\n\n\t/**\n\t * The height of the editing area that includes the editor content. This configuration\n\t * option accepts an integer (to denote a value in pixels) or any CSS-defined length unit\n\t * except percent (`%`) values which are not supported.\n\t *\n\t * **Note:** This configuration option is ignored by [inline editor](#!/guide/dev_inline).\n\t *\n\t * Read more in the [documentation](#!/guide/dev_size) and see the\n\t * [SDK sample](http://sdk.ckeditor.com/samples/size.html).\n\t *\n\t *\t\tconfig.height = 500;\t\t// 500 pixels.\n\t *\t\tconfig.height = '25em';\t\t// CSS length.\n\t *\t\tconfig.height = '300px';\t// CSS length.\n\t *\n\t * @cfg {Number/String}\n\t */\n\theight: 200,\n\n\t/**\n\t * The CSS file(s) to be used to apply style to editor content. It should\n\t * reflect the CSS used in the target pages where the content is to be\n\t * displayed.\n\t *\n\t * **Note:** This configuration value is ignored by [inline editor](#!/guide/dev_inline)\n\t * as it uses the styles that come directly from the page that CKEditor is\n\t * rendered on. It is also ignored in the {@link #fullPage full page mode} in\n\t * which the developer has full control over the page HTML code.\n\t *\n\t * Read more in the [documentation](#!/guide/dev_styles) and see the\n\t * [SDK sample](http://sdk.ckeditor.com/samples/styles.html).\n\t *\n\t *\t\tconfig.contentsCss = '/css/mysitestyles.css';\n\t *\t\tconfig.contentsCss = [ '/css/mysitestyles.css', '/css/anotherfile.css' ];\n\t *\n\t * @cfg {String/Array} [contentsCss=CKEDITOR.getUrl( 'contents.css' )]\n\t */\n\tcontentsCss: CKEDITOR.getUrl( 'contents.css' ),\n\n\t/**\n\t * Comma-separated list of plugins to be used in an editor instance. Note that\n\t * the actual plugins that are to be loaded could still be affected by two other settings:\n\t * {@link CKEDITOR.config#extraPlugins} and {@link CKEDITOR.config#removePlugins}.\n\t *\n\t * @cfg {String} [=\"<default list of plugins>\"]\n\t */\n\tplugins: '', // %REMOVE_LINE%\n\n\t/**\n\t * A list of additional plugins to be loaded. This setting makes it easier\n\t * to add new plugins without having to touch the {@link CKEDITOR.config#plugins} setting.\n\t *\n\t * **Note:** The most recommended way to\n\t * [add CKEditor plugins](http://docs.ckeditor.com/#!/guide/dev_plugins) is through\n\t * [CKEditor Builder](http://ckeditor.com/builder). Read more in the\n\t * [documentation](#!/guide/dev_plugins).\n\t *\n\t *\t\tconfig.extraPlugins = 'myplugin,anotherplugin';\n\t *\n\t * @cfg\n\t */\n\textraPlugins: '',\n\n\t/**\n\t * A list of plugins that must not be loaded. This setting makes it possible\n\t * to avoid loading some plugins defined in the {@link CKEDITOR.config#plugins}\n\t * setting without having to touch it.\n\t *\n\t * **Note:** A plugin required by another plugin cannot be removed and will cause\n\t * an error to be thrown. So for example if `contextmenu` is required by `tabletools`,\n\t * it can only be removed if `tabletools` is not loaded.\n\t *\n\t *\t\tconfig.removePlugins = 'elementspath,save,font';\n\t *\n\t * @cfg\n\t */\n\tremovePlugins: '',\n\n\t/**\n\t * A list of regular expressions to be executed on input HTML,\n\t * indicating HTML source code that when matched, must **not** be available in the WYSIWYG\n\t * mode for editing.\n\t *\n\t *\t\tconfig.protectedSource.push( /<\\?[\\s\\S]*?\\?>/g );\t\t\t\t\t\t\t\t\t\t\t// PHP code\n\t *\t\tconfig.protectedSource.push( /<%[\\s\\S]*?%>/g );\t\t\t\t\t\t\t\t\t\t\t\t// ASP code\n\t *\t\tconfig.protectedSource.push( /(<asp:[^\\>]+>[\\s|\\S]*?<\\/asp:[^\\>]+>)|(<asp:[^\\>]+\\/>)/gi );\t// ASP.NET code\n\t *\n\t * @cfg\n\t */\n\tprotectedSource: [],\n\n\t/**\n\t * The editor `tabindex` value.\n\t *\n\t * Read more in the [documentation](#!/guide/dev_tabindex) and see the\n\t * [SDK sample](http://sdk.ckeditor.com/samples/tabindex.html).\n\t *\n\t *\t\tconfig.tabIndex = 1;\n\t *\n\t * @cfg\n\t */\n\ttabIndex: 0,\n\n\t/**\n\t * The editor UI outer width. This configuration option accepts an integer\n\t * (to denote a value in pixels) or any CSS-defined length unit.\n\t *\n\t * Unlike the {@link CKEDITOR.config#height} setting, this\n\t * one will set the outer width of the entire editor UI, not for the\n\t * editing area only.\n\t *\n\t * **Note:** This configuration option is ignored by [inline editor](#!/guide/dev_inline).\n\t *\n\t * Read more in the [documentation](#!/guide/dev_size) and see the\n\t * [SDK sample](http://sdk.ckeditor.com/samples/size.html).\n\t *\n\t *\t\tconfig.width = 850;\t\t// 850 pixels wide.\n\t *\t\tconfig.width = '75%';\t// CSS unit.\n\t *\n\t * @cfg {String/Number}\n\t */\n\twidth: '',\n\n\t/**\n\t * The base Z-index for floating dialog windows and popups.\n\t *\n\t *\t\tconfig.baseFloatZIndex = 2000;\n\t *\n\t * @cfg\n\t */\n\tbaseFloatZIndex: 10000,\n\n\t/**\n\t * The keystrokes that are blocked by default as the browser implementation\n\t * is buggy. These default keystrokes are handled by the editor.\n\t *\n\t *\t\t// Default setting.\n\t *\t\tconfig.blockedKeystrokes = [\n\t *\t\t\tCKEDITOR.CTRL + 66, // Ctrl+B\n\t *\t\t\tCKEDITOR.CTRL + 73, // Ctrl+I\n\t *\t\t\tCKEDITOR.CTRL + 85 // Ctrl+U\n\t *\t\t];\n\t *\n\t * @cfg {Array} [blockedKeystrokes=see example]\n\t */\n\tblockedKeystrokes: [\n\t\tCKEDITOR.CTRL + 66, // Ctrl+B\n\t\tCKEDITOR.CTRL + 73, // Ctrl+I\n\t\tCKEDITOR.CTRL + 85 // Ctrl+U\n\t]\n};\n\n/**\n * Indicates that some of the editor features, like alignment and text\n * direction, should use the \"computed value\" of the feature to indicate its\n * on/off state instead of using the \"real value\".\n *\n * If enabled in a Left-To-Right written document, the \"Left Justify\"\n * alignment button will be shown as active, even if the alignment style is not\n * explicitly applied to the current paragraph in the editor.\n *\n *\t\tconfig.useComputedState = false;\n *\n * @since 3.4\n * @cfg {Boolean} [useComputedState=true]\n */\n\n/**\n * The base user interface color to be used by the editor. Not all skins are\n * [compatible with this setting](#!/guide/skin_sdk_chameleon).\n *\n * Read more in the [documentation](#!/guide/dev_uicolor) and see the\n * [SDK sample](http://sdk.ckeditor.com/samples/uicolor.html).\n *\n *\t\t// Using a color code.\n *\t\tconfig.uiColor = '#AADC6E';\n *\n *\t\t// Using an HTML color name.\n *\t\tconfig.uiColor = 'Gold';\n *\n * @cfg {String} uiColor\n */\n\n// PACKAGER_RENAME( CKEDITOR.config )\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/config.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n( function() {\n\t'use strict';\n\n\tvar DTD = CKEDITOR.dtd,\n\t\t// processElement flag - means that element has been somehow modified.\n\t\tFILTER_ELEMENT_MODIFIED = 1,\n\t\t// processElement flag - meaning explained in CKEDITOR.FILTER_SKIP_TREE doc.\n\t\tFILTER_SKIP_TREE = 2,\n\t\tcopy = CKEDITOR.tools.copy,\n\t\ttrim = CKEDITOR.tools.trim,\n\t\tTEST_VALUE = 'cke-test',\n\t\tenterModeTags = [ '', 'p', 'br', 'div' ];\n\n\t/**\n\t * A flag indicating that the current element and all its ancestors\n\t * should not be filtered.\n\t *\n\t * See {@link CKEDITOR.filter#addElementCallback} for more details.\n\t *\n\t * @since 4.4\n\t * @readonly\n\t * @property {Number} [=2]\n\t * @member CKEDITOR\n\t */\n\tCKEDITOR.FILTER_SKIP_TREE = FILTER_SKIP_TREE;\n\n\t/**\n\t * Highly configurable class which implements input data filtering mechanisms\n\t * and core functions used for the activation of editor features.\n\t *\n\t * A filter instance is always available under the {@link CKEDITOR.editor#filter}\n\t * property and is used by the editor in its core features like filtering input data,\n\t * applying data transformations, validating whether a feature may be enabled for\n\t * the current setup. It may be configured in two ways:\n\t *\n\t *\t* By the user, with the {@link CKEDITOR.config#allowedContent} setting.\n\t *\t* Automatically, by loaded features (toolbar items, commands, etc.).\n\t *\n\t * In both cases additional allowed content rules may be added by\n\t * setting the {@link CKEDITOR.config#extraAllowedContent}\n\t * configuration option.\n\t *\n\t * **Note**: Filter rules will be extended with the following elements\n\t * depending on the {@link CKEDITOR.config#enterMode} and\n\t * {@link CKEDITOR.config#shiftEnterMode} settings:\n\t *\n\t *\t* `'p'` &ndash; for {@link CKEDITOR#ENTER_P},\n\t *\t* `'div'` &ndash; for {@link CKEDITOR#ENTER_DIV},\n\t *\t* `'br'` &ndash; for {@link CKEDITOR#ENTER_BR}.\n\t *\n\t * **Read more** about the Advanced Content Filter in [guides](#!/guide/dev_advanced_content_filter).\n\t *\n\t * Filter may also be used as a standalone instance by passing\n\t * {@link CKEDITOR.filter.allowedContentRules} instead of {@link CKEDITOR.editor}\n\t * to the constructor:\n\t *\n\t *\t\tvar filter = new CKEDITOR.filter( 'b' );\n\t *\n\t *\t\tfilter.check( 'b' ); // -> true\n\t *\t\tfilter.check( 'i' ); // -> false\n\t *\t\tfilter.allow( 'i' );\n\t *\t\tfilter.check( 'i' ); // -> true\n\t *\n\t * @since 4.1\n\t * @class\n\t * @constructor Creates a filter class instance.\n\t * @param {CKEDITOR.editor/CKEDITOR.filter.allowedContentRules} editorOrRules\n\t */\n\tCKEDITOR.filter = function( editorOrRules ) {\n\t\t/**\n\t\t * Whether custom {@link CKEDITOR.config#allowedContent} was set.\n\t\t *\n\t\t * This property does not apply to the standalone filter.\n\t\t *\n\t\t * @readonly\n\t\t * @property {Boolean} customConfig\n\t\t */\n\n\t\t/**\n\t\t * Array of rules added by the {@link #allow} method (including those\n\t\t * loaded from {@link CKEDITOR.config#allowedContent} and\n\t\t * {@link CKEDITOR.config#extraAllowedContent}).\n\t\t *\n\t\t * Rules in this array are in unified allowed content rules format.\n\t\t *\n\t\t * This property is useful for debugging issues with rules string parsing\n\t\t * or for checking which rules were automatically added by editor features.\n\t\t *\n\t\t * @readonly\n\t\t */\n\t\tthis.allowedContent = [];\n\n\t\t/**\n\t\t * Array of rules added by the {@link #disallow} method (including those\n\t\t * loaded from {@link CKEDITOR.config#disallowedContent}).\n\t\t *\n\t\t * Rules in this array are in unified disallowed content rules format.\n\t\t *\n\t\t * This property is useful for debugging issues with rules string parsing\n\t\t * or for checking which rules were automatically added by editor features.\n\t\t *\n\t\t * @since 4.4\n\t\t * @readonly\n\t\t */\n\t\tthis.disallowedContent = [];\n\n\t\t/**\n\t\t * Array of element callbacks. See {@link #addElementCallback}.\n\t\t *\n\t\t * @readonly\n\t\t * @property {Function[]} [=null]\n\t\t */\n\t\tthis.elementCallbacks = null;\n\n\t\t/**\n\t\t * Whether the filter is disabled.\n\t\t *\n\t\t * To disable the filter, set {@link CKEDITOR.config#allowedContent} to `true`\n\t\t * or use the {@link #disable} method.\n\t\t *\n\t\t * @readonly\n\t\t */\n\t\tthis.disabled = false;\n\n\t\t/**\n\t\t * Editor instance if not a standalone filter.\n\t\t *\n\t\t * @readonly\n\t\t * @property {CKEDITOR.editor} [=null]\n\t\t */\n\t\tthis.editor = null;\n\n\t\t/**\n\t\t * Filter's unique id. It can be used to find filter instance in\n\t\t * {@link CKEDITOR.filter#instances CKEDITOR.filter.instance} object.\n\t\t *\n\t\t * @since 4.3\n\t\t * @readonly\n\t\t * @property {Number} id\n\t\t */\n\t\tthis.id = CKEDITOR.tools.getNextNumber();\n\n\t\tthis._ = {\n\t\t\t// Optimized allowed content rules.\n\t\t\tallowedRules: {\n\t\t\t\telements: {},\n\t\t\t\tgeneric: []\n\t\t\t},\n\t\t\t// Optimized disallowed content rules.\n\t\t\tdisallowedRules: {\n\t\t\t\telements: {},\n\t\t\t\tgeneric: []\n\t\t\t},\n\t\t\t// Object: element name => array of transformations groups.\n\t\t\ttransformations: {},\n\t\t\tcachedTests: {}\n\t\t};\n\n\t\t// Register filter instance.\n\t\tCKEDITOR.filter.instances[ this.id ] = this;\n\n\t\tif ( editorOrRules instanceof CKEDITOR.editor ) {\n\t\t\tvar editor = this.editor = editorOrRules;\n\t\t\tthis.customConfig = true;\n\n\t\t\tvar allowedContent = editor.config.allowedContent;\n\n\t\t\t// Disable filter completely by setting config.allowedContent = true.\n\t\t\tif ( allowedContent === true ) {\n\t\t\t\tthis.disabled = true;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( !allowedContent )\n\t\t\t\tthis.customConfig = false;\n\n\t\t\tthis.allow( allowedContent, 'config', 1 );\n\t\t\tthis.allow( editor.config.extraAllowedContent, 'extra', 1 );\n\n\t\t\t// Enter modes should extend filter rules (ENTER_P adds 'p' rule, etc.).\n\t\t\tthis.allow( enterModeTags[ editor.enterMode ] + ' ' + enterModeTags[ editor.shiftEnterMode ], 'default', 1 );\n\n\t\t\tthis.disallow( editor.config.disallowedContent );\n\t\t}\n\t\t// Rules object passed in editorOrRules argument - initialize standalone filter.\n\t\telse {\n\t\t\tthis.customConfig = false;\n\t\t\tthis.allow( editorOrRules, 'default', 1 );\n\t\t}\n\t};\n\n\t/**\n\t * Object containing all filter instances stored under their\n\t * {@link #id} properties.\n\t *\n\t *\t\tvar filter = new CKEDITOR.filter( 'p' );\n\t *\t\tfilter === CKEDITOR.filter.instances[ filter.id ];\n\t *\n\t * @since 4.3\n\t * @static\n\t * @property instances\n\t */\n\tCKEDITOR.filter.instances = {};\n\n\tCKEDITOR.filter.prototype = {\n\t\t/**\n\t\t * Adds allowed content rules to the filter.\n\t\t *\n\t\t * Read about rules formats in [Allowed Content Rules guide](#!/guide/dev_allowed_content_rules).\n\t\t *\n\t\t *\t\t// Add a basic rule for custom image feature (e.g. 'MyImage' button).\n\t\t *\t\teditor.filter.allow( 'img[!src,alt]', 'MyImage' );\n\t\t *\n\t\t *\t\t// Add rules for two header styles allowed by 'HeadersCombo'.\n\t\t *\t\tvar header1Style = new CKEDITOR.style( { element: 'h1' } ),\n\t\t *\t\t\theader2Style = new CKEDITOR.style( { element: 'h2' } );\n\t\t *\t\teditor.filter.allow( [ header1Style, header2Style ], 'HeadersCombo' );\n\t\t *\n\t\t * @param {CKEDITOR.filter.allowedContentRules} newRules Rule(s) to be added.\n\t\t * @param {String} [featureName] Name of a feature that allows this content (most often plugin/button/command name).\n\t\t * @param {Boolean} [overrideCustom] By default this method will reject any rules\n\t\t * if {@link CKEDITOR.config#allowedContent} is defined to avoid overriding it.\n\t\t * Pass `true` to force rules addition.\n\t\t * @returns {Boolean} Whether the rules were accepted.\n\t\t */\n\t\tallow: function( newRules, featureName, overrideCustom ) {\n\t\t\t// Check arguments and constraints. Clear cache.\n\t\t\tif ( !beforeAddingRule( this, newRules, overrideCustom ) )\n\t\t\t\treturn false;\n\n\t\t\tvar i, ret;\n\n\t\t\tif ( typeof newRules == 'string' )\n\t\t\t\tnewRules = parseRulesString( newRules );\n\t\t\telse if ( newRules instanceof CKEDITOR.style ) {\n\t\t\t\t// If style has the cast method defined, use it and abort.\n\t\t\t\tif ( newRules.toAllowedContentRules )\n\t\t\t\t\treturn this.allow( newRules.toAllowedContentRules( this.editor ), featureName, overrideCustom );\n\n\t\t\t\tnewRules = convertStyleToRules( newRules );\n\t\t\t} else if ( CKEDITOR.tools.isArray( newRules ) ) {\n\t\t\t\tfor ( i = 0; i < newRules.length; ++i )\n\t\t\t\t\tret = this.allow( newRules[ i ], featureName, overrideCustom );\n\t\t\t\treturn ret; // Return last status.\n\t\t\t}\n\n\t\t\taddAndOptimizeRules( this, newRules, featureName, this.allowedContent, this._.allowedRules );\n\n\t\t\treturn true;\n\t\t},\n\n\t\t/**\n\t\t * Applies this filter to passed {@link CKEDITOR.htmlParser.fragment} or {@link CKEDITOR.htmlParser.element}.\n\t\t * The result of filtering is a DOM tree without disallowed content.\n\t\t *\n\t\t *\t\t\t// Create standalone filter passing 'p' and 'b' elements.\n\t\t *\t\tvar filter = new CKEDITOR.filter( 'p b' ),\n\t\t *\t\t\t// Parse HTML string to pseudo DOM structure.\n\t\t *\t\t\tfragment = CKEDITOR.htmlParser.fragment.fromHtml( '<p><b>foo</b> <i>bar</i></p>' ),\n\t\t *\t\t\twriter = new CKEDITOR.htmlParser.basicWriter();\n\t\t *\n\t\t *\t\tfilter.applyTo( fragment );\n\t\t *\t\tfragment.writeHtml( writer );\n\t\t *\t\twriter.getHtml(); // -> '<p><b>foo</b> bar</p>'\n\t\t *\n\t\t * @param {CKEDITOR.htmlParser.fragment/CKEDITOR.htmlParser.element} fragment Node to be filtered.\n\t\t * @param {Boolean} [toHtml] Set to `true` if the filter is used together with {@link CKEDITOR.htmlDataProcessor#toHtml}.\n\t\t * @param {Boolean} [transformOnly] If set to `true` only transformations will be applied. Content\n\t\t * will not be filtered with allowed content rules.\n\t\t * @param {Number} [enterMode] Enter mode used by the filter when deciding how to strip disallowed element.\n\t\t * Defaults to {@link CKEDITOR.editor#activeEnterMode} for a editor's filter or to {@link CKEDITOR#ENTER_P} for standalone filter.\n\t\t * @returns {Boolean} Whether some part of the `fragment` was removed by the filter.\n\t\t */\n\t\tapplyTo: function( fragment, toHtml, transformOnly, enterMode ) {\n\t\t\tif ( this.disabled )\n\t\t\t\treturn false;\n\n\t\t\tvar that = this,\n\t\t\t\ttoBeRemoved = [],\n\t\t\t\tprotectedRegexs = this.editor && this.editor.config.protectedSource,\n\t\t\t\tprocessRetVal,\n\t\t\t\tisModified = false,\n\t\t\t\tfilterOpts = {\n\t\t\t\t\tdoFilter: !transformOnly,\n\t\t\t\t\tdoTransform: true,\n\t\t\t\t\tdoCallbacks: true,\n\t\t\t\t\ttoHtml: toHtml\n\t\t\t\t};\n\n\t\t\t// Filter all children, skip root (fragment or editable-like wrapper used by data processor).\n\t\t\tfragment.forEach( function( el ) {\n\t\t\t\tif ( el.type == CKEDITOR.NODE_ELEMENT ) {\n\t\t\t\t\t// Do not filter element with data-cke-filter=\"off\" and all their descendants.\n\t\t\t\t\tif ( el.attributes[ 'data-cke-filter' ] == 'off' )\n\t\t\t\t\t\treturn false;\n\n\t\t\t\t\t// (#10260) Don't touch elements like spans with data-cke-* attribute since they're\n\t\t\t\t\t// responsible e.g. for placing markers, bookmarks, odds and stuff.\n\t\t\t\t\t// We love 'em and we don't wanna lose anything during the filtering.\n\t\t\t\t\t// '|' is to avoid tricky joints like data-=\"foo\" + cke-=\"bar\". Yes, they're possible.\n\t\t\t\t\t//\n\t\t\t\t\t// NOTE: data-cke-* assigned elements are preserved only when filter is used with\n\t\t\t\t\t//       htmlDataProcessor.toHtml because we don't want to protect them when outputting data\n\t\t\t\t\t//       (toDataFormat).\n\t\t\t\t\tif ( toHtml && el.name == 'span' && ~CKEDITOR.tools.objectKeys( el.attributes ).join( '|' ).indexOf( 'data-cke-' ) )\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tprocessRetVal = processElement( that, el, toBeRemoved, filterOpts );\n\t\t\t\t\tif ( processRetVal & FILTER_ELEMENT_MODIFIED )\n\t\t\t\t\t\tisModified = true;\n\t\t\t\t\telse if ( processRetVal & FILTER_SKIP_TREE )\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\telse if ( el.type == CKEDITOR.NODE_COMMENT && el.value.match( /^\\{cke_protected\\}(?!\\{C\\})/ ) ) {\n\t\t\t\t\tif ( !processProtectedElement( that, el, protectedRegexs, filterOpts ) )\n\t\t\t\t\t\ttoBeRemoved.push( el );\n\t\t\t\t}\n\t\t\t}, null, true );\n\n\t\t\tif ( toBeRemoved.length )\n\t\t\t\tisModified = true;\n\n\t\t\tvar node, element, check,\n\t\t\t\ttoBeChecked = [],\n\t\t\t\tenterTag = enterModeTags[ enterMode || ( this.editor ? this.editor.enterMode : CKEDITOR.ENTER_P ) ],\n\t\t\t\tparentDtd;\n\n\t\t\t// Remove elements in reverse order - from leaves to root, to avoid conflicts.\n\t\t\twhile ( ( node = toBeRemoved.pop() ) ) {\n\t\t\t\tif ( node.type == CKEDITOR.NODE_ELEMENT )\n\t\t\t\t\tremoveElement( node, enterTag, toBeChecked );\n\t\t\t\t// This is a comment securing rejected element - remove it completely.\n\t\t\t\telse\n\t\t\t\t\tnode.remove();\n\t\t\t}\n\n\t\t\t// Check elements that have been marked as possibly invalid.\n\t\t\twhile ( ( check = toBeChecked.pop() ) ) {\n\t\t\t\telement = check.el;\n\t\t\t\t// Element has been already removed.\n\t\t\t\tif ( !element.parent )\n\t\t\t\t\tcontinue;\n\n\t\t\t\t// Handle custom elements as inline elements (#12683).\n\t\t\t\tparentDtd = DTD[ element.parent.name ] || DTD.span;\n\n\t\t\t\tswitch ( check.check ) {\n\t\t\t\t\t// Check if element itself is correct.\n\t\t\t\t\tcase 'it':\n\t\t\t\t\t\t// Check if element included in $removeEmpty has no children.\n\t\t\t\t\t\tif ( DTD.$removeEmpty[ element.name ] && !element.children.length )\n\t\t\t\t\t\t\tremoveElement( element, enterTag, toBeChecked );\n\t\t\t\t\t\t// Check if that is invalid element.\n\t\t\t\t\t\telse if ( !validateElement( element ) )\n\t\t\t\t\t\t\tremoveElement( element, enterTag, toBeChecked );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t// Check if element is in correct context. If not - remove element.\n\t\t\t\t\tcase 'el-up':\n\t\t\t\t\t\t// Check if e.g. li is a child of body after ul has been removed.\n\t\t\t\t\t\tif ( element.parent.type != CKEDITOR.NODE_DOCUMENT_FRAGMENT && !parentDtd[ element.name ] )\n\t\t\t\t\t\t\tremoveElement( element, enterTag, toBeChecked );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t// Check if element is in correct context. If not - remove parent.\n\t\t\t\t\tcase 'parent-down':\n\t\t\t\t\t\tif ( element.parent.type != CKEDITOR.NODE_DOCUMENT_FRAGMENT && !parentDtd[ element.name ] )\n\t\t\t\t\t\t\tremoveElement( element.parent, enterTag, toBeChecked );\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn isModified;\n\t\t},\n\n\t\t/**\n\t\t * Checks whether a {@link CKEDITOR.feature} can be enabled. Unlike {@link #addFeature},\n\t\t * this method always checks the feature, even when the default configuration\n\t\t * for {@link CKEDITOR.config#allowedContent} is used.\n\t\t *\n\t\t *\t\t// TODO example\n\t\t *\n\t\t * @param {CKEDITOR.feature} feature The feature to be tested.\n\t\t * @returns {Boolean} Whether this feature can be enabled.\n\t\t */\n\t\tcheckFeature: function( feature ) {\n\t\t\tif ( this.disabled )\n\t\t\t\treturn true;\n\n\t\t\tif ( !feature )\n\t\t\t\treturn true;\n\n\t\t\t// Some features may want to register other features.\n\t\t\t// E.g. a button may return a command bound to it.\n\t\t\tif ( feature.toFeature )\n\t\t\t\tfeature = feature.toFeature( this.editor );\n\n\t\t\treturn !feature.requiredContent || this.check( feature.requiredContent );\n\t\t},\n\n\t\t/**\n\t\t * Disables Advanced Content Filter.\n\t\t *\n\t\t * This method is meant to be used by plugins which are not\n\t\t * compatible with the filter and in other cases in which the filter\n\t\t * has to be disabled during the initialization phase or runtime.\n\t\t *\n\t\t * In other cases the filter can be disabled by setting\n\t\t * {@link CKEDITOR.config#allowedContent} to `true`.\n\t\t */\n\t\tdisable: function() {\n\t\t\tthis.disabled = true;\n\t\t},\n\n\t\t/**\n\t\t * Adds disallowed content rules to the filter.\n\t\t *\n\t\t * Read about rules formats in the [Allowed Content Rules guide](#!/guide/dev_allowed_content_rules).\n\t\t *\n\t\t *\t\t// Disallow all styles on the image elements.\n\t\t *\t\teditor.filter.disallow( 'img{*}' );\n\t\t *\n\t\t *\t\t// Disallow all span and div elements.\n\t\t *\t\teditor.filter.disallow( 'span div' );\n\t\t *\n\t\t * @since 4.4\n\t\t * @param {CKEDITOR.filter.disallowedContentRules} newRules Rule(s) to be added.\n\t\t */\n\t\tdisallow: function( newRules ) {\n\t\t\t// Check arguments and constraints. Clear cache.\n\t\t\t// Note: we pass true in the 3rd argument, because disallow() should never\n\t\t\t// be blocked by custom configuration.\n\t\t\tif ( !beforeAddingRule( this, newRules, true ) )\n\t\t\t\treturn false;\n\n\t\t\tif ( typeof newRules == 'string' )\n\t\t\t\tnewRules = parseRulesString( newRules );\n\n\t\t\taddAndOptimizeRules( this, newRules, null, this.disallowedContent, this._.disallowedRules );\n\n\t\t\treturn true;\n\t\t},\n\n\t\t/**\n\t\t * Adds an array of {@link CKEDITOR.feature} content forms. All forms\n\t\t * will then be transformed to the first form which is allowed by the filter.\n\t\t *\n\t\t *\t\teditor.filter.allow( 'i; span{!font-style}' );\n\t\t *\t\teditor.filter.addContentForms( [\n\t\t *\t\t\t'em',\n\t\t *\t\t\t'i',\n\t\t *\t\t\t[ 'span', function( el ) {\n\t\t *\t\t\t\treturn el.styles[ 'font-style' ] == 'italic';\n\t\t *\t\t\t} ]\n\t\t *\t\t] );\n\t\t *\t\t// Now <em> and <span style=\"font-style:italic\"> will be replaced with <i>\n\t\t *\t\t// because this is the first allowed form.\n\t\t *\t\t// <span> is allowed too, but it is the last form and\n\t\t *\t\t// additionaly, the editor cannot transform an element based on\n\t\t *\t\t// the array+function form).\n\t\t *\n\t\t * This method is used by the editor to register {@link CKEDITOR.feature#contentForms}\n\t\t * when adding a feature with {@link #addFeature} or {@link CKEDITOR.editor#addFeature}.\n\t\t *\n\t\t * @param {Array} forms The content forms of a feature.\n\t\t */\n\t\taddContentForms: function( forms ) {\n\t\t\tif ( this.disabled )\n\t\t\t\treturn;\n\n\t\t\tif ( !forms )\n\t\t\t\treturn;\n\n\t\t\tvar i, form,\n\t\t\t\ttransfGroups = [],\n\t\t\t\tpreferredForm;\n\n\t\t\t// First, find preferred form - this is, first allowed.\n\t\t\tfor ( i = 0; i < forms.length && !preferredForm; ++i ) {\n\t\t\t\tform = forms[ i ];\n\n\t\t\t\t// Check only strings and styles - array format isn't supported by #check().\n\t\t\t\tif ( ( typeof form == 'string' || form instanceof CKEDITOR.style ) && this.check( form ) )\n\t\t\t\t\tpreferredForm = form;\n\t\t\t}\n\n\t\t\t// This feature doesn't have preferredForm, so ignore it.\n\t\t\tif ( !preferredForm )\n\t\t\t\treturn;\n\n\t\t\tfor ( i = 0; i < forms.length; ++i )\n\t\t\t\ttransfGroups.push( getContentFormTransformationGroup( forms[ i ], preferredForm ) );\n\n\t\t\tthis.addTransformations( transfGroups );\n\t\t},\n\n\t\t/**\n\t\t * Adds a callback which will be executed on every element\n\t\t * that the filter reaches when filtering, before the element is filtered.\n\t\t *\n\t\t * By returning {@link CKEDITOR#FILTER_SKIP_TREE} it is possible to\n\t\t * skip filtering of the current element and all its ancestors.\n\t\t *\n\t\t *\t\teditor.filter.addElementCallback( function( el ) {\n\t\t *\t\t\tif ( el.hasClass( 'protected' ) )\n\t\t *\t\t\t\treturn CKEDITOR.FILTER_SKIP_TREE;\n\t\t *\t\t} );\n\t\t *\n\t\t * **Note:** At this stage the element passed to the callback does not\n\t\t * contain `attributes`, `classes`, and `styles` properties which are available\n\t\t * temporarily on later stages of the filtering process. Therefore you need to\n\t\t *  use the pure {@link CKEDITOR.htmlParser.element} interface.\n\t\t *\n\t\t * @since 4.4\n\t\t * @param {Function} callback The callback to be executed.\n\t\t */\n\t\taddElementCallback: function( callback ) {\n\t\t\t// We want to keep it a falsy value, to speed up finding whether there are any callbacks.\n\t\t\tif ( !this.elementCallbacks )\n\t\t\t\tthis.elementCallbacks = [];\n\n\t\t\tthis.elementCallbacks.push( callback );\n\t\t},\n\n\t\t/**\n\t\t * Checks whether a feature can be enabled for the HTML restrictions in place\n\t\t * for the current CKEditor instance, based on the HTML code the feature might\n\t\t * generate and the minimal HTML code the feature needs to be able to generate.\n\t\t *\n\t\t *\t\t// TODO example\n\t\t *\n\t\t * @param {CKEDITOR.feature} feature\n\t\t * @returns {Boolean} Whether this feature can be enabled.\n\t\t */\n\t\taddFeature: function( feature ) {\n\t\t\tif ( this.disabled )\n\t\t\t\treturn true;\n\n\t\t\tif ( !feature )\n\t\t\t\treturn true;\n\n\t\t\t// Some features may want to register other features.\n\t\t\t// E.g. a button may return a command bound to it.\n\t\t\tif ( feature.toFeature )\n\t\t\t\tfeature = feature.toFeature( this.editor );\n\n\t\t\t// If default configuration (will be checked inside #allow()),\n\t\t\t// then add allowed content rules.\n\t\t\tthis.allow( feature.allowedContent, feature.name );\n\n\t\t\tthis.addTransformations( feature.contentTransformations );\n\t\t\tthis.addContentForms( feature.contentForms );\n\n\t\t\t// If custom configuration or any DACRs, then check if required content is allowed.\n\t\t\tif ( feature.requiredContent && ( this.customConfig || this.disallowedContent.length ) )\n\t\t\t\treturn this.check( feature.requiredContent );\n\n\t\t\treturn true;\n\t\t},\n\n\t\t/**\n\t\t * Adds an array of content transformation groups. One group\n\t\t * may contain many transformation rules, but only the first\n\t\t * matching rule in a group is executed.\n\t\t *\n\t\t * A single transformation rule is an object with four properties:\n\t\t *\n\t\t *\t* `check` (optional) &ndash; if set and {@link CKEDITOR.filter} does\n\t\t *\t\tnot accept this {@link CKEDITOR.filter.contentRule}, this transformation rule\n\t\t *\t\twill not be executed (it does not *match*). This value is passed\n\t\t *\t\tto {@link #check}.\n\t\t *\t* `element` (optional) &ndash; this string property tells the filter on which\n\t\t *\t\telement this transformation can be run. It is optional, because\n\t\t *\t\tthe element name can be obtained from `check` (if it is a String format)\n\t\t *\t\tor `left` (if it is a {@link CKEDITOR.style} instance).\n\t\t *\t* `left` (optional) &ndash; a function accepting an element or a {@link CKEDITOR.style}\n\t\t *\t\tinstance verifying whether the transformation should be\n\t\t *\t\texecuted on this specific element. If it returns `false` or if an element\n\t\t *\t\tdoes not match this style, this transformation rule does not *match*.\n\t\t *\t* `right` &ndash; a function accepting an element and {@link CKEDITOR.filter.transformationsTools}\n\t\t *\t\tor a string containing the name of the {@link CKEDITOR.filter.transformationsTools} method\n\t\t *\t\tthat should be called on an element.\n\t\t *\n\t\t * A shorthand format is also available. A transformation rule can be defined by\n\t\t * a single string `'check:right'`. The string before `':'` will be used as\n\t\t * the `check` property and the second part as the `right` property.\n\t\t *\n\t\t * Transformation rules can be grouped. The filter will try to apply\n\t\t * the first rule in a group. If it *matches*, the filter will ignore subsequent rules and\n\t\t * will move to the next group. If it does not *match*, the next rule will be checked.\n\t\t *\n\t\t * Examples:\n\t\t *\n\t\t *\t\teditor.filter.addTransformations( [\n\t\t *\t\t\t// First group.\n\t\t *\t\t\t[\n\t\t *\t\t\t\t// First rule. If table{width} is allowed, it\n\t\t *\t\t\t\t// executes {@link CKEDITOR.filter.transformationsTools#sizeToStyle} on a table element.\n\t\t *\t\t\t\t'table{width}: sizeToStyle',\n\t\t *\t\t\t\t// Second rule should not be executed if the first was.\n\t\t *\t\t\t\t'table[width]: sizeToAttribute'\n\t\t *\t\t\t],\n\t\t *\t\t\t// Second group.\n\t\t *\t\t\t[\n\t\t *\t\t\t\t// This rule will add the foo=\"1\" attribute to all images that\n\t\t *\t\t\t\t// do not have it.\n\t\t *\t\t\t\t{\n\t\t *\t\t\t\t\telement: 'img',\n\t\t *\t\t\t\t\tleft: function( el ) {\n\t\t *\t\t\t\t\t\treturn !el.attributes.foo;\n\t\t *\t\t\t\t\t},\n\t\t *\t\t\t\t\tright: function( el, tools ) {\n\t\t *\t\t\t\t\t\tel.attributes.foo = '1';\n\t\t *\t\t\t\t\t}\n\t\t *\t\t\t\t}\n\t\t *\t\t\t]\n\t\t *\t\t] );\n\t\t *\n\t\t *\t\t// Case 1:\n\t\t *\t\t// config.allowedContent = 'table{height,width}; tr td'.\n\t\t *\t\t//\n\t\t *\t\t// '<table style=\"height:100px; width:200px\">...</table>'\t\t-> '<table style=\"height:100px; width:200px\">...</table>'\n\t\t *\t\t// '<table height=\"100\" width=\"200\">...</table>'\t\t\t\t-> '<table style=\"height:100px; width:200px\">...</table>'\n\t\t *\n\t\t *\t\t// Case 2:\n\t\t *\t\t// config.allowedContent = 'table[height,width]; tr td'.\n\t\t *\t\t//\n\t\t *\t\t// '<table style=\"height:100px; width:200px\">...</table>'\t\t-> '<table height=\"100\" width=\"200\">...</table>'\n\t\t *\t\t// '<table height=\"100\" width=\"200\">...</table>'\t\t\t\t-> '<table height=\"100\" width=\"200\"\">...</table>'\n\t\t *\n\t\t *\t\t// Case 3:\n\t\t *\t\t// config.allowedContent = 'table{width,height}[height,width]; tr td'.\n\t\t *\t\t//\n\t\t *\t\t// '<table style=\"height:100px; width:200px\">...</table>'\t\t-> '<table style=\"height:100px; width:200px\">...</table>'\n\t\t *\t\t// '<table height=\"100\" width=\"200\">...</table>'\t\t\t\t-> '<table style=\"height:100px; width:200px\">...</table>'\n\t\t *\t\t//\n\t\t *\t\t// Note: Both forms are allowed (size set by style and by attributes), but only\n\t\t *\t\t// the first transformation is applied &mdash; the size is always transformed to a style.\n\t\t *\t\t// This is because only the first transformation matching allowed content rules is applied.\n\t\t *\n\t\t * This method is used by the editor to add {@link CKEDITOR.feature#contentTransformations}\n\t\t * when adding a feature by {@link #addFeature} or {@link CKEDITOR.editor#addFeature}.\n\t\t *\n\t\t * @param {Array} transformations\n\t\t */\n\t\taddTransformations: function( transformations ) {\n\t\t\tif ( this.disabled )\n\t\t\t\treturn;\n\n\t\t\tif ( !transformations )\n\t\t\t\treturn;\n\n\t\t\tvar optimized = this._.transformations,\n\t\t\t\tgroup, i;\n\n\t\t\tfor ( i = 0; i < transformations.length; ++i ) {\n\t\t\t\tgroup = optimizeTransformationsGroup( transformations[ i ] );\n\n\t\t\t\tif ( !optimized[ group.name ] )\n\t\t\t\t\toptimized[ group.name ] = [];\n\n\t\t\t\toptimized[ group.name ].push( group.rules );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Checks whether the content defined in the `test` argument is allowed\n\t\t * by this filter.\n\t\t *\n\t\t * If `strictCheck` is set to `false` (default value), this method checks\n\t\t * if all parts of the `test` (styles, attributes, and classes) are\n\t\t * accepted by the filter. If `strictCheck` is set to `true`, the test\n\t\t * must also contain the required attributes, styles, and classes.\n\t\t *\n\t\t * For example:\n\t\t *\n\t\t *\t\t// Rule: 'img[!src,alt]'.\n\t\t *\t\tfilter.check( 'img[alt]' ); // -> true\n\t\t *\t\tfilter.check( 'img[alt]', true, true ); // -> false\n\t\t *\n\t\t * Second `check()` call returned `false` because `src` is required.\n\t\t *\n\t\t * **Note:** The `test` argument is of {@link CKEDITOR.filter.contentRule} type, which is\n\t\t * a limited version of {@link CKEDITOR.filter.allowedContentRules}. Read more about it\n\t\t * in the {@link CKEDITOR.filter.contentRule}'s documentation.\n\t\t *\n\t\t * @param {CKEDITOR.filter.contentRule} test\n\t\t * @param {Boolean} [applyTransformations=true] Whether to use registered transformations.\n\t\t * @param {Boolean} [strictCheck] Whether the filter should check if an element with exactly\n\t\t * these properties is allowed.\n\t\t * @returns {Boolean} Returns `true` if the content is allowed.\n\t\t */\n\t\tcheck: function( test, applyTransformations, strictCheck ) {\n\t\t\tif ( this.disabled )\n\t\t\t\treturn true;\n\n\t\t\t// If rules are an array, expand it and return the logical OR value of\n\t\t\t// the rules.\n\t\t\tif ( CKEDITOR.tools.isArray( test ) ) {\n\t\t\t\tfor ( var i = test.length ; i-- ; ) {\n\t\t\t\t\tif ( this.check( test[ i ], applyTransformations, strictCheck ) )\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tvar element, result, cacheKey;\n\n\t\t\tif ( typeof test == 'string' ) {\n\t\t\t\tcacheKey = test + '<' + ( applyTransformations === false ? '0' : '1' ) + ( strictCheck ? '1' : '0' ) + '>';\n\n\t\t\t\t// Check if result of this check hasn't been already cached.\n\t\t\t\tif ( cacheKey in this._.cachedChecks )\n\t\t\t\t\treturn this._.cachedChecks[ cacheKey ];\n\n\t\t\t\t// Create test element from string.\n\t\t\t\telement = mockElementFromString( test );\n\t\t\t} else {\n\t\t\t\t// Create test element from CKEDITOR.style.\n\t\t\t\telement = mockElementFromStyle( test );\n\t\t\t}\n\n\t\t\t// Make a deep copy.\n\t\t\tvar clone = CKEDITOR.tools.clone( element ),\n\t\t\t\ttoBeRemoved = [],\n\t\t\t\ttransformations;\n\n\t\t\t// Apply transformations to original element.\n\t\t\t// Transformations will be applied to clone by the filter function.\n\t\t\tif ( applyTransformations !== false && ( transformations = this._.transformations[ element.name ] ) ) {\n\t\t\t\tfor ( i = 0; i < transformations.length; ++i )\n\t\t\t\t\tapplyTransformationsGroup( this, element, transformations[ i ] );\n\n\t\t\t\t// Transformations could modify styles or classes, so they need to be copied\n\t\t\t\t// to attributes object.\n\t\t\t\tupdateAttributes( element );\n\t\t\t}\n\n\t\t\t// Filter clone of mocked element.\n\t\t\tprocessElement( this, clone, toBeRemoved, {\n\t\t\t\tdoFilter: true,\n\t\t\t\tdoTransform: applyTransformations !== false,\n\t\t\t\tskipRequired: !strictCheck,\n\t\t\t\tskipFinalValidation: !strictCheck\n\t\t\t} );\n\n\t\t\t// Element has been marked for removal.\n\t\t\tif ( toBeRemoved.length > 0 ) {\n\t\t\t\tresult = false;\n\t\t\t// Compare only left to right, because clone may be only trimmed version of original element.\n\t\t\t} else if ( !CKEDITOR.tools.objectCompare( element.attributes, clone.attributes, true ) ) {\n\t\t\t\tresult = false;\n\t\t\t} else {\n\t\t\t\tresult = true;\n\t\t\t}\n\n\t\t\t// Cache result of this test - we can build cache only for string tests.\n\t\t\tif ( typeof test == 'string' )\n\t\t\t\tthis._.cachedChecks[ cacheKey ] = result;\n\n\t\t\treturn result;\n\t\t},\n\n\t\t/**\n\t\t * Returns first enter mode allowed by this filter rules. Modes are checked in `p`, `div`, `br` order.\n\t\t * If none of tags is allowed this method will return {@link CKEDITOR#ENTER_BR}.\n\t\t *\n\t\t * @since 4.3\n\t\t * @param {Number} defaultMode The default mode which will be checked as the first one.\n\t\t * @param {Boolean} [reverse] Whether to check modes in reverse order (used for shift enter mode).\n\t\t * @returns {Number} Allowed enter mode.\n\t\t */\n\t\tgetAllowedEnterMode: ( function() {\n\t\t\tvar tagsToCheck = [ 'p', 'div', 'br' ],\n\t\t\t\tenterModes = {\n\t\t\t\t\tp: CKEDITOR.ENTER_P,\n\t\t\t\t\tdiv: CKEDITOR.ENTER_DIV,\n\t\t\t\t\tbr: CKEDITOR.ENTER_BR\n\t\t\t\t};\n\n\t\t\treturn function( defaultMode, reverse ) {\n\t\t\t\t// Clone the array first.\n\t\t\t\tvar tags = tagsToCheck.slice(),\n\t\t\t\t\ttag;\n\n\t\t\t\t// Check the default mode first.\n\t\t\t\tif ( this.check( enterModeTags[ defaultMode ] ) )\n\t\t\t\t\treturn defaultMode;\n\n\t\t\t\t// If not reverse order, reverse array so we can pop() from it.\n\t\t\t\tif ( !reverse )\n\t\t\t\t\ttags = tags.reverse();\n\n\t\t\t\twhile ( ( tag = tags.pop() ) ) {\n\t\t\t\t\tif ( this.check( tag ) )\n\t\t\t\t\t\treturn enterModes[ tag ];\n\t\t\t\t}\n\n\t\t\t\treturn CKEDITOR.ENTER_BR;\n\t\t\t};\n\t\t} )(),\n\n\t\t/**\n\t\t * Destroys the filter instance and removes it from the global {@link CKEDITOR.filter#instances} object.\n\t\t *\n\t\t * @since 4.4.5\n\t\t */\n\t\tdestroy: function() {\n\t\t\tdelete CKEDITOR.filter.instances[ this.id ];\n\t\t\t// Deleting reference to filter instance should be enough,\n\t\t\t// but since these are big objects it's safe to clean them up too.\n\t\t\tdelete this._;\n\t\t\tdelete this.allowedContent;\n\t\t\tdelete this.disallowedContent;\n\t\t}\n\t};\n\n\tfunction addAndOptimizeRules( that, newRules, featureName, standardizedRules, optimizedRules ) {\n\t\tvar groupName, rule,\n\t\t\trulesToOptimize = [];\n\n\t\tfor ( groupName in newRules ) {\n\t\t\trule = newRules[ groupName ];\n\n\t\t\t// { 'p h1': true } => { 'p h1': {} }.\n\t\t\tif ( typeof rule == 'boolean' )\n\t\t\t\trule = {};\n\t\t\t// { 'p h1': func } => { 'p h1': { match: func } }.\n\t\t\telse if ( typeof rule == 'function' )\n\t\t\t\trule = { match: rule };\n\t\t\t// Clone (shallow) rule, because we'll modify it later.\n\t\t\telse\n\t\t\t\trule = copy( rule );\n\n\t\t\t// If this is not an unnamed rule ({ '$1' => { ... } })\n\t\t\t// move elements list to property.\n\t\t\tif ( groupName.charAt( 0 ) != '$' )\n\t\t\t\trule.elements = groupName;\n\n\t\t\tif ( featureName )\n\t\t\t\trule.featureName = featureName.toLowerCase();\n\n\t\t\tstandardizeRule( rule );\n\n\t\t\t// Save rule and remember to optimize it.\n\t\t\tstandardizedRules.push( rule );\n\t\t\trulesToOptimize.push( rule );\n\t\t}\n\n\t\toptimizeRules( optimizedRules, rulesToOptimize );\n\t}\n\n\t// Apply ACR to an element.\n\t// @param rule\n\t// @param element\n\t// @param status Object containing status of element's filtering.\n\t// @param {Boolean} skipRequired If true don't check if element has all required properties.\n\tfunction applyAllowedRule( rule, element, status, skipRequired ) {\n\t\t// This rule doesn't match this element - skip it.\n\t\tif ( rule.match && !rule.match( element ) )\n\t\t\treturn;\n\n\t\t// If element doesn't have all required styles/attrs/classes\n\t\t// this rule doesn't match it.\n\t\tif ( !skipRequired && !hasAllRequired( rule, element ) )\n\t\t\treturn;\n\n\t\t// If this rule doesn't validate properties only mark element as valid.\n\t\tif ( !rule.propertiesOnly )\n\t\t\tstatus.valid = true;\n\n\t\t// Apply rule only when all attrs/styles/classes haven't been marked as valid.\n\t\tif ( !status.allAttributes )\n\t\t\tstatus.allAttributes = applyAllowedRuleToHash( rule.attributes, element.attributes, status.validAttributes );\n\n\t\tif ( !status.allStyles )\n\t\t\tstatus.allStyles = applyAllowedRuleToHash( rule.styles, element.styles, status.validStyles );\n\n\t\tif ( !status.allClasses )\n\t\t\tstatus.allClasses = applyAllowedRuleToArray( rule.classes, element.classes, status.validClasses );\n\t}\n\n\t// Apply itemsRule to items (only classes are kept in array).\n\t// Push accepted items to validItems array.\n\t// Return true when all items are valid.\n\tfunction applyAllowedRuleToArray( itemsRule, items, validItems ) {\n\t\tif ( !itemsRule )\n\t\t\treturn false;\n\n\t\t// True means that all elements of array are accepted (the asterix was used for classes).\n\t\tif ( itemsRule === true )\n\t\t\treturn true;\n\n\t\tfor ( var i = 0, l = items.length, item; i < l; ++i ) {\n\t\t\titem = items[ i ];\n\t\t\tif ( !validItems[ item ] )\n\t\t\t\tvalidItems[ item ] = itemsRule( item );\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tfunction applyAllowedRuleToHash( itemsRule, items, validItems ) {\n\t\tif ( !itemsRule )\n\t\t\treturn false;\n\n\t\tif ( itemsRule === true )\n\t\t\treturn true;\n\n\t\tfor ( var name in items ) {\n\t\t\tif ( !validItems[ name ] )\n\t\t\t\tvalidItems[ name ] = itemsRule( name );\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t// Apply DACR rule to an element.\n\tfunction applyDisallowedRule( rule, element, status ) {\n\t\t// This rule doesn't match this element - skip it.\n\t\tif ( rule.match && !rule.match( element ) )\n\t\t\treturn;\n\n\t\t// No properties - it's an element only rule so it disallows entire element.\n\t\t// Early return is handled in filterElement.\n\t\tif ( rule.noProperties )\n\t\t\treturn false;\n\n\t\t// Apply rule to attributes, styles and classes. Switch hadInvalid* to true if method returned true.\n\t\tstatus.hadInvalidAttribute = applyDisallowedRuleToHash( rule.attributes, element.attributes ) || status.hadInvalidAttribute;\n\t\tstatus.hadInvalidStyle = applyDisallowedRuleToHash( rule.styles, element.styles ) || status.hadInvalidStyle;\n\t\tstatus.hadInvalidClass = applyDisallowedRuleToArray( rule.classes, element.classes ) || status.hadInvalidClass;\n\t}\n\n\t// Apply DACR to items (only classes are kept in array).\n\t// @returns {Boolean} True if at least one of items was invalid (disallowed).\n\tfunction applyDisallowedRuleToArray( itemsRule, items ) {\n\t\tif ( !itemsRule )\n\t\t\treturn false;\n\n\t\tvar hadInvalid = false,\n\t\t\tallDisallowed = itemsRule === true;\n\n\t\tfor ( var i = items.length; i--; ) {\n\t\t\tif ( allDisallowed || itemsRule( items[ i ] ) ) {\n\t\t\t\titems.splice( i, 1 );\n\t\t\t\thadInvalid = true;\n\t\t\t}\n\t\t}\n\n\t\treturn hadInvalid;\n\t}\n\n\t// Apply DACR to items (styles and attributes).\n\t// @returns {Boolean} True if at least one of items was invalid (disallowed).\n\tfunction applyDisallowedRuleToHash( itemsRule, items ) {\n\t\tif ( !itemsRule )\n\t\t\treturn false;\n\n\t\tvar hadInvalid = false,\n\t\t\tallDisallowed = itemsRule === true;\n\n\t\tfor ( var name in items ) {\n\t\t\tif ( allDisallowed || itemsRule( name ) ) {\n\t\t\t\tdelete items[ name ];\n\t\t\t\thadInvalid = true;\n\t\t\t}\n\t\t}\n\n\t\treturn hadInvalid;\n\t}\n\n\tfunction beforeAddingRule( that, newRules, overrideCustom ) {\n\t\tif ( that.disabled )\n\t\t\treturn false;\n\n\t\t// Don't override custom user's configuration if not explicitly requested.\n\t\tif ( that.customConfig && !overrideCustom )\n\t\t\treturn false;\n\n\t\tif ( !newRules )\n\t\t\treturn false;\n\n\t\t// Clear cache, because new rules could change results of checks.\n\t\tthat._.cachedChecks = {};\n\n\t\treturn true;\n\t}\n\n\t// Convert CKEDITOR.style to filter's rule.\n\tfunction convertStyleToRules( style ) {\n\t\tvar styleDef = style.getDefinition(),\n\t\t\trules = {},\n\t\t\trule,\n\t\t\tattrs = styleDef.attributes;\n\n\t\trules[ styleDef.element ] = rule = {\n\t\t\tstyles: styleDef.styles,\n\t\t\trequiredStyles: styleDef.styles && CKEDITOR.tools.objectKeys( styleDef.styles )\n\t\t};\n\n\t\tif ( attrs ) {\n\t\t\tattrs = copy( attrs );\n\t\t\trule.classes = attrs[ 'class' ] ? attrs[ 'class' ].split( /\\s+/ ) : null;\n\t\t\trule.requiredClasses = rule.classes;\n\t\t\tdelete attrs[ 'class' ];\n\t\t\trule.attributes = attrs;\n\t\t\trule.requiredAttributes = attrs && CKEDITOR.tools.objectKeys( attrs );\n\t\t}\n\n\t\treturn rules;\n\t}\n\n\t// Convert all validator formats (string, array, object, boolean) to hash or boolean:\n\t// * true is returned for '*'/true validator,\n\t// * false is returned for empty validator (no validator at all (false/null) or e.g. empty array),\n\t// * object is returned in other cases.\n\tfunction convertValidatorToHash( validator, delimiter ) {\n\t\tif ( !validator )\n\t\t\treturn false;\n\n\t\tif ( validator === true )\n\t\t\treturn validator;\n\n\t\tif ( typeof validator == 'string' ) {\n\t\t\tvalidator = trim( validator );\n\t\t\tif ( validator == '*' )\n\t\t\t\treturn true;\n\t\t\telse\n\t\t\t\treturn CKEDITOR.tools.convertArrayToObject( validator.split( delimiter ) );\n\t\t}\n\t\telse if ( CKEDITOR.tools.isArray( validator ) ) {\n\t\t\tif ( validator.length )\n\t\t\t\treturn CKEDITOR.tools.convertArrayToObject( validator );\n\t\t\telse\n\t\t\t\treturn false;\n\t\t}\n\t\t// If object.\n\t\telse {\n\t\t\tvar obj = {},\n\t\t\t\tlen = 0;\n\n\t\t\tfor ( var i in validator ) {\n\t\t\t\tobj[ i ] = validator[ i ];\n\t\t\t\tlen++;\n\t\t\t}\n\n\t\t\treturn len ? obj : false;\n\t\t}\n\t}\n\n\tfunction executeElementCallbacks( element, callbacks ) {\n\t\tfor ( var i = 0, l = callbacks.length, retVal; i < l; ++i ) {\n\t\t\tif ( ( retVal = callbacks[ i ]( element ) ) )\n\t\t\t\treturn retVal;\n\t\t}\n\t}\n\n\t// Extract required properties from \"required\" validator and \"all\" properties.\n\t// Remove exclamation marks from \"all\" properties.\n\t//\n\t// E.g.:\n\t// requiredClasses = { cl1: true }\n\t// (all) classes = { cl1: true, cl2: true, '!cl3': true }\n\t//\n\t// result:\n\t// returned = { cl1: true, cl3: true }\n\t// all = { cl1: true, cl2: true, cl3: true }\n\t//\n\t// This function returns false if nothing is required.\n\tfunction extractRequired( required, all ) {\n\t\tvar unbang = [],\n\t\t\tempty = true,\n\t\t\ti;\n\n\t\tif ( required )\n\t\t\tempty = false;\n\t\telse\n\t\t\trequired = {};\n\n\t\tfor ( i in all ) {\n\t\t\tif ( i.charAt( 0 ) == '!' ) {\n\t\t\t\ti = i.slice( 1 );\n\t\t\t\tunbang.push( i );\n\t\t\t\trequired[ i ] = true;\n\t\t\t\tempty = false;\n\t\t\t}\n\t\t}\n\n\t\twhile ( ( i = unbang.pop() ) ) {\n\t\t\tall[ i ] = all[ '!' + i ];\n\t\t\tdelete all[ '!' + i ];\n\t\t}\n\n\t\treturn empty ? false : required;\n\t}\n\n\t// Does the actual filtering by appling allowed content rules\n\t// to the element.\n\t//\n\t// @param {CKEDITOR.filter} that The context.\n\t// @param {CKEDITOR.htmlParser.element} element\n\t// @param {Object} opts The same as in processElement.\n\tfunction filterElement( that, element, opts ) {\n\t\tvar name = element.name,\n\t\t\tprivObj = that._,\n\t\t\tallowedRules = privObj.allowedRules.elements[ name ],\n\t\t\tgenericAllowedRules = privObj.allowedRules.generic,\n\t\t\tdisallowedRules = privObj.disallowedRules.elements[ name ],\n\t\t\tgenericDisallowedRules = privObj.disallowedRules.generic,\n\t\t\tskipRequired = opts.skipRequired,\n\t\t\tstatus = {\n\t\t\t\t// Whether any of rules accepted element.\n\t\t\t\t// If not - it will be stripped.\n\t\t\t\tvalid: false,\n\t\t\t\t// Objects containing accepted attributes, classes and styles.\n\t\t\t\tvalidAttributes: {},\n\t\t\t\tvalidClasses: {},\n\t\t\t\tvalidStyles: {},\n\t\t\t\t// Whether all are valid.\n\t\t\t\t// If we know that all element's attrs/classes/styles are valid\n\t\t\t\t// we can skip their validation, to improve performance.\n\t\t\t\tallAttributes: false,\n\t\t\t\tallClasses: false,\n\t\t\t\tallStyles: false,\n\t\t\t\t// Whether element had (before applying DACRs) at least one invalid attribute/class/style.\n\t\t\t\thadInvalidAttribute: false,\n\t\t\t\thadInvalidClass: false,\n\t\t\t\thadInvalidStyle: false\n\t\t\t},\n\t\t\ti, l;\n\n\t\t// Early return - if there are no rules for this element (specific or generic), remove it.\n\t\tif ( !allowedRules && !genericAllowedRules )\n\t\t\treturn null;\n\n\t\t// Could not be done yet if there were no transformations and if this\n\t\t// is real (not mocked) object.\n\t\tpopulateProperties( element );\n\n\t\t// Note - this step modifies element's styles, classes and attributes.\n\t\tif ( disallowedRules ) {\n\t\t\tfor ( i = 0, l = disallowedRules.length; i < l; ++i ) {\n\t\t\t\t// Apply rule and make an early return if false is returned what means\n\t\t\t\t// that element is completely disallowed.\n\t\t\t\tif ( applyDisallowedRule( disallowedRules[ i ], element, status ) === false )\n\t\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\n\t\t// Note - this step modifies element's styles, classes and attributes.\n\t\tif ( genericDisallowedRules ) {\n\t\t\tfor ( i = 0, l = genericDisallowedRules.length; i < l; ++i )\n\t\t\t\tapplyDisallowedRule( genericDisallowedRules[ i ], element, status );\n\t\t}\n\n\t\tif ( allowedRules ) {\n\t\t\tfor ( i = 0, l = allowedRules.length; i < l; ++i )\n\t\t\t\tapplyAllowedRule( allowedRules[ i ], element, status, skipRequired );\n\t\t}\n\n\t\tif ( genericAllowedRules ) {\n\t\t\tfor ( i = 0, l = genericAllowedRules.length; i < l; ++i )\n\t\t\t\tapplyAllowedRule( genericAllowedRules[ i ], element, status, skipRequired );\n\t\t}\n\n\t\treturn status;\n\t}\n\n\t// Check whether element has all properties (styles,classes,attrs) required by a rule.\n\tfunction hasAllRequired( rule, element ) {\n\t\tif ( rule.nothingRequired )\n\t\t\treturn true;\n\n\t\tvar i, req, reqs, existing;\n\n\t\tif ( ( reqs = rule.requiredClasses ) ) {\n\t\t\texisting = element.classes;\n\t\t\tfor ( i = 0; i < reqs.length; ++i ) {\n\t\t\t\treq = reqs[ i ];\n\t\t\t\tif ( typeof req == 'string' ) {\n\t\t\t\t\tif ( CKEDITOR.tools.indexOf( existing, req ) == -1 )\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t// This means regexp.\n\t\t\t\telse {\n\t\t\t\t\tif ( !CKEDITOR.tools.checkIfAnyArrayItemMatches( existing, req ) )\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn hasAllRequiredInHash( element.styles, rule.requiredStyles ) &&\n\t\t\thasAllRequiredInHash( element.attributes, rule.requiredAttributes );\n\t}\n\n\t// Check whether all items in required (array) exist in existing (object).\n\tfunction hasAllRequiredInHash( existing, required ) {\n\t\tif ( !required )\n\t\t\treturn true;\n\n\t\tfor ( var i = 0, req; i < required.length; ++i ) {\n\t\t\treq = required[ i ];\n\t\t\tif ( typeof req == 'string' ) {\n\t\t\t\tif ( !( req in existing ) )\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\t// This means regexp.\n\t\t\telse {\n\t\t\t\tif ( !CKEDITOR.tools.checkIfAnyObjectPropertyMatches( existing, req ) )\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t// Create pseudo element that will be passed through filter\n\t// to check if tested string is allowed.\n\tfunction mockElementFromString( str ) {\n\t\tvar element = parseRulesString( str ).$1,\n\t\t\tstyles = element.styles,\n\t\t\tclasses = element.classes;\n\n\t\telement.name = element.elements;\n\t\telement.classes = classes = ( classes ? classes.split( /\\s*,\\s*/ ) : [] );\n\t\telement.styles = mockHash( styles );\n\t\telement.attributes = mockHash( element.attributes );\n\t\telement.children = [];\n\n\t\tif ( classes.length )\n\t\t\telement.attributes[ 'class' ] = classes.join( ' ' );\n\t\tif ( styles )\n\t\t\telement.attributes.style = CKEDITOR.tools.writeCssText( element.styles );\n\n\t\treturn element;\n\t}\n\n\t// Create pseudo element that will be passed through filter\n\t// to check if tested style is allowed.\n\tfunction mockElementFromStyle( style ) {\n\t\tvar styleDef = style.getDefinition(),\n\t\t\tstyles = styleDef.styles,\n\t\t\tattrs = styleDef.attributes || {};\n\n\t\tif ( styles && !CKEDITOR.tools.isEmpty( styles ) ) {\n\t\t\tstyles = copy( styles );\n\t\t\tattrs.style = CKEDITOR.tools.writeCssText( styles, true );\n\t\t} else {\n\t\t\tstyles = {};\n\t\t}\n\n\t\treturn {\n\t\t\tname: styleDef.element,\n\t\t\tattributes: attrs,\n\t\t\tclasses: attrs[ 'class' ] ? attrs[ 'class' ].split( /\\s+/ ) : [],\n\t\t\tstyles: styles,\n\t\t\tchildren: []\n\t\t};\n\t}\n\n\t// Mock hash based on string.\n\t// 'a,b,c' => { a: 'cke-test', b: 'cke-test', c: 'cke-test' }\n\t// Used to mock styles and attributes objects.\n\tfunction mockHash( str ) {\n\t\t// It may be a null or empty string.\n\t\tif ( !str )\n\t\t\treturn {};\n\n\t\tvar keys = str.split( /\\s*,\\s*/ ).sort(),\n\t\t\tobj = {};\n\n\t\twhile ( keys.length )\n\t\t\tobj[ keys.shift() ] = TEST_VALUE;\n\n\t\treturn obj;\n\t}\n\n\t// Extract properties names from the object\n\t// and replace those containing wildcards with regexps.\n\t// Note: there's a room for performance improvement. Array of mixed types\n\t// breaks JIT-compiler optiomization what may invalidate compilation of pretty a lot of code.\n\t//\n\t// @returns An array of strings and regexps.\n\tfunction optimizeRequiredProperties( requiredProperties ) {\n\t\tvar arr = [];\n\t\tfor ( var propertyName in requiredProperties ) {\n\t\t\tif ( propertyName.indexOf( '*' ) > -1 )\n\t\t\t\tarr.push( new RegExp( '^' + propertyName.replace( /\\*/g, '.*' ) + '$' ) );\n\t\t\telse\n\t\t\t\tarr.push( propertyName );\n\t\t}\n\t\treturn arr;\n\t}\n\n\tvar validators = { styles: 1, attributes: 1, classes: 1 },\n\t\tvalidatorsRequired = {\n\t\t\tstyles: 'requiredStyles',\n\t\t\tattributes: 'requiredAttributes',\n\t\t\tclasses: 'requiredClasses'\n\t\t};\n\n\t// Optimize a rule by replacing validators with functions\n\t// and rewriting requiredXXX validators to arrays.\n\tfunction optimizeRule( rule ) {\n\t\tvar validatorName,\n\t\t\trequiredProperties,\n\t\t\ti;\n\n\t\tfor ( validatorName in validators )\n\t\t\trule[ validatorName ] = validatorFunction( rule[ validatorName ] );\n\n\t\tvar nothingRequired = true;\n\t\tfor ( i in validatorsRequired ) {\n\t\t\tvalidatorName = validatorsRequired[ i ];\n\t\t\trequiredProperties = optimizeRequiredProperties( rule[ validatorName ] );\n\t\t\t// Don't set anything if there are no required properties. This will allow to\n\t\t\t// save some memory by GCing all empty arrays (requiredProperties).\n\t\t\tif ( requiredProperties.length ) {\n\t\t\t\trule[ validatorName ] = requiredProperties;\n\t\t\t\tnothingRequired = false;\n\t\t\t}\n\t\t}\n\n\t\trule.nothingRequired = nothingRequired;\n\t\trule.noProperties = !( rule.attributes || rule.classes || rule.styles );\n\t}\n\n\t// Add optimized version of rule to optimizedRules object.\n\tfunction optimizeRules( optimizedRules, rules ) {\n\t\tvar elementsRules = optimizedRules.elements,\n\t\t\tgenericRules = optimizedRules.generic,\n\t\t\ti, l, rule, element, priority;\n\n\t\tfor ( i = 0, l = rules.length; i < l; ++i ) {\n\t\t\t// Shallow copy. Do not modify original rule.\n\t\t\trule = copy( rules[ i ] );\n\t\t\tpriority = rule.classes === true || rule.styles === true || rule.attributes === true;\n\t\t\toptimizeRule( rule );\n\n\t\t\t// E.g. \"*(xxx)[xxx]\" - it's a generic rule that\n\t\t\t// validates properties only.\n\t\t\t// Or '$1': { match: function() {...} }\n\t\t\tif ( rule.elements === true || rule.elements === null ) {\n\t\t\t\t// Add priority rules at the beginning.\n\t\t\t\tgenericRules[ priority ? 'unshift' : 'push' ]( rule );\n\t\t\t}\n\t\t\t// If elements list was explicitly defined,\n\t\t\t// add this rule for every defined element.\n\t\t\telse {\n\t\t\t\t// We don't need elements validator for this kind of rule.\n\t\t\t\tvar elements = rule.elements;\n\t\t\t\tdelete rule.elements;\n\n\t\t\t\tfor ( element in elements ) {\n\t\t\t\t\tif ( !elementsRules[ element ] )\n\t\t\t\t\t\telementsRules[ element ] = [ rule ];\n\t\t\t\t\telse\n\t\t\t\t\t\telementsRules[ element ][ priority ? 'unshift' : 'push' ]( rule );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t//                  <   elements   ><                       styles, attributes and classes                        >< separator >\n\tvar rulePattern = /^([a-z0-9\\-*\\s]+)((?:\\s*\\{[!\\w\\-,\\s\\*]+\\}\\s*|\\s*\\[[!\\w\\-,\\s\\*]+\\]\\s*|\\s*\\([!\\w\\-,\\s\\*]+\\)\\s*){0,3})(?:;\\s*|$)/i,\n\t\tgroupsPatterns = {\n\t\t\tstyles: /{([^}]+)}/,\n\t\t\tattrs: /\\[([^\\]]+)\\]/,\n\t\t\tclasses: /\\(([^\\)]+)\\)/\n\t\t};\n\n\tfunction parseRulesString( input ) {\n\t\tvar match,\n\t\t\tprops, styles, attrs, classes,\n\t\t\trules = {},\n\t\t\tgroupNum = 1;\n\n\t\tinput = trim( input );\n\n\t\twhile ( ( match = input.match( rulePattern ) ) ) {\n\t\t\tif ( ( props = match[ 2 ] ) ) {\n\t\t\t\tstyles = parseProperties( props, 'styles' );\n\t\t\t\tattrs = parseProperties( props, 'attrs' );\n\t\t\t\tclasses = parseProperties( props, 'classes' );\n\t\t\t} else {\n\t\t\t\tstyles = attrs = classes = null;\n\t\t\t}\n\n\t\t\t// Add as an unnamed rule, because there can be two rules\n\t\t\t// for one elements set defined in string format.\n\t\t\trules[ '$' + groupNum++ ] = {\n\t\t\t\telements: match[ 1 ],\n\t\t\t\tclasses: classes,\n\t\t\t\tstyles: styles,\n\t\t\t\tattributes: attrs\n\t\t\t};\n\n\t\t\t// Move to the next group.\n\t\t\tinput = input.slice( match[ 0 ].length );\n\t\t}\n\n\t\treturn rules;\n\t}\n\n\t// Extract specified properties group (styles, attrs, classes) from\n\t// what stands after the elements list in string format of allowedContent.\n\tfunction parseProperties( properties, groupName ) {\n\t\tvar group = properties.match( groupsPatterns[ groupName ] );\n\t\treturn group ? trim( group[ 1 ] ) : null;\n\t}\n\n\tfunction populateProperties( element ) {\n\t\t\t// Backup styles and classes, because they may be removed by DACRs.\n\t\t\t// We'll need them in updateElement().\n\t\tvar styles = element.styleBackup = element.attributes.style,\n\t\t\tclasses = element.classBackup = element.attributes[ 'class' ];\n\n\t\t// Parse classes and styles if that hasn't been done before.\n\t\tif ( !element.styles )\n\t\t\telement.styles = CKEDITOR.tools.parseCssText( styles || '', 1 );\n\t\tif ( !element.classes )\n\t\t\telement.classes = classes ? classes.split( /\\s+/ ) : [];\n\t}\n\n\t// Filter element protected with a comment.\n\t// Returns true if protected content is ok, false otherwise.\n\tfunction processProtectedElement( that, comment, protectedRegexs, filterOpts ) {\n\t\tvar source = decodeURIComponent( comment.value.replace( /^\\{cke_protected\\}/, '' ) ),\n\t\t\tprotectedFrag,\n\t\t\ttoBeRemoved = [],\n\t\t\tnode, i, match;\n\n\t\t// Protected element's and protected source's comments look exactly the same.\n\t\t// Check if what we have isn't a protected source instead of protected script/noscript.\n\t\tif ( protectedRegexs ) {\n\t\t\tfor ( i = 0; i < protectedRegexs.length; ++i ) {\n\t\t\t\tif ( ( match = source.match( protectedRegexs[ i ] ) ) &&\n\t\t\t\t\tmatch[ 0 ].length == source.length\t// Check whether this pattern matches entire source\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// to avoid '<script>alert(\"<? 1 ?>\")</script>' matching\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// the PHP's protectedSource regexp.\n\t\t\t\t)\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tprotectedFrag = CKEDITOR.htmlParser.fragment.fromHtml( source );\n\n\t\tif ( protectedFrag.children.length == 1 && ( node = protectedFrag.children[ 0 ] ).type == CKEDITOR.NODE_ELEMENT )\n\t\t\tprocessElement( that, node, toBeRemoved, filterOpts );\n\n\t\t// If protected element has been marked to be removed, return 'false' - comment was rejected.\n\t\treturn !toBeRemoved.length;\n\t}\n\n\tvar unprotectElementsNamesRegexp = /^cke:(object|embed|param)$/,\n\t\tprotectElementsNamesRegexp = /^(object|embed|param)$/;\n\n\t// The actual function which filters, transforms and does other funny things with an element.\n\t//\n\t// @param {CKEDITOR.filter} that Context.\n\t// @param {CKEDITOR.htmlParser.element} element The element to be processed.\n\t// @param {Array} toBeRemoved Array into which elements rejected by the filter will be pushed.\n\t// @param {Boolean} [opts.doFilter] Whether element should be filtered.\n\t// @param {Boolean} [opts.doTransform] Whether transformations should be applied.\n\t// @param {Boolean} [opts.doCallbacks] Whether to execute element callbacks.\n\t// @param {Boolean} [opts.toHtml] Set to true if filter used together with htmlDP#toHtml\n\t// @param {Boolean} [opts.skipRequired] Whether element's required properties shouldn't be verified.\n\t// @param {Boolean} [opts.skipFinalValidation] Whether to not perform final element validation (a,img).\n\t// @returns {Number} Possible flags:\n\t//  * FILTER_ELEMENT_MODIFIED,\n\t//  * FILTER_SKIP_TREE.\n\tfunction processElement( that, element, toBeRemoved, opts ) {\n\t\tvar status,\n\t\t\tretVal = 0,\n\t\t\tcallbacksRetVal;\n\n\t\t// Unprotect elements names previously protected by htmlDataProcessor\n\t\t// (see protectElementNames and protectSelfClosingElements functions).\n\t\t// Note: body, title, etc. are not protected by htmlDataP (or are protected and then unprotected).\n\t\tif ( opts.toHtml )\n\t\t\telement.name = element.name.replace( unprotectElementsNamesRegexp, '$1' );\n\n\t\t// Execute element callbacks and return if one of them returned any value.\n\t\tif ( opts.doCallbacks && that.elementCallbacks ) {\n\t\t\t// For now we only support here FILTER_SKIP_TREE, so we can early return if retVal is truly value.\n\t\t\tif ( ( callbacksRetVal = executeElementCallbacks( element, that.elementCallbacks ) ) )\n\t\t\t\treturn callbacksRetVal;\n\t\t}\n\n\t\t// If transformations are set apply all groups.\n\t\tif ( opts.doTransform )\n\t\t\ttransformElement( that, element );\n\n\t\tif ( opts.doFilter ) {\n\t\t\t// Apply all filters.\n\t\t\tstatus = filterElement( that, element, opts );\n\n\t\t\t// Handle early return from filterElement.\n\t\t\tif ( !status ) {\n\t\t\t\ttoBeRemoved.push( element );\n\t\t\t\treturn FILTER_ELEMENT_MODIFIED;\n\t\t\t}\n\n\t\t\t// Finally, if after running all filter rules it still hasn't been allowed - remove it.\n\t\t\tif ( !status.valid ) {\n\t\t\t\ttoBeRemoved.push( element );\n\t\t\t\treturn FILTER_ELEMENT_MODIFIED;\n\t\t\t}\n\n\t\t\t// Update element's attributes based on status of filtering.\n\t\t\tif ( updateElement( element, status ) )\n\t\t\t\tretVal = FILTER_ELEMENT_MODIFIED;\n\n\t\t\tif ( !opts.skipFinalValidation && !validateElement( element ) ) {\n\t\t\t\ttoBeRemoved.push( element );\n\t\t\t\treturn FILTER_ELEMENT_MODIFIED;\n\t\t\t}\n\t\t}\n\n\t\t// Protect previously unprotected elements.\n\t\tif ( opts.toHtml )\n\t\t\telement.name = element.name.replace( protectElementsNamesRegexp, 'cke:$1' );\n\n\t\treturn retVal;\n\t}\n\n\t// Returns a regexp object which can be used to test if a property\n\t// matches one of wildcard validators.\n\tfunction regexifyPropertiesWithWildcards( validators ) {\n\t\tvar patterns = [],\n\t\t\ti;\n\n\t\tfor ( i in validators ) {\n\t\t\tif ( i.indexOf( '*' ) > -1 )\n\t\t\t\tpatterns.push( i.replace( /\\*/g, '.*' ) );\n\t\t}\n\n\t\tif ( patterns.length )\n\t\t\treturn new RegExp( '^(?:' + patterns.join( '|' ) + ')$' );\n\t\telse\n\t\t\treturn null;\n\t}\n\n\t// Standardize a rule by converting all validators to hashes.\n\tfunction standardizeRule( rule ) {\n\t\trule.elements = convertValidatorToHash( rule.elements, /\\s+/ ) || null;\n\t\trule.propertiesOnly = rule.propertiesOnly || ( rule.elements === true );\n\n\t\tvar delim = /\\s*,\\s*/,\n\t\t\ti;\n\n\t\tfor ( i in validators ) {\n\t\t\trule[ i ] = convertValidatorToHash( rule[ i ], delim ) || null;\n\t\t\trule[ validatorsRequired[ i ] ] = extractRequired( convertValidatorToHash(\n\t\t\t\trule[ validatorsRequired[ i ] ], delim ), rule[ i ] ) || null;\n\t\t}\n\n\t\trule.match = rule.match || null;\n\t}\n\n\t// Does the element transformation by applying registered\n\t// transformation rules.\n\tfunction transformElement( that, element ) {\n\t\tvar transformations = that._.transformations[ element.name ],\n\t\t\ti;\n\n\t\tif ( !transformations )\n\t\t\treturn;\n\n\t\tpopulateProperties( element );\n\n\t\tfor ( i = 0; i < transformations.length; ++i )\n\t\t\tapplyTransformationsGroup( that, element, transformations[ i ] );\n\n\t\t// Do not count on updateElement() which is called in processElement, because it:\n\t\t// * may not be called,\n\t\t// * may skip some properties when all are marked as valid.\n\t\tupdateAttributes( element );\n\t}\n\n\t// Copy element's styles and classes back to attributes array.\n\tfunction updateAttributes( element ) {\n\t\tvar attrs = element.attributes,\n\t\t\tstyles;\n\n\t\t// Will be recreated later if any of styles/classes exists.\n\t\tdelete attrs.style;\n\t\tdelete attrs[ 'class' ];\n\n\t\tif ( ( styles = CKEDITOR.tools.writeCssText( element.styles, true ) ) )\n\t\t\tattrs.style = styles;\n\n\t\tif ( element.classes.length )\n\t\t\tattrs[ 'class' ] = element.classes.sort().join( ' ' );\n\t}\n\n\t// Update element object based on status of filtering.\n\t// @returns Whether element was modified.\n\tfunction updateElement( element, status ) {\n\t\tvar validAttrs = status.validAttributes,\n\t\t\tvalidStyles = status.validStyles,\n\t\t\tvalidClasses = status.validClasses,\n\t\t\tattrs = element.attributes,\n\t\t\tstyles = element.styles,\n\t\t\tclasses = element.classes,\n\t\t\torigClasses = element.classBackup,\n\t\t\torigStyles = element.styleBackup,\n\t\t\tname, origName, i,\n\t\t\tstylesArr = [],\n\t\t\tclassesArr = [],\n\t\t\tinternalAttr = /^data-cke-/,\n\t\t\tisModified = false;\n\n\t\t// Will be recreated later if any of styles/classes were passed.\n\t\tdelete attrs.style;\n\t\tdelete attrs[ 'class' ];\n\t\t// Clean up.\n\t\tdelete element.classBackup;\n\t\tdelete element.styleBackup;\n\n\t\tif ( !status.allAttributes ) {\n\t\t\tfor ( name in attrs ) {\n\t\t\t\t// If not valid and not internal attribute delete it.\n\t\t\t\tif ( !validAttrs[ name ] ) {\n\t\t\t\t\t// Allow all internal attibutes...\n\t\t\t\t\tif ( internalAttr.test( name ) ) {\n\t\t\t\t\t\t// ... unless this is a saved attribute and the original one isn't allowed.\n\t\t\t\t\t\tif ( name != ( origName = name.replace( /^data-cke-saved-/, '' ) ) &&\n\t\t\t\t\t\t\t!validAttrs[ origName ]\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tdelete attrs[ name ];\n\t\t\t\t\t\t\tisModified = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdelete attrs[ name ];\n\t\t\t\t\t\tisModified = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tif ( !status.allStyles || status.hadInvalidStyle ) {\n\t\t\tfor ( name in styles ) {\n\t\t\t\t// We check status.allStyles because when there was a '*' ACR and some\n\t\t\t\t// DACR we have now both properties true - status.allStyles and status.hadInvalidStyle.\n\t\t\t\t// However unlike in the case when we only have '*' ACR, in which we can just copy original\n\t\t\t\t// styles, in this case we must copy only those styles which were not removed by DACRs.\n\t\t\t\tif ( status.allStyles || validStyles[ name ] )\n\t\t\t\t\tstylesArr.push( name + ':' + styles[ name ] );\n\t\t\t\telse\n\t\t\t\t\tisModified = true;\n\t\t\t}\n\t\t\tif ( stylesArr.length )\n\t\t\t\tattrs.style = stylesArr.sort().join( '; ' );\n\t\t}\n\t\telse if ( origStyles ) {\n\t\t\tattrs.style = origStyles;\n\t\t}\n\n\t\tif ( !status.allClasses || status.hadInvalidClass ) {\n\t\t\tfor ( i = 0; i < classes.length; ++i ) {\n\t\t\t\t// See comment for styles.\n\t\t\t\tif ( status.allClasses || validClasses[ classes[ i ] ] )\n\t\t\t\t\tclassesArr.push( classes[ i ] );\n\t\t\t}\n\t\t\tif ( classesArr.length )\n\t\t\t\tattrs[ 'class' ] = classesArr.sort().join( ' ' );\n\n\t\t\tif ( origClasses && classesArr.length < origClasses.split( /\\s+/ ).length )\n\t\t\t\tisModified = true;\n\t\t}\n\t\telse if ( origClasses ) {\n\t\t\tattrs[ 'class' ] = origClasses;\n\t\t}\n\n\t\treturn isModified;\n\t}\n\n\tfunction validateElement( element ) {\n\t\tswitch ( element.name ) {\n\t\t\tcase 'a':\n\t\t\t\t// Code borrowed from htmlDataProcessor, so ACF does the same clean up.\n\t\t\t\tif ( !( element.children.length || element.attributes.name || element.attributes.id ) )\n\t\t\t\t\treturn false;\n\t\t\t\tbreak;\n\t\t\tcase 'img':\n\t\t\t\tif ( !element.attributes.src )\n\t\t\t\t\treturn false;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tfunction validatorFunction( validator ) {\n\t\tif ( !validator )\n\t\t\treturn false;\n\t\tif ( validator === true )\n\t\t\treturn true;\n\n\t\t// Note: We don't need to remove properties with wildcards from the validator object.\n\t\t// E.g. data-* is actually an edge case of /^data-.*$/, so when it's accepted\n\t\t// by `value in validator` it's ok.\n\t\tvar regexp = regexifyPropertiesWithWildcards( validator );\n\n\t\treturn function( value ) {\n\t\t\treturn value in validator || ( regexp && value.match( regexp ) );\n\t\t};\n\t}\n\n\t//\n\t// REMOVE ELEMENT ---------------------------------------------------------\n\t//\n\n\t// Check whether all children will be valid in new context.\n\t// Note: it doesn't verify if text node is valid, because\n\t// new parent should accept them.\n\tfunction checkChildren( children, newParentName ) {\n\t\tvar allowed = DTD[ newParentName ];\n\n\t\tfor ( var i = 0, l = children.length, child; i < l; ++i ) {\n\t\t\tchild = children[ i ];\n\t\t\tif ( child.type == CKEDITOR.NODE_ELEMENT && !allowed[ child.name ] )\n\t\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tfunction createBr() {\n\t\treturn new CKEDITOR.htmlParser.element( 'br' );\n\t}\n\n\t// Whether this is an inline element or text.\n\tfunction inlineNode( node ) {\n\t\treturn node.type == CKEDITOR.NODE_TEXT ||\n\t\t\tnode.type == CKEDITOR.NODE_ELEMENT && DTD.$inline[ node.name ];\n\t}\n\n\tfunction isBrOrBlock( node ) {\n\t\treturn node.type == CKEDITOR.NODE_ELEMENT &&\n\t\t\t( node.name == 'br' || DTD.$block[ node.name ] );\n\t}\n\n\t// Try to remove element in the best possible way.\n\t//\n\t// @param {Array} toBeChecked After executing this function\n\t// this array will contain elements that should be checked\n\t// because they were marked as potentially:\n\t// * in wrong context (e.g. li in body),\n\t// * empty elements from $removeEmpty,\n\t// * incorrect img/a/other element validated by validateElement().\n\tfunction removeElement( element, enterTag, toBeChecked ) {\n\t\tvar name = element.name;\n\n\t\tif ( DTD.$empty[ name ] || !element.children.length ) {\n\t\t\t// Special case - hr in br mode should be replaced with br, not removed.\n\t\t\tif ( name == 'hr' && enterTag == 'br' )\n\t\t\t\telement.replaceWith( createBr() );\n\t\t\telse {\n\t\t\t\t// Parent might become an empty inline specified in $removeEmpty or empty a[href].\n\t\t\t\tif ( element.parent )\n\t\t\t\t\ttoBeChecked.push( { check: 'it', el: element.parent } );\n\n\t\t\t\telement.remove();\n\t\t\t}\n\t\t} else if ( DTD.$block[ name ] || name == 'tr' ) {\n\t\t\tif ( enterTag == 'br' )\n\t\t\t\tstripBlockBr( element, toBeChecked );\n\t\t\telse\n\t\t\t\tstripBlock( element, enterTag, toBeChecked );\n\t\t}\n\t\t// Special case - elements that may contain CDATA should be removed completely.\n\t\telse if ( name in { style: 1, script: 1 } )\n\t\t\telement.remove();\n\t\t// The rest of inline elements. May also be the last resort\n\t\t// for some special elements.\n\t\telse {\n\t\t\t// Parent might become an empty inline specified in $removeEmpty or empty a[href].\n\t\t\tif ( element.parent )\n\t\t\t\ttoBeChecked.push( { check: 'it', el: element.parent } );\n\t\t\telement.replaceWithChildren();\n\t\t}\n\t}\n\n\t// Strip element block, but leave its content.\n\t// Works in 'div' and 'p' enter modes.\n\tfunction stripBlock( element, enterTag, toBeChecked ) {\n\t\tvar children = element.children;\n\n\t\t// First, check if element's children may be wrapped with <p/div>.\n\t\t// Ignore that <p/div> may not be allowed in element.parent.\n\t\t// This will be fixed when removing parent or by toBeChecked rule.\n\t\tif ( checkChildren( children, enterTag ) ) {\n\t\t\telement.name = enterTag;\n\t\t\telement.attributes = {};\n\t\t\t// Check if this p/div was put in correct context.\n\t\t\t// If not - strip parent.\n\t\t\ttoBeChecked.push( { check: 'parent-down', el: element } );\n\t\t\treturn;\n\t\t}\n\n\t\tvar parent = element.parent,\n\t\t\tshouldAutoP = parent.type == CKEDITOR.NODE_DOCUMENT_FRAGMENT || parent.name == 'body',\n\t\t\ti, child, p, parentDtd;\n\n\t\tfor ( i = children.length; i > 0; ) {\n\t\t\tchild = children[ --i ];\n\n\t\t\t// If parent requires auto paragraphing and child is inline node,\n\t\t\t// insert this child into newly created paragraph.\n\t\t\tif ( shouldAutoP && inlineNode( child )  ) {\n\t\t\t\tif ( !p ) {\n\t\t\t\t\tp = new CKEDITOR.htmlParser.element( enterTag );\n\t\t\t\t\tp.insertAfter( element );\n\n\t\t\t\t\t// Check if this p/div was put in correct context.\n\t\t\t\t\t// If not - strip parent.\n\t\t\t\t\ttoBeChecked.push( { check: 'parent-down', el: p } );\n\t\t\t\t}\n\t\t\t\tp.add( child, 0 );\n\t\t\t}\n\t\t\t// Child which doesn't need to be auto paragraphed.\n\t\t\telse {\n\t\t\t\tp = null;\n\t\t\t\tparentDtd = DTD[ parent.name ] || DTD.span;\n\n\t\t\t\tchild.insertAfter( element );\n\t\t\t\t// If inserted into invalid context, mark it and check\n\t\t\t\t// after removing all elements.\n\t\t\t\tif ( parent.type != CKEDITOR.NODE_DOCUMENT_FRAGMENT &&\n\t\t\t\t\tchild.type == CKEDITOR.NODE_ELEMENT &&\n\t\t\t\t\t!parentDtd[ child.name ]\n\t\t\t\t)\n\t\t\t\t\ttoBeChecked.push( { check: 'el-up', el: child } );\n\t\t\t}\n\t\t}\n\n\t\t// All children have been moved to element's parent, so remove it.\n\t\telement.remove();\n\t}\n\n\t// Prepend/append block with <br> if isn't\n\t// already prepended/appended with <br> or block and\n\t// isn't first/last child of its parent.\n\t// Then replace element with its children.\n\t// <p>a</p><p>b</p> => <p>a</p><br>b => a<br>b\n\tfunction stripBlockBr( element ) {\n\t\tvar br;\n\n\t\tif ( element.previous && !isBrOrBlock( element.previous ) ) {\n\t\t\tbr = createBr();\n\t\t\tbr.insertBefore( element );\n\t\t}\n\n\t\tif ( element.next && !isBrOrBlock( element.next ) ) {\n\t\t\tbr = createBr();\n\t\t\tbr.insertAfter( element );\n\t\t}\n\n\t\telement.replaceWithChildren();\n\t}\n\n\t//\n\t// TRANSFORMATIONS --------------------------------------------------------\n\t//\n\tvar transformationsTools;\n\n\t// Apply given transformations group to the element.\n\tfunction applyTransformationsGroup( filter, element, group ) {\n\t\tvar i, rule;\n\n\t\tfor ( i = 0; i < group.length; ++i ) {\n\t\t\trule = group[ i ];\n\n\t\t\t// Test with #check or #left only if it's set.\n\t\t\t// Do not apply transformations because that creates infinite loop.\n\t\t\tif ( ( !rule.check || filter.check( rule.check, false ) ) &&\n\t\t\t\t( !rule.left || rule.left( element ) ) ) {\n\t\t\t\trule.right( element, transformationsTools );\n\t\t\t\treturn; // Only first matching rule in a group is executed.\n\t\t\t}\n\t\t}\n\t}\n\n\t// Check whether element matches CKEDITOR.style.\n\t// The element can be a \"superset\" of style,\n\t// e.g. it may have more classes, but need to have\n\t// at least those defined in style.\n\tfunction elementMatchesStyle( element, style ) {\n\t\tvar def = style.getDefinition(),\n\t\t\tdefAttrs = def.attributes,\n\t\t\tdefStyles = def.styles,\n\t\t\tattrName, styleName,\n\t\t\tclasses, classPattern, cl;\n\n\t\tif ( element.name != def.element )\n\t\t\treturn false;\n\n\t\tfor ( attrName in defAttrs ) {\n\t\t\tif ( attrName == 'class' ) {\n\t\t\t\tclasses = defAttrs[ attrName ].split( /\\s+/ );\n\t\t\t\tclassPattern = element.classes.join( '|' );\n\t\t\t\twhile ( ( cl = classes.pop() ) ) {\n\t\t\t\t\tif ( classPattern.indexOf( cl ) == -1 )\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif ( element.attributes[ attrName ] != defAttrs[ attrName ] )\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tfor ( styleName in defStyles ) {\n\t\t\tif ( element.styles[ styleName ] != defStyles[ styleName ] )\n\t\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t// Return transformation group for content form.\n\t// One content form makes one transformation rule in one group.\n\tfunction getContentFormTransformationGroup( form, preferredForm ) {\n\t\tvar element, left;\n\n\t\tif ( typeof form == 'string' )\n\t\t\telement = form;\n\t\telse if ( form instanceof CKEDITOR.style )\n\t\t\tleft = form;\n\t\telse {\n\t\t\telement = form[ 0 ];\n\t\t\tleft = form[ 1 ];\n\t\t}\n\n\t\treturn [ {\n\t\t\telement: element,\n\t\t\tleft: left,\n\t\t\tright: function( el, tools ) {\n\t\t\t\ttools.transform( el, preferredForm );\n\t\t\t}\n\t\t} ];\n\t}\n\n\t// Obtain element's name from transformation rule.\n\t// It will be defined by #element, or #check or #left (styleDef.element).\n\tfunction getElementNameForTransformation( rule, check ) {\n\t\tif ( rule.element )\n\t\t\treturn rule.element;\n\t\tif ( check )\n\t\t\treturn check.match( /^([a-z0-9]+)/i )[ 0 ];\n\t\treturn rule.left.getDefinition().element;\n\t}\n\n\tfunction getMatchStyleFn( style ) {\n\t\treturn function( el ) {\n\t\t\treturn elementMatchesStyle( el, style );\n\t\t};\n\t}\n\n\tfunction getTransformationFn( toolName ) {\n\t\treturn function( el, tools ) {\n\t\t\ttools[ toolName ]( el );\n\t\t};\n\t}\n\n\tfunction optimizeTransformationsGroup( rules ) {\n\t\tvar groupName, i, rule,\n\t\t\tcheck, left, right,\n\t\t\toptimizedRules = [];\n\n\t\tfor ( i = 0; i < rules.length; ++i ) {\n\t\t\trule = rules[ i ];\n\n\t\t\tif ( typeof rule == 'string' ) {\n\t\t\t\trule = rule.split( /\\s*:\\s*/ );\n\t\t\t\tcheck = rule[ 0 ];\n\t\t\t\tleft = null;\n\t\t\t\tright = rule[ 1 ];\n\t\t\t} else {\n\t\t\t\tcheck = rule.check;\n\t\t\t\tleft = rule.left;\n\t\t\t\tright = rule.right;\n\t\t\t}\n\n\t\t\t// Extract element name.\n\t\t\tif ( !groupName )\n\t\t\t\tgroupName = getElementNameForTransformation( rule, check );\n\n\t\t\tif ( left instanceof CKEDITOR.style )\n\t\t\t\tleft = getMatchStyleFn( left );\n\n\t\t\toptimizedRules.push( {\n\t\t\t\t// It doesn't make sense to test against name rule (e.g. 'table'), so don't save it.\n\t\t\t\tcheck: check == groupName ? null : check,\n\n\t\t\t\tleft: left,\n\n\t\t\t\t// Handle shorthand format. E.g.: 'table[width]:sizeToAttribute'.\n\t\t\t\tright: typeof right == 'string' ? getTransformationFn( right ) : right\n\t\t\t} );\n\t\t}\n\n\t\treturn {\n\t\t\tname: groupName,\n\t\t\trules: optimizedRules\n\t\t};\n\t}\n\n\t/**\n\t * Singleton containing tools useful for transformation rules.\n\t *\n\t * @class CKEDITOR.filter.transformationsTools\n\t * @singleton\n\t */\n\ttransformationsTools = CKEDITOR.filter.transformationsTools = {\n\t\t/**\n\t\t * Converts `width` and `height` attributes to styles.\n\t\t *\n\t\t * @param {CKEDITOR.htmlParser.element} element\n\t\t */\n\t\tsizeToStyle: function( element ) {\n\t\t\tthis.lengthToStyle( element, 'width' );\n\t\t\tthis.lengthToStyle( element, 'height' );\n\t\t},\n\n\t\t/**\n\t\t * Converts `width` and `height` styles to attributes.\n\t\t *\n\t\t * @param {CKEDITOR.htmlParser.element} element\n\t\t */\n\t\tsizeToAttribute: function( element ) {\n\t\t\tthis.lengthToAttribute( element, 'width' );\n\t\t\tthis.lengthToAttribute( element, 'height' );\n\t\t},\n\n\t\t/**\n\t\t * Converts length in the `attrName` attribute to a valid CSS length (like `width` or `height`).\n\t\t *\n\t\t * @param {CKEDITOR.htmlParser.element} element\n\t\t * @param {String} attrName Name of the attribute that will be converted.\n\t\t * @param {String} [styleName=attrName] Name of the style into which the attribute will be converted.\n\t\t */\n\t\tlengthToStyle: function( element, attrName, styleName ) {\n\t\t\tstyleName = styleName || attrName;\n\n\t\t\tif ( !( styleName in element.styles ) ) {\n\t\t\t\tvar value = element.attributes[ attrName ];\n\n\t\t\t\tif ( value ) {\n\t\t\t\t\tif ( ( /^\\d+$/ ).test( value ) )\n\t\t\t\t\t\tvalue += 'px';\n\n\t\t\t\t\telement.styles[ styleName ] = value;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdelete element.attributes[ attrName ];\n\t\t},\n\n\t\t/**\n\t\t * Converts length in the `styleName` style to a valid length attribute (like `width` or `height`).\n\t\t *\n\t\t * @param {CKEDITOR.htmlParser.element} element\n\t\t * @param {String} styleName Name of the style that will be converted.\n\t\t * @param {String} [attrName=styleName] Name of the attribute into which the style will be converted.\n\t\t */\n\t\tlengthToAttribute: function( element, styleName, attrName ) {\n\t\t\tattrName = attrName || styleName;\n\n\t\t\tif ( !( attrName in element.attributes ) ) {\n\t\t\t\tvar value = element.styles[ styleName ],\n\t\t\t\t\tmatch = value && value.match( /^(\\d+)(?:\\.\\d*)?px$/ );\n\n\t\t\t\tif ( match )\n\t\t\t\t\telement.attributes[ attrName ] = match[ 1 ];\n\t\t\t\t// Pass the TEST_VALUE used by filter#check when mocking element.\n\t\t\t\telse if ( value == TEST_VALUE )\n\t\t\t\t\telement.attributes[ attrName ] = TEST_VALUE;\n\t\t\t}\n\n\t\t\tdelete element.styles[ styleName ];\n\t\t},\n\n\t\t/**\n\t\t * Converts the `align` attribute to the `float` style if not set. Attribute\n\t\t * is always removed.\n\t\t *\n\t\t * @param {CKEDITOR.htmlParser.element} element\n\t\t */\n\t\talignmentToStyle: function( element ) {\n\t\t\tif ( !( 'float' in element.styles ) ) {\n\t\t\t\tvar value = element.attributes.align;\n\n\t\t\t\tif ( value == 'left' || value == 'right' )\n\t\t\t\t\telement.styles[ 'float' ] = value; // Uh... GCC doesn't like the 'float' prop name.\n\t\t\t}\n\n\t\t\tdelete element.attributes.align;\n\t\t},\n\n\t\t/**\n\t\t * Converts the `float` style to the `align` attribute if not set.\n\t\t * Style is always removed.\n\t\t *\n\t\t * @param {CKEDITOR.htmlParser.element} element\n\t\t */\n\t\talignmentToAttribute: function( element ) {\n\t\t\tif ( !( 'align' in element.attributes ) ) {\n\t\t\t\tvar value = element.styles[ 'float' ];\n\n\t\t\t\tif ( value == 'left' || value == 'right' )\n\t\t\t\t\telement.attributes.align = value;\n\t\t\t}\n\n\t\t\tdelete element.styles[ 'float' ]; // Uh... GCC doesn't like the 'float' prop name.\n\t\t},\n\n\t\t/**\n\t\t * Checks whether an element matches a given {@link CKEDITOR.style}.\n\t\t * The element can be a \"superset\" of a style, e.g. it may have\n\t\t * more classes, but needs to have at least those defined in the style.\n\t\t *\n\t\t * @param {CKEDITOR.htmlParser.element} element\n\t\t * @param {CKEDITOR.style} style\n\t\t */\n\t\tmatchesStyle: elementMatchesStyle,\n\n\t\t/**\n\t\t * Transforms element to given form.\n\t\t *\n\t\t * Form may be a:\n\t\t *\n\t\t *\t* {@link CKEDITOR.style},\n\t\t *\t* string &ndash; the new name of an element.\n\t\t *\n\t\t * @param {CKEDITOR.htmlParser.element} el\n\t\t * @param {CKEDITOR.style/String} form\n\t\t */\n\t\ttransform: function( el, form ) {\n\t\t\tif ( typeof form == 'string' )\n\t\t\t\tel.name = form;\n\t\t\t// Form is an instance of CKEDITOR.style.\n\t\t\telse {\n\t\t\t\tvar def = form.getDefinition(),\n\t\t\t\t\tdefStyles = def.styles,\n\t\t\t\t\tdefAttrs = def.attributes,\n\t\t\t\t\tattrName, styleName,\n\t\t\t\t\texistingClassesPattern, defClasses, cl;\n\n\t\t\t\tel.name = def.element;\n\n\t\t\t\tfor ( attrName in defAttrs ) {\n\t\t\t\t\tif ( attrName == 'class' ) {\n\t\t\t\t\t\texistingClassesPattern = el.classes.join( '|' );\n\t\t\t\t\t\tdefClasses = defAttrs[ attrName ].split( /\\s+/ );\n\n\t\t\t\t\t\twhile ( ( cl = defClasses.pop() ) ) {\n\t\t\t\t\t\t\tif ( existingClassesPattern.indexOf( cl ) == -1 )\n\t\t\t\t\t\t\t\tel.classes.push( cl );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tel.attributes[ attrName ] = defAttrs[ attrName ];\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tfor ( styleName in defStyles ) {\n\t\t\t\t\tel.styles[ styleName ] = defStyles[ styleName ];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n} )();\n\n/**\n * Allowed content rules. This setting is used when\n * instantiating {@link CKEDITOR.editor#filter}.\n *\n * The following values are accepted:\n *\n *\t* {@link CKEDITOR.filter.allowedContentRules} &ndash; defined rules will be added\n *\tto the {@link CKEDITOR.editor#filter}.\n *\t* `true` &ndash; will disable the filter (data will not be filtered,\n *\tall features will be activated).\n *\t* default &ndash; the filter will be configured by loaded features\n *\t(toolbar items, commands, etc.).\n *\n * In all cases filter configuration may be extended by\n * {@link CKEDITOR.config#extraAllowedContent}. This option may be especially\n * useful when you want to use the default `allowedContent` value\n * along with some additional rules.\n *\n *\t\tCKEDITOR.replace( 'textarea_id', {\n *\t\t\tallowedContent: 'p b i; a[!href]',\n *\t\t\ton: {\n *\t\t\t\tinstanceReady: function( evt ) {\n *\t\t\t\t\tvar editor = evt.editor;\n *\n *\t\t\t\t\teditor.filter.check( 'h1' ); // -> false\n *\t\t\t\t\teditor.setData( '<h1><i>Foo</i></h1><p class=\"left\"><span>Bar</span> <a href=\"http://foo.bar\">foo</a></p>' );\n *\t\t\t\t\t// Editor contents will be:\n *\t\t\t\t\t'<p><i>Foo</i></p><p>Bar <a href=\"http://foo.bar\">foo</a></p>'\n *\t\t\t\t}\n *\t\t\t}\n *\t\t} );\n *\n * It is also possible to disallow some already allowed content. It is especially\n * useful when you want to \"trim down\" the content allowed by default by\n * editor features. To do that, use the {@link #disallowedContent} option.\n *\n * Read more in the [documentation](#!/guide/dev_acf)\n * and see the [SDK sample](http://sdk.ckeditor.com/samples/acf.html).\n *\n * @since 4.1\n * @cfg {CKEDITOR.filter.allowedContentRules/Boolean} [allowedContent=null]\n * @member CKEDITOR.config\n */\n\n/**\n * This option makes it possible to set additional allowed\n * content rules for {@link CKEDITOR.editor#filter}.\n *\n * It is especially useful in combination with the default\n * {@link CKEDITOR.config#allowedContent} value:\n *\n *\t\tCKEDITOR.replace( 'textarea_id', {\n *\t\t\tplugins: 'wysiwygarea,toolbar,format',\n *\t\t\textraAllowedContent: 'b i',\n *\t\t\ton: {\n *\t\t\t\tinstanceReady: function( evt ) {\n *\t\t\t\t\tvar editor = evt.editor;\n *\n *\t\t\t\t\teditor.filter.check( 'h1' ); // -> true (thanks to Format combo)\n *\t\t\t\t\teditor.filter.check( 'b' ); // -> true (thanks to extraAllowedContent)\n *\t\t\t\t\teditor.setData( '<h1><i>Foo</i></h1><p class=\"left\"><b>Bar</b> <a href=\"http://foo.bar\">foo</a></p>' );\n *\t\t\t\t\t// Editor contents will be:\n *\t\t\t\t\t'<h1><i>Foo</i></h1><p><b>Bar</b> foo</p>'\n *\t\t\t\t}\n *\t\t\t}\n *\t\t} );\n *\n * Read more in the [documentation](#!/guide/dev_acf-section-automatic-mode-and-allow-additional-tags%2Fproperties)\n * and see the [SDK sample](http://sdk.ckeditor.com/samples/acf.html).\n * See also {@link CKEDITOR.config#allowedContent} for more details.\n *\n * @since 4.1\n * @cfg {Object/String} extraAllowedContent\n * @member CKEDITOR.config\n */\n\n/**\n * Disallowed content rules. They have precedence over {@link #allowedContent allowed content rules}.\n * Read more in the [Disallowed Content guide](#!/guide/dev_disallowed_content).\n *\n * Read more in the [documentation](#!/guide/dev_acf-section-automatic-mode-but-disallow-certain-tags%2Fproperties)\n * and see the [SDK sample](http://sdk.ckeditor.com/samples/acf.html).\n * See also {@link CKEDITOR.config#allowedContent} and {@link CKEDITOR.config#extraAllowedContent}.\n *\n * @since 4.4\n * @cfg {CKEDITOR.filter.disallowedContentRules} disallowedContent\n * @member CKEDITOR.config\n */\n\n/**\n * This event is fired when {@link CKEDITOR.filter} has stripped some\n * content from the data that was loaded (e.g. by {@link CKEDITOR.editor#method-setData}\n * method or in the source mode) or inserted (e.g. when pasting or using the\n * {@link CKEDITOR.editor#method-insertHtml} method).\n *\n * This event is useful when testing whether the {@link CKEDITOR.config#allowedContent}\n * setting is sufficient and correct for a system that is migrating to CKEditor 4.1\n * (where the [Advanced Content Filter](#!/guide/dev_advanced_content_filter) was introduced).\n *\n * @since 4.1\n * @event dataFiltered\n * @member CKEDITOR.editor\n * @param {CKEDITOR.editor} editor This editor instance.\n */\n\n/**\n * Virtual class which is the [Allowed Content Rules](#!/guide/dev_allowed_content_rules) formats type.\n *\n * Possible formats are:\n *\n *\t* the [string format](#!/guide/dev_allowed_content_rules-section-2),\n *\t* the [object format](#!/guide/dev_allowed_content_rules-section-3),\n *\t* a {@link CKEDITOR.style} instance &ndash; used mainly for integrating plugins with Advanced Content Filter,\n *\t* an array of the above formats.\n *\n * @since 4.1\n * @class CKEDITOR.filter.allowedContentRules\n * @abstract\n */\n\n/**\n * Virtual class representing the {@link CKEDITOR.filter#disallow} argument and a type of\n * the {@link CKEDITOR.config#disallowedContent} option.\n *\n * This is a simplified version of the {@link CKEDITOR.filter.allowedContentRules} type.\n * Only the string format and object format are accepted. Required properties\n * are not allowed in this format.\n *\n * Read more in the [Disallowed Content guide](#!/guide/dev_disallowed_content).\n *\n * @since 4.4\n * @class CKEDITOR.filter.disallowedContentRules\n * @abstract\n */\n\n/**\n * Virtual class representing {@link CKEDITOR.filter#check} argument.\n *\n * This is a simplified version of the {@link CKEDITOR.filter.allowedContentRules} type.\n * It may contain only one element and its styles, classes, and attributes. Only the\n * string format and a {@link CKEDITOR.style} instances are accepted. Required properties\n * are not allowed in this format.\n *\n * Example:\n *\n *\t\t'img[src,alt](foo)'\t// Correct rule.\n *\t\t'ol, ul(!foo)'\t\t// Incorrect rule. Multiple elements and required\n *\t\t\t\t\t\t\t// properties are not supported.\n *\n * @since 4.1\n * @class CKEDITOR.filter.contentRule\n * @abstract\n */\n\n/**\n * Interface that may be automatically implemented by any\n * instance of any class which has at least the `name` property and\n * can be meant as an editor feature.\n *\n * For example:\n *\n *\t* \"Bold\" command, button, and keystroke &ndash; it does not mean exactly\n * `<strong>` or `<b>` but just the ability to create bold text.\n *\t* \"Format\" drop-down list &ndash; it also does not imply any HTML tag.\n *\t* \"Link\" command, button, and keystroke.\n *\t* \"Image\" command, button, and dialog window.\n *\n * Thus most often a feature is an instance of one of the following classes:\n *\n *\t* {@link CKEDITOR.command}\n *\t* {@link CKEDITOR.ui.button}\n *\t* {@link CKEDITOR.ui.richCombo}\n *\n * None of them have a `name` property explicitly defined, but\n * it is set by {@link CKEDITOR.editor#addCommand} and {@link CKEDITOR.ui#add}.\n *\n * During editor initialization all features that the editor should activate\n * should be passed to {@link CKEDITOR.editor#addFeature} (shorthand for {@link CKEDITOR.filter#addFeature}).\n *\n * This method checks if a feature can be activated (see {@link #requiredContent}) and if yes,\n * then it registers allowed content rules required by this feature (see {@link #allowedContent}) along\n * with two kinds of transformations: {@link #contentForms} and {@link #contentTransformations}.\n *\n * By default all buttons that are included in [toolbar layout configuration](#!/guide/dev_toolbar)\n * are checked and registered with {@link CKEDITOR.editor#addFeature}, all styles available in the\n * 'Format' and 'Styles' drop-down lists are checked and registered too and so on.\n *\n * @since 4.1\n * @class CKEDITOR.feature\n * @abstract\n */\n\n/**\n * HTML code that can be generated by this feature.\n *\n * For example a basic image feature (image button displaying the image dialog window)\n * may allow `'img[!src,alt,width,height]'`.\n *\n * During the feature activation this value is passed to {@link CKEDITOR.filter#allow}.\n *\n * @property {CKEDITOR.filter.allowedContentRules} [allowedContent=null]\n */\n\n/**\n * Minimal HTML code that this feature must be allowed to\n * generate in order to work.\n *\n * For example a basic image feature (image button displaying the image dialog window)\n * needs `'img[src,alt]'` in order to be activated.\n *\n * During the feature validation this value is passed to {@link CKEDITOR.filter#check}.\n *\n * If this value is not provided, a feature will be always activated.\n *\n * @property {CKEDITOR.filter.contentRule} [requiredContent=null]\n */\n\n/**\n * The name of the feature.\n *\n * It is used for example to identify which {@link CKEDITOR.filter#allowedContent}\n * rule was added for which feature.\n *\n * @property {String} name\n */\n\n/**\n * Feature content forms to be registered in the {@link CKEDITOR.editor#filter}\n * during the feature activation.\n *\n * See {@link CKEDITOR.filter#addContentForms} for more details.\n *\n * @property [contentForms=null]\n */\n\n/**\n * Transformations (usually for content generated by this feature, but not necessarily)\n * that will be registered in the {@link CKEDITOR.editor#filter} during the feature activation.\n *\n * See {@link CKEDITOR.filter#addTransformations} for more details.\n *\n * @property [contentTransformations=null]\n */\n\n/**\n * Returns a feature that this feature needs to register.\n *\n * In some cases, during activation, one feature may need to register\n * another feature. For example a {@link CKEDITOR.ui.button} often registers\n * a related command. See {@link CKEDITOR.ui.button#toFeature}.\n *\n * This method is executed when a feature is passed to the {@link CKEDITOR.editor#addFeature}.\n *\n * @method toFeature\n * @returns {CKEDITOR.feature}\n */\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/filter.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Defines the {@link CKEDITOR.focusManager} class, which is used\n *\t\tto handle the focus in editor instances.\n */\n\n( function() {\n\t/**\n\t * Manages the focus activity in an editor instance. This class is to be\n\t * used mainly by UI element coders when adding interface elements that need\n\t * to set the focus state of the editor.\n\t *\n\t *\t\tvar focusManager = new CKEDITOR.focusManager( editor );\n\t *\t\tfocusManager.focus();\n\t *\n\t * @class\n\t * @constructor Creates a focusManager class instance.\n\t * @param {CKEDITOR.editor} editor The editor instance.\n\t */\n\tCKEDITOR.focusManager = function( editor ) {\n\t\tif ( editor.focusManager )\n\t\t\treturn editor.focusManager;\n\n\t\t/**\n\t\t * Indicates that the editor instance has focus.\n\t\t *\n\t\t *\t\talert( CKEDITOR.instances.editor1.focusManager.hasFocus ); // e.g. true\n\t\t */\n\t\tthis.hasFocus = false;\n\n\t\t/**\n\t\t * Indicates the currently focused DOM element that makes the editor activated.\n\t\t *\n\t\t * @property {CKEDITOR.dom.domObject}\n\t\t */\n\t\tthis.currentActive = null;\n\n\t\t/**\n\t\t * Object used to store private stuff.\n\t\t *\n\t\t * @private\n\t\t */\n\t\tthis._ = {\n\t\t\teditor: editor\n\t\t};\n\n\t\treturn this;\n\t};\n\n\tvar SLOT_NAME = 'focusmanager',\n\t\tSLOT_NAME_LISTENERS = 'focusmanager_handlers';\n\n\t/**\n\t * Object used to store private stuff.\n\t *\n\t * @private\n\t * @class\n\t * @singleton\n\t */\n\tCKEDITOR.focusManager._ = {\n\t\t/**\n\t\t * The delay (in milliseconds) to deactivate the editor when a UI DOM element has lost focus.\n\t\t *\n\t\t * @private\n\t\t * @property {Number} [blurDelay=200]\n\t\t * @member CKEDITOR.focusManager._\n\t\t */\n\t\tblurDelay: 200\n\t};\n\n\tCKEDITOR.focusManager.prototype = {\n\n\t\t/**\n\t\t * Indicates that this editor instance is activated (due to a DOM focus change).\n\t\t * The `activated` state is a symbolic indicator of an active user\n\t\t * interaction session.\n\t\t *\n\t\t * **Note:** This method will not introduce UI focus\n\t\t * impact on DOM, it is here to record the editor UI focus state internally.\n\t\t * If you want to make the cursor blink inside the editable, use\n\t\t * {@link CKEDITOR.editor#method-focus} instead.\n\t\t *\n\t\t *\t\tvar editor = CKEDITOR.instances.editor1;\n\t\t *\t\teditor.focusManage.focus( editor.editable() );\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} [currentActive] The new value of the {@link #currentActive} property.\n\t\t * @member CKEDITOR.focusManager\n\t\t */\n\t\tfocus: function( currentActive ) {\n\t\t\tif ( this._.timer )\n\t\t\t\tclearTimeout( this._.timer );\n\n\t\t\tif ( currentActive )\n\t\t\t\tthis.currentActive = currentActive;\n\n\t\t\tif ( !( this.hasFocus || this._.locked ) ) {\n\t\t\t\t// If another editor has the current focus, we first \"blur\" it. In\n\t\t\t\t// this way the events happen in a more logical sequence, like:\n\t\t\t\t//\t\t\"focus 1\" > \"blur 1\" > \"focus 2\"\n\t\t\t\t// ... instead of:\n\t\t\t\t//\t\t\"focus 1\" > \"focus 2\" > \"blur 1\"\n\t\t\t\tvar current = CKEDITOR.currentInstance;\n\t\t\t\tcurrent && current.focusManager.blur( 1 );\n\n\t\t\t\tthis.hasFocus = true;\n\n\t\t\t\tvar ct = this._.editor.container;\n\t\t\t\tct && ct.addClass( 'cke_focus' );\n\t\t\t\tthis._.editor.fire( 'focus' );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Prevents from changing the focus manager state until the next {@link #unlock} is called.\n\t\t *\n\t\t * @member CKEDITOR.focusManager\n\t\t */\n\t\tlock: function() {\n\t\t\tthis._.locked = 1;\n\t\t},\n\n\t\t/**\n\t\t * Restores the automatic focus management if {@link #lock} is called.\n\t\t *\n\t\t * @member CKEDITOR.focusManager\n\t\t */\n\t\tunlock: function() {\n\t\t\tdelete this._.locked;\n\t\t},\n\n\t\t/**\n\t\t * Used to indicate that the editor instance has been deactivated by the specified\n\t\t * element which has just lost focus.\n\t\t *\n\t\t * **Note:** This function acts asynchronously with a delay of 100ms to\n\t\t * avoid temporary deactivation. Use the `noDelay` parameter instead\n\t\t * to deactivate immediately.\n\t\t *\n\t\t *\t\tvar editor = CKEDITOR.instances.editor1;\n\t\t *\t\teditor.focusManager.blur();\n\t\t *\n\t\t * @param {Boolean} [noDelay=false] Immediately deactivate the editor instance synchronously.\n\t\t * @member CKEDITOR.focusManager\n\t\t */\n\t\tblur: function( noDelay ) {\n\t\t\tif ( this._.locked )\n\t\t\t\treturn;\n\n\t\t\tfunction doBlur() {\n\t\t\t\tif ( this.hasFocus ) {\n\t\t\t\t\tthis.hasFocus = false;\n\n\t\t\t\t\tvar ct = this._.editor.container;\n\t\t\t\t\tct && ct.removeClass( 'cke_focus' );\n\t\t\t\t\tthis._.editor.fire( 'blur' );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( this._.timer )\n\t\t\t\tclearTimeout( this._.timer );\n\n\t\t\tvar delay = CKEDITOR.focusManager._.blurDelay;\n\t\t\tif ( noDelay || !delay )\n\t\t\t\tdoBlur.call( this );\n\t\t\telse {\n\t\t\t\tthis._.timer = CKEDITOR.tools.setTimeout( function() {\n\t\t\t\t\tdelete this._.timer;\n\t\t\t\t\tdoBlur.call( this );\n\t\t\t\t}, delay, this );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Registers a UI DOM element to the focus manager, which will make the focus manager \"hasFocus\"\n\t\t * once the input focus is relieved on the element.\n\t\t * This method is designed to be used by plugins to expand the jurisdiction of the editor focus.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} element The container (topmost) element of one UI part.\n\t\t * @param {Boolean} isCapture If specified, {@link CKEDITOR.event#useCapture} will be used when listening to the focus event.\n\t\t * @member CKEDITOR.focusManager\n\t\t */\n\t\tadd: function( element, isCapture ) {\n\t\t\tvar fm = element.getCustomData( SLOT_NAME );\n\t\t\tif ( !fm || fm != this ) {\n\t\t\t\t// If this element is already taken by another instance, dismiss it first.\n\t\t\t\tfm && fm.remove( element );\n\n\t\t\t\tvar focusEvent = 'focus',\n\t\t\t\t\tblurEvent = 'blur';\n\n\t\t\t\t// Bypass the element's internal DOM focus change.\n\t\t\t\tif ( isCapture ) {\n\n\t\t\t\t\t// Use \"focusin/focusout\" events instead of capture phase in IEs,\n\t\t\t\t\t// which fires synchronously.\n\t\t\t\t\tif ( CKEDITOR.env.ie ) {\n\t\t\t\t\t\tfocusEvent = 'focusin';\n\t\t\t\t\t\tblurEvent = 'focusout';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tCKEDITOR.event.useCapture = 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar listeners = {\n\t\t\t\t\tblur: function() {\n\t\t\t\t\t\tif ( element.equals( this.currentActive ) )\n\t\t\t\t\t\t\tthis.blur();\n\t\t\t\t\t},\n\t\t\t\t\tfocus: function() {\n\t\t\t\t\t\tthis.focus( element );\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\telement.on( focusEvent, listeners.focus, this );\n\t\t\t\telement.on( blurEvent, listeners.blur, this );\n\n\t\t\t\tif ( isCapture )\n\t\t\t\t\tCKEDITOR.event.useCapture = 0;\n\n\t\t\t\telement.setCustomData( SLOT_NAME, this );\n\t\t\t\telement.setCustomData( SLOT_NAME_LISTENERS, listeners );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Dismisses an element from the focus manager delegations added by {@link #add}.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} element The element to be removed from the focus manager.\n\t\t * @member CKEDITOR.focusManager\n\t\t */\n\t\tremove: function( element ) {\n\t\t\telement.removeCustomData( SLOT_NAME );\n\t\t\tvar listeners = element.removeCustomData( SLOT_NAME_LISTENERS );\n\t\t\telement.removeListener( 'blur', listeners.blur );\n\t\t\telement.removeListener( 'focus', listeners.focus );\n\t\t}\n\n\t};\n\n} )();\n\n/**\n * Fired when the editor instance receives the input focus.\n *\n *\t\teditor.on( 'focus', function( e ) {\n *\t\t\talert( 'The editor named ' + e.editor.name + ' is now focused' );\n *\t\t} );\n *\n * @event focus\n * @member CKEDITOR.editor\n * @param {CKEDITOR.editor} editor The editor instance.\n */\n\n/**\n * Fired when the editor instance loses the input focus.\n *\n * **Note:** This event will **NOT** be triggered when focus is moved internally, e.g. from\n * an editable to another part of the editor UI like a dialog window.\n * If you are interested only in the focus state of the editable, listen to the `focus`\n * and `blur` events of the {@link CKEDITOR.editable} instead.\n *\n *\t\teditor.on( 'blur', function( e ) {\n *\t\t\talert( 'The editor named ' + e.editor.name + ' lost the focus' );\n *\t\t} );\n *\n * @event blur\n * @member CKEDITOR.editor\n * @param {CKEDITOR.editor} editor The editor instance.\n */\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/focusmanager.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * Controls keystrokes typing in an editor instance.\n *\n * @class\n * @constructor Creates a keystrokeHandler class instance.\n * @param {CKEDITOR.editor} editor The editor instance.\n */\nCKEDITOR.keystrokeHandler = function( editor ) {\n\tif ( editor.keystrokeHandler )\n\t\treturn editor.keystrokeHandler;\n\n\t/**\n\t * A list of keystrokes associated with commands. Each entry points to the\n\t * command to be executed.\n\t *\n\t * Since CKEditor 4 there is no need to modify this property directly during the runtime.\n\t * Use {@link CKEDITOR.editor#setKeystroke} instead.\n\t */\n\tthis.keystrokes = {};\n\n\t/**\n\t * A list of keystrokes that should be blocked if not defined in\n\t * {@link #keystrokes}. In this way it is possible to block the default\n\t * browser behavior for those keystrokes.\n\t */\n\tthis.blockedKeystrokes = {};\n\n\tthis._ = {\n\t\teditor: editor\n\t};\n\n\treturn this;\n};\n\n( function() {\n\tvar cancel;\n\n\tvar onKeyDown = function( event ) {\n\t\t\t// The DOM event object is passed by the \"data\" property.\n\t\t\tevent = event.data;\n\n\t\t\tvar keyCombination = event.getKeystroke();\n\t\t\tvar command = this.keystrokes[ keyCombination ];\n\t\t\tvar editor = this._.editor;\n\n\t\t\tcancel = ( editor.fire( 'key', { keyCode: keyCombination, domEvent: event } ) === false );\n\n\t\t\tif ( !cancel ) {\n\t\t\t\tif ( command ) {\n\t\t\t\t\tvar data = { from: 'keystrokeHandler' };\n\t\t\t\t\tcancel = ( editor.execCommand( command, data ) !== false );\n\t\t\t\t}\n\n\t\t\t\tif ( !cancel )\n\t\t\t\t\tcancel = !!this.blockedKeystrokes[ keyCombination ];\n\t\t\t}\n\n\t\t\tif ( cancel )\n\t\t\t\tevent.preventDefault( true );\n\n\t\t\treturn !cancel;\n\t\t};\n\n\tvar onKeyPress = function( event ) {\n\t\t\tif ( cancel ) {\n\t\t\t\tcancel = false;\n\t\t\t\tevent.data.preventDefault( true );\n\t\t\t}\n\t\t};\n\n\tCKEDITOR.keystrokeHandler.prototype = {\n\t\t/**\n\t\t * Attaches this keystroke handle to a DOM object. Keystrokes typed\n\t\t * over this object will be handled by this keystrokeHandler.\n\t\t *\n\t\t * @param {CKEDITOR.dom.domObject} domObject The DOM object to attach to.\n\t\t */\n\t\tattach: function( domObject ) {\n\t\t\t// For most browsers, it is enough to listen to the keydown event\n\t\t\t// only.\n\t\t\tdomObject.on( 'keydown', onKeyDown, this );\n\n\t\t\t// Some browsers instead, don't cancel key events in the keydown, but in the\n\t\t\t// keypress. So we must do a longer trip in those cases.\n\t\t\tif ( CKEDITOR.env.gecko && CKEDITOR.env.mac )\n\t\t\t\tdomObject.on( 'keypress', onKeyPress, this );\n\t\t}\n\t};\n} )();\n\n/**\n * A list associating keystrokes with editor commands. Each element in the list\n * is an array where the first item is the keystroke, and the second is the\n * name of the command to be executed.\n *\n * This setting should be used to define (as well as to overwrite or remove) keystrokes\n * set by plugins (like `link` and `basicstyles`). If you want to set a keystroke\n * for your plugin or during the runtime, use {@link CKEDITOR.editor#setKeystroke} instead.\n *\n * Since default keystrokes are set by the {@link CKEDITOR.editor#setKeystroke}\n * method, by default `config.keystrokes` is an empty array.\n *\n * See {@link CKEDITOR.editor#setKeystroke} documentation for more details\n * regarding the start up order.\n *\n *\t\t// Change default Ctrl+L keystroke for 'link' command to Ctrl+Shift+L.\n *\t\tconfig.keystrokes = [\n *\t\t\t...\n *\t\t\t[ CKEDITOR.CTRL + CKEDITOR.SHIFT + 76, 'link' ],\t// Ctrl+Shift+L\n *\t\t\t...\n *\t\t];\n *\n * To reset a particular keystroke, the following approach can be used:\n *\n *\t\t// Disable default Ctrl+L keystroke which executes the 'link' command by default.\n *\t\tconfig.keystrokes = [\n *\t\t\t...\n *\t\t\t[ CKEDITOR.CTRL + 76, null ],\t\t\t\t\t\t// Ctrl+L\n *\t\t\t...\n *\t\t];\n *\n * In order to reset all default keystrokes, a {@link CKEDITOR#instanceReady} callback should be\n * used. This is since editor defaults are merged rather than overwritten by\n * user keystrokes.\n *\n * **Note**: This can be potentially harmful for the editor. Avoid this unless you are\n * aware of the consequences.\n *\n *\t\t// Reset all default keystrokes.\n *\t\tconfig.on.instanceReady = function() {\n *\t\t\tthis.keystrokeHandler.keystrokes = [];\n *\t\t};\n *\n * @cfg {Array} [keystrokes=[]]\n * @member CKEDITOR.config\n */\n\n/**\n * Fired when any keyboard key (or a combination thereof) is pressed in the editing area.\n *\n *\t\teditor.on( 'key', function( evt ) {\n *\t\t\tif ( evt.data.keyCode == CKEDITOR.CTRL + 90 ) {\n *\t\t\t\t// Do something...\n *\n *\t\t\t\t// Cancel the event, so other listeners will not be executed and\n *\t\t\t\t// the keydown's default behavior will be prevented.\n *\t\t\t\tevt.cancel();\n *\t\t\t}\n *\t\t} );\n *\n * Usually you will want to use the {@link CKEDITOR.editor#setKeystroke} method or\n * the {@link CKEDITOR.config#keystrokes} option to attach a keystroke to some {@link CKEDITOR.command command}.\n * Key event listeners are usuful when some action should be executed conditionally, based\n * for example on precise selection location.\n *\n * @event key\n * @member CKEDITOR.editor\n * @param data\n * @param {Number} data.keyCode A number representing the key code (or a combination thereof).\n * It is the sum of the current key code and the {@link CKEDITOR#CTRL}, {@link CKEDITOR#SHIFT}\n * and {@link CKEDITOR#ALT} constants, if those are pressed.\n * @param {CKEDITOR.dom.event} data.domEvent A `keydown` DOM event instance. Available since CKEditor 4.4.1.\n * @param {CKEDITOR.editor} editor This editor instance.\n */\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/keystrokehandler.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n( function() {\n\t/**\n\t * Stores language-related functions.\n\t *\n\t * @class\n\t * @singleton\n\t */\n\tCKEDITOR.lang = {\n\t\t/**\n\t\t * The list of languages available in the editor core.\n\t\t *\n\t\t *\t\talert( CKEDITOR.lang.languages.en ); // 1\n\t\t */\n\t\tlanguages: {\n\t\t\taf: 1, ar: 1, bg: 1, bn: 1, bs: 1, ca: 1, cs: 1, cy: 1, da: 1, de: 1, 'de-ch': 1, el: 1,\n\t\t\t'en-au': 1, 'en-ca': 1, 'en-gb': 1, en: 1, eo: 1, es: 1, et: 1, eu: 1, fa: 1, fi: 1, fo: 1,\n\t\t\t'fr-ca': 1, fr: 1, gl: 1, gu: 1, he: 1, hi: 1, hr: 1, hu: 1, id: 1, is: 1, it: 1, ja: 1, ka: 1,\n\t\t\tkm: 1, ko: 1, ku: 1, lt: 1, lv: 1, mk: 1, mn: 1, ms: 1, nb: 1, nl: 1, no: 1, pl: 1, 'pt-br': 1,\n\t\t\tpt: 1, ro: 1, ru: 1, si: 1, sk: 1, sl: 1, sq: 1, 'sr-latn': 1, sr: 1, sv: 1, th: 1, tr: 1, tt: 1, ug: 1,\n\t\t\tuk: 1, vi: 1, 'zh-cn': 1, zh: 1\n\t\t},\n\n\t\t/**\n\t\t * The list of languages that are written Right-To-Left (RTL) and are supported by the editor.\n\t\t */\n\t\trtl: { ar: 1, fa: 1, he: 1, ku: 1, ug: 1 },\n\n\t\t/**\n\t\t * Loads a specific language file, or auto detects it. A callback is\n\t\t * then called when the file gets loaded.\n\t\t *\n\t\t * @param {String} languageCode The code of the language file to be\n\t\t * loaded. If null or empty, autodetection will be performed. The\n\t\t * same happens if the language is not supported.\n\t\t * @param {String} defaultLanguage The language to be used if\n\t\t * `languageCode` is not supported or if the autodetection fails.\n\t\t * @param {Function} callback A function to be called once the\n\t\t * language file is loaded. Two parameters are passed to this\n\t\t * function: the language code and the loaded language entries.\n\t\t */\n\t\tload: function( languageCode, defaultLanguage, callback ) {\n\t\t\t// If no languageCode - fallback to browser or default.\n\t\t\t// If languageCode - fallback to no-localized version or default.\n\t\t\tif ( !languageCode || !CKEDITOR.lang.languages[ languageCode ] )\n\t\t\t\tlanguageCode = this.detect( defaultLanguage, languageCode );\n\n\t\t\tvar that = this,\n\t\t\t\tloadedCallback = function() {\n\t\t\t\t\tthat[ languageCode ].dir = that.rtl[ languageCode ] ? 'rtl' : 'ltr';\n\t\t\t\t\tcallback( languageCode, that[ languageCode ] );\n\t\t\t\t};\n\n\t\t\t// if ( !this[ languageCode ] )\n\t\t\t\t// CKEDITOR.scriptLoader.load( CKEDITOR.getUrl( 'lang/' + languageCode + '.js' ), loadedCallback, this );\n\t\t\t// else\n\t\t\t\tloadedCallback();\n\t\t},\n\n\t\t/**\n\t\t * Returns the language that best fits the user language. For example,\n\t\t * suppose that the user language is \"pt-br\". If this language is\n\t\t * supported by the editor, it is returned. Otherwise, if only \"pt\" is\n\t\t * supported, it is returned instead. If none of the previous are\n\t\t * supported, a default language is then returned.\n\t\t *\n\t\t *\t\talert( CKEDITOR.lang.detect( 'en' ) ); // e.g., in a German browser: 'de'\n\t\t *\n\t\t * @param {String} defaultLanguage The default language to be returned\n\t\t * if the user language is not supported.\n\t\t * @param {String} [probeLanguage] A language code to try to use,\n\t\t * instead of the browser-based autodetection.\n\t\t * @returns {String} The detected language code.\n\t\t */\n\t\tdetect: function( defaultLanguage, probeLanguage ) {\n\t\t\tvar languages = this.languages;\n\t\t\tprobeLanguage = probeLanguage || navigator.userLanguage || navigator.language || defaultLanguage;\n\n\t\t\tvar parts = probeLanguage.toLowerCase().match( /([a-z]+)(?:-([a-z]+))?/ ),\n\t\t\t\tlang = parts[ 1 ],\n\t\t\t\tlocale = parts[ 2 ];\n\n\t\t\tif ( languages[ lang + '-' + locale ] )\n\t\t\t\tlang = lang + '-' + locale;\n\t\t\telse if ( !languages[ lang ] )\n\t\t\t\tlang = null;\n\n\t\t\tCKEDITOR.lang.detect = lang ?\n\t\t\tfunction() {\n\t\t\t\treturn lang;\n\t\t\t} : function( defaultLanguage ) {\n\t\t\t\treturn defaultLanguage;\n\t\t\t};\n\n\t\t\treturn lang || defaultLanguage;\n\t\t}\n\t};\n\n} )();\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/lang.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Defines the {@link CKEDITOR.scriptLoader} object, used to load scripts\n *\t\tasynchronously.\n */\n\n/**\n * Load scripts asynchronously.\n *\n * @class\n * @singleton\n */\nCKEDITOR.scriptLoader = ( function() {\n\tvar uniqueScripts = {},\n\t\twaitingList = {};\n\n\treturn {\n\t\t/**\n\t\t * Loads one or more external script checking if not already loaded\n\t\t * previously by this function.\n\t\t *\n\t\t *\t\tCKEDITOR.scriptLoader.load( '/myscript.js' );\n\t\t *\n\t\t *\t\tCKEDITOR.scriptLoader.load( '/myscript.js', function( success ) {\n\t\t *\t\t\t// Alerts true if the script has been properly loaded.\n\t\t *\t\t\t// HTTP error 404 should return false.\n\t\t *\t\t\talert( success );\n\t\t *\t\t} );\n\t\t *\n\t\t *\t\tCKEDITOR.scriptLoader.load( [ '/myscript1.js', '/myscript2.js' ], function( completed, failed ) {\n\t\t *\t\t\talert( 'Number of scripts loaded: ' + completed.length );\n\t\t *\t\t\talert( 'Number of failures: ' + failed.length );\n\t\t *\t\t} );\n\t\t *\n\t\t * @param {String/Array} scriptUrl One or more URLs pointing to the\n\t\t * scripts to be loaded.\n\t\t * @param {Function} [callback] A function to be called when the script\n\t\t * is loaded and executed. If a string is passed to `scriptUrl`, a\n\t\t * boolean parameter is passed to the callback, indicating the\n\t\t * success of the load. If an array is passed instead, two arrays\n\t\t * parameters are passed to the callback - the first contains the\n\t\t * URLs that have been properly loaded and the second the failed ones.\n\t\t * @param {Object} [scope] The scope (`this` reference) to be used for\n\t\t * the callback call. Defaults to {@link CKEDITOR}.\n\t\t * @param {Boolean} [showBusy] Changes the cursor of the document while\n\t\t * the script is loaded.\n\t\t */\n\t\tload: function( scriptUrl, callback, scope, showBusy ) {\n\t\t\tvar isString = ( typeof scriptUrl == 'string' );\n\n\t\t\tif ( isString )\n\t\t\t\tscriptUrl = [ scriptUrl ];\n\n\t\t\tif ( !scope )\n\t\t\t\tscope = CKEDITOR;\n\n\t\t\tvar scriptCount = scriptUrl.length,\n\t\t\t\tcompleted = [],\n\t\t\t\tfailed = [];\n\n\t\t\tvar doCallback = function( success ) {\n\t\t\t\t\tif ( callback ) {\n\t\t\t\t\t\tif ( isString )\n\t\t\t\t\t\t\tcallback.call( scope, success );\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tcallback.call( scope, completed, failed );\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\tif ( scriptCount === 0 ) {\n\t\t\t\tdoCallback( true );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar checkLoaded = function( url, success ) {\n\t\t\t\t\t( success ? completed : failed ).push( url );\n\n\t\t\t\t\tif ( --scriptCount <= 0 ) {\n\t\t\t\t\t\tshowBusy && CKEDITOR.document.getDocumentElement().removeStyle( 'cursor' );\n\t\t\t\t\t\tdoCallback( success );\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\tvar onLoad = function( url, success ) {\n\t\t\t\t\t// Mark this script as loaded.\n\t\t\t\t\tuniqueScripts[ url ] = 1;\n\n\t\t\t\t\t// Get the list of callback checks waiting for this file.\n\t\t\t\t\tvar waitingInfo = waitingList[ url ];\n\t\t\t\t\tdelete waitingList[ url ];\n\n\t\t\t\t\t// Check all callbacks waiting for this file.\n\t\t\t\t\tfor ( var i = 0; i < waitingInfo.length; i++ )\n\t\t\t\t\t\twaitingInfo[ i ]( url, success );\n\t\t\t\t};\n\n\t\t\tvar loadScript = function( url ) {\n\t\t\t\t\tif ( uniqueScripts[ url ] ) {\n\t\t\t\t\t\tcheckLoaded( url, true );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar waitingInfo = waitingList[ url ] || ( waitingList[ url ] = [] );\n\t\t\t\t\twaitingInfo.push( checkLoaded );\n\n\t\t\t\t\t// Load it only for the first request.\n\t\t\t\t\tif ( waitingInfo.length > 1 )\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t// Create the <script> element.\n\t\t\t\t\tvar script = new CKEDITOR.dom.element( 'script' );\n\t\t\t\t\tscript.setAttributes( {\n\t\t\t\t\t\ttype: 'text/javascript',\n\t\t\t\t\t\tsrc: url\n\t\t\t\t\t} );\n\n\t\t\t\t\tif ( callback ) {\n\t\t\t\t\t\t// The onload or onerror event does not fire in IE8.\n\t\t\t\t\t\tif ( CKEDITOR.env.ie && CKEDITOR.env.version <= 8 ) {\n\n\t\t\t\t\t\t\tscript.$.onreadystatechange = function() {\n\t\t\t\t\t\t\t\tif ( script.$.readyState == 'loaded' || script.$.readyState == 'complete' ) {\n\t\t\t\t\t\t\t\t\tscript.$.onreadystatechange = null;\n\t\t\t\t\t\t\t\t\tonLoad( url, true );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tscript.$.onload = function() {\n\t\t\t\t\t\t\t\t// Some browsers, such as Safari, may call the onLoad function\n\t\t\t\t\t\t\t\t// immediately. Which will break the loading sequence. (#3661)\n\t\t\t\t\t\t\t\tsetTimeout( function() {\n\t\t\t\t\t\t\t\t\tonLoad( url, true );\n\t\t\t\t\t\t\t\t}, 0 );\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tscript.$.onerror = function() {\n\t\t\t\t\t\t\t\tonLoad( url, false );\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Append it to <head>.\n\t\t\t\t\tscript.appendTo( CKEDITOR.document.getHead() );\n\n\t\t\t\t\tCKEDITOR.fire( 'download', url ); // %REMOVE_LINE%\n\t\t\t\t};\n\n\t\t\tshowBusy && CKEDITOR.document.getDocumentElement().setStyle( 'cursor', 'wait' );\n\t\t\tfor ( var i = 0; i < scriptCount; i++ ) {\n\t\t\t\tloadScript( scriptUrl[ i ] );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Loads a script in a queue, so only one is loaded at the same time.\n\t\t *\n\t\t * @since 4.1.2\n\t\t * @param {String} scriptUrl URL pointing to the script to be loaded.\n\t\t * @param {Function} [callback] A function to be called when the script\n\t\t * is loaded and executed. A boolean parameter is passed to the callback,\n\t\t * indicating the success of the load.\n\t\t *\n\t\t * @see CKEDITOR.scriptLoader#load\n\t\t */\n\t\tqueue: ( function() {\n\t\t\tvar pending = [];\n\n\t\t\t// Loads the very first script from queue and removes it.\n\t\t\tfunction loadNext() {\n\t\t\t\tvar script;\n\n\t\t\t\tif ( ( script = pending[ 0 ] ) )\n\t\t\t\t\tthis.load( script.scriptUrl, script.callback, CKEDITOR, 0 );\n\t\t\t}\n\n\t\t\treturn function( scriptUrl, callback ) {\n\t\t\t\tvar that = this;\n\n\t\t\t\t// This callback calls the standard callback for the script\n\t\t\t\t// and loads the very next script from pending list.\n\t\t\t\tfunction callbackWrapper() {\n\t\t\t\t\tcallback && callback.apply( this, arguments );\n\n\t\t\t\t\t// Removed the just loaded script from the queue.\n\t\t\t\t\tpending.shift();\n\n\t\t\t\t\tloadNext.call( that );\n\t\t\t\t}\n\n\t\t\t\t// Let's add this script to the queue\n\t\t\t\tpending.push( { scriptUrl: scriptUrl, callback: callbackWrapper } );\n\n\t\t\t\t// If the queue was empty, then start loading.\n\t\t\t\tif ( pending.length == 1 )\n\t\t\t\t\tloadNext.call( this );\n\t\t\t};\n\t\t} )()\n\t};\n} )();\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/scriptloader.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Defines the {@link CKEDITOR.resourceManager} class, which is\n *\t\tthe base for resource managers, like plugins.\n */\n\n/**\n * Base class for resource managers, like plugins. This class is not\n * intended to be used out of the CKEditor core code.\n *\n * @class\n * @constructor Creates a resourceManager class instance.\n * @param {String} basePath The path for the resources folder.\n * @param {String} fileName The name used for resource files.\n */\nCKEDITOR.resourceManager = function( basePath, fileName ) {\n\t/**\n\t * The base directory containing all resources.\n\t *\n\t * @property {String}\n\t */\n\tthis.basePath = basePath;\n\n\t/**\n\t * The name used for resource files.\n\t *\n\t * @property {String}\n\t */\n\tthis.fileName = fileName;\n\n\t/**\n\t * Contains references to all resources that have already been registered\n\t * with {@link #add}.\n\t */\n\tthis.registered = {};\n\n\t/**\n\t * Contains references to all resources that have already been loaded\n\t * with {@link #load}.\n\t */\n\tthis.loaded = {};\n\n\t/**\n\t * Contains references to all resources that have already been registered\n\t * with {@link #addExternal}.\n\t */\n\tthis.externals = {};\n\n\t/**\n\t * @private\n\t */\n\tthis._ = {\n\t\t// List of callbacks waiting for plugins to be loaded.\n\t\twaitingList: {}\n\t};\n};\n\nCKEDITOR.resourceManager.prototype = {\n\t/**\n\t * Registers a resource.\n\t *\n\t *\t\tCKEDITOR.plugins.add( 'sample', { ... plugin definition ... } );\n\t *\n\t * @param {String} name The resource name.\n\t * @param {Object} [definition] The resource definition.\n\t * @see CKEDITOR.pluginDefinition\n\t */\n\tadd: function( name, definition ) {\n\t\tif ( this.registered[ name ] )\n\t\t\tthrow new Error( '[CKEDITOR.resourceManager.add] The resource name \"' + name + '\" is already registered.' );\n\n\t\tvar resource = this.registered[ name ] = definition || {};\n\t\tresource.name = name;\n\t\tresource.path = this.getPath( name );\n\n\t\tCKEDITOR.fire( name + CKEDITOR.tools.capitalize( this.fileName ) + 'Ready', resource );\n\n\t\treturn this.get( name );\n\t},\n\n\t/**\n\t * Gets the definition of a specific resource.\n\t *\n\t *\t\tvar definition = CKEDITOR.plugins.get( 'sample' );\n\t *\n\t * @param {String} name The resource name.\n\t * @returns {Object} The registered object.\n\t */\n\tget: function( name ) {\n\t\treturn this.registered[ name ] || null;\n\t},\n\n\t/**\n\t * Get the folder path for a specific loaded resource.\n\t *\n\t *\t\talert( CKEDITOR.plugins.getPath( 'sample' ) ); // '<editor path>/plugins/sample/'\n\t *\n\t * @param {String} name The resource name.\n\t * @returns {String}\n\t */\n\tgetPath: function( name ) {\n\t\tvar external = this.externals[ name ];\n\t\treturn CKEDITOR.getUrl( ( external && external.dir ) || this.basePath + name + '/' );\n\t},\n\n\t/**\n\t * Get the file path for a specific loaded resource.\n\t *\n\t *\t\talert( CKEDITOR.plugins.getFilePath( 'sample' ) ); // '<editor path>/plugins/sample/plugin.js'\n\t *\n\t * @param {String} name The resource name.\n\t * @returns {String}\n\t */\n\tgetFilePath: function( name ) {\n\t\tvar external = this.externals[ name ];\n\t\treturn CKEDITOR.getUrl( this.getPath( name ) + ( external ? external.file : this.fileName + '.js' ) );\n\t},\n\n\t/**\n\t * Registers one or more resources to be loaded from an external path\n\t * instead of the core base path.\n\t *\n\t *\t\t// Loads a plugin from '/myplugin/samples/plugin.js'.\n\t *\t\tCKEDITOR.plugins.addExternal( 'sample', '/myplugins/sample/' );\n\t *\n\t *\t\t// Loads a plugin from '/myplugin/samples/my_plugin.js'.\n\t *\t\tCKEDITOR.plugins.addExternal( 'sample', '/myplugins/sample/', 'my_plugin.js' );\n\t *\n\t *\t\t// Loads a plugin from '/myplugin/samples/my_plugin.js'.\n\t *\t\tCKEDITOR.plugins.addExternal( 'sample', '/myplugins/sample/my_plugin.js', '' );\n\t *\n\t * @param {String} names The resource names, separated by commas.\n\t * @param {String} path The path of the folder containing the resource.\n\t * @param {String} [fileName] The resource file name. If not provided, the\n\t * default name is used. If provided with a empty string, will implicitly indicates that `path` argument\n\t * is already the full path.\n\t */\n\taddExternal: function( names, path, fileName ) {\n\t\tnames = names.split( ',' );\n\t\tfor ( var i = 0; i < names.length; i++ ) {\n\t\t\tvar name = names[ i ];\n\n\t\t\t// If \"fileName\" is not provided, we assume that it may be available\n\t\t\t// in \"path\". Try to extract it in this case.\n\t\t\tif ( !fileName ) {\n\t\t\t\tpath = path.replace( /[^\\/]+$/, function( match ) {\n\t\t\t\t\tfileName = match;\n\t\t\t\t\treturn '';\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\tthis.externals[ name ] = {\n\t\t\t\tdir: path,\n\n\t\t\t\t// Use the default file name if there is no \"fileName\" and it\n\t\t\t\t// was not found in \"path\".\n\t\t\t\tfile: fileName || ( this.fileName + '.js' )\n\t\t\t};\n\t\t}\n\t},\n\n\t/**\n\t * Loads one or more resources.\n\t *\n\t *\t\tCKEDITOR.plugins.load( 'myplugin', function( plugins ) {\n\t *\t\t\talert( plugins[ 'myplugin' ] ); // object\n\t *\t\t} );\n\t *\n\t * @param {String/Array} name The name of the resource to load. It may be a\n\t * string with a single resource name, or an array with several names.\n\t * @param {Function} callback A function to be called when all resources\n\t * are loaded. The callback will receive an array containing all loaded names.\n\t * @param {Object} [scope] The scope object to be used for the callback call.\n\t */\n\tload: function( names, callback, scope ) {\n\t\t// Ensure that we have an array of names.\n\t\tif ( !CKEDITOR.tools.isArray( names ) )\n\t\t\tnames = names ? [ names ] : [];\n\n\t\tvar loaded = this.loaded,\n\t\t\tregistered = this.registered,\n\t\t\turls = [],\n\t\t\turlsNames = {},\n\t\t\tresources = {};\n\n\t\t// Loop through all names.\n\t\tfor ( var i = 0; i < names.length; i++ ) {\n\t\t\tvar name = names[ i ];\n\n\t\t\tif ( !name )\n\t\t\t\tcontinue;\n\n\t\t\t// If not available yet.\n\t\t\tif ( !loaded[ name ] && !registered[ name ] ) {\n\t\t\t\tvar url = this.getFilePath( name );\n\t\t\t\turls.push( url );\n\t\t\t\tif ( !( url in urlsNames ) )\n\t\t\t\t\turlsNames[ url ] = [];\n\t\t\t\turlsNames[ url ].push( name );\n\t\t\t} else {\n\t\t\t\tresources[ name ] = this.get( name );\n\t\t\t}\n\t\t}\n\n\t\tCKEDITOR.scriptLoader.load( urls, function( completed, failed ) {\n\t\t\tif ( failed.length ) {\n\t\t\t\tthrow new Error( '[CKEDITOR.resourceManager.load] Resource name \"' + urlsNames[ failed[ 0 ] ].join( ',' ) +\n\t\t\t\t\t'\" was not found at \"' + failed[ 0 ] + '\".' );\n\t\t\t}\n\n\t\t\tfor ( var i = 0; i < completed.length; i++ ) {\n\t\t\t\tvar nameList = urlsNames[ completed[ i ] ];\n\t\t\t\tfor ( var j = 0; j < nameList.length; j++ ) {\n\t\t\t\t\tvar name = nameList[ j ];\n\t\t\t\t\tresources[ name ] = this.get( name );\n\n\t\t\t\t\tloaded[ name ] = 1;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcallback.call( scope, resources );\n\t\t}, this );\n\t}\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/resourcemanager.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Defines the {@link CKEDITOR.plugins} object, which is used to\n *\t\tmanage plugins registration and loading.\n */\n\n/**\n * Manages plugins registration and loading.\n *\n * @class\n * @extends CKEDITOR.resourceManager\n * @singleton\n */\nCKEDITOR.plugins = new CKEDITOR.resourceManager( 'plugins/', 'plugin' );\n\n// PACKAGER_RENAME( CKEDITOR.plugins )\n\nCKEDITOR.plugins.load = CKEDITOR.tools.override( CKEDITOR.plugins.load, function( originalLoad ) {\n\tvar initialized = {};\n\n\treturn function( name, callback, scope ) {\n\t\tvar allPlugins = {};\n\n\t\tvar loadPlugins = function( names ) {\n\t\t\t\toriginalLoad.call( this, names, function( plugins ) {\n\t\t\t\t\tCKEDITOR.tools.extend( allPlugins, plugins );\n\n\t\t\t\t\tvar requiredPlugins = [];\n\t\t\t\t\tfor ( var pluginName in plugins ) {\n\t\t\t\t\t\tvar plugin = plugins[ pluginName ],\n\t\t\t\t\t\t\trequires = plugin && plugin.requires;\n\n\t\t\t\t\t\tif ( !initialized[ pluginName ] ) {\n\t\t\t\t\t\t\t// Register all icons eventually defined by this plugin.\n\t\t\t\t\t\t\tif ( plugin.icons ) {\n\t\t\t\t\t\t\t\tvar icons = plugin.icons.split( ',' );\n\t\t\t\t\t\t\t\tfor ( var ic = icons.length; ic--; ) {\n\t\t\t\t\t\t\t\t\tCKEDITOR.skin.addIcon( icons[ ic ],\n\t\t\t\t\t\t\t\t\t\tplugin.path +\n\t\t\t\t\t\t\t\t\t\t'icons/' +\n\t\t\t\t\t\t\t\t\t\t( CKEDITOR.env.hidpi && plugin.hidpi ? 'hidpi/' : '' ) +\n\t\t\t\t\t\t\t\t\t\ticons[ ic ] +\n\t\t\t\t\t\t\t\t\t\t'.png' );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tinitialized[ pluginName ] = 1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( requires ) {\n\t\t\t\t\t\t\t// Trasnform it into an array, if it's not one.\n\t\t\t\t\t\t\tif ( requires.split )\n\t\t\t\t\t\t\t\trequires = requires.split( ',' );\n\n\t\t\t\t\t\t\tfor ( var i = 0; i < requires.length; i++ ) {\n\t\t\t\t\t\t\t\tif ( !allPlugins[ requires[ i ] ] )\n\t\t\t\t\t\t\t\t\trequiredPlugins.push( requires[ i ] );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( requiredPlugins.length )\n\t\t\t\t\t\tloadPlugins.call( this, requiredPlugins );\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Call the \"onLoad\" function for all plugins.\n\t\t\t\t\t\tfor ( pluginName in allPlugins ) {\n\t\t\t\t\t\t\tplugin = allPlugins[ pluginName ];\n\t\t\t\t\t\t\tif ( plugin.onLoad && !plugin.onLoad._called ) {\n\t\t\t\t\t\t\t\t// Make it possible to return false from plugin::onLoad to disable it.\n\t\t\t\t\t\t\t\tif ( plugin.onLoad() === false )\n\t\t\t\t\t\t\t\t\tdelete allPlugins[ pluginName ];\n\n\t\t\t\t\t\t\t\tplugin.onLoad._called = 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Call the callback.\n\t\t\t\t\t\tif ( callback )\n\t\t\t\t\t\t\tcallback.call( scope || window, allPlugins );\n\t\t\t\t\t}\n\t\t\t\t}, this );\n\n\t\t\t};\n\n\t\tloadPlugins.call( this, name );\n\t};\n} );\n\n/**\n * Loads a specific language file, or auto detect it. A callback is\n * then called when the file gets loaded.\n *\n *\t\tCKEDITOR.plugins.setLang( 'myPlugin', 'en', {\n *\t\t\ttitle: 'My plugin',\n *\t\t\tselectOption: 'Please select an option'\n *\t\t} );\n *\n * @param {String} pluginName The name of the plugin to which the provided translation\n * should be attached.\n * @param {String} languageCode The code of the language translation provided.\n * @param {Object} languageEntries An object that contains pairs of label and\n * the respective translation.\n */\nCKEDITOR.plugins.setLang = function( pluginName, languageCode, languageEntries ) {\n\tvar plugin = this.get( pluginName ),\n\t\tpluginLangEntries = plugin.langEntries || ( plugin.langEntries = {} ),\n\t\tpluginLang = plugin.lang || ( plugin.lang = [] );\n\n\tif ( pluginLang.split )\n\t\tpluginLang = pluginLang.split( ',' );\n\n\tif ( CKEDITOR.tools.indexOf( pluginLang, languageCode ) == -1 )\n\t\tpluginLang.push( languageCode );\n\n\tpluginLangEntries[ languageCode ] = languageEntries;\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/plugins.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * Contains UI features related to an editor instance.\n *\n * @class\n * @mixins CKEDITOR.event\n * @constructor Creates a `ui` class instance.\n * @param {CKEDITOR.editor} editor The editor instance.\n */\nCKEDITOR.ui = function( editor ) {\n\tif ( editor.ui )\n\t\treturn editor.ui;\n\n\tthis.items = {};\n\tthis.instances = {};\n\tthis.editor = editor;\n\n\t/**\n\t * Object used to store private stuff.\n\t *\n\t * @private\n\t */\n\tthis._ = {\n\t\thandlers: {}\n\t};\n\n\treturn this;\n};\n\n// PACKAGER_RENAME( CKEDITOR.ui )\n\nCKEDITOR.ui.prototype = {\n\t/**\n\t * Adds a UI item to the items collection. These items can be later used in\n\t * the interface.\n\t *\n\t *\t\t// Add a new button named 'MyBold'.\n\t *\t\teditorInstance.ui.add( 'MyBold', CKEDITOR.UI_BUTTON, {\n\t *\t\t\tlabel: 'My Bold',\n\t *\t\t\tcommand: 'bold'\n\t *\t\t} );\n\t *\n\t * @param {String} name The UI item name.\n\t * @param {Object} type The item type.\n\t * @param {Object} definition The item definition. The properties of this\n\t * object depend on the item type.\n\t */\n\tadd: function( name, type, definition ) {\n\t\t// Compensate the unique name of this ui item to definition.\n\t\tdefinition.name = name.toLowerCase();\n\n\t\tvar item = this.items[ name ] = {\n\t\t\ttype: type,\n\t\t\t// The name of {@link CKEDITOR.command} which associate with this UI.\n\t\t\tcommand: definition.command || null,\n\t\t\targs: Array.prototype.slice.call( arguments, 2 )\n\t\t};\n\n\t\tCKEDITOR.tools.extend( item, definition );\n\t},\n\n\t/**\n\t * Retrieves the created UI objects by name.\n\t *\n\t * @param {String} name The name of the UI definition.\n\t */\n\tget: function( name ) {\n\t\treturn this.instances[ name ];\n\t},\n\n\t/**\n\t * Gets a UI object.\n\t *\n\t * @param {String} name The UI item name.\n\t * @returns {Object} The UI element.\n\t */\n\tcreate: function( name ) {\n\t\tvar item = this.items[ name ],\n\t\t\thandler = item && this._.handlers[ item.type ],\n\t\t\tcommand = item && item.command && this.editor.getCommand( item.command );\n\n\t\tvar result = handler && handler.create.apply( this, item.args );\n\n\t\tthis.instances[ name ] = result;\n\n\t\t// Add reference inside command object.\n\t\tif ( command )\n\t\t\tcommand.uiItems.push( result );\n\n\t\tif ( result && !result.type )\n\t\t\tresult.type = item.type;\n\n\t\treturn result;\n\t},\n\n\t/**\n\t * Adds a handler for a UI item type. The handler is responsible for\n\t * transforming UI item definitions into UI objects.\n\t *\n\t * @param {Object} type The item type.\n\t * @param {Object} handler The handler definition.\n\t */\n\taddHandler: function( type, handler ) {\n\t\tthis._.handlers[ type ] = handler;\n\t},\n\n\t/**\n\t * Returns the unique DOM element that represents one editor's UI part, also known as \"space\".\n\t * There are 3 main editor spaces available: `top`, `contents` and `bottom`\n\t * and their availability depends on editor type.\n\t *\n\t *\t\t// Hide the bottom space in the UI.\n\t *\t\tvar bottom = editor.ui.space( 'bottom' );\n\t *\t\tbottom.setStyle( 'display', 'none' );\n\t *\n\t * @param {String} name The name of the space.\n\t * @returns {CKEDITOR.dom.element} The element that represents the space.\n\t */\n\tspace: function( name ) {\n\t\treturn CKEDITOR.document.getById( this.spaceId( name ) );\n\t},\n\n\t/**\n\t * Returns the HTML ID for a specific UI space name.\n\t *\n\t * @param {String} name The name of the space.\n\t * @returns {String} The ID of an element representing this space in the DOM.\n\t */\n\tspaceId: function( name ) {\n\t\treturn this.editor.id + '_' + name;\n\t}\n};\n\nCKEDITOR.event.implementOn( CKEDITOR.ui );\n\n/**\n * Internal event fired when a new UI element is ready.\n *\n * @event ready\n * @param {Object} data The new UI element.\n */\n\n/**\n * Virtual class which just illustrates the features of handler objects to be\n * passed to the {@link CKEDITOR.ui#addHandler} function.\n * This class is not really a part of the API, so do not call its constructor.\n *\n * @class CKEDITOR.ui.handlerDefinition\n */\n\n/**\n * Transforms an item definition into a UI item object.\n *\n *\t\teditorInstance.ui.addHandler( CKEDITOR.UI_BUTTON, {\n *\t\t\tcreate: function( definition ) {\n *\t\t\t\treturn new CKEDITOR.ui.button( definition );\n *\t\t\t}\n *\t\t} );\n *\n * @method create\n * @param {Object} definition The item definition.\n * @returns {Object} The UI element.\n * @todo We lack the \"UI element\" abstract super class.\n */\n\n/**\n * The element in the {@link CKEDITOR#document host page's document} that contains the editor content.\n * If the [fixed editor UI](#!/guide/dev_uitypes-section-fixed-user-interface) is used, then it will be set to\n * `editor.ui.space( 'contents' )` &mdash; i.e. the `<div>` which contains the editor `<iframe>` (in case of classic editor)\n * or {@link CKEDITOR.editable} (in case of inline editor). Otherwise it is set to the {@link CKEDITOR.editable} itself.\n *\n * Use the position of this element if you need to position elements placed in the host page's document relatively to the\n * editor content.\n *\n *\t\tvar editor = CKEDITOR.instances.editor1;\n *\t\tconsole.log( editor.ui.contentsElement.getName() ); // 'div'\n *\n * @since 4.5\n * @readonly\n * @property {CKEDITOR.dom.element} contentsElement\n */\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/ui.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Defines the {@link CKEDITOR.editor} class that represents an\n *\t\teditor instance.\n */\n\n( function() {\n\t// Override the basic constructor defined at editor_basic.js.\n\tEditor.prototype = CKEDITOR.editor.prototype;\n\tCKEDITOR.editor = Editor;\n\n\t/**\n\t * Represents an editor instance. This constructor should be rarely\n\t * used in favor of the {@link CKEDITOR} editor creation functions.\n\t *\n\t * @class CKEDITOR.editor\n\t * @mixins CKEDITOR.event\n\t * @constructor Creates an editor class instance.\n\t * @param {Object} [instanceConfig] Configuration values for this specific instance.\n\t * @param {CKEDITOR.dom.element} [element] The DOM element upon which this editor\n\t * will be created.\n\t * @param {Number} [mode] The element creation mode to be used by this editor.\n\t */\n\tfunction Editor( instanceConfig, element, mode ) {\n\t\t// Call the CKEDITOR.event constructor to initialize this instance.\n\t\tCKEDITOR.event.call( this );//有两个类，一个是editor类 一个是event类，这里将event类的构造函数的执行环境改为editor类\n\t\t// Make a clone of the config object, to avoid having it touched by our code. (#9636)\n\t\tinstanceConfig = instanceConfig && CKEDITOR.tools.clone( instanceConfig );\n\t\t// if editor is created off one page element.\n\t\tif ( element !== undefined ) {\n\t\t\t// Asserting element and mode not null.\n\t\t\tif ( !( element instanceof CKEDITOR.dom.element ) )\n\t\t\t\tthrow new Error( 'Expect element of type CKEDITOR.dom.element.' );\n\t\t\telse if ( !mode )\n\t\t\t\tthrow new Error( 'One of the element modes must be specified.' );\n\n\t\t\tif ( CKEDITOR.env.ie && CKEDITOR.env.quirks && mode == CKEDITOR.ELEMENT_MODE_INLINE )\n\t\t\t\tthrow new Error( 'Inline element mode is not supported on IE quirks.' );\n\n\t\t\tif ( !isSupportedElement( element, mode ) )\n\t\t\t\tthrow new Error( 'The specified element mode is not supported on element: \"' + element.getName() + '\".' );\n\n\t\t\t/**\n\t\t\t * The original host page element upon which the editor is created. It is only\n\t\t\t * supposed to be provided by the particular editor creator and is not subject to\n\t\t\t * be modified.\n\t\t\t *\n\t\t\t * @readonly\n\t\t\t * @property {CKEDITOR.dom.element}\n\t\t\t */\n\t\t\tthis.element = element;\n\n\t\t\t/**\n\t\t\t * This property indicates the way this instance is associated with the {@link #element}.\n\t\t\t * See also {@link CKEDITOR#ELEMENT_MODE_INLINE} and {@link CKEDITOR#ELEMENT_MODE_REPLACE}.\n\t\t\t *\n\t\t\t * @readonly\n\t\t\t * @property {Number}\n\t\t\t */\n\t\t\tthis.elementMode = mode;\n\n\t\t\tthis.name = ( this.elementMode != CKEDITOR.ELEMENT_MODE_APPENDTO ) && ( element.getId() || element.getNameAtt() );\n\t\t} else {\n\t\t\tthis.elementMode = CKEDITOR.ELEMENT_MODE_NONE;\n\t\t}\n\n\t\t// Declare the private namespace.\n\t\tthis._ = {};\n\n\t\tthis.commands = {};\n\n\t\t/**\n\t\t * Contains all UI templates created for this editor instance.\n\t\t *\n\t\t * @readonly\n\t\t * @property {Object}\n\t\t */\n\t\tthis.templates = {};\n\n\t\t/**\n\t\t * A unique identifier of this editor instance.\n\t\t *\n\t\t * **Note:** It will be originated from the `id` or `name`\n\t\t * attribute of the {@link #element}, otherwise a name pattern of\n\t\t * `'editor{n}'` will be used.\n\t\t *\n\t\t * @readonly\n\t\t * @property {String}\n\t\t */\n\t\tthis.name = this.name || genEditorName();\n\n\t\t/**\n\t\t * A unique random string assigned to each editor instance on the page.\n\t\t *\n\t\t * @readonly\n\t\t * @property {String}\n\t\t */\n\t\tthis.id = CKEDITOR.tools.getNextId();\n\n\t\t/**\n\t\t * Indicates editor initialization status. The following statuses are available:\n\t\t *\n\t\t *\t* **unloaded**: The initial state &mdash; the editor instance was initialized,\n\t\t *\tbut its components (configuration, plugins, language files) are not loaded yet.\n\t\t *\t* **loaded**: The editor components were loaded &mdash; see the {@link CKEDITOR.editor#loaded} event.\n\t\t *\t* **ready**: The editor is fully initialized and ready &mdash; see the {@link CKEDITOR.editor#instanceReady} event.\n\t\t *\t* **destroyed**: The editor was destroyed &mdash; see the {@link CKEDITOR.editor#method-destroy} method.\n\t\t *\n\t\t * @since 4.1\n\t\t * @readonly\n\t\t * @property {String}\n\t\t */\n\t\tthis.status = 'unloaded';\n\n\t\t/**\n\t\t * The configuration for this editor instance. It inherits all\n\t\t * settings defined in {@link CKEDITOR.config}, combined with settings\n\t\t * loaded from custom configuration files and those defined inline in\n\t\t * the page when creating the editor.\n\t\t *\n\t\t *\t\tvar editor = CKEDITOR.instances.editor1;\n\t\t *\t\talert( editor.config.skin ); // e.g. 'moono'\n\t\t *\n\t\t * @readonly\n\t\t * @property {CKEDITOR.config}\n\t\t */\n\t\tthis.config = CKEDITOR.tools.prototypedCopy( CKEDITOR.config );\n\n\n\t\t/**\n\t\t * The namespace containing UI features related to this editor instance.\n\t\t *\n\t\t * @readonly\n\t\t * @property {CKEDITOR.ui}\n\t\t */\n\t\tthis.ui = new CKEDITOR.ui( this );\n\n\t\t/**\n\t\t * Controls the focus state of this editor instance. This property\n\t\t * is rarely used for normal API operations. It is mainly\n\t\t * targeted at developers adding UI elements to the editor interface.\n\t\t *\n\t\t * @readonly\n\t\t * @property {CKEDITOR.focusManager}\n\t\t */\n\t\tthis.focusManager = new CKEDITOR.focusManager( this );\n\n\t\t/**\n\t\t * Controls keystroke typing in this editor instance.\n\t\t *\n\t\t * @readonly\n\t\t * @property {CKEDITOR.keystrokeHandler}\n\t\t */\n\t\tthis.keystrokeHandler = new CKEDITOR.keystrokeHandler( this );\n\n\t\t// Make the editor update its command states on mode change.\n\t\tthis.on( 'readOnly', updateCommands );\n\t\tthis.on( 'selectionChange', function( evt ) {\n\t\t\tupdateCommandsContext( this, evt.data.path );\n\t\t} );\n\t\tthis.on( 'activeFilterChange', function() {\n\t\t\tupdateCommandsContext( this, this.elementPath(), true );\n\t\t} );\n\t\tthis.on( 'mode', updateCommands );\n\n\t\t// Handle startup focus.\n\t\tthis.on( 'instanceReady', function() {\n\t\t\tthis.config.startupFocus && this.focus();\n\t\t} );\n\n\t\tCKEDITOR.fire( 'instanceCreated', null, this );\n\n\t\t// Add this new editor to the CKEDITOR.instances collections.\n\t\tCKEDITOR.add( this );\n\n\t\t// Return the editor instance immediately to enable early stage event registrations.\n\t\tCKEDITOR.tools.setTimeout( function() {//罪魁祸首\n\t\t\tif ( this.status !== 'destroyed' ) {\n\t\t\t\tinitConfig( this, instanceConfig );\n\t\t\t} else {\n\t\t\t\tCKEDITOR.warn( 'editor-incorrect-destroy' );\n\t\t\t}\n\t\t}, 0, this );\n\t\t// console.log(this.config);\n\t\t// return;\n\t}\n\n\tvar nameCounter = 0;\n\n\tfunction genEditorName() {\n\t\tdo {\n\t\t\tvar name = 'editor' + ( ++nameCounter );\n\t\t}\n\t\twhile ( CKEDITOR.instances[ name ] );\n\n\t\treturn name;\n\t}\n\n\t// Asserting element DTD depending on mode.\n\tfunction isSupportedElement( element, mode ) {\n\t\tif ( mode == CKEDITOR.ELEMENT_MODE_INLINE )\n\t\t\treturn element.is( CKEDITOR.dtd.$editable ) || element.is( 'textarea' );\n\t\telse if ( mode == CKEDITOR.ELEMENT_MODE_REPLACE )\n\t\t\treturn !element.is( CKEDITOR.dtd.$nonBodyContent );\n\t\treturn 1;\n\t}\n\n\tfunction updateCommands() {\n\t\tvar commands = this.commands,\n\t\t\tname;\n\n\t\tfor ( name in commands )\n\t\t\tupdateCommand( this, commands[ name ] );\n\t}\n\n\tfunction updateCommand( editor, cmd ) {\n\t\tcmd[ cmd.startDisabled ? 'disable' : editor.readOnly && !cmd.readOnly ? 'disable' : cmd.modes[ editor.mode ] ? 'enable' : 'disable' ]();\n\t}\n\n\tfunction updateCommandsContext( editor, path, forceRefresh ) {\n\t\t// Commands cannot be refreshed without a path. In edge cases\n\t\t// it may happen that there's no selection when this function is executed.\n\t\t// For example when active filter is changed in #10877.\n\t\tif ( !path )\n\t\t\treturn;\n\n\t\tvar command,\n\t\t\tname,\n\t\t\tcommands = editor.commands;\n\n\t\tfor ( name in commands ) {\n\t\t\tcommand = commands[ name ];\n\n\t\t\tif ( forceRefresh || command.contextSensitive )\n\t\t\t\tcommand.refresh( editor, path );\n\t\t}\n\t}\n\n\t// ##### START: Config Privates\n\n\t// These function loads custom configuration files and cache the\n\t// CKEDITOR.editorConfig functions defined on them, so there is no need to\n\t// download them more than once for several instances.\n\tvar loadConfigLoaded = {};\n\n\tfunction loadConfig( editor ) {\n\t\tvar customConfig = editor.config.customConfig;\n\t\t// Check if there is a custom config to load.\n\t\tif ( !customConfig )\n\t\t\treturn false;\n\n\t\tcustomConfig = CKEDITOR.getUrl( customConfig );\n\n\t\tvar loadedConfig = loadConfigLoaded[ customConfig ] || ( loadConfigLoaded[ customConfig ] = {} );\n\n\t\t// If the custom config has already been downloaded, reuse it.\n\t\tif ( loadedConfig.fn ) {\n\t\t\t// Call the cached CKEDITOR.editorConfig defined in the custom\n\t\t\t// config file for the editor instance depending on it.\n\t\t\tloadedConfig.fn.call( editor, editor.config );\n\n\t\t\t// If there is no other customConfig in the chain, fire the\n\t\t\t// \"configLoaded\" event.\n\t\t\tif ( CKEDITOR.getUrl( editor.config.customConfig ) == customConfig || !loadConfig( editor ) )\n\t\t\t\teditor.fireOnce( 'customConfigLoaded' );\n\t\t} else {\n\t\t\t// Load the custom configuration file.\n\t\t\t// To resolve customConfig race conflicts, use scriptLoader#queue\n\t\t\t// instead of scriptLoader#load (#6504).\n\t\t\t// CKEDITOR.scriptLoader.queue( customConfig, function() {//这里去拿了配置\n\t\t\t\t// If the CKEDITOR.editorConfig function has been properly\n\t\t\t\t// defined in the custom configuration file, cache it.\n\t\t\t\t// if ( CKEDITOR.editorConfig )\n\t\t\t\t\tloadedConfig.fn = CKEDITOR.editorConfig;\n\t\t\t\t// else\n\t\t\t\t\t// loadedConfig.fn = function() {};\n\n\t\t\t\t// Call the load config again. This time the custom\n\t\t\t\t// config is already cached and so it will get loaded.\n\t\t\t\tloadConfig( editor );\n\t\t\t// } );\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tfunction initConfig( editor, instanceConfig ) {\n\n\t\t// Setup the lister for the \"customConfigLoaded\" event.\n\t\teditor.on( 'customConfigLoaded', function() {\n\n\t\t\tif ( instanceConfig ) {\n\t\t\t\t// Register the events that may have been set at the instance\n\t\t\t\t// configuration object.\n\t\t\t\tif ( instanceConfig.on ) {\n\t\t\t\t\tfor ( var eventName in instanceConfig.on ) {\n\t\t\t\t\t\teditor.on( eventName, instanceConfig.on[ eventName ] );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Overwrite the settings from the in-page config.\n\t\t\t\tCKEDITOR.tools.extend( editor.config, instanceConfig, true );\n\n\t\t\t\tdelete editor.config.on;\n\t\t\t}\n\n\t\t\tonConfigLoaded( editor );\n\t\t} );\n\n\t\t// The instance config may override the customConfig setting to avoid\n\t\t// loading the default ~/config.js file.\n\t\tif ( instanceConfig && instanceConfig.customConfig != null )\n\t\t\teditor.config.customConfig = instanceConfig.customConfig;\n\n\t\t// Load configs from the custom configuration files.\n\t\tif ( !loadConfig( editor ) )\n\t\t\teditor.fireOnce( 'customConfigLoaded' );\n\t}\n\n\t// ##### END: Config Privates\n\n\t// Set config related properties.\n\tfunction onConfigLoaded( editor ) {\n\n\t\tvar config = editor.config;\n\n\t\t/**\n\t\t * Indicates the read-only state of this editor. This is a read-only property.\n\t\t * See also {@link CKEDITOR.editor#setReadOnly}.\n\t\t *\n\t\t * @since 3.6\n\t\t * @readonly\n\t\t * @property {Boolean}\n\t\t */\n\t\teditor.readOnly = isEditorReadOnly();\n\n\t\tfunction isEditorReadOnly() {\n\t\t\tif ( config.readOnly ) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif ( editor.elementMode == CKEDITOR.ELEMENT_MODE_INLINE ) {\n\t\t\t\tif ( editor.element.is( 'textarea' ) ) {\n\t\t\t\t\treturn editor.element.hasAttribute( 'disabled' ) || editor.element.hasAttribute( 'readonly' );\n\t\t\t\t} else {\n\t\t\t\t\treturn editor.element.isReadOnly();\n\t\t\t\t}\n\t\t\t} else if ( editor.elementMode == CKEDITOR.ELEMENT_MODE_REPLACE ) {\n\t\t\t\treturn editor.element.hasAttribute( 'disabled' ) || editor.element.hasAttribute( 'readonly' );\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\t/**\n\t\t * Indicates that the editor is running in an environment where\n\t\t * no block elements are accepted inside the content.\n\t\t *\n\t\t * This can be for example inline editor based on an `<h1>` element.\n\t\t *\n\t\t * @readonly\n\t\t * @property {Boolean}\n\t\t */\n\t\teditor.blockless = editor.elementMode == CKEDITOR.ELEMENT_MODE_INLINE ?\n\t\t\t!( editor.element.is( 'textarea' ) || CKEDITOR.dtd[ editor.element.getName() ].p ) :\n\t\t\tfalse;\n\n\t\t/**\n\t\t * The [tabbing navigation](http://en.wikipedia.org/wiki/Tabbing_navigation) order determined for this editor instance.\n\t\t * This can be set by the <code>{@link CKEDITOR.config#tabIndex}</code>\n\t\t * setting or taken from the `tabindex` attribute of the\n\t\t * {@link #element} associated with the editor.\n\t\t *\n\t\t *\t\talert( editor.tabIndex ); // e.g. 0\n\t\t *\n\t\t * @readonly\n\t\t * @property {Number} [=0]\n\t\t */\n\t\teditor.tabIndex = config.tabIndex || editor.element && editor.element.getAttribute( 'tabindex' ) || 0;\n\n\t\teditor.activeEnterMode = editor.enterMode = validateEnterMode( editor, config.enterMode );\n\t\teditor.activeShiftEnterMode = editor.shiftEnterMode = validateEnterMode( editor, config.shiftEnterMode );\n\n\t\t// Set CKEDITOR.skinName. Note that it is not possible to have\n\t\t// different skins on the same page, so the last one to set it \"wins\".\n\t\tif ( config.skin )\n\t\t\tCKEDITOR.skinName = config.skin;\n\n\t\t// Fire the \"configLoaded\" event.\n\t\teditor.fireOnce( 'configLoaded' );\n\n\t\tinitComponents( editor );\n\t}\n\n\t// Various other core components that read editor configuration.\n\tfunction initComponents( editor ) {\n\t\t// Documented in dataprocessor.js.\n\t\teditor.dataProcessor = new CKEDITOR.htmlDataProcessor( editor );\n\n\t\t// Set activeFilter directly to avoid firing event.\n\t\teditor.filter = editor.activeFilter = new CKEDITOR.filter( editor );\n\n\t\tloadSkin( editor );\n\t}\n\n\tfunction loadSkin( editor ) {\n\t\tCKEDITOR.skin.loadPart( 'editor', function() {\n\t\t\tloadLang( editor );\n\t\t} );\n\t}\n\n\tfunction loadLang( editor ) {\n\t\tCKEDITOR.lang.load( editor.config.language, editor.config.defaultLanguage, function( languageCode, lang ) {\n\t\t\tconsole.log(languageCode)\n\t\t\tconsole.log(lang);\n\t\t\t\n\t\t\tvar configTitle = editor.config.title;\n\n\t\t\t/**\n\t\t\t * The code for the language resources that have been loaded\n\t\t\t * for the user interface elements of this editor instance.\n\t\t\t *\n\t\t\t *\t\talert( editor.langCode ); // e.g. 'en'\n\t\t\t *\n\t\t\t * @readonly\n\t\t\t * @property {String}\n\t\t\t */\n\t\t\teditor.langCode = languageCode;\n\n\t\t\t/**\n\t\t\t * An object that contains all language strings used by the editor interface.\n\t\t\t *\n\t\t\t *\t\talert( editor.lang.basicstyles.bold ); // e.g. 'Negrito' (if the language is set to Portuguese)\n\t\t\t *\n\t\t\t * @readonly\n\t\t\t * @property {Object} lang\n\t\t\t */\n\t\t\t// As we'll be adding plugin specific entries that could come\n\t\t\t// from different language code files, we need a copy of lang,\n\t\t\t// not a direct reference to it.\n\t\t\teditor.lang = CKEDITOR.tools.prototypedCopy( lang );\n\n\t\t\t/**\n\t\t\t * Indicates the human-readable title of this editor. Although this is a read-only property,\n\t\t\t * it can be initialized with {@link CKEDITOR.config#title}.\n\t\t\t *\n\t\t\t * **Note:** Please do not confuse this property with {@link CKEDITOR.editor#name editor.name}\n\t\t\t * which identifies the instance in the {@link CKEDITOR#instances} literal.\n\t\t\t *\n\t\t\t * @since 4.2\n\t\t\t * @readonly\n\t\t\t * @property {String/Boolean}\n\t\t\t */\n\t\t\teditor.title = typeof configTitle == 'string' || configTitle === false ? configTitle : [ editor.lang.editor, editor.name ].join( ', ' );\n\n\t\t\tif ( !editor.config.contentsLangDirection ) {\n\t\t\t\t// Fallback to either the editable element direction or editor UI direction depending on creators.\n\t\t\t\teditor.config.contentsLangDirection = editor.elementMode == CKEDITOR.ELEMENT_MODE_INLINE ? editor.element.getDirection( 1 ) : editor.lang.dir;\n\t\t\t}\n\n\t\t\teditor.fire( 'langLoaded' );\n\n\t\t\tpreloadStylesSet( editor );\n\t\t} );\n\n\n\t}\n\n\t// Preloads styles set file (config.stylesSet).\n\t// If stylesSet was defined directly (by an array)\n\t// this function will call loadPlugins fully synchronously.\n\t// If stylesSet is a string (path) loadPlugins will\n\t// be called asynchronously.\n\t// In both cases - styles will be preload before plugins initialization.\n\tfunction preloadStylesSet( editor ) {\n\t\teditor.getStylesSet( function( styles ) {\n\t\t\t// Wait for editor#loaded, so plugins could add their listeners.\n\t\t\t// But listen with high priority to fire editor#stylesSet before editor#uiReady and editor#setData.\n\t\t\teditor.once( 'loaded', function() {\n\t\t\t\t// Note: we can't use fireOnce because this event may canceled and fired again.\n\t\t\t\teditor.fire( 'stylesSet', { styles: styles } );\n\t\t\t}, null, null, 1 );\n\n\t\t\tloadPlugins( editor );\n\t\t} );\n\t}\n\n\tfunction loadPlugins( editor ) {\n\t\tvar config = editor.config,\n\t\t\tplugins = config.plugins,\n\t\t\textraPlugins = config.extraPlugins,\n\t\t\tremovePlugins = config.removePlugins;\n\t\tif ( extraPlugins ) {\n\t\t\t// Remove them first to avoid duplications.\n\t\t\tvar extraRegex = new RegExp( '(?:^|,)(?:' + extraPlugins.replace( /\\s*,\\s*/g, '|' ) + ')(?=,|$)', 'g' );\n\t\t\tplugins = plugins.replace( extraRegex, '' );\n\n\t\t\tplugins += ',' + extraPlugins;\n\t\t}\n\n\t\tif ( removePlugins ) {\n\t\t\tvar removeRegex = new RegExp( '(?:^|,)(?:' + removePlugins.replace( /\\s*,\\s*/g, '|' ) + ')(?=,|$)', 'g' );\n\t\t\tplugins = plugins.replace( removeRegex, '' );\n\t\t}\n\n\t\t// Load the Adobe AIR plugin conditionally.\n\t\tCKEDITOR.env.air && ( plugins += ',adobeair' );\n\n\t\t// Load all plugins defined in the \"plugins\" setting.\n\t\tCKEDITOR.plugins.load( plugins.split( ',' ), function( plugins ) {\n\t\t\t// The list of plugins.\n\t\t\tvar pluginsArray = [];\n\n\t\t\t// The language code to get loaded for each plugin. Null\n\t\t\t// entries will be appended for plugins with no language files.\n\t\t\tvar languageCodes = [];\n\n\t\t\t// The list of URLs to language files.\n\t\t\tvar languageFiles = [];\n\n\t\t\t/**\n\t\t\t * An object that contains references to all plugins used by this\n\t\t\t * editor instance.\n\t\t\t *\n\t\t\t *\t\talert( editor.plugins.dialog.path ); // e.g. 'http://example.com/ckeditor/plugins/dialog/'\n\t\t\t *\n\t\t\t *\t\t// Check if a plugin is available.\n\t\t\t *\t\tif ( editor.plugins.image ) {\n\t\t\t *\t\t\t...\n\t\t\t *\t\t}\n\t\t\t *\n\t\t\t * @readonly\n\t\t\t * @property {Object}\n\t\t\t */\n\n\t\t\teditor.plugins = plugins;\n\n\t\t\t// Loop through all plugins, to build the list of language\n\t\t\t// files to get loaded.\n\t\t\t//\n\t\t\t// Check also whether any of loaded plugins doesn't require plugins\n\t\t\t// defined in config.removePlugins. Throw non-blocking error if this happens.\n\t\t\tfor ( var pluginName in plugins ) {\n\t\t\t\tvar plugin = plugins[ pluginName ],\n\t\t\t\t\tpluginLangs = plugin.lang,\n\t\t\t\t\tlang = null,\n\t\t\t\t\trequires = plugin.requires,\n\t\t\t\t\tmatch, name;\n\n\t\t\t\t// Transform it into a string, if it's not one.\n\t\t\t\tif ( CKEDITOR.tools.isArray( requires ) )\n\t\t\t\t\trequires = requires.join( ',' );\n\n\t\t\t\tif ( requires && ( match = requires.match( removeRegex ) ) ) {\n\t\t\t\t\twhile ( ( name = match.pop() ) ) {\n\t\t\t\t\t\tCKEDITOR.error( 'editor-plugin-required', { plugin: name.replace( ',', '' ), requiredBy: pluginName } );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// If the plugin has \"lang\".\n\t\t\t\tif ( pluginLangs && !editor.lang[ pluginName ] ) {\n\t\t\t\t\t// Trasnform the plugin langs into an array, if it's not one.\n\t\t\t\t\tif ( pluginLangs.split )\n\t\t\t\t\t\tpluginLangs = pluginLangs.split( ',' );\n\n\t\t\t\t\t// Resolve the plugin language. If the current language\n\t\t\t\t\t// is not available, get English or the first one.\n\t\t\t\t\tif ( CKEDITOR.tools.indexOf( pluginLangs, editor.langCode ) >= 0 )\n\t\t\t\t\t\tlang = editor.langCode;\n\t\t\t\t\telse {\n\t\t\t\t\t\t// The language code may have the locale information (zh-cn).\n\t\t\t\t\t\t// Fall back to locale-less in that case (zh).\n\t\t\t\t\t\tvar langPart = editor.langCode.replace( /-.*/, '' );\n\t\t\t\t\t\tif ( langPart != editor.langCode && CKEDITOR.tools.indexOf( pluginLangs, langPart ) >= 0 )\n\t\t\t\t\t\t\tlang = langPart;\n\t\t\t\t\t\t// Try the only \"generic\" option we have: English.\n\t\t\t\t\t\telse if ( CKEDITOR.tools.indexOf( pluginLangs, 'en' ) >= 0 )\n\t\t\t\t\t\t\tlang = 'en';\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tlang = pluginLangs[ 0 ];\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( !plugin.langEntries || !plugin.langEntries[ lang ] ) {\n\t\t\t\t\t\t// Put the language file URL into the list of files to\n\t\t\t\t\t\t// get downloaded.\n\t\t\t\t\t\tlanguageFiles.push( CKEDITOR.getUrl( plugin.path + 'lang/' + lang + '.js' ) );\n\t\t\t\t\t} else {\n\t\t\t\t\t\teditor.lang[ pluginName ] = plugin.langEntries[ lang ];\n\t\t\t\t\t\tlang = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Save the language code, so we know later which\n\t\t\t\t// language has been resolved to this plugin.\n\t\t\t\tlanguageCodes.push( lang );\n\n\t\t\t\tpluginsArray.push( plugin );\n\t\t\t}\n\n\t\t\t// Load all plugin specific language files in a row.\n\t\t\tCKEDITOR.scriptLoader.load( languageFiles, function() {\n\t\t\t\t// Initialize all plugins that have the \"beforeInit\" and \"init\" methods defined.\n\t\t\t\tvar methods = [ 'beforeInit', 'init', 'afterInit' ];\n\t\t\t\tfor ( var m = 0; m < methods.length; m++ ) {\n\t\t\t\t\tfor ( var i = 0; i < pluginsArray.length; i++ ) {\n\t\t\t\t\t\tvar plugin = pluginsArray[ i ];\n\n\t\t\t\t\t\t// Uses the first loop to update the language entries also.\n\t\t\t\t\t\tif ( m === 0 && languageCodes[ i ] && plugin.lang && plugin.langEntries )\n\t\t\t\t\t\t\teditor.lang[ plugin.name ] = plugin.langEntries[ languageCodes[ i ] ];\n\n\t\t\t\t\t\t// Call the plugin method (beforeInit and init).\n\t\t\t\t\t\tif ( plugin[ methods[ m ] ] )\n\t\t\t\t\t\t\tplugin[ methods[ m ] ]( editor );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\teditor.fireOnce( 'pluginsLoaded' );\n\n\t\t\t\t// Setup the configured keystrokes.\n\t\t\t\tconfig.keystrokes && editor.setKeystroke( editor.config.keystrokes );\n\n\t\t\t\t// Setup the configured blocked keystrokes.\n\t\t\t\tfor ( i = 0; i < editor.config.blockedKeystrokes.length; i++ )\n\t\t\t\t\teditor.keystrokeHandler.blockedKeystrokes[ editor.config.blockedKeystrokes[ i ] ] = 1;\n\n\t\t\t\teditor.status = 'loaded';\n\t\t\t\teditor.fireOnce( 'loaded' );\n\t\t\t\tCKEDITOR.fire( 'instanceLoaded', null, editor );\n\t\t\t} );\n\t\t} );\n\t}\n\n\t// Send to data output back to editor's associated element.\n\tfunction updateEditorElement() {\n\t\tvar element = this.element;\n\n\t\t// Some editor creation mode will not have the\n\t\t// associated element.\n\t\tif ( element && this.elementMode != CKEDITOR.ELEMENT_MODE_APPENDTO ) {\n\t\t\tvar data = this.getData();\n\n\t\t\tif ( this.config.htmlEncodeOutput )\n\t\t\t\tdata = CKEDITOR.tools.htmlEncode( data );\n\n\t\t\tif ( element.is( 'textarea' ) )\n\t\t\t\telement.setValue( data );\n\t\t\telse\n\t\t\t\telement.setHtml( data );\n\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\t// Always returns ENTER_BR in case of blockless editor.\n\tfunction validateEnterMode( editor, enterMode ) {\n\t\treturn editor.blockless ? CKEDITOR.ENTER_BR : enterMode;\n\t}\n\n\t// Create DocumentFragment from specified ranges. For now it handles only tables in Firefox\n\t// and returns DocumentFragment from the 1. range for other cases. (#13884)\n\tfunction createDocumentFragmentFromRanges( ranges, editable ) {\n\t\tvar docFragment = new CKEDITOR.dom.documentFragment(),\n\t\t\ttableClone,\n\t\t\tcurrentRow,\n\t\t\tcurrentRowClone;\n\n\t\tfor ( var i = 0; i < ranges.length; i++ ) {\n\t\t\tvar range = ranges[ i ],\n\t\t\t\tcontainer = range.startContainer;\n\n\t\t\tif ( container.getName && container.getName() == 'tr' ) {\n\t\t\t\tif ( !tableClone ) {\n\t\t\t\t\ttableClone = container.getAscendant( 'table' ).clone();\n\t\t\t\t\ttableClone.append( container.getAscendant( 'tbody' ).clone() );\n\t\t\t\t\tdocFragment.append( tableClone );\n\t\t\t\t\ttableClone = tableClone.findOne( 'tbody' );\n\t\t\t\t}\n\n\t\t\t\tif ( !( currentRow && currentRow.equals( container ) ) ) {\n\t\t\t\t\tcurrentRow = container;\n\t\t\t\t\tcurrentRowClone = container.clone();\n\t\t\t\t\ttableClone.append( currentRowClone );\n\t\t\t\t}\n\n\t\t\t\tcurrentRowClone.append( range.cloneContents() );\n\t\t\t} else {\n\t\t\t\t// If there was something else copied with table,\n\t\t\t\t// append it to DocumentFragment.\n\t\t\t\tdocFragment.append( range.cloneContents() );\n\t\t\t}\n\t\t}\n\n\t\tif ( !tableClone ) {\n\t\t\treturn editable.getHtmlFromRange( ranges[ 0 ] );\n\t\t}\n\n\t\treturn docFragment;\n\t}\n\n\tCKEDITOR.tools.extend( CKEDITOR.editor.prototype, {\n\t\t/**\n\t\t * Adds a command definition to the editor instance. Commands added with\n\t\t * this function can be executed later with the <code>{@link #execCommand}</code> method.\n\t\t *\n\t\t * \t\teditorInstance.addCommand( 'sample', {\n\t\t * \t\t\texec: function( editor ) {\n\t\t * \t\t\t\talert( 'Executing a command for the editor name \"' + editor.name + '\"!' );\n\t\t * \t\t\t}\n\t\t * \t\t} );\n\t\t *\n\t\t * @param {String} commandName The indentifier name of the command.\n\t\t * @param {CKEDITOR.commandDefinition} commandDefinition The command definition.\n\t\t */\n\t\taddCommand: function( commandName, commandDefinition ) {\n\t\t\tcommandDefinition.name = commandName.toLowerCase();\n\t\t\tvar cmd = new CKEDITOR.command( this, commandDefinition );\n\n\t\t\t// Update command when mode is set.\n\t\t\t// This guarantees that commands added before first editor#mode\n\t\t\t// aren't immediately updated, but waits for editor#mode and that\n\t\t\t// commands added later are immediately refreshed, even when added\n\t\t\t// before instanceReady. #10103, #10249\n\t\t\tif ( this.mode )\n\t\t\t\tupdateCommand( this, cmd );\n\n\t\t\treturn this.commands[ commandName ] = cmd;\n\t\t},\n\n\t\t/**\n\t\t * Attaches the editor to a form to call {@link #updateElement} before form submission.\n\t\t * This method is called by both creators ({@link CKEDITOR#replace replace} and\n\t\t * {@link CKEDITOR#inline inline}), so there is no reason to call it manually.\n\t\t *\n\t\t * @private\n\t\t */\n\t\t_attachToForm: function() {\n\t\t\tvar editor = this,\n\t\t\t\telement = editor.element,\n\t\t\t\tform = new CKEDITOR.dom.element( element.$.form );\n\n\t\t\t// If are replacing a textarea, we must\n\t\t\tif ( element.is( 'textarea' ) ) {\n\t\t\t\tif ( form ) {\n\t\t\t\t\tform.on( 'submit', onSubmit );\n\n\t\t\t\t\t// Check if there is no element/elements input with name == \"submit\".\n\t\t\t\t\t// If they exists they will overwrite form submit function (form.$.submit).\n\t\t\t\t\t// If form.$.submit is overwritten we can not do anything with it.\n\t\t\t\t\tif ( isFunction( form.$.submit ) ) {\n\t\t\t\t\t\t// Setup the submit function because it doesn't fire the\n\t\t\t\t\t\t// \"submit\" event.\n\t\t\t\t\t\tform.$.submit = CKEDITOR.tools.override( form.$.submit, function( originalSubmit ) {\n\t\t\t\t\t\t\treturn function() {\n\t\t\t\t\t\t\t\tonSubmit();\n\n\t\t\t\t\t\t\t\t// For IE, the DOM submit function is not a\n\t\t\t\t\t\t\t\t// function, so we need third check.\n\t\t\t\t\t\t\t\tif ( originalSubmit.apply )\n\t\t\t\t\t\t\t\t\toriginalSubmit.apply( this );\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\toriginalSubmit();\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Remove 'submit' events registered on form element before destroying.(#3988)\n\t\t\t\t\teditor.on( 'destroy', function() {\n\t\t\t\t\t\tform.removeListener( 'submit', onSubmit );\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction onSubmit( evt ) {\n\t\t\t\teditor.updateElement();\n\n\t\t\t\t// #8031 If textarea had required attribute and editor is empty fire 'required' event and if\n\t\t\t\t// it was cancelled, prevent submitting the form.\n\t\t\t\tif ( editor._.required && !element.getValue() && editor.fire( 'required' ) === false ) {\n\t\t\t\t\t// When user press save button event (evt) is undefined (see save plugin).\n\t\t\t\t\t// This method works because it throws error so originalSubmit won't be called.\n\t\t\t\t\t// Also this error won't be shown because it will be caught in save plugin.\n\t\t\t\t\tevt.data.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction isFunction( f ) {\n\t\t\t\t// For IE8 typeof fun == object so we cannot use it.\n\t\t\t\treturn !!( f && f.call && f.apply );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Destroys the editor instance, releasing all resources used by it.\n\t\t * If the editor replaced an element, the element will be recovered.\n\t\t *\n\t\t *\t\talert( CKEDITOR.instances.editor1 ); // e.g. object\n\t\t *\t\tCKEDITOR.instances.editor1.destroy();\n\t\t *\t\talert( CKEDITOR.instances.editor1 ); // undefined\n\t\t *\n\t\t * @param {Boolean} [noUpdate] If the instance is replacing a DOM\n\t\t * element, this parameter indicates whether or not to update the\n\t\t * element with the instance content.\n\t\t */\n\t\tdestroy: function( noUpdate ) {\n\t\t\tthis.fire( 'beforeDestroy' );\n\n\t\t\t!noUpdate && updateEditorElement.call( this );\n\n\t\t\tthis.editable( null );\n\n\t\t\tif ( this.filter ) {\n\t\t\t\tthis.filter.destroy();\n\t\t\t\tdelete this.filter;\n\t\t\t}\n\n\t\t\tdelete this.activeFilter;\n\n\t\t\tthis.status = 'destroyed';\n\n\t\t\tthis.fire( 'destroy' );\n\n\t\t\t// Plug off all listeners to prevent any further events firing.\n\t\t\tthis.removeAllListeners();\n\n\t\t\tCKEDITOR.remove( this );\n\t\t\tCKEDITOR.fire( 'instanceDestroyed', null, this );\n\t\t},\n\n\t\t/**\n\t\t * Returns an {@link CKEDITOR.dom.elementPath element path} for the selection in the editor.\n\t\t *\n\t\t * @param {CKEDITOR.dom.node} [startNode] From which the path should start,\n\t\t * if not specified defaults to editor selection's\n\t\t * start element yielded by {@link CKEDITOR.dom.selection#getStartElement}.\n\t\t * @returns {CKEDITOR.dom.elementPath}\n\t\t */\n\t\telementPath: function( startNode ) {\n\t\t\tif ( !startNode ) {\n\t\t\t\tvar sel = this.getSelection();\n\t\t\t\tif ( !sel )\n\t\t\t\t\treturn null;\n\n\t\t\t\tstartNode = sel.getStartElement();\n\t\t\t}\n\n\t\t\treturn startNode ? new CKEDITOR.dom.elementPath( startNode, this.editable() ) : null;\n\t\t},\n\n\t\t/**\n\t\t * Shortcut to create a {@link CKEDITOR.dom.range} instance from the editable element.\n\t\t *\n\t\t * @returns {CKEDITOR.dom.range} The DOM range created if the editable has presented.\n\t\t * @see CKEDITOR.dom.range\n\t\t */\n\t\tcreateRange: function() {\n\t\t\tvar editable = this.editable();\n\t\t\treturn editable ? new CKEDITOR.dom.range( editable ) : null;\n\t\t},\n\n\t\t/**\n\t\t * Executes a command associated with the editor.\n\t\t *\n\t\t *\t\teditorInstance.execCommand( 'bold' );\n\t\t *\n\t\t * @param {String} commandName The indentifier name of the command.\n\t\t * @param {Object} [data] The data to be passed to the command.\n\t\t * @returns {Boolean} `true` if the command was executed\n\t\t * successfully, otherwise `false`.\n\t\t * @see CKEDITOR.editor#addCommand\n\t\t */\n\t\texecCommand: function( commandName, data ) {\n\t\t\tvar command = this.getCommand( commandName );\n\n\t\t\tvar eventData = {\n\t\t\t\tname: commandName,\n\t\t\t\tcommandData: data,\n\t\t\t\tcommand: command\n\t\t\t};\n\n\t\t\tif ( command && command.state != CKEDITOR.TRISTATE_DISABLED ) {\n\t\t\t\tif ( this.fire( 'beforeCommandExec', eventData ) !== false ) {\n\t\t\t\t\teventData.returnValue = command.exec( eventData.commandData );\n\n\t\t\t\t\t// Fire the 'afterCommandExec' immediately if command is synchronous.\n\t\t\t\t\tif ( !command.async && this.fire( 'afterCommandExec', eventData ) !== false )\n\t\t\t\t\t\treturn eventData.returnValue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// throw 'Unknown command name \"' + commandName + '\"';\n\t\t\treturn false;\n\t\t},\n\n\t\t/**\n\t\t * Gets one of the registered commands. Note that after registering a\n\t\t * command definition with {@link #addCommand}, it is\n\t\t * transformed internally into an instance of\n\t\t * {@link CKEDITOR.command}, which will then be returned by this function.\n\t\t *\n\t\t * @param {String} commandName The name of the command to be returned.\n\t\t * This is the same name that is used to register the command with `addCommand`.\n\t\t * @returns {CKEDITOR.command} The command object identified by the provided name.\n\t\t */\n\t\tgetCommand: function( commandName ) {\n\t\t\treturn this.commands[ commandName ];\n\t\t},\n\n\t\t/**\n\t\t * Gets the editor data. The data will be in \"raw\" format. It is the same\n\t\t * data that is posted by the editor.\n\t\t *\n\t\t *\t\tif ( CKEDITOR.instances.editor1.getData() == '' )\n\t\t *\t\t\talert( 'There is no data available.' );\n\t\t *\n\t\t * @param {Boolean} internal If set to `true`, it will prevent firing the\n\t\t * {@link CKEDITOR.editor#beforeGetData} and {@link CKEDITOR.editor#event-getData} events, so\n\t\t * the real content of the editor will not be read and cached data will be returned. The method will work\n\t\t * much faster, but this may result in the editor returning the data that is not up to date. This parameter\n\t\t * should thus only be set to `true` when you are certain that the cached data is up to date.\n\t\t *\n\t\t * @returns {String} The editor data.\n\t\t */\n\t\tgetData: function( internal ) {\n\t\t\t!internal && this.fire( 'beforeGetData' );\n\n\t\t\tvar eventData = this._.data;\n\n\t\t\tif ( typeof eventData != 'string' ) {\n\t\t\t\tvar element = this.element;\n\t\t\t\tif ( element && this.elementMode == CKEDITOR.ELEMENT_MODE_REPLACE )\n\t\t\t\t\teventData = element.is( 'textarea' ) ? element.getValue() : element.getHtml();\n\t\t\t\telse\n\t\t\t\t\teventData = '';\n\t\t\t}\n\n\t\t\teventData = { dataValue: eventData };\n\n\t\t\t// Fire \"getData\" so data manipulation may happen.\n\t\t\t!internal && this.fire( 'getData', eventData );\n\n\t\t\treturn eventData.dataValue;\n\t\t},\n\n\t\t/**\n\t\t * Gets the \"raw data\" currently available in the editor. This is a\n\t\t * fast method which returns the data as is, without processing, so it is\n\t\t * not recommended to use it on resulting pages. Instead it can be used\n\t\t * combined with the {@link #method-loadSnapshot} method in order\n\t\t * to automatically save the editor data from time to time\n\t\t * while the user is using the editor, to avoid data loss, without risking\n\t\t * performance issues.\n\t\t *\n\t\t *\t\talert( editor.getSnapshot() );\n\t\t *\n\t\t * See also:\n\t\t *\n\t\t * * {@link CKEDITOR.editor#method-getData}.\n\t\t *\n\t\t * @returns {String} Editor \"raw data\".\n\t\t */\n\t\tgetSnapshot: function() {\n\t\t\tvar data = this.fire( 'getSnapshot' );\n\n\t\t\tif ( typeof data != 'string' ) {\n\t\t\t\tvar element = this.element;\n\n\t\t\t\tif ( element && this.elementMode == CKEDITOR.ELEMENT_MODE_REPLACE ) {\n\t\t\t\t\tdata = element.is( 'textarea' ) ? element.getValue() : element.getHtml();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// If we don't have a proper element, set data to an empty string,\n\t\t\t\t\t// as this method is expected to return a string. (#13385)\n\t\t\t\t\tdata = '';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn data;\n\t\t},\n\n\t\t/**\n\t\t * Loads \"raw data\" into the editor. The data is loaded with processing\n\t\t * straight to the editing area. It should not be used as a way to load\n\t\t * any kind of data, but instead in combination with\n\t\t * {@link #method-getSnapshot}-produced data.\n\t\t *\n\t\t *\t\tvar data = editor.getSnapshot();\n\t\t *\t\teditor.loadSnapshot( data );\n\t\t *\n\t\t * @see CKEDITOR.editor#setData\n\t\t */\n\t\tloadSnapshot: function( snapshot ) {\n\t\t\tthis.fire( 'loadSnapshot', snapshot );\n\t\t},\n\n\t\t/**\n\t\t * Sets the editor data. The data must be provided in the \"raw\" format (HTML).\n\t\t *\n\t\t * Note that this method is asynchronous. The `callback` parameter must\n\t\t * be used if interaction with the editor is needed after setting the data.\n\t\t *\n\t\t *\t\tCKEDITOR.instances.editor1.setData( '<p>This is the editor data.</p>' );\n\t\t *\n\t\t *\t\tCKEDITOR.instances.editor1.setData( '<p>Some other editor data.</p>', {\n\t\t *\t\t\tcallback: function() {\n\t\t *\t\t\t\tthis.checkDirty(); // true\n\t\t *\t\t\t}\n\t\t *\t\t} );\n\t\t *\n\t\t * Note: In **CKEditor 4.4.2** the signature of this method has changed. All arguments\n\t\t * except `data` were wrapped into the `options` object. However, backward compatibility\n\t\t * was preserved and it is still possible to use the `data, callback, internal` arguments.\n\t\t *\n\t\t *\n\t\t * @param {String} data The HTML code to replace current editor content.\n\t\t * @param {Object} [options]\n\t\t * @param {Boolean} [options.internal=false] Whether to suppress any event firing when copying data internally inside the editor.\n\t\t * @param {Function} [options.callback] Function to be called after `setData` is completed (on {@link #dataReady}).\n\t\t * @param {Boolean} [options.noSnapshot=false] If set to `true`, it will prevent recording an undo snapshot.\n\t\t * Introduced in CKEditor 4.4.2.\n\t\t */\n\t\tsetData: function( data, options, internal ) {\n\t\t\tvar fireSnapshot = true,\n\t\t\t\t// Backward compatibility.\n\t\t\t\tcallback = options,\n\t\t\t\teventData;\n\n\t\t\tif ( options && typeof options == 'object' ) {\n\t\t\t\tinternal = options.internal;\n\t\t\t\tcallback = options.callback;\n\t\t\t\tfireSnapshot = !options.noSnapshot;\n\t\t\t}\n\n\t\t\tif ( !internal && fireSnapshot )\n\t\t\t\tthis.fire( 'saveSnapshot' );\n\n\t\t\tif ( callback || !internal ) {\n\t\t\t\tthis.once( 'dataReady', function( evt ) {\n\t\t\t\t\tif ( !internal && fireSnapshot )\n\t\t\t\t\t\tthis.fire( 'saveSnapshot' );\n\n\t\t\t\t\tif ( callback )\n\t\t\t\t\t\tcallback.call( evt.editor );\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\t// Fire \"setData\" so data manipulation may happen.\n\t\t\teventData = { dataValue: data };\n\t\t\t!internal && this.fire( 'setData', eventData );\n\n\t\t\tthis._.data = eventData.dataValue;\n\n\t\t\t!internal && this.fire( 'afterSetData', eventData );\n\t\t},\n\n\t\t/**\n\t\t * Puts or restores the editor into the read-only state. When in read-only,\n\t\t * the user is not able to change the editor content, but can still use\n\t\t * some editor features. This function sets the {@link #property-readOnly}\n\t\t * property of the editor, firing the {@link #event-readOnly} event.\n\t\t *\n\t\t * **Note:** The current editing area will be reloaded.\n\t\t *\n\t\t * @since 3.6\n\t\t * @param {Boolean} [isReadOnly] Indicates that the editor must go\n\t\t * read-only (`true`, default) or be restored and made editable (`false`).\n\t\t */\n\t\tsetReadOnly: function( isReadOnly ) {\n\t\t\tisReadOnly = ( isReadOnly == null ) || isReadOnly;\n\n\t\t\tif ( this.readOnly != isReadOnly ) {\n\t\t\t\tthis.readOnly = isReadOnly;\n\n\t\t\t\t// Block or release BACKSPACE key according to current read-only\n\t\t\t\t// state to prevent browser's history navigation (#9761).\n\t\t\t\tthis.keystrokeHandler.blockedKeystrokes[ 8 ] = +isReadOnly;\n\n\t\t\t\tthis.editable().setReadOnly( isReadOnly );\n\n\t\t\t\t// Fire the readOnly event so the editor features can update\n\t\t\t\t// their state accordingly.\n\t\t\t\tthis.fire( 'readOnly' );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Inserts HTML code into the currently selected position in the editor in WYSIWYG mode.\n\t\t *\n\t\t * Example:\n\t\t *\n\t\t *\t\tCKEDITOR.instances.editor1.insertHtml( '<p>This is a new paragraph.</p>' );\n\t\t *\n\t\t * Fires the {@link #event-insertHtml} and {@link #event-afterInsertHtml} events. The HTML is inserted\n\t\t * in the {@link #event-insertHtml} event's listener with a default priority (10) so you can add listeners with\n\t\t * lower or higher priorities in order to execute some code before or after the HTML is inserted.\n\t\t *\n\t\t * @param {String} html HTML code to be inserted into the editor.\n\t\t * @param {String} [mode='html'] The mode in which the HTML code will be inserted. One of the following:\n\t\t *\n\t\t * * `'html'` &ndash; The inserted content  will completely override the styles at the selected position.\n\t\t * * `'unfiltered_html'` &ndash; Like `'html'` but the content is not filtered with {@link CKEDITOR.filter}.\n\t\t * * `'text'` &ndash; The inserted content will inherit the styles applied in\n\t\t *    the selected position. This mode should be used when inserting \"htmlified\" plain text\n\t\t *    (HTML without inline styles and styling elements like `<b>`, `<strong>`, `<span style=\"...\">`).\n\t\t *\n\t\t * @param {CKEDITOR.dom.range} [range] If specified, the HTML will be inserted into the range\n\t\t * instead of into the selection. The selection will be placed at the end of the insertion (like in the normal case).\n\t\t * Introduced in CKEditor 4.5.\n\t\t */\n\t\tinsertHtml: function( html, mode, range ) {\n\t\t\tthis.fire( 'insertHtml', { dataValue: html, mode: mode, range: range } );\n\t\t},\n\n\t\t/**\n\t\t * Inserts text content into the currently selected position in the\n\t\t * editor in WYSIWYG mode. The styles of the selected element will be applied to the inserted text.\n\t\t * Spaces around the text will be left untouched.\n\t\t *\n\t\t *\t\tCKEDITOR.instances.editor1.insertText( ' line1 \\n\\n line2' );\n\t\t *\n\t\t * Fires the {@link #event-insertText} and {@link #event-afterInsertHtml} events. The text is inserted\n\t\t * in the {@link #event-insertText} event's listener with a default priority (10) so you can add listeners with\n\t\t * lower or higher priorities in order to execute some code before or after the text is inserted.\n\t\t *\n\t\t * @since 3.5\n\t\t * @param {String} text Text to be inserted into the editor.\n\t\t */\n\t\tinsertText: function( text ) {\n\t\t\tthis.fire( 'insertText', text );\n\t\t},\n\n\t\t/**\n\t\t * Inserts an element into the currently selected position in the editor in WYSIWYG mode.\n\t\t *\n\t\t *\t\tvar element = CKEDITOR.dom.element.createFromHtml( '<img src=\"hello.png\" border=\"0\" title=\"Hello\" />' );\n\t\t *\t\tCKEDITOR.instances.editor1.insertElement( element );\n\t\t *\n\t\t * Fires the {@link #event-insertElement} event. The element is inserted in the listener with a default priority (10),\n\t\t * so you can add listeners with lower or higher priorities in order to execute some code before or after\n\t\t * the element is inserted.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} element The element to be inserted into the editor.\n\t\t */\n\t\tinsertElement: function( element ) {\n\t\t\tthis.fire( 'insertElement', element );\n\t\t},\n\n\t\t/**\n\t\t * Gets the selected HTML (it is returned as a {@link CKEDITOR.dom.documentFragment document fragment}\n\t\t * or a string). This method is designed to work as the user would expect the copy functionality to work.\n\t\t * For instance, if the following selection was made:\n\t\t *\n\t\t *\t\t<p>a<b>b{c}d</b>e</p>\n\t\t *\n\t\t * The following HTML will be returned:\n\t\t *\n\t\t *\t\t<b>c</b>\n\t\t *\n\t\t * As you can see, the information about the bold formatting was preserved, even though the selection was\n\t\t * anchored inside the `<b>` element.\n\t\t *\n\t\t * See also:\n\t\t *\n\t\t * * the {@link #extractSelectedHtml} method,\n\t\t * * the {@link CKEDITOR.editable#getHtmlFromRange} method.\n\t\t *\n\t\t * @since 4.5\n\t\t * @param {Boolean} [toString] If `true`, then stringified HTML will be returned.\n\t\t * @returns {CKEDITOR.dom.documentFragment/String}\n\t\t */\n\t\tgetSelectedHtml: function( toString ) {\n\t\t\tvar editable = this.editable(),\n\t\t\t\tselection = this.getSelection(),\n\t\t\t\tranges = selection && selection.getRanges();\n\n\t\t\tif ( !editable || !ranges || ranges.length === 0 ) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tvar docFragment = createDocumentFragmentFromRanges( ranges, editable );\n\n\t\t\treturn toString ? docFragment.getHtml() : docFragment;\n\t\t},\n\n\t\t/**\n\t\t * Gets the selected HTML (it is returned as a {@link CKEDITOR.dom.documentFragment document fragment}\n\t\t * or a string) and removes the selected part of the DOM. This method is designed to work as the user would\n\t\t * expect the cut and delete functionalities to work.\n\t\t *\n\t\t * See also:\n\t\t *\n\t\t * * the {@link #getSelectedHtml} method,\n\t\t * * the {@link CKEDITOR.editable#extractHtmlFromRange} method.\n\t\t *\n\t\t * @since 4.5\n\t\t * @param {Boolean} [toString] If `true`, then stringified HTML will be returned.\n\t\t * @param {Boolean} [removeEmptyBlock=false] Default `false` means that the function will keep an empty block (if the\n\t\t * entire content was removed) or it will create it (if a block element was removed) and set the selection in that block.\n\t\t * If `true`, the empty block will be removed or not created. In this case the function will not handle the selection.\n\t\t * @returns {CKEDITOR.dom.documentFragment/String/null}\n\t\t */\n\t\textractSelectedHtml: function( toString, removeEmptyBlock ) {\n\t\t\tvar editable = this.editable(),\n\t\t\t\tranges = this.getSelection().getRanges();\n\n\t\t\tif ( !editable || ranges.length === 0 ) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tvar range = ranges[ 0 ],\n\t\t\t\tdocFragment = editable.extractHtmlFromRange( range, removeEmptyBlock );\n\n\t\t\tif ( !removeEmptyBlock ) {\n\t\t\t\tthis.getSelection().selectRanges( [ range ] );\n\t\t\t}\n\n\t\t\treturn toString ? docFragment.getHtml() : docFragment;\n\t\t},\n\n\t\t/**\n\t\t * Moves the selection focus to the editing area space in the editor.\n\t\t */\n\t\tfocus: function() {\n\t\t\tthis.fire( 'beforeFocus' );\n\t\t},\n\n\t\t/**\n\t\t * Checks whether the current editor content contains changes when\n\t\t * compared to the content loaded into the editor at startup, or to\n\t\t * the content available in the editor when {@link #resetDirty}\n\t\t * was called.\n\t\t *\n\t\t *\t\tfunction beforeUnload( evt ) {\n\t\t *\t\t\tif ( CKEDITOR.instances.editor1.checkDirty() )\n\t\t *\t\t\t\treturn evt.returnValue = \"You will lose the changes made in the editor.\";\n\t\t *\t\t}\n\t\t *\n\t\t *\t\tif ( window.addEventListener )\n\t\t *\t\t\twindow.addEventListener( 'beforeunload', beforeUnload, false );\n\t\t *\t\telse\n\t\t *\t\t\twindow.attachEvent( 'onbeforeunload', beforeUnload );\n\t\t *\n\t\t * @returns {Boolean} `true` if the content contains changes.\n\t\t */\n\t\tcheckDirty: function() {\n\t\t\treturn this.status == 'ready' && this._.previousValue !== this.getSnapshot();\n\t\t},\n\n\t\t/**\n\t\t * Resets the \"dirty state\" of the editor so subsequent calls to\n\t\t * {@link #checkDirty} will return `false` if the user will not\n\t\t * have made further changes to the content.\n\t\t *\n\t\t *\t\talert( editor.checkDirty() ); // e.g. true\n\t\t *\t\teditor.resetDirty();\n\t\t *\t\talert( editor.checkDirty() ); // false\n\t\t */\n\t\tresetDirty: function() {\n\t\t\tthis._.previousValue = this.getSnapshot();\n\t\t},\n\n\t\t/**\n\t\t * Updates the `<textarea>` element that was replaced by the editor with\n\t\t * the current data available in the editor.\n\t\t *\n\t\t * **Note:** This method will only affect those editor instances created\n\t\t * with the {@link CKEDITOR#ELEMENT_MODE_REPLACE} element mode or inline instances\n\t\t * bound to `<textarea>` elements.\n\t\t *\n\t\t *\t\tCKEDITOR.instances.editor1.updateElement();\n\t\t *\t\talert( document.getElementById( 'editor1' ).value ); // The current editor data.\n\t\t *\n\t\t * @see CKEDITOR.editor#element\n\t\t */\n\t\tupdateElement: function() {\n\t\t\treturn updateEditorElement.call( this );\n\t\t},\n\n\t\t/**\n\t\t * Assigns keystrokes associated with editor commands.\n\t\t *\n\t\t *\t\teditor.setKeystroke( CKEDITOR.CTRL + 115, 'save' );\t// Assigned Ctrl+S to the \"save\" command.\n\t\t *\t\teditor.setKeystroke( CKEDITOR.CTRL + 115, false );\t// Disabled Ctrl+S keystroke assignment.\n\t\t *\t\teditor.setKeystroke( [\n\t\t *\t\t\t[ CKEDITOR.ALT + 122, false ],\n\t\t *\t\t\t[ CKEDITOR.CTRL + 121, 'link' ],\n\t\t *\t\t\t[ CKEDITOR.SHIFT + 120, 'bold' ]\n\t\t *\t\t] );\n\t\t *\n\t\t * This method may be used in the following cases:\n\t\t *\n\t\t * * By plugins (like `link` or `basicstyles`) to set their keystrokes when plugins are being loaded.\n\t\t * * During the runtime to modify existing keystrokes.\n\t\t *\n\t\t * The editor handles keystroke configuration in the following order:\n\t\t *\n\t\t * 1. Plugins use this method to define default keystrokes.\n\t\t * 2. Editor extends default keystrokes with {@link CKEDITOR.config#keystrokes}.\n\t\t * 3. Editor blocks keystrokes defined in {@link CKEDITOR.config#blockedKeystrokes}.\n\t\t *\n\t\t * You can then set new keystrokes using this method during the runtime.\n\t\t *\n\t\t * @since 4.0\n\t\t * @param {Number/Array} keystroke A keystroke or an array of keystroke definitions.\n\t\t * @param {String/Boolean} [behavior] A command to be executed on the keystroke.\n\t\t */\n\t\tsetKeystroke: function() {\n\t\t\tvar keystrokes = this.keystrokeHandler.keystrokes,\n\t\t\t\tnewKeystrokes = CKEDITOR.tools.isArray( arguments[ 0 ] ) ? arguments[ 0 ] : [ [].slice.call( arguments, 0 ) ],\n\t\t\t\tkeystroke, behavior;\n\n\t\t\tfor ( var i = newKeystrokes.length; i--; ) {\n\t\t\t\tkeystroke = newKeystrokes[ i ];\n\t\t\t\tbehavior = 0;\n\n\t\t\t\t// It may be a pair of: [ key, command ]\n\t\t\t\tif ( CKEDITOR.tools.isArray( keystroke ) ) {\n\t\t\t\t\tbehavior = keystroke[ 1 ];\n\t\t\t\t\tkeystroke = keystroke[ 0 ];\n\t\t\t\t}\n\n\t\t\t\tif ( behavior )\n\t\t\t\t\tkeystrokes[ keystroke ] = behavior;\n\t\t\t\telse\n\t\t\t\t\tdelete keystrokes[ keystroke ];\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Shorthand for {@link CKEDITOR.filter#addFeature}.\n\t\t *\n\t\t * @since 4.1\n\t\t * @param {CKEDITOR.feature} feature See {@link CKEDITOR.filter#addFeature}.\n\t\t * @returns {Boolean} See {@link CKEDITOR.filter#addFeature}.\n\t\t */\n\t\taddFeature: function( feature ) {\n\t\t\treturn this.filter.addFeature( feature );\n\t\t},\n\n\t\t/**\n\t\t * Sets the active filter ({@link #activeFilter}). Fires the {@link #activeFilterChange} event.\n\t\t *\n\t\t *\t\t// Set active filter which allows only 4 elements.\n\t\t *\t\t// Buttons like Bold, Italic will be disabled.\n\t\t *\t\tvar filter = new CKEDITOR.filter( 'p strong em br' );\n\t\t *\t\teditor.setActiveFilter( filter );\n\t\t *\n\t\t * Setting a new filter will also change the {@link #setActiveEnterMode active Enter modes} to the first values\n\t\t * allowed by the new filter (see {@link CKEDITOR.filter#getAllowedEnterMode}).\n\t\t *\n\t\t * @since 4.3\n\t\t * @param {CKEDITOR.filter} filter Filter instance or a falsy value (e.g. `null`) to reset to the default one.\n\t\t */\n\t\tsetActiveFilter: function( filter ) {\n\t\t\tif ( !filter )\n\t\t\t\tfilter = this.filter;\n\n\t\t\tif ( this.activeFilter !== filter ) {\n\t\t\t\tthis.activeFilter = filter;\n\t\t\t\tthis.fire( 'activeFilterChange' );\n\n\t\t\t\t// Reset active filter to the main one - it resets enter modes, too.\n\t\t\t\tif ( filter === this.filter )\n\t\t\t\t\tthis.setActiveEnterMode( null, null );\n\t\t\t\telse\n\t\t\t\t\tthis.setActiveEnterMode(\n\t\t\t\t\t\tfilter.getAllowedEnterMode( this.enterMode ),\n\t\t\t\t\t\tfilter.getAllowedEnterMode( this.shiftEnterMode, true )\n\t\t\t\t\t);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Sets the active Enter modes: ({@link #enterMode} and {@link #shiftEnterMode}).\n\t\t * Fires the {@link #activeEnterModeChange} event.\n\t\t *\n\t\t * Prior to CKEditor 4.3 Enter modes were static and it was enough to check {@link CKEDITOR.config#enterMode}\n\t\t * and {@link CKEDITOR.config#shiftEnterMode} when implementing a feature which should depend on the Enter modes.\n\t\t * Since CKEditor 4.3 these options are source of initial:\n\t\t *\n\t\t * * static {@link #enterMode} and {@link #shiftEnterMode} values,\n\t\t * * dynamic {@link #activeEnterMode} and {@link #activeShiftEnterMode} values.\n\t\t *\n\t\t * However, the dynamic Enter modes can be changed during runtime by using this method, to reflect the selection context.\n\t\t * For example, if selection is moved to the {@link CKEDITOR.plugins.widget widget}'s nested editable which\n\t\t * is a {@link #blockless blockless one}, then the active Enter modes should be changed to {@link CKEDITOR#ENTER_BR}\n\t\t * (in this case [Widget System](#!/guide/dev_widgets) takes care of that).\n\t\t *\n\t\t * **Note:** This method should not be used to configure the editor &ndash; use {@link CKEDITOR.config#enterMode} and\n\t\t * {@link CKEDITOR.config#shiftEnterMode} instead. This method should only be used to dynamically change\n\t\t * Enter modes during runtime based on selection changes.\n\t\t * Keep in mind that changed Enter mode may be overwritten by another plugin/feature when it decided that\n\t\t * the changed context requires this.\n\t\t *\n\t\t * **Note:** In case of blockless editor (inline editor based on an element which cannot contain block elements\n\t\t * &mdash; see {@link CKEDITOR.editor#blockless}) only {@link CKEDITOR#ENTER_BR} is a valid Enter mode. Therefore\n\t\t * this method will not allow to set other values.\n\t\t *\n\t\t * **Note:** Changing the {@link #activeFilter active filter} may cause the Enter mode to change if default Enter modes\n\t\t * are not allowed by the new filter.\n\t\t *\n\t\t * @since 4.3\n\t\t * @param {Number} enterMode One of {@link CKEDITOR#ENTER_P}, {@link CKEDITOR#ENTER_DIV}, {@link CKEDITOR#ENTER_BR}.\n\t\t * Pass falsy value (e.g. `null`) to reset the Enter mode to the default value ({@link #enterMode} and/or {@link #shiftEnterMode}).\n\t\t * @param {Number} shiftEnterMode See the `enterMode` argument.\n\t\t */\n\t\tsetActiveEnterMode: function( enterMode, shiftEnterMode ) {\n\t\t\t// Validate passed modes or use default ones (validated on init).\n\t\t\tenterMode = enterMode ? validateEnterMode( this, enterMode ) : this.enterMode;\n\t\t\tshiftEnterMode = shiftEnterMode ? validateEnterMode( this, shiftEnterMode ) : this.shiftEnterMode;\n\n\t\t\tif ( this.activeEnterMode != enterMode || this.activeShiftEnterMode != shiftEnterMode ) {\n\t\t\t\tthis.activeEnterMode = enterMode;\n\t\t\t\tthis.activeShiftEnterMode = shiftEnterMode;\n\t\t\t\tthis.fire( 'activeEnterModeChange' );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Shows a notification to the user.\n\t\t *\n\t\t * If the [Notification](http://ckeditor.com/addons/notification) plugin is not enabled, this function shows\n\t\t * a normal alert with the given `message`. The `type` and `progressOrDuration` parameters are supported\n\t\t * only by the Notification plugin.\n\t\t *\n\t\t * If the Notification plugin is enabled, this method creates and shows a new notification.\n\t\t * By default the notification is shown over the editor content, in the viewport if it is possible.\n\t\t *\n\t\t * See {@link CKEDITOR.plugins.notification}.\n\t\t *\n\t\t * @since 4.5\n\t\t * @member CKEDITOR.editor\n\t\t * @param {String} message The message displayed in the notification.\n\t\t * @param {String} [type='info'] The type of the notification. Can be `'info'`, `'warning'`, `'success'` or `'progress'`.\n\t\t * @param {Number} [progressOrDuration] If the type is `progress`, the third parameter may be a progress from `0` to `1`\n\t\t * (defaults to `0`). Otherwise the third parameter may be a notification duration denoting after how many milliseconds\n\t\t * the notification should be closed automatically. `0` means that the notification will not close automatically and the user\n\t\t * needs to close it manually. See {@link CKEDITOR.plugins.notification#duration}.\n\t\t * Note that `warning` notifications will not be closed automatically.\n\t\t * @returns {CKEDITOR.plugins.notification} Created and shown notification.\n\t\t */\n\t\tshowNotification: function( message ) {\n\t\t\talert( message ); // jshint ignore:line\n\t\t}\n\t} );\n} )();\n\n/**\n * The editor has no associated element.\n *\n * @readonly\n * @property {Number} [=0]\n * @member CKEDITOR\n */\nCKEDITOR.ELEMENT_MODE_NONE = 0;\n\n/**\n * The element is to be replaced by the editor instance.\n *\n * @readonly\n * @property {Number} [=1]\n * @member CKEDITOR\n */\nCKEDITOR.ELEMENT_MODE_REPLACE = 1;\n\n/**\n * The editor is to be created inside the element.\n *\n * @readonly\n * @property {Number} [=2]\n * @member CKEDITOR\n */\nCKEDITOR.ELEMENT_MODE_APPENDTO = 2;\n\n/**\n * The editor is to be attached to the element, using it as the editing block.\n *\n * @readonly\n * @property {Number} [=3]\n * @member CKEDITOR\n */\nCKEDITOR.ELEMENT_MODE_INLINE = 3;\n\n/**\n * Whether to escape HTML when the editor updates the original input element.\n *\n *\t\tconfig.htmlEncodeOutput = true;\n *\n * @since 3.1\n * @cfg {Boolean} [htmlEncodeOutput=false]\n * @member CKEDITOR.config\n */\n\n/**\n * If `true`, makes the editor start in read-only state. Otherwise, it will check\n * if the linked `<textarea>` element has the `disabled` attribute.\n *\n * Read more in the [documentation](#!/guide/dev_readonly)\n * and see the [SDK sample](http://sdk.ckeditor.com/samples/readonly.html).\n *\n *\t\tconfig.readOnly = true;\n *\n * @since 3.6\n * @cfg {Boolean} [readOnly=false]\n * @member CKEDITOR.config\n * @see CKEDITOR.editor#setReadOnly\n */\n\n/**\n * Whether an editable element should have focus when the editor is loading for the first time.\n *\n *\t\tconfig.startupFocus = true;\n *\n * @cfg {Boolean} [startupFocus=false]\n * @member CKEDITOR.config\n */\n\n /**\n * Customizes the {@link CKEDITOR.editor#title human-readable title} of this editor. This title is displayed in\n * tooltips and impacts various [accessibility aspects](#!/guide/dev_a11y-section-announcing-the-editor-on-the-page),\n * e.g. it is commonly used by screen readers for distinguishing editor instances and for navigation.\n * Accepted values are a string or `false`.\n *\n * **Note:** When `config.title` is set globally, the same value will be applied to all editor instances\n * loaded with this config. This may adversely affect accessibility as screen reader users will be unable\n * to distinguish particular editor instances and navigate between them.\n *\n * **Note:** Setting `config.title = false` may also impair accessibility in a similar way.\n *\n * **Note:** Please do not confuse this property with {@link CKEDITOR.editor#name}\n * which identifies the instance in the {@link CKEDITOR#instances} literal.\n *\n *\t\t// Sets the title to 'My WYSIWYG editor.'. The original title of the element (if it exists)\n *\t\t// will be restored once the editor instance is destroyed.\n *\t\tconfig.title = 'My WYSIWYG editor.';\n *\n *\t\t// Do not touch the title. If the element already has a title, it remains unchanged.\n *\t\t// Also if no `title` attribute exists, nothing new will be added.\n *\t\tconfig.title = false;\n *\n * See also:\n *\n * * CKEDITOR.editor#name\n * * CKEDITOR.editor#title\n *\n * @since 4.2\n * @cfg {String/Boolean} [title=based on editor.name]\n * @member CKEDITOR.config\n */\n\n/**\n * Sets listeners on editor events.\n *\n * **Note:** This property can only be set in the `config` object passed directly\n * to {@link CKEDITOR#replace}, {@link CKEDITOR#inline}, and other creators.\n *\n *\t\tCKEDITOR.replace( 'editor1', {\n *\t\t\ton: {\n *\t\t\t\tinstanceReady: function() {\n *\t\t\t\t\talert( this.name ); // 'editor1'\n *\t\t\t\t},\n *\n *\t\t\t\tkey: function() {\n *\t\t\t\t\t// ...\n *\t\t\t\t}\n *\t\t\t}\n *\t\t} );\n *\n * @cfg {Object} on\n * @member CKEDITOR.config\n */\n\n/**\n * The outermost element in the DOM tree in which the editable element resides. It is provided\n * by a specific editor creator after the editor UI is created and is not intended to\n * be modified.\n *\n *\t\tvar editor = CKEDITOR.instances.editor1;\n *\t\talert( editor.container.getName() ); // 'span'\n *\n * @readonly\n * @property {CKEDITOR.dom.element} container\n */\n\n/**\n * The document that stores the editor content.\n *\n * * For the classic (`iframe`-based) editor it is equal to the document inside the\n * `iframe` containing the editable element.\n * * For the inline editor it is equal to {@link CKEDITOR#document}.\n *\n * The document object is available after the {@link #contentDom} event is fired\n * and may be invalidated when the {@link #contentDomUnload} event is fired\n * (classic editor only).\n *\n *\t\teditor.on( 'contentDom', function() {\n *\t\t\tconsole.log( editor.document );\n *\t\t} );\n *\n * @readonly\n * @property {CKEDITOR.dom.document} document\n */\n\n/**\n * The window instance related to the {@link #document} property.\n *\n * It is always equal to the `editor.document.getWindow()`.\n *\n * See the {@link #document} property documentation.\n *\n * @readonly\n * @property {CKEDITOR.dom.window} window\n */\n\n/**\n * The main filter instance used for input data filtering, data\n * transformations, and activation of features.\n *\n * It points to a {@link CKEDITOR.filter} instance set up based on\n * editor configuration.\n *\n * @since 4.1\n * @readonly\n * @property {CKEDITOR.filter} filter\n */\n\n/**\n * The active filter instance which should be used in the current context (location selection).\n * This instance will be used to make a decision which commands, buttons and other\n * {@link CKEDITOR.feature features} can be enabled.\n *\n * By default it equals the {@link #filter} and it can be changed by the {@link #setActiveFilter} method.\n *\n *\t\teditor.on( 'activeFilterChange', function() {\n *\t\t\tif ( editor.activeFilter.check( 'cite' ) )\n *\t\t\t\t// Do something when <cite> was enabled - e.g. enable a button.\n *\t\t\telse\n *\t\t\t\t// Otherwise do something else.\n *\t\t} );\n *\n * See also the {@link #setActiveEnterMode} method for an explanation of dynamic settings.\n *\n * @since 4.3\n * @readonly\n * @property {CKEDITOR.filter} activeFilter\n */\n\n/**\n * The main (static) Enter mode which is a validated version of the {@link CKEDITOR.config#enterMode} setting.\n * Currently only one rule exists &mdash; {@link #blockless blockless editors} may have\n * Enter modes set only to {@link CKEDITOR#ENTER_BR}.\n *\n * @since 4.3\n * @readonly\n * @property {Number} enterMode\n */\n\n/**\n * See the {@link #enterMode} property.\n *\n * @since 4.3\n * @readonly\n * @property {Number} shiftEnterMode\n */\n\n/**\n * The dynamic Enter mode which should be used in the current context (selection location).\n * By default it equals the {@link #enterMode} and it can be changed by the {@link #setActiveEnterMode} method.\n *\n * See also the {@link #setActiveEnterMode} method for an explanation of dynamic settings.\n *\n * @since 4.3\n * @readonly\n * @property {Number} activeEnterMode\n */\n\n/**\n * See the {@link #activeEnterMode} property.\n *\n * @since 4.3\n * @readonly\n * @property {Number} activeShiftEnterMode\n */\n\n/**\n * Event fired by the {@link #setActiveFilter} method when the {@link #activeFilter} is changed.\n *\n * @since 4.3\n * @event activeFilterChange\n */\n\n/**\n * Event fired by the {@link #setActiveEnterMode} method when any of the active Enter modes is changed.\n * See also the {@link #activeEnterMode} and {@link #activeShiftEnterMode} properties.\n *\n * @since 4.3\n * @event activeEnterModeChange\n */\n\n/**\n * Event fired when a CKEDITOR instance is created, but still before initializing it.\n * To interact with a fully initialized instance, use the\n * {@link CKEDITOR#instanceReady} event instead.\n *\n * @event instanceCreated\n * @member CKEDITOR\n * @param {CKEDITOR.editor} editor The editor instance that has been created.\n */\n\n/**\n * Event fired when CKEDITOR instance's components (configuration, languages and plugins) are fully\n * loaded and initialized. However, the editor will be fully ready for interaction\n * on {@link CKEDITOR#instanceReady}.\n *\n * @event instanceLoaded\n * @member CKEDITOR\n * @param {CKEDITOR.editor} editor This editor instance that has been loaded.\n */\n\n/**\n * Event fired when a CKEDITOR instance is destroyed.\n *\n * @event instanceDestroyed\n * @member CKEDITOR\n * @param {CKEDITOR.editor} editor The editor instance that has been destroyed.\n */\n\n/**\n * Event fired when a CKEDITOR instance is created, fully initialized and ready for interaction.\n *\n * @event instanceReady\n * @member CKEDITOR\n * @param {CKEDITOR.editor} editor The editor instance that has been created.\n */\n\n/**\n * Event fired when the language is loaded into the editor instance.\n *\n * @since 3.6.1\n * @event langLoaded\n * @param {CKEDITOR.editor} editor This editor instance.\n */\n\n/**\n * Event fired when all plugins are loaded and initialized into the editor instance.\n *\n * @event pluginsLoaded\n * @param {CKEDITOR.editor} editor This editor instance.\n */\n\n/**\n * Event fired when the styles set is loaded. During the editor initialization\n * phase the {@link #getStylesSet} method returns only styles that\n * are already loaded, which may not include e.g. styles parsed\n * by the `stylesheetparser` plugin. Thus, to be notified when all\n * styles are ready, you can listen on this event.\n *\n * @since 4.1\n * @event stylesSet\n * @param {CKEDITOR.editor} editor This editor instance.\n * @param {Array} styles An array of styles definitions.\n */\n\n/**\n * Event fired before the command execution when {@link #execCommand} is called.\n *\n * @event beforeCommandExec\n * @param {CKEDITOR.editor} editor This editor instance.\n * @param data\n * @param {String} data.name The command name.\n * @param {Object} data.commandData The data to be sent to the command. This\n * can be manipulated by the event listener.\n * @param {CKEDITOR.command} data.command The command itself.\n */\n\n/**\n * Event fired after the command execution when {@link #execCommand} is called.\n *\n * @event afterCommandExec\n * @param {CKEDITOR.editor} editor This editor instance.\n * @param data\n * @param {String} data.name The command name.\n * @param {Object} data.commandData The data sent to the command.\n * @param {CKEDITOR.command} data.command The command itself.\n * @param {Object} data.returnValue The value returned by the command execution.\n */\n\n/**\n * Event fired when a custom configuration file is loaded, before the final\n * configuration initialization.\n *\n * Custom configuration files can be loaded thorugh the\n * {@link CKEDITOR.config#customConfig} setting. Several files can be loaded\n * by changing this setting.\n *\n * @event customConfigLoaded\n * @param {CKEDITOR.editor} editor This editor instance.\n */\n\n/**\n * Event fired once the editor configuration is ready (loaded and processed).\n *\n * @event configLoaded\n * @param {CKEDITOR.editor} editor This editor instance.\n */\n\n/**\n * Event fired when this editor instance is destroyed. The editor at this\n * point is not usable and this event should be used to perform the clean-up\n * in any plugin.\n *\n * @event destroy\n * @param {CKEDITOR.editor} editor This editor instance.\n */\n\n/**\n * Internal event to get the current data.\n *\n * @event beforeGetData\n * @param {CKEDITOR.editor} editor This editor instance.\n */\n\n/**\n * Internal event to perform the {@link #method-getSnapshot} call.\n *\n * @event getSnapshot\n * @param {CKEDITOR.editor} editor This editor instance.\n */\n\n/**\n * Internal event to perform the {@link #method-loadSnapshot} call.\n *\n * @event loadSnapshot\n * @param {CKEDITOR.editor} editor This editor instance.\n * @param {String} data The data that will be used.\n */\n\n/**\n * Event fired before the {@link #method-getData} call returns, allowing for additional manipulation.\n *\n * @event getData\n * @param {CKEDITOR.editor} editor This editor instance.\n * @param data\n * @param {String} data.dataValue The data that will be returned.\n */\n\n/**\n * Event fired before the {@link #method-setData} call is executed, allowing for additional manipulation.\n *\n * @event setData\n * @param {CKEDITOR.editor} editor This editor instance.\n * @param data\n * @param {String} data.dataValue The data that will be used.\n */\n\n/**\n * Event fired at the end of the {@link #method-setData} call execution. Usually it is better to use the\n * {@link #dataReady} event.\n *\n * @event afterSetData\n * @param {CKEDITOR.editor} editor This editor instance.\n * @param data\n * @param {String} data.dataValue The data that has been set.\n */\n\n/**\n * Event fired as an indicator of the editor data loading. It may be the result of\n * calling {@link #method-setData} explicitly or an internal\n * editor function, like the editor editing mode switching (move to Source and back).\n *\n * @event dataReady\n * @param {CKEDITOR.editor} editor This editor instance.\n */\n\n/**\n * Event fired when the CKEDITOR instance is completely created, fully initialized\n * and ready for interaction.\n *\n * @event instanceReady\n * @param {CKEDITOR.editor} editor This editor instance.\n */\n\n/**\n * Event fired when editor components (configuration, languages and plugins) are fully\n * loaded and initialized. However, the editor will be fully ready to for interaction\n * on {@link #instanceReady}.\n *\n * @event loaded\n * @param {CKEDITOR.editor} editor This editor instance.\n */\n\n/**\n * Event fired by the {@link #method-insertHtml} method. See the method documentation for more information\n * about how this event can be used.\n *\n * @event insertHtml\n * @param {CKEDITOR.editor} editor This editor instance.\n * @param data\n * @param {String} data.mode The mode in which the data is inserted (see {@link #method-insertHtml}).\n * @param {String} data.dataValue The HTML code to insert.\n * @param {CKEDITOR.dom.range} [data.range] See {@link #method-insertHtml}'s `range` parameter.\n */\n\n/**\n * Event fired by the {@link #method-insertText} method. See the method documentation for more information\n * about how this event can be used.\n *\n * @event insertText\n * @param {CKEDITOR.editor} editor This editor instance.\n * @param {String} data The text to insert.\n */\n\n/**\n * Event fired by the {@link #method-insertElement} method. See the method documentation for more information\n * about how this event can be used.\n *\n * @event insertElement\n * @param {CKEDITOR.editor} editor This editor instance.\n * @param {CKEDITOR.dom.element} data The element to insert.\n */\n\n/**\n * Event fired after data insertion using the {@link #method-insertHtml}, {@link CKEDITOR.editable#insertHtml},\n * or {@link CKEDITOR.editable#insertHtmlIntoRange} methods.\n *\n * @since 4.5\n * @event afterInsertHtml\n * @param data\n * @param {CKEDITOR.dom.range} [data.intoRange] If set, the HTML was not inserted into the current selection, but into\n * the specified range. This property is set if the {@link CKEDITOR.editable#insertHtmlIntoRange} method was used,\n * but not if for the {@link CKEDITOR.editable#insertHtml} method.\n */\n\n/**\n * Event fired after the {@link #property-readOnly} property changes.\n *\n * @since 3.6\n * @event readOnly\n * @param {CKEDITOR.editor} editor This editor instance.\n */\n\n/**\n * Event fired when a UI template is added to the editor instance. It makes\n * it possible to bring customizations to the template source.\n *\n * @event template\n * @param {CKEDITOR.editor} editor This editor instance.\n * @param data\n * @param {String} data.name The template name.\n * @param {String} data.source The source data for this template.\n */\n\n/**\n * Event fired when the editor content (its DOM structure) is ready.\n * It is similar to the native `DOMContentLoaded` event, but it applies to\n * the editor content. It is also the first event fired after\n * the {@link CKEDITOR.editable} is initialized.\n *\n * This event is particularly important for classic (`iframe`-based)\n * editor, because on editor initialization and every time the data are set\n * (by {@link CKEDITOR.editor#method-setData}) content DOM structure\n * is rebuilt. Thus, e.g. you need to attach DOM event listeners\n * on editable one more time.\n *\n * For inline editor this event is fired only once &mdash; when the\n * editor is initialized for the first time. This is because setting\n * editor content does not cause editable destruction and creation.\n *\n * The {@link #contentDom} event goes along with {@link #contentDomUnload}\n * which is fired before the content DOM structure is destroyed. This is the\n * right moment to detach content DOM event listener. Otherwise\n * browsers like IE or Opera may throw exceptions when accessing\n * elements from the detached document.\n *\n * **Note:** {@link CKEDITOR.editable#attachListener} is a convenient\n * way to attach listeners that will be detached on {@link #contentDomUnload}.\n *\n *\t\teditor.on( 'contentDom', function() {\n *\t\t\tvar editable = editor.editable();\n *\n *\t\t\teditable.attachListener( editable, 'click', function() {\n *\t\t\t\tconsole.log( 'The editable was clicked.' );\n *\t\t\t});\n *\t\t});\n *\n * @event contentDom\n * @param {CKEDITOR.editor} editor This editor instance.\n */\n\n/**\n * Event fired before the content DOM structure is destroyed.\n * See {@link #contentDom} documentation for more details.\n *\n * @event contentDomUnload\n * @param {CKEDITOR.editor} editor This editor instance.\n */\n\n/**\n * Event fired when the content DOM changes and some of the references as well as\n * the native DOM event listeners could be lost.\n * This event is useful when it is important to keep track of references\n * to elements in the editable content from code.\n *\n * @since 4.3\n * @event contentDomInvalidated\n * @param {CKEDITOR.editor} editor This editor instance.\n */\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/editor.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * Provides an \"event like\" system to parse strings of HTML data.\n *\n *\t\tvar parser = new CKEDITOR.htmlParser();\n *\t\tparser.onTagOpen = function( tagName, attributes, selfClosing ) {\n *\t\t\talert( tagName );\n *\t\t};\n *\t\tparser.parse( '<p>Some <b>text</b>.</p>' ); // Alerts 'p', 'b'.\n *\n * @class\n * @constructor Creates a htmlParser class instance.\n */\nCKEDITOR.htmlParser = function() {\n\tthis._ = {\n\t\thtmlPartsRegex: /<(?:(?:\\/([^>]+)>)|(?:!--([\\S|\\s]*?)-->)|(?:([^\\/\\s>]+)((?:\\s+[\\w\\-:.]+(?:\\s*=\\s*?(?:(?:\"[^\"]*\")|(?:'[^']*')|[^\\s\"'\\/>]+))?)*)[\\S\\s]*?(\\/?)>))/g\n\t};\n};\n\n( function() {\n\tvar attribsRegex = /([\\w\\-:.]+)(?:(?:\\s*=\\s*(?:(?:\"([^\"]*)\")|(?:'([^']*)')|([^\\s>]+)))|(?=\\s|$))/g,\n\t\temptyAttribs = { checked: 1, compact: 1, declare: 1, defer: 1, disabled: 1, ismap: 1, multiple: 1, nohref: 1, noresize: 1, noshade: 1, nowrap: 1, readonly: 1, selected: 1 };\n\n\tCKEDITOR.htmlParser.prototype = {\n\t\t/**\n\t\t * Function to be fired when a tag opener is found. This function\n\t\t * should be overriden when using this class.\n\t\t *\n\t\t *\t\tvar parser = new CKEDITOR.htmlParser();\n\t\t *\t\tparser.onTagOpen = function( tagName, attributes, selfClosing ) {\n\t\t *\t\t\talert( tagName ); // e.g. 'b'\n\t\t *\t\t} );\n\t\t *\t\tparser.parse( '<!-- Example --><b>Hello</b>' );\n\t\t *\n\t\t * @param {String} tagName The tag name. The name is guarantted to be lowercased.\n\t\t * @param {Object} attributes An object containing all tag attributes. Each\n\t\t * property in this object represent and attribute name and its value is the attribute value.\n\t\t * @param {Boolean} selfClosing `true` if the tag closes itself, false if the tag doesn't.\n\t\t */\n\t\tonTagOpen: function() {},\n\n\t\t/**\n\t\t * Function to be fired when a tag closer is found. This function\n\t\t * should be overriden when using this class.\n\t\t *\n\t\t *\t\tvar parser = new CKEDITOR.htmlParser();\n\t\t *\t\tparser.onTagClose = function( tagName ) {\n\t\t *\t\t\talert( tagName ); // 'b'\n\t\t *\t\t} );\n\t\t *\t\tparser.parse( '<!-- Example --><b>Hello</b>' );\n\t\t *\n\t\t * @param {String} tagName The tag name. The name is guarantted to be lowercased.\n\t\t */\n\t\tonTagClose: function() {},\n\n\t\t/**\n\t\t * Function to be fired when text is found. This function\n\t\t * should be overriden when using this class.\n\t\t *\n\t\t *\t\tvar parser = new CKEDITOR.htmlParser();\n\t\t *\t\tparser.onText = function( text ) {\n\t\t *\t\t\talert( text ); // 'Hello'\n\t\t *\t\t} );\n\t\t *\t\tparser.parse( '<!-- Example --><b>Hello</b>' );\n\t\t *\n\t\t * @param {String} text The text found.\n\t\t */\n\t\tonText: function() {},\n\n\t\t/**\n\t\t * Function to be fired when CDATA section is found. This function\n\t\t * should be overriden when using this class.\n\t\t *\n\t\t *\t\tvar parser = new CKEDITOR.htmlParser();\n\t\t *\t\tparser.onCDATA = function( cdata ) {\n\t\t *\t\t\talert( cdata ); // 'var hello;'\n\t\t *\t\t} );\n\t\t *\t\tparser.parse( '<script>var hello;</script>' );\n\t\t *\n\t\t * @param {String} cdata The CDATA been found.\n\t\t */\n\t\tonCDATA: function() {},\n\n\t\t/**\n\t\t * Function to be fired when a commend is found. This function\n\t\t * should be overriden when using this class.\n\t\t *\n\t\t *\t\tvar parser = new CKEDITOR.htmlParser();\n\t\t *\t\tparser.onComment = function( comment ) {\n\t\t *\t\t\talert( comment ); // ' Example '\n\t\t *\t\t} );\n\t\t *\t\tparser.parse( '<!-- Example --><b>Hello</b>' );\n\t\t *\n\t\t * @param {String} comment The comment text.\n\t\t */\n\t\tonComment: function() {},\n\n\t\t/**\n\t\t * Parses text, looking for HTML tokens, like tag openers or closers,\n\t\t * or comments. This function fires the onTagOpen, onTagClose, onText\n\t\t * and onComment function during its execution.\n\t\t *\n\t\t *\t\tvar parser = new CKEDITOR.htmlParser();\n\t\t *\t\t// The onTagOpen, onTagClose, onText and onComment should be overriden\n\t\t *\t\t// at this point.\n\t\t *\t\tparser.parse( '<!-- Example --><b>Hello</b>' );\n\t\t *\n\t\t * @param {String} html The HTML to be parsed.\n\t\t */\n\t\tparse: function( html ) {\n\t\t\tvar parts, tagName,\n\t\t\t\tnextIndex = 0,\n\t\t\t\tcdata; // The collected data inside a CDATA section.\n\n\t\t\twhile ( ( parts = this._.htmlPartsRegex.exec( html ) ) ) {\n\t\t\t\tvar tagIndex = parts.index;\n\t\t\t\tif ( tagIndex > nextIndex ) {\n\t\t\t\t\tvar text = html.substring( nextIndex, tagIndex );\n\n\t\t\t\t\tif ( cdata )\n\t\t\t\t\t\tcdata.push( text );\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.onText( text );\n\t\t\t\t}\n\n\t\t\t\tnextIndex = this._.htmlPartsRegex.lastIndex;\n\n\t\t\t\t// \"parts\" is an array with the following items:\n\t\t\t\t//\t\t0 : The entire match for opening/closing tags and comments.\n\t\t\t\t//\t\t  : Group filled with the tag name for closing tags.\n\t\t\t\t//\t\t2 : Group filled with the comment text.\n\t\t\t\t//\t\t3 : Group filled with the tag name for opening tags.\n\t\t\t\t//\t\t4 : Group filled with the attributes part of opening tags.\n\n\t\t\t\t// Closing tag\n\t\t\t\tif ( ( tagName = parts[ 1 ] ) ) {\n\t\t\t\t\ttagName = tagName.toLowerCase();\n\n\t\t\t\t\tif ( cdata && CKEDITOR.dtd.$cdata[ tagName ] ) {\n\t\t\t\t\t\t// Send the CDATA data.\n\t\t\t\t\t\tthis.onCDATA( cdata.join( '' ) );\n\t\t\t\t\t\tcdata = null;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( !cdata ) {\n\t\t\t\t\t\tthis.onTagClose( tagName );\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// If CDATA is enabled, just save the raw match.\n\t\t\t\tif ( cdata ) {\n\t\t\t\t\tcdata.push( parts[ 0 ] );\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Opening tag\n\t\t\t\tif ( ( tagName = parts[ 3 ] ) ) {\n\t\t\t\t\ttagName = tagName.toLowerCase();\n\n\t\t\t\t\t// There are some tag names that can break things, so let's\n\t\t\t\t\t// simply ignore them when parsing. (#5224)\n\t\t\t\t\tif ( /=\"/.test( tagName ) )\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tvar attribs = {},\n\t\t\t\t\t\tattribMatch,\n\t\t\t\t\t\tattribsPart = parts[ 4 ],\n\t\t\t\t\t\tselfClosing = !!parts[ 5 ];\n\n\t\t\t\t\tif ( attribsPart ) {\n\t\t\t\t\t\twhile ( ( attribMatch = attribsRegex.exec( attribsPart ) ) ) {\n\t\t\t\t\t\t\tvar attName = attribMatch[ 1 ].toLowerCase(),\n\t\t\t\t\t\t\t\tattValue = attribMatch[ 2 ] || attribMatch[ 3 ] || attribMatch[ 4 ] || '';\n\n\t\t\t\t\t\t\tif ( !attValue && emptyAttribs[ attName ] )\n\t\t\t\t\t\t\t\tattribs[ attName ] = attName;\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tattribs[ attName ] = CKEDITOR.tools.htmlDecodeAttr( attValue );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.onTagOpen( tagName, attribs, selfClosing );\n\n\t\t\t\t\t// Open CDATA mode when finding the appropriate tags.\n\t\t\t\t\tif ( !cdata && CKEDITOR.dtd.$cdata[ tagName ] )\n\t\t\t\t\t\tcdata = [];\n\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Comment\n\t\t\t\tif ( ( tagName = parts[ 2 ] ) )\n\t\t\t\t\tthis.onComment( tagName );\n\t\t\t}\n\n\t\t\tif ( html.length > nextIndex )\n\t\t\t\tthis.onText( html.substring( nextIndex, html.length ) );\n\t\t}\n\t};\n} )();\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/htmlparser.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * TODO\n *\n * @class\n * @todo\n */\nCKEDITOR.htmlParser.basicWriter = CKEDITOR.tools.createClass( {\n\t/**\n\t * Creates a basicWriter class instance.\n\t *\n\t * @constructor\n\t */\n\t$: function() {\n\t\tthis._ = {\n\t\t\toutput: []\n\t\t};\n\t},\n\n\tproto: {\n\t\t/**\n\t\t * Writes the tag opening part for a opener tag.\n\t\t *\n\t\t *\t\t// Writes '<p'.\n\t\t *\t\twriter.openTag( 'p', { class : 'MyClass', id : 'MyId' } );\n\t\t *\n\t\t * @param {String} tagName The element name for this tag.\n\t\t * @param {Object} attributes The attributes defined for this tag. The\n\t\t * attributes could be used to inspect the tag.\n\t\t */\n\t\topenTag: function( tagName ) {\n\t\t\tthis._.output.push( '<', tagName );\n\t\t},\n\n\t\t/**\n\t\t * Writes the tag closing part for a opener tag.\n\t\t *\n\t\t *\t\t// Writes '>'.\n\t\t *\t\twriter.openTagClose( 'p', false );\n\t\t *\n\t\t *\t\t// Writes ' />'.\n\t\t *\t\twriter.openTagClose( 'br', true );\n\t\t *\n\t\t * @param {String} tagName The element name for this tag.\n\t\t * @param {Boolean} isSelfClose Indicates that this is a self-closing tag,\n\t\t * like `<br>` or `<img>`.\n\t\t */\n\t\topenTagClose: function( tagName, isSelfClose ) {\n\t\t\tif ( isSelfClose )\n\t\t\t\tthis._.output.push( ' />' );\n\t\t\telse\n\t\t\t\tthis._.output.push( '>' );\n\t\t},\n\n\t\t/**\n\t\t * Writes an attribute. This function should be called after opening the\n\t\t * tag with {@link #openTagClose}.\n\t\t *\n\t\t *\t\t// Writes ' class=\"MyClass\"'.\n\t\t *\t\twriter.attribute( 'class', 'MyClass' );\n\t\t *\n\t\t * @param {String} attName The attribute name.\n\t\t * @param {String} attValue The attribute value.\n\t\t */\n\t\tattribute: function( attName, attValue ) {\n\t\t\t// Browsers don't always escape special character in attribute values. (#4683, #4719).\n\t\t\tif ( typeof attValue == 'string' )\n\t\t\t\tattValue = CKEDITOR.tools.htmlEncodeAttr( attValue );\n\n\t\t\tthis._.output.push( ' ', attName, '=\"', attValue, '\"' );\n\t\t},\n\n\t\t/**\n\t\t * Writes a closer tag.\n\t\t *\n\t\t *\t\t// Writes '</p>'.\n\t\t *\t\twriter.closeTag( 'p' );\n\t\t *\n\t\t * @param {String} tagName The element name for this tag.\n\t\t */\n\t\tcloseTag: function( tagName ) {\n\t\t\tthis._.output.push( '</', tagName, '>' );\n\t\t},\n\n\t\t/**\n\t\t * Writes text.\n\t\t *\n\t\t *\t\t// Writes 'Hello Word'.\n\t\t *\t\twriter.text( 'Hello Word' );\n\t\t *\n\t\t * @param {String} text The text value.\n\t\t */\n\t\ttext: function( text ) {\n\t\t\tthis._.output.push( text );\n\t\t},\n\n\t\t/**\n\t\t * Writes a comment.\n\t\t *\n\t\t *\t\t// Writes '<!-- My comment -->'.\n\t\t *\t\twriter.comment( ' My comment ' );\n\t\t *\n\t\t * @param {String} comment The comment text.\n\t\t */\n\t\tcomment: function( comment ) {\n\t\t\tthis._.output.push( '<!--', comment, '-->' );\n\t\t},\n\n\t\t/**\n\t\t * Writes any kind of data to the ouput.\n\t\t *\n\t\t *\t\twriter.write( 'This is an <b>example</b>.' );\n\t\t *\n\t\t * @param {String} data\n\t\t */\n\t\twrite: function( data ) {\n\t\t\tthis._.output.push( data );\n\t\t},\n\n\t\t/**\n\t\t * Empties the current output buffer.\n\t\t *\n\t\t *\t\twriter.reset();\n\t\t */\n\t\treset: function() {\n\t\t\tthis._.output = [];\n\t\t\tthis._.indent = false;\n\t\t},\n\n\t\t/**\n\t\t * Empties the current output buffer.\n\t\t *\n\t\t *\t\tvar html = writer.getHtml();\n\t\t *\n\t\t * @param {Boolean} reset Indicates that the {@link #reset} method is to\n\t\t * be automatically called after retrieving the HTML.\n\t\t * @returns {String} The HTML written to the writer so far.\n\t\t */\n\t\tgetHtml: function( reset ) {\n\t\t\tvar html = this._.output.join( '' );\n\n\t\t\tif ( reset )\n\t\t\t\tthis.reset();\n\n\t\t\treturn html;\n\t\t}\n\t}\n} );\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/htmlparser/basicwriter.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n'use strict';\n\n( function() {\n\t/**\n\t * A lightweight representation of HTML node.\n\t *\n\t * @since 4.1\n\t * @class\n\t * @constructor Creates a node class instance.\n\t */\n\tCKEDITOR.htmlParser.node = function() {};\n\n\tCKEDITOR.htmlParser.node.prototype = {\n\t\t/**\n\t\t * Remove this node from a tree.\n\t\t *\n\t\t * @since 4.1\n\t\t */\n\t\tremove: function() {\n\t\t\tvar children = this.parent.children,\n\t\t\t\tindex = CKEDITOR.tools.indexOf( children, this ),\n\t\t\t\tprevious = this.previous,\n\t\t\t\tnext = this.next;\n\n\t\t\tprevious && ( previous.next = next );\n\t\t\tnext && ( next.previous = previous );\n\t\t\tchildren.splice( index, 1 );\n\t\t\tthis.parent = null;\n\t\t},\n\n\t\t/**\n\t\t * Replace this node with given one.\n\t\t *\n\t\t * @since 4.1\n\t\t * @param {CKEDITOR.htmlParser.node} node The node that will replace this one.\n\t\t */\n\t\treplaceWith: function( node ) {\n\t\t\tvar children = this.parent.children,\n\t\t\t\tindex = CKEDITOR.tools.indexOf( children, this ),\n\t\t\t\tprevious = node.previous = this.previous,\n\t\t\t\tnext = node.next = this.next;\n\n\t\t\tprevious && ( previous.next = node );\n\t\t\tnext && ( next.previous = node );\n\n\t\t\tchildren[ index ] = node;\n\n\t\t\tnode.parent = this.parent;\n\t\t\tthis.parent = null;\n\t\t},\n\n\t\t/**\n\t\t * Insert this node after given one.\n\t\t *\n\t\t * @since 4.1\n\t\t * @param {CKEDITOR.htmlParser.node} node The node that will precede this element.\n\t\t */\n\t\tinsertAfter: function( node ) {\n\t\t\tvar children = node.parent.children,\n\t\t\t\tindex = CKEDITOR.tools.indexOf( children, node ),\n\t\t\t\tnext = node.next;\n\n\t\t\tchildren.splice( index + 1, 0, this );\n\n\t\t\tthis.next = node.next;\n\t\t\tthis.previous = node;\n\t\t\tnode.next = this;\n\t\t\tnext && ( next.previous = this );\n\n\t\t\tthis.parent = node.parent;\n\t\t},\n\n\t\t/**\n\t\t * Insert this node before given one.\n\t\t *\n\t\t * @since 4.1\n\t\t * @param {CKEDITOR.htmlParser.node} node The node that will follow this element.\n\t\t */\n\t\tinsertBefore: function( node ) {\n\t\t\tvar children = node.parent.children,\n\t\t\t\tindex = CKEDITOR.tools.indexOf( children, node );\n\n\t\t\tchildren.splice( index, 0, this );\n\n\t\t\tthis.next = node;\n\t\t\tthis.previous = node.previous;\n\t\t\tnode.previous && ( node.previous.next = this );\n\t\t\tnode.previous = this;\n\n\t\t\tthis.parent = node.parent;\n\t\t},\n\n\t\t/**\n\t\t * Gets the closest ancestor element of this element which satisfies given condition\n\t\t *\n\t\t * @since 4.3\n\t\t * @param {String/Object/Function} condition Name of an ancestor, hash of names or validator function.\n\t\t * @returns {CKEDITOR.htmlParser.element} The closest ancestor which satisfies given condition or `null`.\n\t\t */\n\t\tgetAscendant: function( condition ) {\n\t\t\tvar checkFn =\n\t\t\t\ttypeof condition == 'function' ?\n\t\t\t\t\tcondition :\n\t\t\t\ttypeof condition == 'string' ?\n\t\t\t\t\tfunction( el ) {\n\t\t\t\t\t\treturn el.name == condition;\n\t\t\t\t\t} :\n\t\t\t\t\tfunction( el ) {\n\t\t\t\t\t\treturn el.name in condition;\n\t\t\t\t\t};\n\n\t\t\tvar parent = this.parent;\n\n\t\t\t// Parent has to be an element - don't check doc fragment.\n\t\t\twhile ( parent && parent.type == CKEDITOR.NODE_ELEMENT ) {\n\t\t\t\tif ( checkFn( parent ) )\n\t\t\t\t\treturn parent;\n\t\t\t\tparent = parent.parent;\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\n\t\t/**\n\t\t * Wraps this element with given `wrapper`.\n\t\t *\n\t\t * @since 4.3\n\t\t * @param {CKEDITOR.htmlParser.element} wrapper The element which will be this element's new parent.\n\t\t * @returns {CKEDITOR.htmlParser.element} Wrapper.\n\t\t */\n\t\twrapWith: function( wrapper ) {\n\t\t\tthis.replaceWith( wrapper );\n\t\t\twrapper.add( this );\n\t\t\treturn wrapper;\n\t\t},\n\n\t\t/**\n\t\t * Gets this node's index in its parent's children array.\n\t\t *\n\t\t * @since 4.3\n\t\t * @returns {Number}\n\t\t */\n\t\tgetIndex: function() {\n\t\t\treturn CKEDITOR.tools.indexOf( this.parent.children, this );\n\t\t},\n\n\t\tgetFilterContext: function( context ) {\n\t\t\treturn context || {};\n\t\t}\n\t};\n} )();\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/htmlparser/node.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n 'use strict';\n\n/**\n * A lightweight representation of an HTML comment.\n *\n * @class\n * @extends CKEDITOR.htmlParser.node\n * @constructor Creates a comment class instance.\n * @param {String} value The comment text value.\n */\nCKEDITOR.htmlParser.comment = function( value ) {\n\t/**\n\t * The comment text.\n\t *\n\t * @property {String}\n\t */\n\tthis.value = value;\n\n\t/** @private */\n\tthis._ = {\n\t\tisBlockLike: false\n\t};\n};\n\nCKEDITOR.htmlParser.comment.prototype = CKEDITOR.tools.extend( new CKEDITOR.htmlParser.node(), {\n\t/**\n\t * The node type. This is a constant value set to {@link CKEDITOR#NODE_COMMENT}.\n\t *\n\t * @readonly\n\t * @property {Number} [=CKEDITOR.NODE_COMMENT]\n\t */\n\ttype: CKEDITOR.NODE_COMMENT,\n\n\t/**\n\t * Filter this comment with given filter.\n\t *\n\t * @since 4.1\n\t * @param {CKEDITOR.htmlParser.filter} filter\n\t * @returns {Boolean} Method returns `false` when this comment has\n\t * been removed or replaced with other node. This is an information for\n\t * {@link CKEDITOR.htmlParser.element#filterChildren} that it has\n\t * to repeat filter on current position in parent's children array.\n\t */\n\tfilter: function( filter, context ) {\n\t\tvar comment = this.value;\n\n\t\tif ( !( comment = filter.onComment( context, comment, this ) ) ) {\n\t\t\tthis.remove();\n\t\t\treturn false;\n\t\t}\n\n\t\tif ( typeof comment != 'string' ) {\n\t\t\tthis.replaceWith( comment );\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.value = comment;\n\n\t\treturn true;\n\t},\n\n\t/**\n\t * Writes the HTML representation of this comment to a CKEDITOR.htmlWriter.\n\t *\n\t * @param {CKEDITOR.htmlParser.basicWriter} writer The writer to which write the HTML.\n\t * @param {CKEDITOR.htmlParser.filter} [filter] The filter to be applied to this node.\n\t * **Note:** it's unsafe to filter offline (not appended) node.\n\t */\n\twriteHtml: function( writer, filter ) {\n\t\tif ( filter )\n\t\t\tthis.filter( filter );\n\n\t\twriter.comment( this.value );\n\t}\n} );\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/htmlparser/comment.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n 'use strict';\n\n( function() {\n\t/**\n\t * A lightweight representation of HTML text.\n\t *\n\t * @class\n\t * @extends CKEDITOR.htmlParser.node\n\t * @constructor Creates a text class instance.\n\t * @param {String} value The text node value.\n\t */\n\tCKEDITOR.htmlParser.text = function( value ) {\n\t\t/**\n\t\t * The text value.\n\t\t *\n\t\t * @property {String}\n\t\t */\n\t\tthis.value = value;\n\n\t\t/** @private */\n\t\tthis._ = {\n\t\t\tisBlockLike: false\n\t\t};\n\t};\n\n\tCKEDITOR.htmlParser.text.prototype = CKEDITOR.tools.extend( new CKEDITOR.htmlParser.node(), {\n\t\t/**\n\t\t * The node type. This is a constant value set to {@link CKEDITOR#NODE_TEXT}.\n\t\t *\n\t\t * @readonly\n\t\t * @property {Number} [=CKEDITOR.NODE_TEXT]\n\t\t */\n\t\ttype: CKEDITOR.NODE_TEXT,\n\n\t\t/**\n\t\t * Filter this text node with given filter.\n\t\t *\n\t\t * @since 4.1\n\t\t * @param {CKEDITOR.htmlParser.filter} filter\n\t\t * @returns {Boolean} Method returns `false` when this text node has\n\t\t * been removed. This is an information for {@link CKEDITOR.htmlParser.element#filterChildren}\n\t\t * that it has to repeat filter on current position in parent's children array.\n\t\t */\n\t\tfilter: function( filter, context ) {\n\t\t\tif ( !( this.value = filter.onText( context, this.value, this ) ) ) {\n\t\t\t\tthis.remove();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Writes the HTML representation of this text to a {CKEDITOR.htmlParser.basicWriter}.\n\t\t *\n\t\t * @param {CKEDITOR.htmlParser.basicWriter} writer The writer to which write the HTML.\n\t\t * @param {CKEDITOR.htmlParser.filter} [filter] The filter to be applied to this node.\n\t\t * **Note:** it's unsafe to filter offline (not appended) node.\n\t\t */\n\t\twriteHtml: function( writer, filter ) {\n\t\t\tif ( filter )\n\t\t\t\tthis.filter( filter );\n\n\t\t\twriter.text( this.value );\n\t\t}\n\t} );\n} )();\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/htmlparser/text.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n 'use strict';\n\n( function() {\n\n\t/**\n\t * A lightweight representation of HTML CDATA.\n\t *\n\t * @class\n\t * @extends CKEDITOR.htmlParser.node\n\t * @constructor Creates a cdata class instance.\n\t * @param {String} value The CDATA section value.\n\t */\n\tCKEDITOR.htmlParser.cdata = function( value ) {\n\t\t/**\n\t\t * The CDATA value.\n\t\t *\n\t\t * @property {String}\n\t\t */\n\t\tthis.value = value;\n\t};\n\n\tCKEDITOR.htmlParser.cdata.prototype = CKEDITOR.tools.extend( new CKEDITOR.htmlParser.node(), {\n\t\t/**\n\t\t * CDATA has the same type as {@link CKEDITOR.htmlParser.text} This is\n\t\t * a constant value set to {@link CKEDITOR#NODE_TEXT}.\n\t\t *\n\t\t * @readonly\n\t\t * @property {Number} [=CKEDITOR.NODE_TEXT]\n\t\t */\n\t\ttype: CKEDITOR.NODE_TEXT,\n\n\t\tfilter: function() {},\n\n\t\t/**\n\t\t * Writes the CDATA with no special manipulations.\n\t\t *\n\t\t * @param {CKEDITOR.htmlParser.basicWriter} writer The writer to which write the HTML.\n\t\t */\n\t\twriteHtml: function( writer ) {\n\t\t\twriter.write( this.value );\n\t\t}\n\t} );\n} )();\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/htmlparser/cdata.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n'use strict';\n\n/**\n * A lightweight representation of an HTML DOM structure.\n *\n * @class\n * @constructor Creates a fragment class instance.\n */\nCKEDITOR.htmlParser.fragment = function() {\n\t/**\n\t * The nodes contained in the root of this fragment.\n\t *\n\t *\t\tvar fragment = CKEDITOR.htmlParser.fragment.fromHtml( '<b>Sample</b> Text' );\n\t *\t\talert( fragment.children.length ); // 2\n\t */\n\tthis.children = [];\n\n\t/**\n\t * Get the fragment parent. Should always be null.\n\t *\n\t * @property {Object} [=null]\n\t */\n\tthis.parent = null;\n\n\t/** @private */\n\tthis._ = {\n\t\tisBlockLike: true,\n\t\thasInlineStarted: false\n\t};\n};\n\n( function() {\n\t// Block-level elements whose internal structure should be respected during\n\t// parser fixing.\n\tvar nonBreakingBlocks = CKEDITOR.tools.extend( { table: 1, ul: 1, ol: 1, dl: 1 }, CKEDITOR.dtd.table, CKEDITOR.dtd.ul, CKEDITOR.dtd.ol, CKEDITOR.dtd.dl );\n\n\tvar listBlocks = { ol: 1, ul: 1 };\n\n\t// Dtd of the fragment element, basically it accept anything except for intermediate structure, e.g. orphan <li>.\n\tvar rootDtd = CKEDITOR.tools.extend( {}, { html: 1 }, CKEDITOR.dtd.html, CKEDITOR.dtd.body, CKEDITOR.dtd.head, { style: 1, script: 1 } );\n\n\t// Which element to create when encountered not allowed content.\n\tvar structureFixes = {\n\t\tul: 'li',\n\t\tol: 'li',\n\t\tdl: 'dd',\n\t\ttable: 'tbody',\n\t\ttbody: 'tr',\n\t\tthead: 'tr',\n\t\ttfoot: 'tr',\n\t\ttr: 'td'\n\t};\n\n\tfunction isRemoveEmpty( node ) {\n\t\t// Keep marked element event if it is empty.\n\t\tif ( node.attributes[ 'data-cke-survive' ] )\n\t\t\treturn false;\n\n\t\t// Empty link is to be removed when empty but not anchor. (#7894)\n\t\treturn node.name == 'a' && node.attributes.href || CKEDITOR.dtd.$removeEmpty[ node.name ];\n\t}\n\n\t/**\n\t * Creates a {@link CKEDITOR.htmlParser.fragment} from an HTML string.\n\t *\n\t *\t\tvar fragment = CKEDITOR.htmlParser.fragment.fromHtml( '<b>Sample</b> Text' );\n\t *\t\talert( fragment.children[ 0 ].name );\t\t// 'b'\n\t *\t\talert( fragment.children[ 1 ].value );\t// ' Text'\n\t *\n\t * @static\n\t * @param {String} fragmentHtml The HTML to be parsed, filling the fragment.\n\t * @param {CKEDITOR.htmlParser.element/String} [parent] Optional contextual\n\t * element which makes the content been parsed as the content of this element and fix\n\t * to match it.\n\t * If not provided, then {@link CKEDITOR.htmlParser.fragment} will be used\n\t * as the parent and it will be returned.\n\t * @param {String/Boolean} [fixingBlock] When `parent` is a block limit element,\n\t * and the param is a string value other than `false`, it is to\n\t * avoid having block-less content as the direct children of parent by wrapping\n\t * the content with a block element of the specified tag, e.g.\n\t * when `fixingBlock` specified as `p`, the content `<body><i>foo</i></body>`\n\t * will be fixed into `<body><p><i>foo</i></p></body>`.\n\t * @returns {CKEDITOR.htmlParser.fragment/CKEDITOR.htmlParser.element} The created fragment or passed `parent`.\n\t */\n\tCKEDITOR.htmlParser.fragment.fromHtml = function( fragmentHtml, parent, fixingBlock ) {\n\t\tvar parser = new CKEDITOR.htmlParser();\n\n\t\tvar root = parent instanceof CKEDITOR.htmlParser.element ? parent : typeof parent == 'string' ? new CKEDITOR.htmlParser.element( parent ) : new CKEDITOR.htmlParser.fragment();\n\n\t\tvar pendingInline = [],\n\t\t\tpendingBRs = [],\n\t\t\tcurrentNode = root,\n\t\t\t// Indicate we're inside a <textarea> element, spaces should be touched differently.\n\t\t\tinTextarea = root.name == 'textarea',\n\t\t\t// Indicate we're inside a <pre> element, spaces should be touched differently.\n\t\t\tinPre = root.name == 'pre';\n\n\t\tfunction checkPending( newTagName ) {\n\t\t\tvar pendingBRsSent;\n\n\t\t\tif ( pendingInline.length > 0 ) {\n\t\t\t\tfor ( var i = 0; i < pendingInline.length; i++ ) {\n\t\t\t\t\tvar pendingElement = pendingInline[ i ],\n\t\t\t\t\t\tpendingName = pendingElement.name,\n\t\t\t\t\t\tpendingDtd = CKEDITOR.dtd[ pendingName ],\n\t\t\t\t\t\tcurrentDtd = currentNode.name && CKEDITOR.dtd[ currentNode.name ];\n\n\t\t\t\t\tif ( ( !currentDtd || currentDtd[ pendingName ] ) && ( !newTagName || !pendingDtd || pendingDtd[ newTagName ] || !CKEDITOR.dtd[ newTagName ] ) ) {\n\t\t\t\t\t\tif ( !pendingBRsSent ) {\n\t\t\t\t\t\t\tsendPendingBRs();\n\t\t\t\t\t\t\tpendingBRsSent = 1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Get a clone for the pending element.\n\t\t\t\t\t\tpendingElement = pendingElement.clone();\n\n\t\t\t\t\t\t// Add it to the current node and make it the current,\n\t\t\t\t\t\t// so the new element will be added inside of it.\n\t\t\t\t\t\tpendingElement.parent = currentNode;\n\t\t\t\t\t\tcurrentNode = pendingElement;\n\n\t\t\t\t\t\t// Remove the pending element (back the index by one\n\t\t\t\t\t\t// to properly process the next entry).\n\t\t\t\t\t\tpendingInline.splice( i, 1 );\n\t\t\t\t\t\ti--;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Some element of the same type cannot be nested, flat them,\n\t\t\t\t\t\t// e.g. <a href=\"#\">foo<a href=\"#\">bar</a></a>. (#7894)\n\t\t\t\t\t\tif ( pendingName == currentNode.name )\n\t\t\t\t\t\t\taddElement( currentNode, currentNode.parent, 1 ), i--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction sendPendingBRs() {\n\t\t\twhile ( pendingBRs.length )\n\t\t\t\taddElement( pendingBRs.shift(), currentNode );\n\t\t}\n\n\t\t// Rtrim empty spaces on block end boundary. (#3585)\n\t\tfunction removeTailWhitespace( element ) {\n\t\t\tif ( element._.isBlockLike && element.name != 'pre' && element.name != 'textarea' ) {\n\n\t\t\t\tvar length = element.children.length,\n\t\t\t\t\tlastChild = element.children[ length - 1 ],\n\t\t\t\t\ttext;\n\t\t\t\tif ( lastChild && lastChild.type == CKEDITOR.NODE_TEXT ) {\n\t\t\t\t\tif ( !( text = CKEDITOR.tools.rtrim( lastChild.value ) ) )\n\t\t\t\t\t\telement.children.length = length - 1;\n\t\t\t\t\telse\n\t\t\t\t\t\tlastChild.value = text;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Beside of simply append specified element to target, this function also takes\n\t\t// care of other dirty lifts like forcing block in body, trimming spaces at\n\t\t// the block boundaries etc.\n\t\t//\n\t\t// @param {Element} element  The element to be added as the last child of {@link target}.\n\t\t// @param {Element} target The parent element to relieve the new node.\n\t\t// @param {Boolean} [moveCurrent=false] Don't change the \"currentNode\" global unless\n\t\t// there's a return point node specified on the element, otherwise move current onto {@link target} node.\n\t\t//\n\t\tfunction addElement( element, target, moveCurrent ) {\n\t\t\ttarget = target || currentNode || root;\n\n\t\t\t// Current element might be mangled by fix body below,\n\t\t\t// save it for restore later.\n\t\t\tvar savedCurrent = currentNode;\n\n\t\t\t// Ignore any element that has already been added.\n\t\t\tif ( element.previous === undefined ) {\n\t\t\t\tif ( checkAutoParagraphing( target, element ) ) {\n\t\t\t\t\t// Create a <p> in the fragment.\n\t\t\t\t\tcurrentNode = target;\n\t\t\t\t\tparser.onTagOpen( fixingBlock, {} );\n\n\t\t\t\t\t// The new target now is the <p>.\n\t\t\t\t\telement.returnPoint = target = currentNode;\n\t\t\t\t}\n\n\t\t\t\tremoveTailWhitespace( element );\n\n\t\t\t\t// Avoid adding empty inline.\n\t\t\t\tif ( !( isRemoveEmpty( element ) && !element.children.length ) )\n\t\t\t\t\ttarget.add( element );\n\n\t\t\t\tif ( element.name == 'pre' )\n\t\t\t\t\tinPre = false;\n\n\t\t\t\tif ( element.name == 'textarea' )\n\t\t\t\t\tinTextarea = false;\n\t\t\t}\n\n\t\t\tif ( element.returnPoint ) {\n\t\t\t\tcurrentNode = element.returnPoint;\n\t\t\t\tdelete element.returnPoint;\n\t\t\t} else {\n\t\t\t\tcurrentNode = moveCurrent ? target : savedCurrent;\n\t\t\t}\n\t\t}\n\n\t\t// Auto paragraphing should happen when inline content enters the root element.\n\t\tfunction checkAutoParagraphing( parent, node ) {\n\n\t\t\t// Check for parent that can contain block.\n\t\t\tif ( ( parent == root || parent.name == 'body' ) && fixingBlock &&\n\t\t\t\t\t( !parent.name || CKEDITOR.dtd[ parent.name ][ fixingBlock ] ) ) {\n\t\t\t\tvar name, realName;\n\n\t\t\t\tif ( node.attributes && ( realName = node.attributes[ 'data-cke-real-element-type' ] ) )\n\t\t\t\t\tname = realName;\n\t\t\t\telse\n\t\t\t\t\tname = node.name;\n\n\t\t\t\t// Text node, inline elements are subjected, except for <script>/<style>.\n\t\t\t\treturn name && name in CKEDITOR.dtd.$inline &&\n\t\t\t\t\t!( name in CKEDITOR.dtd.head ) &&\n\t\t\t\t\t!node.isOrphan ||\n\t\t\t\t\tnode.type == CKEDITOR.NODE_TEXT;\n\t\t\t}\n\t\t}\n\n\t\t// Judge whether two element tag names are likely the siblings from the same\n\t\t// structural element.\n\t\tfunction possiblySibling( tag1, tag2 ) {\n\n\t\t\tif ( tag1 in CKEDITOR.dtd.$listItem || tag1 in CKEDITOR.dtd.$tableContent )\n\t\t\t\treturn tag1 == tag2 || tag1 == 'dt' && tag2 == 'dd' || tag1 == 'dd' && tag2 == 'dt';\n\n\t\t\treturn false;\n\t\t}\n\n\t\tparser.onTagOpen = function( tagName, attributes, selfClosing, optionalClose ) {\n\t\t\tvar element = new CKEDITOR.htmlParser.element( tagName, attributes );\n\n\t\t\t// \"isEmpty\" will be always \"false\" for unknown elements, so we\n\t\t\t// must force it if the parser has identified it as a selfClosing tag.\n\t\t\tif ( element.isUnknown && selfClosing )\n\t\t\t\telement.isEmpty = true;\n\n\t\t\t// Check for optional closed elements, including browser quirks and manually opened blocks.\n\t\t\telement.isOptionalClose = optionalClose;\n\n\t\t\t// This is a tag to be removed if empty, so do not add it immediately.\n\t\t\tif ( isRemoveEmpty( element ) ) {\n\t\t\t\tpendingInline.push( element );\n\t\t\t\treturn;\n\t\t\t} else if ( tagName == 'pre' )\n\t\t\t\tinPre = true;\n\t\t\telse if ( tagName == 'br' && inPre ) {\n\t\t\t\tcurrentNode.add( new CKEDITOR.htmlParser.text( '\\n' ) );\n\t\t\t\treturn;\n\t\t\t} else if ( tagName == 'textarea' ) {\n\t\t\t\tinTextarea = true;\n\t\t\t}\n\n\t\t\tif ( tagName == 'br' ) {\n\t\t\t\tpendingBRs.push( element );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\twhile ( 1 ) {\n\t\t\t\tvar currentName = currentNode.name;\n\n\t\t\t\tvar currentDtd = currentName ? ( CKEDITOR.dtd[ currentName ] || ( currentNode._.isBlockLike ? CKEDITOR.dtd.div : CKEDITOR.dtd.span ) ) : rootDtd;\n\n\t\t\t\t// If the element cannot be child of the current element.\n\t\t\t\tif ( !element.isUnknown && !currentNode.isUnknown && !currentDtd[ tagName ] ) {\n\t\t\t\t\t// Current node doesn't have a close tag, time for a close\n\t\t\t\t\t// as this element isn't fit in. (#7497)\n\t\t\t\t\tif ( currentNode.isOptionalClose )\n\t\t\t\t\t\tparser.onTagClose( currentName );\n\t\t\t\t\t// Fixing malformed nested lists by moving it into a previous list item. (#3828)\n\t\t\t\t\telse if ( tagName in listBlocks && currentName in listBlocks ) {\n\t\t\t\t\t\tvar children = currentNode.children,\n\t\t\t\t\t\t\tlastChild = children[ children.length - 1 ];\n\n\t\t\t\t\t\t// Establish the list item if it's not existed.\n\t\t\t\t\t\tif ( !( lastChild && lastChild.name == 'li' ) )\n\t\t\t\t\t\t\taddElement( ( lastChild = new CKEDITOR.htmlParser.element( 'li' ) ), currentNode );\n\n\t\t\t\t\t\t!element.returnPoint && ( element.returnPoint = currentNode );\n\t\t\t\t\t\tcurrentNode = lastChild;\n\t\t\t\t\t}\n\t\t\t\t\t// Establish new list root for orphan list items, but NOT to create\n\t\t\t\t\t// new list for the following ones, fix them instead. (#6975)\n\t\t\t\t\t// <dl><dt>foo<dd>bar</dl>\n\t\t\t\t\t// <ul><li>foo<li>bar</ul>\n\t\t\t\t\telse if ( tagName in CKEDITOR.dtd.$listItem &&\n\t\t\t\t\t\t\t!possiblySibling( tagName, currentName ) ) {\n\t\t\t\t\t\tparser.onTagOpen( tagName == 'li' ? 'ul' : 'dl', {}, 0, 1 );\n\t\t\t\t\t}\n\t\t\t\t\t// We're inside a structural block like table and list, AND the incoming element\n\t\t\t\t\t// is not of the same type (e.g. <td>td1<td>td2</td>), we simply add this new one before it,\n\t\t\t\t\t// and most importantly, return back to here once this element is added,\n\t\t\t\t\t// e.g. <table><tr><td>td1</td><p>p1</p><td>td2</td></tr></table>\n\t\t\t\t\telse if ( currentName in nonBreakingBlocks &&\n\t\t\t\t\t\t\t!possiblySibling( tagName, currentName ) ) {\n\t\t\t\t\t\t!element.returnPoint && ( element.returnPoint = currentNode );\n\t\t\t\t\t\tcurrentNode = currentNode.parent;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// The current element is an inline element, which\n\t\t\t\t\t\t// need to be continued even after the close, so put\n\t\t\t\t\t\t// it in the pending list.\n\t\t\t\t\t\tif ( currentName in CKEDITOR.dtd.$inline )\n\t\t\t\t\t\t\tpendingInline.unshift( currentNode );\n\n\t\t\t\t\t\t// The most common case where we just need to close the\n\t\t\t\t\t\t// current one and append the new one to the parent.\n\t\t\t\t\t\tif ( currentNode.parent )\n\t\t\t\t\t\t\taddElement( currentNode, currentNode.parent, 1 );\n\t\t\t\t\t\t// We've tried our best to fix the embarrassment here, while\n\t\t\t\t\t\t// this element still doesn't find it's parent, mark it as\n\t\t\t\t\t\t// orphan and show our tolerance to it.\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\telement.isOrphan = 1;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcheckPending( tagName );\n\t\t\tsendPendingBRs();\n\n\t\t\telement.parent = currentNode;\n\n\t\t\tif ( element.isEmpty )\n\t\t\t\taddElement( element );\n\t\t\telse\n\t\t\t\tcurrentNode = element;\n\t\t};\n\n\t\tparser.onTagClose = function( tagName ) {\n\t\t\t// Check if there is any pending tag to be closed.\n\t\t\tfor ( var i = pendingInline.length - 1; i >= 0; i-- ) {\n\t\t\t\t// If found, just remove it from the list.\n\t\t\t\tif ( tagName == pendingInline[ i ].name ) {\n\t\t\t\t\tpendingInline.splice( i, 1 );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar pendingAdd = [],\n\t\t\t\tnewPendingInline = [],\n\t\t\t\tcandidate = currentNode;\n\n\t\t\twhile ( candidate != root && candidate.name != tagName ) {\n\t\t\t\t// If this is an inline element, add it to the pending list, if we're\n\t\t\t\t// really closing one of the parents element later, they will continue\n\t\t\t\t// after it.\n\t\t\t\tif ( !candidate._.isBlockLike )\n\t\t\t\t\tnewPendingInline.unshift( candidate );\n\n\t\t\t\t// This node should be added to it's parent at this point. But,\n\t\t\t\t// it should happen only if the closing tag is really closing\n\t\t\t\t// one of the nodes. So, for now, we just cache it.\n\t\t\t\tpendingAdd.push( candidate );\n\n\t\t\t\t// Make sure return point is properly restored.\n\t\t\t\tcandidate = candidate.returnPoint || candidate.parent;\n\t\t\t}\n\n\t\t\tif ( candidate != root ) {\n\t\t\t\t// Add all elements that have been found in the above loop.\n\t\t\t\tfor ( i = 0; i < pendingAdd.length; i++ ) {\n\t\t\t\t\tvar node = pendingAdd[ i ];\n\t\t\t\t\taddElement( node, node.parent );\n\t\t\t\t}\n\n\t\t\t\tcurrentNode = candidate;\n\n\t\t\t\tif ( candidate._.isBlockLike )\n\t\t\t\t\tsendPendingBRs();\n\n\t\t\t\taddElement( candidate, candidate.parent );\n\n\t\t\t\t// The parent should start receiving new nodes now, except if\n\t\t\t\t// addElement changed the currentNode.\n\t\t\t\tif ( candidate == currentNode )\n\t\t\t\t\tcurrentNode = currentNode.parent;\n\n\t\t\t\tpendingInline = pendingInline.concat( newPendingInline );\n\t\t\t}\n\n\t\t\tif ( tagName == 'body' )\n\t\t\t\tfixingBlock = false;\n\t\t};\n\n\t\tparser.onText = function( text ) {\n\t\t\t// Trim empty spaces at beginning of text contents except <pre> and <textarea>.\n\t\t\tif ( ( !currentNode._.hasInlineStarted || pendingBRs.length ) && !inPre && !inTextarea ) {\n\t\t\t\ttext = CKEDITOR.tools.ltrim( text );\n\n\t\t\t\tif ( text.length === 0 )\n\t\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar currentName = currentNode.name,\n\t\t\t\tcurrentDtd = currentName ? ( CKEDITOR.dtd[ currentName ] || ( currentNode._.isBlockLike ? CKEDITOR.dtd.div : CKEDITOR.dtd.span ) ) : rootDtd;\n\n\t\t\t// Fix orphan text in list/table. (#8540) (#8870)\n\t\t\tif ( !inTextarea && !currentDtd[ '#' ] && currentName in nonBreakingBlocks ) {\n\t\t\t\tparser.onTagOpen( structureFixes[ currentName ] || '' );\n\t\t\t\tparser.onText( text );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsendPendingBRs();\n\t\t\tcheckPending();\n\n\t\t\t// Shrinking consequential spaces into one single for all elements\n\t\t\t// text contents.\n\t\t\tif ( !inPre && !inTextarea )\n\t\t\t\ttext = text.replace( /[\\t\\r\\n ]{2,}|[\\t\\r\\n]/g, ' ' );\n\n\t\t\ttext = new CKEDITOR.htmlParser.text( text );\n\n\n\t\t\tif ( checkAutoParagraphing( currentNode, text ) )\n\t\t\t\tthis.onTagOpen( fixingBlock, {}, 0, 1 );\n\n\t\t\tcurrentNode.add( text );\n\t\t};\n\n\t\tparser.onCDATA = function( cdata ) {\n\t\t\tcurrentNode.add( new CKEDITOR.htmlParser.cdata( cdata ) );\n\t\t};\n\n\t\tparser.onComment = function( comment ) {\n\t\t\tsendPendingBRs();\n\t\t\tcheckPending();\n\t\t\tcurrentNode.add( new CKEDITOR.htmlParser.comment( comment ) );\n\t\t};\n\n\t\t// Parse it.\n\t\tparser.parse( fragmentHtml );\n\n\t\tsendPendingBRs();\n\n\t\t// Close all pending nodes, make sure return point is properly restored.\n\t\twhile ( currentNode != root )\n\t\t\taddElement( currentNode, currentNode.parent, 1 );\n\n\t\tremoveTailWhitespace( root );\n\n\t\treturn root;\n\t};\n\n\tCKEDITOR.htmlParser.fragment.prototype = {\n\n\t\t/**\n\t\t * The node type. This is a constant value set to {@link CKEDITOR#NODE_DOCUMENT_FRAGMENT}.\n\t\t *\n\t\t * @readonly\n\t\t * @property {Number} [=CKEDITOR.NODE_DOCUMENT_FRAGMENT]\n\t\t */\n\t\ttype: CKEDITOR.NODE_DOCUMENT_FRAGMENT,\n\n\t\t/**\n\t\t * Adds a node to this fragment.\n\t\t *\n\t\t * @param {CKEDITOR.htmlParser.node} node The node to be added.\n\t\t * @param {Number} [index] From where the insertion happens.\n\t\t */\n\t\tadd: function( node, index ) {\n\t\t\tisNaN( index ) && ( index = this.children.length );\n\n\t\t\tvar previous = index > 0 ? this.children[ index - 1 ] : null;\n\t\t\tif ( previous ) {\n\t\t\t\t// If the block to be appended is following text, trim spaces at\n\t\t\t\t// the right of it.\n\t\t\t\tif ( node._.isBlockLike && previous.type == CKEDITOR.NODE_TEXT ) {\n\t\t\t\t\tprevious.value = CKEDITOR.tools.rtrim( previous.value );\n\n\t\t\t\t\t// If we have completely cleared the previous node.\n\t\t\t\t\tif ( previous.value.length === 0 ) {\n\t\t\t\t\t\t// Remove it from the list and add the node again.\n\t\t\t\t\t\tthis.children.pop();\n\t\t\t\t\t\tthis.add( node );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tprevious.next = node;\n\t\t\t}\n\n\t\t\tnode.previous = previous;\n\t\t\tnode.parent = this;\n\n\t\t\tthis.children.splice( index, 0, node );\n\n\t\t\tif ( !this._.hasInlineStarted )\n\t\t\t\tthis._.hasInlineStarted = node.type == CKEDITOR.NODE_TEXT || ( node.type == CKEDITOR.NODE_ELEMENT && !node._.isBlockLike );\n\t\t},\n\n\t\t/**\n\t\t * Filter this fragment's content with given filter.\n\t\t *\n\t\t * @since 4.1\n\t\t * @param {CKEDITOR.htmlParser.filter} filter\n\t\t */\n\t\tfilter: function( filter, context ) {\n\t\t\tcontext = this.getFilterContext( context );\n\n\t\t\t// Apply the root filter.\n\t\t\tfilter.onRoot( context, this );\n\n\t\t\tthis.filterChildren( filter, false, context );\n\t\t},\n\n\t\t/**\n\t\t * Filter this fragment's children with given filter.\n\t\t *\n\t\t * Element's children may only be filtered once by one\n\t\t * instance of filter.\n\t\t *\n\t\t * @since 4.1\n\t\t * @param {CKEDITOR.htmlParser.filter} filter\n\t\t * @param {Boolean} [filterRoot] Whether to apply the \"root\" filter rule specified in the `filter`.\n\t\t */\n\t\tfilterChildren: function( filter, filterRoot, context ) {\n\t\t\t// If this element's children were already filtered\n\t\t\t// by current filter, don't filter them 2nd time.\n\t\t\t// This situation may occur when filtering bottom-up\n\t\t\t// (filterChildren() called manually in element's filter),\n\t\t\t// or in unpredictable edge cases when filter\n\t\t\t// is manipulating DOM structure.\n\t\t\tif ( this.childrenFilteredBy == filter.id )\n\t\t\t\treturn;\n\n\t\t\tcontext = this.getFilterContext( context );\n\n\t\t\t// Filtering root if enforced.\n\t\t\tif ( filterRoot && !this.parent )\n\t\t\t\tfilter.onRoot( context, this );\n\n\t\t\tthis.childrenFilteredBy = filter.id;\n\n\t\t\t// Don't cache anything, children array may be modified by filter rule.\n\t\t\tfor ( var i = 0; i < this.children.length; i++ ) {\n\t\t\t\t// Stay in place if filter returned false, what means\n\t\t\t\t// that node has been removed.\n\t\t\t\tif ( this.children[ i ].filter( filter, context ) === false )\n\t\t\t\t\ti--;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Writes the fragment HTML to a {@link CKEDITOR.htmlParser.basicWriter}.\n\t\t *\n\t\t *\t\tvar writer = new CKEDITOR.htmlWriter();\n\t\t *\t\tvar fragment = CKEDITOR.htmlParser.fragment.fromHtml( '<P><B>Example' );\n\t\t *\t\tfragment.writeHtml( writer );\n\t\t *\t\talert( writer.getHtml() ); // '<p><b>Example</b></p>'\n\t\t *\n\t\t * @param {CKEDITOR.htmlParser.basicWriter} writer The writer to which write the HTML.\n\t\t * @param {CKEDITOR.htmlParser.filter} [filter] The filter to use when writing the HTML.\n\t\t */\n\t\twriteHtml: function( writer, filter ) {\n\t\t\tif ( filter )\n\t\t\t\tthis.filter( filter );\n\n\t\t\tthis.writeChildrenHtml( writer );\n\t\t},\n\n\t\t/**\n\t\t * Write and filtering the child nodes of this fragment.\n\t\t *\n\t\t * @param {CKEDITOR.htmlParser.basicWriter} writer The writer to which write the HTML.\n\t\t * @param {CKEDITOR.htmlParser.filter} [filter] The filter to use when writing the HTML.\n\t\t * @param {Boolean} [filterRoot] Whether to apply the \"root\" filter rule specified in the `filter`.\n\t\t */\n\t\twriteChildrenHtml: function( writer, filter, filterRoot ) {\n\t\t\tvar context = this.getFilterContext();\n\n\t\t\t// Filtering root if enforced.\n\t\t\tif ( filterRoot && !this.parent && filter )\n\t\t\t\tfilter.onRoot( context, this );\n\n\t\t\tif ( filter )\n\t\t\t\tthis.filterChildren( filter, false, context );\n\n\t\t\tfor ( var i = 0, children = this.children, l = children.length; i < l; i++ )\n\t\t\t\tchildren[ i ].writeHtml( writer );\n\t\t},\n\n\t\t/**\n\t\t * Execute callback on each node (of given type) in this document fragment.\n\t\t *\n\t\t *\t\tvar fragment = CKEDITOR.htmlParser.fragment.fromHtml( '<p>foo<b>bar</b>bom</p>' );\n\t\t *\t\tfragment.forEach( function( node ) {\n\t\t *\t\t\tconsole.log( node );\n\t\t *\t\t} );\n\t\t *\t\t// Will log:\n\t\t *\t\t// 1. document fragment,\n\t\t *\t\t// 2. <p> element,\n\t\t *\t\t// 3. \"foo\" text node,\n\t\t *\t\t// 4. <b> element,\n\t\t *\t\t// 5. \"bar\" text node,\n\t\t *\t\t// 6. \"bom\" text node.\n\t\t *\n\t\t * @since 4.1\n\t\t * @param {Function} callback Function to be executed on every node.\n\t\t * **Since 4.3** if `callback` returned `false` descendants of current node will be ignored.\n\t\t * @param {CKEDITOR.htmlParser.node} callback.node Node passed as argument.\n\t\t * @param {Number} [type] If specified `callback` will be executed only on nodes of this type.\n\t\t * @param {Boolean} [skipRoot] Don't execute `callback` on this fragment.\n\t\t */\n\t\tforEach: function( callback, type, skipRoot ) {\n\t\t\tif ( !skipRoot && ( !type || this.type == type ) )\n\t\t\t\tvar ret = callback( this );\n\n\t\t\t// Do not filter children if callback returned false.\n\t\t\tif ( ret === false )\n\t\t\t\treturn;\n\n\t\t\tvar children = this.children,\n\t\t\t\tnode,\n\t\t\t\ti = 0;\n\n\t\t\t// We do not cache the size, because the list of nodes may be changed by the callback.\n\t\t\tfor ( ; i < children.length; i++ ) {\n\t\t\t\tnode = children[ i ];\n\t\t\t\tif ( node.type == CKEDITOR.NODE_ELEMENT )\n\t\t\t\t\tnode.forEach( callback, type );\n\t\t\t\telse if ( !type || node.type == type )\n\t\t\t\t\tcallback( node );\n\t\t\t}\n\t\t},\n\n\t\tgetFilterContext: function( context ) {\n\t\t\treturn context || {};\n\t\t}\n\t};\n} )();\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/htmlparser/fragment.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n'use strict';\n\n( function() {\n\t/**\n\t * Filter is a configurable tool for transforming and filtering {@link CKEDITOR.htmlParser.node nodes}.\n\t * It is mainly used during data processing phase which is done not on real DOM nodes,\n\t * but on their simplified form represented by {@link CKEDITOR.htmlParser.node} class and its subclasses.\n\t *\n\t *\t\tvar filter = new CKEDITOR.htmlParser.filter( {\n\t *\t\t\ttext: function( value ) {\n\t *\t\t\t\treturn '@' + value + '@';\n\t *\t\t\t},\n\t *\t\t\telements: {\n\t *\t\t\t\tp: function( element ) {\n\t *\t\t\t\t\telement.attributes.foo = '1';\n\t *\t\t\t\t}\n\t *\t\t\t}\n\t *\t\t} );\n\t *\n\t *\t\tvar fragment = CKEDITOR.htmlParser.fragment.fromHtml( '<p>Foo<b>bar!</b></p>' ),\n\t *\t\t\twriter = new CKEDITOR.htmlParser.basicWriter();\n\t *\t\tfilter.applyTo( fragment );\n\t *\t\tfragment.writeHtml( writer );\n\t *\t\twriter.getHtml(); // '<p foo=\"1\">@Foo@<b>@bar!@</b></p>'\n\t *\n\t * @class\n\t */\n\tCKEDITOR.htmlParser.filter = CKEDITOR.tools.createClass( {\n\t\t/**\n\t\t * @constructor Creates a filter class instance.\n\t\t * @param {CKEDITOR.htmlParser.filterRulesDefinition} [rules]\n\t\t */\n\t\t$: function( rules ) {\n\t\t\t/**\n\t\t\t * ID of filter instance, which is used to mark elements\n\t\t\t * to which this filter has been already applied.\n\t\t\t *\n\t\t\t * @property {Number} id\n\t\t\t * @readonly\n\t\t\t */\n\t\t\tthis.id = CKEDITOR.tools.getNextNumber();\n\n\t\t\t/**\n\t\t\t * Rules for element names.\n\t\t\t *\n\t\t\t * @property {CKEDITOR.htmlParser.filterRulesGroup}\n\t\t\t * @readonly\n\t\t\t */\n\t\t\tthis.elementNameRules = new filterRulesGroup();\n\n\t\t\t/**\n\t\t\t * Rules for attribute names.\n\t\t\t *\n\t\t\t * @property {CKEDITOR.htmlParser.filterRulesGroup}\n\t\t\t * @readonly\n\t\t\t */\n\t\t\tthis.attributeNameRules = new filterRulesGroup();\n\n\t\t\t/**\n\t\t\t * Hash of elementName => {@link CKEDITOR.htmlParser.filterRulesGroup rules for elements}.\n\t\t\t *\n\t\t\t * @readonly\n\t\t\t */\n\t\t\tthis.elementsRules = {};\n\n\t\t\t/**\n\t\t\t * Hash of attributeName => {@link CKEDITOR.htmlParser.filterRulesGroup rules for attributes}.\n\t\t\t *\n\t\t\t * @readonly\n\t\t\t */\n\t\t\tthis.attributesRules = {};\n\n\t\t\t/**\n\t\t\t * Rules for text nodes.\n\t\t\t *\n\t\t\t * @property {CKEDITOR.htmlParser.filterRulesGroup}\n\t\t\t * @readonly\n\t\t\t */\n\t\t\tthis.textRules = new filterRulesGroup();\n\n\t\t\t/**\n\t\t\t * Rules for comment nodes.\n\t\t\t *\n\t\t\t * @property {CKEDITOR.htmlParser.filterRulesGroup}\n\t\t\t * @readonly\n\t\t\t */\n\t\t\tthis.commentRules = new filterRulesGroup();\n\n\t\t\t/**\n\t\t\t * Rules for a root node.\n\t\t\t *\n\t\t\t * @property {CKEDITOR.htmlParser.filterRulesGroup}\n\t\t\t * @readonly\n\t\t\t */\n\t\t\tthis.rootRules = new filterRulesGroup();\n\n\t\t\tif ( rules )\n\t\t\t\tthis.addRules( rules, 10 );\n\t\t},\n\n\t\tproto: {\n\t\t\t/**\n\t\t\t * Add rules to this filter.\n\t\t\t *\n\t\t\t * @param {CKEDITOR.htmlParser.filterRulesDefinition} rules Object containing filter rules.\n\t\t\t * @param {Object/Number} [options] Object containing rules' options or a priority\n\t\t\t * (for a backward compatibility with CKEditor versions up to 4.2.x).\n\t\t\t * @param {Number} [options.priority=10] The priority of a rule.\n\t\t\t * @param {Boolean} [options.applyToAll=false] Whether to apply rule to non-editable\n\t\t\t * elements and their descendants too.\n\t\t\t */\n\t\t\taddRules: function( rules, options ) {\n\t\t\t\tvar priority;\n\n\t\t\t\t// Backward compatibility.\n\t\t\t\tif ( typeof options == 'number' )\n\t\t\t\t\tpriority = options;\n\t\t\t\t// New version - try reading from options.\n\t\t\t\telse if ( options && ( 'priority' in options ) )\n\t\t\t\t\tpriority = options.priority;\n\n\t\t\t\t// Defaults.\n\t\t\t\tif ( typeof priority != 'number' )\n\t\t\t\t\tpriority = 10;\n\t\t\t\tif ( typeof options != 'object' )\n\t\t\t\t\toptions = {};\n\n\t\t\t\t// Add the elementNames.\n\t\t\t\tif ( rules.elementNames )\n\t\t\t\t\tthis.elementNameRules.addMany( rules.elementNames, priority, options );\n\n\t\t\t\t// Add the attributeNames.\n\t\t\t\tif ( rules.attributeNames )\n\t\t\t\t\tthis.attributeNameRules.addMany( rules.attributeNames, priority, options );\n\n\t\t\t\t// Add the elements.\n\t\t\t\tif ( rules.elements )\n\t\t\t\t\taddNamedRules( this.elementsRules, rules.elements, priority, options );\n\n\t\t\t\t// Add the attributes.\n\t\t\t\tif ( rules.attributes )\n\t\t\t\t\taddNamedRules( this.attributesRules, rules.attributes, priority, options );\n\n\t\t\t\t// Add the text.\n\t\t\t\tif ( rules.text )\n\t\t\t\t\tthis.textRules.add( rules.text, priority, options );\n\n\t\t\t\t// Add the comment.\n\t\t\t\tif ( rules.comment )\n\t\t\t\t\tthis.commentRules.add( rules.comment, priority, options );\n\n\t\t\t\t// Add root node rules.\n\t\t\t\tif ( rules.root )\n\t\t\t\t\tthis.rootRules.add( rules.root, priority, options );\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Apply this filter to given node.\n\t\t\t *\n\t\t\t * @param {CKEDITOR.htmlParser.node} node The node to be filtered.\n\t\t\t */\n\t\t\tapplyTo: function( node ) {\n\t\t\t\tnode.filter( this );\n\t\t\t},\n\n\t\t\tonElementName: function( context, name ) {\n\t\t\t\treturn this.elementNameRules.execOnName( context, name );\n\t\t\t},\n\n\t\t\tonAttributeName: function( context, name ) {\n\t\t\t\treturn this.attributeNameRules.execOnName( context, name );\n\t\t\t},\n\n\t\t\tonText: function( context, text, node ) {\n\t\t\t\treturn this.textRules.exec( context, text, node );\n\t\t\t},\n\n\t\t\tonComment: function( context, commentText, comment ) {\n\t\t\t\treturn this.commentRules.exec( context, commentText, comment );\n\t\t\t},\n\n\t\t\tonRoot: function( context, element ) {\n\t\t\t\treturn this.rootRules.exec( context, element );\n\t\t\t},\n\n\t\t\tonElement: function( context, element ) {\n\t\t\t\t// We must apply filters set to the specific element name as\n\t\t\t\t// well as those set to the generic ^/$ name. So, add both to an\n\t\t\t\t// array and process them in a small loop.\n\t\t\t\tvar rulesGroups = [ this.elementsRules[ '^' ], this.elementsRules[ element.name ], this.elementsRules.$ ],\n\t\t\t\t\trulesGroup, ret;\n\n\t\t\t\tfor ( var i = 0; i < 3; i++ ) {\n\t\t\t\t\trulesGroup = rulesGroups[ i ];\n\t\t\t\t\tif ( rulesGroup ) {\n\t\t\t\t\t\tret = rulesGroup.exec( context, element, this );\n\n\t\t\t\t\t\tif ( ret === false )\n\t\t\t\t\t\t\treturn null;\n\n\t\t\t\t\t\tif ( ret && ret != element )\n\t\t\t\t\t\t\treturn this.onNode( context, ret );\n\n\t\t\t\t\t\t// The non-root element has been dismissed by one of the filters.\n\t\t\t\t\t\tif ( element.parent && !element.name )\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn element;\n\t\t\t},\n\n\t\t\tonNode: function( context, node ) {\n\t\t\t\tvar type = node.type;\n\n\t\t\t\treturn type == CKEDITOR.NODE_ELEMENT ? this.onElement( context, node ) :\n\t\t\t\t\ttype == CKEDITOR.NODE_TEXT ? new CKEDITOR.htmlParser.text( this.onText( context, node.value ) ) :\n\t\t\t\t\ttype == CKEDITOR.NODE_COMMENT ? new CKEDITOR.htmlParser.comment( this.onComment( context, node.value ) ) : null;\n\t\t\t},\n\n\t\t\tonAttribute: function( context, element, name, value ) {\n\t\t\t\tvar rulesGroup = this.attributesRules[ name ];\n\n\t\t\t\tif ( rulesGroup )\n\t\t\t\t\treturn rulesGroup.exec( context, value, element, this );\n\t\t\t\treturn value;\n\t\t\t}\n\t\t}\n\t} );\n\n\t/**\n\t * Class grouping filter rules for one subject (like element or attribute names).\n\t *\n\t * @class CKEDITOR.htmlParser.filterRulesGroup\n\t */\n\tfunction filterRulesGroup() {\n\t\t/**\n\t\t * Array of objects containing rule, priority and options.\n\t\t *\n\t\t * @property {Object[]}\n\t\t * @readonly\n\t\t */\n\t\tthis.rules = [];\n\t}\n\n\tCKEDITOR.htmlParser.filterRulesGroup = filterRulesGroup;\n\n\tfilterRulesGroup.prototype = {\n\t\t/**\n\t\t * Adds specified rule to this group.\n\t\t *\n\t\t * @param {Function/Array} rule Function for function based rule or [ pattern, replacement ] array for\n\t\t * rule applicable to names.\n\t\t * @param {Number} priority\n\t\t * @param options\n\t\t */\n\t\tadd: function( rule, priority, options ) {\n\t\t\tthis.rules.splice( this.findIndex( priority ), 0, {\n\t\t\t\tvalue: rule,\n\t\t\t\tpriority: priority,\n\t\t\t\toptions: options\n\t\t\t} );\n\t\t},\n\n\t\t/**\n\t\t * Adds specified rules to this group.\n\t\t *\n\t\t * @param {Array} rules Array of rules - see {@link #add}.\n\t\t * @param {Number} priority\n\t\t * @param options\n\t\t */\n\t\taddMany: function( rules, priority, options ) {\n\t\t\tvar args = [ this.findIndex( priority ), 0 ];\n\n\t\t\tfor ( var i = 0, len = rules.length; i < len; i++ ) {\n\t\t\t\targs.push( {\n\t\t\t\t\tvalue: rules[ i ],\n\t\t\t\t\tpriority: priority,\n\t\t\t\t\toptions: options\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\tthis.rules.splice.apply( this.rules, args );\n\t\t},\n\n\t\t/**\n\t\t * Finds an index at which rule with given priority should be inserted.\n\t\t *\n\t\t * @param {Number} priority\n\t\t * @returns {Number} Index.\n\t\t */\n\t\tfindIndex: function( priority ) {\n\t\t\tvar rules = this.rules,\n\t\t\t\tlen = rules.length,\n\t\t\t\ti = len - 1;\n\n\t\t\t// Search from the end, because usually rules will be added with default priority, so\n\t\t\t// we will be able to stop loop quickly.\n\t\t\twhile ( i >= 0 && priority < rules[ i ].priority )\n\t\t\t\ti--;\n\n\t\t\treturn i + 1;\n\t\t},\n\n\t\t/**\n\t\t * Executes this rules group on given value. Applicable only if function based rules were added.\n\t\t *\n\t\t * All arguments passed to this function will be forwarded to rules' functions.\n\t\t *\n\t\t * @param {CKEDITOR.htmlParser.node/CKEDITOR.htmlParser.fragment/String} currentValue The value to be filtered.\n\t\t * @returns {CKEDITOR.htmlParser.node/CKEDITOR.htmlParser.fragment/String} Filtered value.\n\t\t */\n\t\texec: function( context, currentValue ) {\n\t\t\tvar isNode = currentValue instanceof CKEDITOR.htmlParser.node || currentValue instanceof CKEDITOR.htmlParser.fragment,\n\t\t\t\t// Splice '1' to remove context, which we don't want to pass to filter rules.\n\t\t\t\targs = Array.prototype.slice.call( arguments, 1 ),\n\t\t\t\trules = this.rules,\n\t\t\t\tlen = rules.length,\n\t\t\t\torgType, orgName, ret, i, rule;\n\n\t\t\tfor ( i = 0; i < len; i++ ) {\n\t\t\t\t// Backup the node info before filtering.\n\t\t\t\tif ( isNode ) {\n\t\t\t\t\torgType = currentValue.type;\n\t\t\t\t\torgName = currentValue.name;\n\t\t\t\t}\n\n\t\t\t\trule = rules[ i ];\n\t\t\t\tif ( isRuleApplicable( context, rule ) ) {\n\t\t\t\t\tret = rule.value.apply( null, args );\n\n\t\t\t\t\tif ( ret === false )\n\t\t\t\t\t\treturn ret;\n\n\t\t\t\t\t// We're filtering node (element/fragment).\n\t\t\t\t\t// No further filtering if it's not anymore fitable for the subsequent filters.\n\t\t\t\t\tif ( isNode && ret && ( ret.name != orgName || ret.type != orgType ) )\n\t\t\t\t\t\treturn ret;\n\n\t\t\t\t\t// Update currentValue and corresponding argument in args array.\n\t\t\t\t\t// Updated values will be used in next for-loop step.\n\t\t\t\t\tif ( ret != null )\n\t\t\t\t\t\targs[ 0 ] = currentValue = ret;\n\n\t\t\t\t\t// ret == undefined will continue loop as nothing has happened.\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn currentValue;\n\t\t},\n\n\t\t/**\n\t\t * Executes this rules group on name. Applicable only if filter rules for names were added.\n\t\t *\n\t\t * @param {String} currentName The name to be filtered.\n\t\t * @returns {String} Filtered name.\n\t\t */\n\t\texecOnName: function( context, currentName ) {\n\t\t\tvar i = 0,\n\t\t\t\trules = this.rules,\n\t\t\t\tlen = rules.length,\n\t\t\t\trule;\n\n\t\t\tfor ( ; currentName && i < len; i++ ) {\n\t\t\t\trule = rules[ i ];\n\t\t\t\tif ( isRuleApplicable( context, rule ) )\n\t\t\t\t\tcurrentName = currentName.replace( rule.value[ 0 ], rule.value[ 1 ] );\n\t\t\t}\n\n\t\t\treturn currentName;\n\t\t}\n\t};\n\n\tfunction addNamedRules( rulesGroups, newRules, priority, options ) {\n\t\tvar ruleName, rulesGroup;\n\n\t\tfor ( ruleName in newRules ) {\n\t\t\trulesGroup = rulesGroups[ ruleName ];\n\n\t\t\tif ( !rulesGroup )\n\t\t\t\trulesGroup = rulesGroups[ ruleName ] = new filterRulesGroup();\n\n\t\t\trulesGroup.add( newRules[ ruleName ], priority, options );\n\t\t}\n\t}\n\n\tfunction isRuleApplicable( context, rule ) {\n\t\tif ( context.nonEditable && !rule.options.applyToAll )\n\t\t\treturn false;\n\n\t\tif ( context.nestedEditable && rule.options.excludeNestedEditable )\n\t\t\treturn false;\n\n\t\treturn true;\n\t}\n\n} )();\n\n/**\n * @class CKEDITOR.htmlParser.filterRulesDefinition\n * @abstract\n */\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/htmlparser/filter.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n( function() {\n\t/**\n\t * Represents an HTML data processor, which is responsible for translating and\n\t * transforming the editor data on input and output.\n\t *\n\t * @class\n\t * @extends CKEDITOR.dataProcessor\n\t * @constructor Creates an htmlDataProcessor class instance.\n\t * @param {CKEDITOR.editor} editor\n\t */\n\tCKEDITOR.htmlDataProcessor = function( editor ) {\n\t\tvar dataFilter, htmlFilter,\n\t\t\tthat = this;\n\n\t\tthis.editor = editor;\n\n\t\t/**\n\t\t * Data filter used when processing input by {@link #toHtml}.\n\t\t *\n\t\t * @property {CKEDITOR.htmlParser.filter}\n\t\t */\n\t\tthis.dataFilter = dataFilter = new CKEDITOR.htmlParser.filter();\n\n\t\t/**\n\t\t * HTML filter used when processing output by {@link #toDataFormat}.\n\t\t *\n\t\t * @property {CKEDITOR.htmlParser.filter}\n\t\t */\n\t\tthis.htmlFilter = htmlFilter = new CKEDITOR.htmlParser.filter();\n\n\t\t/**\n\t\t * The HTML writer used by this data processor to format the output.\n\t\t *\n\t\t * @property {CKEDITOR.htmlParser.basicWriter}\n\t\t */\n\t\tthis.writer = new CKEDITOR.htmlParser.basicWriter();\n\n\t\tdataFilter.addRules( defaultDataFilterRulesEditableOnly );\n\t\tdataFilter.addRules( defaultDataFilterRulesForAll, { applyToAll: true } );\n\t\tdataFilter.addRules( createBogusAndFillerRules( editor, 'data' ), { applyToAll: true } );\n\t\thtmlFilter.addRules( defaultHtmlFilterRulesEditableOnly );\n\t\thtmlFilter.addRules( defaultHtmlFilterRulesForAll, { applyToAll: true } );\n\t\thtmlFilter.addRules( createBogusAndFillerRules( editor, 'html' ), { applyToAll: true } );\n\n\t\teditor.on( 'toHtml', function( evt ) {\n\t\t\tvar evtData = evt.data,\n\t\t\t\tdata = evtData.dataValue,\n\t\t\t\tfixBodyTag;\n\n\t\t\t// The source data is already HTML, but we need to clean\n\t\t\t// it up and apply the filter.\n\t\t\tdata = protectSource( data, editor );\n\n\t\t\t// Protect content of textareas. (#9995)\n\t\t\t// Do this before protecting attributes to avoid breaking:\n\t\t\t// <textarea><img src=\"...\" /></textarea>\n\t\t\tdata = protectElements( data, protectTextareaRegex );\n\n\t\t\t// Before anything, we must protect the URL attributes as the\n\t\t\t// browser may changing them when setting the innerHTML later in\n\t\t\t// the code.\n\t\t\tdata = protectAttributes( data );\n\n\t\t\t// Protect elements than can't be set inside a DIV. E.g. IE removes\n\t\t\t// style tags from innerHTML. (#3710)\n\t\t\tdata = protectElements( data, protectElementsRegex );\n\n\t\t\t// Certain elements has problem to go through DOM operation, protect\n\t\t\t// them by prefixing 'cke' namespace. (#3591)\n\t\t\tdata = protectElementsNames( data );\n\n\t\t\t// All none-IE browsers ignore self-closed custom elements,\n\t\t\t// protecting them into open-close. (#3591)\n\t\t\tdata = protectSelfClosingElements( data );\n\n\t\t\t// Compensate one leading line break after <pre> open as browsers\n\t\t\t// eat it up. (#5789)\n\t\t\tdata = protectPreFormatted( data );\n\n\t\t\t// There are attributes which may execute JavaScript code inside fixBin.\n\t\t\t// Encode them greedily. They will be unprotected right after getting HTML from fixBin. (#10)\n\t\t\tdata = protectInsecureAttributes( data );\n\n\t\t\tvar fixBin = evtData.context || editor.editable().getName(),\n\t\t\t\tisPre;\n\n\t\t\t// Old IEs loose formats when load html into <pre>.\n\t\t\tif ( CKEDITOR.env.ie && CKEDITOR.env.version < 9 && fixBin == 'pre' ) {\n\t\t\t\tfixBin = 'div';\n\t\t\t\tdata = '<pre>' + data + '</pre>';\n\t\t\t\tisPre = 1;\n\t\t\t}\n\n\t\t\t// Call the browser to help us fixing a possibly invalid HTML\n\t\t\t// structure.\n\t\t\tvar el = editor.document.createElement( fixBin );\n\t\t\t// Add fake character to workaround IE comments bug. (#3801)\n\t\t\tel.setHtml( 'a' + data );\n\t\t\tdata = el.getHtml().substr( 1 );\n\n\t\t\t// Restore shortly protected attribute names.\n\t\t\tdata = data.replace( new RegExp( 'data-cke-' + CKEDITOR.rnd + '-', 'ig' ), '' );\n\n\t\t\tisPre && ( data = data.replace( /^<pre>|<\\/pre>$/gi, '' ) );\n\n\t\t\t// Unprotect \"some\" of the protected elements at this point.\n\t\t\tdata = unprotectElementNames( data );\n\n\t\t\tdata = unprotectElements( data );\n\n\t\t\t// Restore the comments that have been protected, in this way they\n\t\t\t// can be properly filtered.\n\t\t\tdata = unprotectRealComments( data );\n\n\t\t\tif ( evtData.fixForBody === false ) {\n\t\t\t\tfixBodyTag = false;\n\t\t\t} else {\n\t\t\t\tfixBodyTag = getFixBodyTag( evtData.enterMode, editor.config.autoParagraph );\n\t\t\t}\n\n\t\t\t// Now use our parser to make further fixes to the structure, as\n\t\t\t// well as apply the filter.\n\t\t\tdata = CKEDITOR.htmlParser.fragment.fromHtml( data, evtData.context, fixBodyTag );\n\n\t\t\t// The empty root element needs to be fixed by adding 'p' or 'div' into it.\n\t\t\t// This avoids the need to create that element on the first focus (#12630).\n\t\t\tif ( fixBodyTag ) {\n\t\t\t\tfixEmptyRoot( data, fixBodyTag );\n\t\t\t}\n\n\t\t\tevtData.dataValue = data;\n\t\t}, null, null, 5 );\n\n\t\t// Filter incoming \"data\".\n\t\t// Add element filter before htmlDataProcessor.dataFilter when purifying input data to correct html.\n\t\teditor.on( 'toHtml', function( evt ) {\n\t\t\tif ( evt.data.filter.applyTo( evt.data.dataValue, true, evt.data.dontFilter, evt.data.enterMode ) )\n\t\t\t\teditor.fire( 'dataFiltered' );\n\t\t}, null, null, 6 );\n\n\t\teditor.on( 'toHtml', function( evt ) {\n\t\t\tevt.data.dataValue.filterChildren( that.dataFilter, true );\n\t\t}, null, null, 10 );\n\n\t\teditor.on( 'toHtml', function( evt ) {\n\t\t\tvar evtData = evt.data,\n\t\t\t\tdata = evtData.dataValue,\n\t\t\t\twriter = new CKEDITOR.htmlParser.basicWriter();\n\n\t\t\tdata.writeChildrenHtml( writer );\n\t\t\tdata = writer.getHtml( true );\n\n\t\t\t// Protect the real comments again.\n\t\t\tevtData.dataValue = protectRealComments( data );\n\t\t}, null, null, 15 );\n\n\n\t\teditor.on( 'toDataFormat', function( evt ) {\n\t\t\tvar data = evt.data.dataValue;\n\n\t\t\t// #10854 - we need to strip leading blockless <br> which FF adds\n\t\t\t// automatically when editable contains only non-editable content.\n\t\t\t// We do that for every browser (so it's a constant behavior) and\n\t\t\t// not in BR mode, in which chance of valid leading blockless <br> is higher.\n\t\t\tif ( evt.data.enterMode != CKEDITOR.ENTER_BR )\n\t\t\t\tdata = data.replace( /^<br *\\/?>/i, '' );\n\n\t\t\tevt.data.dataValue = CKEDITOR.htmlParser.fragment.fromHtml(\n\t\t\t\tdata, evt.data.context, getFixBodyTag( evt.data.enterMode, editor.config.autoParagraph ) );\n\t\t}, null, null, 5 );\n\n\t\teditor.on( 'toDataFormat', function( evt ) {\n\t\t\tevt.data.dataValue.filterChildren( that.htmlFilter, true );\n\t\t}, null, null, 10 );\n\n\t\t// Transform outcoming \"data\".\n\t\t// Add element filter after htmlDataProcessor.htmlFilter when preparing output data HTML.\n\t\teditor.on( 'toDataFormat', function( evt ) {\n\t\t\tevt.data.filter.applyTo( evt.data.dataValue, false, true );\n\t\t}, null, null, 11 );\n\n\t\teditor.on( 'toDataFormat', function( evt ) {\n\t\t\tvar data = evt.data.dataValue,\n\t\t\t\twriter = that.writer;\n\n\t\t\twriter.reset();\n\t\t\tdata.writeChildrenHtml( writer );\n\t\t\tdata = writer.getHtml( true );\n\n\t\t\t// Restore those non-HTML protected source. (#4475,#4880)\n\t\t\tdata = unprotectRealComments( data );\n\t\t\tdata = unprotectSource( data, editor );\n\n\t\t\tevt.data.dataValue = data;\n\t\t}, null, null, 15 );\n\t};\n\n\tCKEDITOR.htmlDataProcessor.prototype = {\n\t\t/**\n\t\t * Processes the (potentially malformed) input HTML to a purified form which\n\t\t * is suitable for using in the WYSIWYG editable.\n\t\t *\n\t\t * This method fires the {@link CKEDITOR.editor#toHtml} event which makes it possible\n\t\t * to hook into the process at various stages.\n\t\t *\n\t\t * **Note:** Since CKEditor 4.3 the signature of this method changed and all options\n\t\t * are now grouped in one `options` object. Previously `context`, `fixForBody` and `dontFilter`\n\t\t * were passed separately.\n\t\t *\n\t\t * @param {String} data The raw data.\n\t\t * @param {Object} [options] The options object.\n\t\t * @param {String} [options.context] The tag name of a context element within which\n\t\t * the input is to be processed, defaults to the editable element.\n\t\t * If `null` is passed, then data will be parsed without context (as children of {@link CKEDITOR.htmlParser.fragment}).\n\t\t * See {@link CKEDITOR.htmlParser.fragment#fromHtml} for more details.\n\t\t * @param {Boolean} [options.fixForBody=true] Whether to trigger the auto paragraph for non-block content.\n\t\t * @param {CKEDITOR.filter} [options.filter] When specified, instead of using the {@link CKEDITOR.editor#filter main filter},\n\t\t * the passed instance will be used to filter the content.\n\t\t * @param {Boolean} [options.dontFilter] Do not filter data with {@link CKEDITOR.filter} (note: transformations\n\t\t * will still be applied).\n\t\t * @param {Number} [options.enterMode] When specified, it will be used instead of the {@link CKEDITOR.editor#enterMode main enterMode}.\n\t\t * @param {Boolean} [options.protectedWhitespaces] Indicates that content was wrapped with `<span>` elements to preserve\n\t\t * leading and trailing whitespaces. Option used by the {@link CKEDITOR.editor#method-insertHtml} method.\n\t\t * @returns {String}\n\t\t */\n\t\ttoHtml: function( data, options, fixForBody, dontFilter ) {\n\t\t\tvar editor = this.editor,\n\t\t\t\tcontext, filter, enterMode, protectedWhitespaces;\n\n\t\t\t// Typeof null == 'object', so check truthiness of options too.\n\t\t\tif ( options && typeof options == 'object' ) {\n\t\t\t\tcontext = options.context;\n\t\t\t\tfixForBody = options.fixForBody;\n\t\t\t\tdontFilter = options.dontFilter;\n\t\t\t\tfilter = options.filter;\n\t\t\t\tenterMode = options.enterMode;\n\t\t\t\tprotectedWhitespaces = options.protectedWhitespaces;\n\t\t\t}\n\t\t\t// Backward compatibility. Since CKEDITOR 4.3 every option was a separate argument.\n\t\t\telse {\n\t\t\t\tcontext = options;\n\t\t\t}\n\n\t\t\t// Fall back to the editable as context if not specified.\n\t\t\tif ( !context && context !== null )\n\t\t\t\tcontext = editor.editable().getName();\n\n\t\t\treturn editor.fire( 'toHtml', {\n\t\t\t\tdataValue: data,\n\t\t\t\tcontext: context,\n\t\t\t\tfixForBody: fixForBody,\n\t\t\t\tdontFilter: dontFilter,\n\t\t\t\tfilter: filter || editor.filter,\n\t\t\t\tenterMode: enterMode || editor.enterMode,\n\t\t\t\tprotectedWhitespaces: protectedWhitespaces\n\t\t\t} ).dataValue;\n\t\t},\n\n\t\t/**\n\t\t * See {@link CKEDITOR.dataProcessor#toDataFormat}.\n\t\t *\n\t\t * This method fires the {@link CKEDITOR.editor#toDataFormat} event which makes it possible\n\t\t * to hook into the process at various stages.\n\t\t *\n\t\t * @param {String} html\n\t\t * @param {Object} [options] The options object.\n\t\t * @param {String} [options.context] The tag name of the context element within which\n\t\t * the input is to be processed, defaults to the editable element.\n\t\t * @param {CKEDITOR.filter} [options.filter] When specified, instead of using the {@link CKEDITOR.editor#filter main filter},\n\t\t * the passed instance will be used to apply content transformations to the content.\n\t\t * @param {Number} [options.enterMode] When specified, it will be used instead of the {@link CKEDITOR.editor#enterMode main enterMode}.\n\t\t * @returns {String}\n\t\t */\n\t\ttoDataFormat: function( html, options ) {\n\t\t\tvar context, filter, enterMode;\n\n\t\t\t// Do not shorten this to `options && options.xxx`, because\n\t\t\t// falsy `options` will be passed instead of undefined.\n\t\t\tif ( options ) {\n\t\t\t\tcontext = options.context;\n\t\t\t\tfilter = options.filter;\n\t\t\t\tenterMode = options.enterMode;\n\t\t\t}\n\n\t\t\t// Fall back to the editable as context if not specified.\n\t\t\tif ( !context && context !== null )\n\t\t\t\tcontext = this.editor.editable().getName();\n\n\t\t\treturn this.editor.fire( 'toDataFormat', {\n\t\t\t\tdataValue: html,\n\t\t\t\tfilter: filter || this.editor.filter,\n\t\t\t\tcontext: context,\n\t\t\t\tenterMode: enterMode || this.editor.enterMode\n\t\t\t} ).dataValue;\n\t\t}\n\t};\n\n\t// Produce a set of filtering rules that handles bogus and filler node at the\n\t// end of block/pseudo block, in the following consequence:\n\t// 1. elements:<block> - this filter removes any bogus node, then check\n\t// if it's an empty block that requires a filler.\n\t// 2. elements:<br> - After cleaned with bogus, this filter checks the real\n\t// line-break BR to compensate a filler after it.\n\t//\n\t// Terms definitions:\n\t// filler: An element that's either <BR> or &NBSP; at the end of block that established line height.\n\t// bogus: Whenever a filler is proceeded with inline content, it becomes a bogus which is subjected to be removed.\n\t//\n\t// Various forms of the filler:\n\t// In output HTML: Filler should be consistently &NBSP; <BR> at the end of block is always considered as bogus.\n\t// In Wysiwyg HTML: Browser dependent - see env.needsBrFiller. Either BR for when needsBrFiller is true, or &NBSP; otherwise.\n\t// <BR> is NEVER considered as bogus when needsBrFiller is true.\n\tfunction createBogusAndFillerRules( editor, type ) {\n\t\tfunction createFiller( isOutput ) {\n\t\t\treturn isOutput || CKEDITOR.env.needsNbspFiller ?\n\t\t\t\tnew CKEDITOR.htmlParser.text( '\\xa0' ) :\n\t\t\t\tnew CKEDITOR.htmlParser.element( 'br', { 'data-cke-bogus': 1 } );\n\t\t}\n\n\t\t// This text block filter, remove any bogus and create the filler on demand.\n\t\tfunction blockFilter( isOutput, fillEmptyBlock ) {\n\n\t\t\treturn function( block ) {\n\t\t\t\t// DO NOT apply the filler if it's a fragment node.\n\t\t\t\tif ( block.type == CKEDITOR.NODE_DOCUMENT_FRAGMENT )\n\t\t\t\t\treturn;\n\n\t\t\t\tcleanBogus( block );\n\n\t\t\t\t// Add fillers to input (always) and to output (if fillEmptyBlock is ok with that).\n\t\t\t\tvar shouldFillBlock = !isOutput ||\n\t\t\t\t\t( typeof fillEmptyBlock == 'function' ? fillEmptyBlock( block ) : fillEmptyBlock ) !== false;\n\n\t\t\t\tif ( shouldFillBlock && isEmptyBlockNeedFiller( block ) ) {\n\t\t\t\t\tblock.add( createFiller( isOutput ) );\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// Append a filler right after the last line-break BR, found at the end of block.\n\t\tfunction brFilter( isOutput ) {\n\t\t\treturn function( br ) {\n\t\t\t\t// DO NOT apply the filer if parent's a fragment node.\n\t\t\t\tif ( br.parent.type == CKEDITOR.NODE_DOCUMENT_FRAGMENT )\n\t\t\t\t\treturn;\n\n\t\t\t\tvar attrs = br.attributes;\n\t\t\t\t// Dismiss BRs that are either bogus or eol marker.\n\t\t\t\tif ( 'data-cke-bogus' in attrs || 'data-cke-eol' in attrs ) {\n\t\t\t\t\tdelete attrs [ 'data-cke-bogus' ];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Judge the tail line-break BR, and to insert bogus after it.\n\t\t\t\tvar next = getNext( br ), previous = getPrevious( br );\n\n\t\t\t\tif ( !next && isBlockBoundary( br.parent ) )\n\t\t\t\t\tappend( br.parent, createFiller( isOutput ) );\n\t\t\t\telse if ( isBlockBoundary( next ) && previous && !isBlockBoundary( previous ) )\n\t\t\t\t\tcreateFiller( isOutput ).insertBefore( next );\n\t\t\t};\n\t\t}\n\n\t\t// Determinate whether this node is potentially a bogus node.\n\t\tfunction maybeBogus( node, atBlockEnd ) {\n\n\t\t\t// BR that's not from IE<11 DOM, except for a EOL marker.\n\t\t\tif ( !( isOutput && !CKEDITOR.env.needsBrFiller ) &&\n\t\t\t\t\tnode.type == CKEDITOR.NODE_ELEMENT && node.name == 'br' &&\n\t\t\t\t\t!node.attributes[ 'data-cke-eol' ] ) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tvar match;\n\n\t\t\t// NBSP, possibly.\n\t\t\tif ( node.type == CKEDITOR.NODE_TEXT && ( match = node.value.match( tailNbspRegex ) ) ) {\n\t\t\t\t// We need to separate tail NBSP out of a text node, for later removal.\n\t\t\t\tif ( match.index ) {\n\t\t\t\t\t( new CKEDITOR.htmlParser.text( node.value.substring( 0, match.index ) ) ).insertBefore( node );\n\t\t\t\t\tnode.value = match[ 0 ];\n\t\t\t\t}\n\n\t\t\t\t// From IE<11 DOM, at the end of a text block, or before block boundary.\n\t\t\t\tif ( !CKEDITOR.env.needsBrFiller && isOutput && ( !atBlockEnd || node.parent.name in textBlockTags ) )\n\t\t\t\t\treturn true;\n\n\t\t\t\t// From the output.\n\t\t\t\tif ( !isOutput ) {\n\t\t\t\t\tvar previous = node.previous;\n\n\t\t\t\t\t// Following a line-break at the end of block.\n\t\t\t\t\tif ( previous && previous.name == 'br' )\n\t\t\t\t\t\treturn true;\n\n\t\t\t\t\t// Or a single NBSP between two blocks.\n\t\t\t\t\tif ( !previous || isBlockBoundary( previous ) )\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\t// Removes all bogus inside of this block, and to convert fillers into the proper form.\n\t\tfunction cleanBogus( block ) {\n\t\t\tvar bogus = [];\n\t\t\tvar last = getLast( block ), node, previous;\n\n\t\t\tif ( last ) {\n\t\t\t\t// Check for bogus at the end of this block.\n\t\t\t\t// e.g. <p>foo<br /></p>\n\t\t\t\tmaybeBogus( last, 1 ) && bogus.push( last );\n\n\t\t\t\twhile ( last ) {\n\t\t\t\t\t// Check for bogus at the end of any pseudo block contained.\n\t\t\t\t\tif ( isBlockBoundary( last ) && ( node = getPrevious( last ) ) && maybeBogus( node ) ) {\n\t\t\t\t\t\t// Bogus must have inline proceeding, instead single BR between two blocks,\n\t\t\t\t\t\t// is considered as filler, e.g. <hr /><br /><hr />\n\t\t\t\t\t\tif ( ( previous = getPrevious( node ) ) && !isBlockBoundary( previous ) )\n\t\t\t\t\t\t\tbogus.push( node );\n\t\t\t\t\t\t// Convert the filler into appropriate form.\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tcreateFiller( isOutput ).insertAfter( node );\n\t\t\t\t\t\t\tnode.remove();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tlast = last.previous;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Now remove all bogus collected from above.\n\t\t\tfor ( var i = 0 ; i < bogus.length ; i++ )\n\t\t\t\tbogus[ i ].remove();\n\t\t}\n\n\t\t// Judge whether it's an empty block that requires a filler node.\n\t\tfunction isEmptyBlockNeedFiller( block ) {\n\n\t\t\t// DO NOT fill empty editable in IE<11.\n\t\t\tif ( !isOutput && !CKEDITOR.env.needsBrFiller && block.type == CKEDITOR.NODE_DOCUMENT_FRAGMENT )\n\t\t\t\treturn false;\n\n\t\t\t// 1. For IE version >=8,  empty blocks are displayed correctly themself in wysiwiyg;\n\t\t\t// 2. For the rest, at least table cell and list item need no filler space. (#6248)\n\t\t\tif ( !isOutput && !CKEDITOR.env.needsBrFiller &&\n\t\t\t\t( document.documentMode > 7 ||\n\t\t\t\t\tblock.name in CKEDITOR.dtd.tr ||\n\t\t\t\t\tblock.name in CKEDITOR.dtd.$listItem ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tvar last = getLast( block );\n\t\t\treturn !last || block.name == 'form' && last.name == 'input' ;\n\t\t}\n\n\t\tvar rules = { elements: {} },\n\t\t\tisOutput = type == 'html',\n\t\t\ttextBlockTags = CKEDITOR.tools.extend( {}, blockLikeTags );\n\n\t\t// Build the list of text blocks.\n\t\tfor ( var i in textBlockTags ) {\n\t\t\tif ( !( '#' in dtd[ i ] ) )\n\t\t\t\tdelete textBlockTags[ i ];\n\t\t}\n\n\t\tfor ( i in textBlockTags )\n\t\t\trules.elements[ i ] = blockFilter( isOutput, editor.config.fillEmptyBlocks );\n\n\t\t// Editable element has to be checked separately.\n\t\trules.root = blockFilter( isOutput, false );\n\t\trules.elements.br = brFilter( isOutput );\n\t\treturn rules;\n\t}\n\n\tfunction getFixBodyTag( enterMode, autoParagraph ) {\n\t\treturn ( enterMode != CKEDITOR.ENTER_BR && autoParagraph !== false ) ? enterMode == CKEDITOR.ENTER_DIV ? 'div' : 'p' : false;\n\t}\n\n\t// Regex to scan for &nbsp; at the end of blocks, which are actually placeholders.\n\t// Safari transforms the &nbsp; to \\xa0. (#4172)\n\tvar tailNbspRegex = /(?:&nbsp;|\\xa0)$/;\n\n\tvar protectedSourceMarker = '{cke_protected}';\n\n\tfunction getLast( node ) {\n\t\tvar last = node.children[ node.children.length - 1 ];\n\t\twhile ( last && isEmpty( last ) )\n\t\t\tlast = last.previous;\n\t\treturn last;\n\t}\n\n\tfunction getNext( node ) {\n\t\tvar next = node.next;\n\t\twhile ( next && isEmpty( next ) )\n\t\t\tnext = next.next;\n\t\treturn next;\n\t}\n\n\tfunction getPrevious( node ) {\n\t\tvar previous = node.previous;\n\t\twhile ( previous && isEmpty( previous ) )\n\t\t\tprevious = previous.previous;\n\t\treturn previous;\n\t}\n\n\t// Judge whether the node is an ghost node to be ignored, when traversing.\n\tfunction isEmpty( node ) {\n\t\treturn node.type == CKEDITOR.NODE_TEXT &&\n\t\t\t!CKEDITOR.tools.trim( node.value ) ||\n\t\t\tnode.type == CKEDITOR.NODE_ELEMENT &&\n\t\t\tnode.attributes[ 'data-cke-bookmark' ];\n\t}\n\n\t// Judge whether the node is a block-like element.\n\tfunction isBlockBoundary( node ) {\n\t\treturn node &&\n\t\t\t( node.type == CKEDITOR.NODE_ELEMENT && node.name in blockLikeTags ||\n\t\t\tnode.type == CKEDITOR.NODE_DOCUMENT_FRAGMENT );\n\t}\n\n\tfunction append( parent, node ) {\n\t\tvar last = parent.children[ parent.children.length - 1 ];\n\t\tparent.children.push( node );\n\t\tnode.parent = parent;\n\t\tif ( last ) {\n\t\t\tlast.next = node;\n\t\t\tnode.previous = last;\n\t\t}\n\t}\n\n\tfunction getNodeIndex( node ) {\n\t\treturn node.parent ? node.getIndex() : -1;\n\t}\n\n\tvar dtd = CKEDITOR.dtd,\n\t\t// Define orders of table elements.\n\t\ttableOrder = [ 'caption', 'colgroup', 'col', 'thead', 'tfoot', 'tbody' ],\n\t\t// List of all block elements.\n\t\tblockLikeTags = CKEDITOR.tools.extend( {}, dtd.$blockLimit, dtd.$block );\n\n\t//\n\t// DATA filter rules ------------------------------------------------------\n\t//\n\n\tvar defaultDataFilterRulesEditableOnly = {\n\t\telements: {\n\t\t\tinput: protectReadOnly,\n\t\t\ttextarea: protectReadOnly\n\t\t}\n\t};\n\n\t// These rules will also be applied to non-editable content.\n\tvar defaultDataFilterRulesForAll = {\n\t\tattributeNames: [\n\t\t\t// Event attributes (onXYZ) must not be directly set. They can become\n\t\t\t// active in the editing area (IE|WebKit).\n\t\t\t[ ( /^on/ ), 'data-cke-pa-on' ],\n\n\t\t\t// Don't let some old expando enter editor. Concerns only IE8,\n\t\t\t// but for consistency remove on all browsers.\n\t\t\t[ ( /^data-cke-expando$/ ), '' ]\n\t\t]\n\t};\n\n\t// Disable form elements editing mode provided by some browsers. (#5746)\n\tfunction protectReadOnly( element ) {\n\t\tvar attrs = element.attributes;\n\n\t\t// We should flag that the element was locked by our code so\n\t\t// it'll be editable by the editor functions (#6046).\n\t\tif ( attrs.contenteditable != 'false' )\n\t\t\tattrs[ 'data-cke-editable' ] = attrs.contenteditable ? 'true' : 1;\n\n\t\tattrs.contenteditable = 'false';\n\t}\n\n\t//\n\t// HTML filter rules ------------------------------------------------------\n\t//\n\n\tvar defaultHtmlFilterRulesEditableOnly = {\n\t\telements: {\n\t\t\tembed: function( element ) {\n\t\t\t\tvar parent = element.parent;\n\n\t\t\t\t// If the <embed> is child of a <object>, copy the width\n\t\t\t\t// and height attributes from it.\n\t\t\t\tif ( parent && parent.name == 'object' ) {\n\t\t\t\t\tvar parentWidth = parent.attributes.width,\n\t\t\t\t\t\tparentHeight = parent.attributes.height;\n\t\t\t\t\tif ( parentWidth )\n\t\t\t\t\t\telement.attributes.width = parentWidth;\n\t\t\t\t\tif ( parentHeight )\n\t\t\t\t\t\telement.attributes.height = parentHeight;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// Remove empty link but not empty anchor. (#3829, #13516)\n\t\t\ta: function( element ) {\n\t\t\t\tvar attrs = element.attributes;\n\n\t\t\t\tif ( !( element.children.length || attrs.name || attrs.id || element.attributes[ 'data-cke-saved-name' ] ) )\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t};\n\n\t// These rules will also be applied to non-editable content.\n\tvar defaultHtmlFilterRulesForAll = {\n\t\telementNames: [\n\t\t\t// Remove the \"cke:\" namespace prefix.\n\t\t\t[ ( /^cke:/ ), '' ],\n\n\t\t\t// Ignore <?xml:namespace> tags.\n\t\t\t[ ( /^\\?xml:namespace$/ ), '' ]\n\t\t],\n\n\t\tattributeNames: [\n\t\t\t// Attributes saved for changes and protected attributes.\n\t\t\t[ ( /^data-cke-(saved|pa)-/ ), '' ],\n\n\t\t\t// All \"data-cke-\" attributes are to be ignored.\n\t\t\t[ ( /^data-cke-.*/ ), '' ],\n\n\t\t\t[ 'hidefocus', '' ]\n\t\t],\n\n\t\telements: {\n\t\t\t$: function( element ) {\n\t\t\t\tvar attribs = element.attributes;\n\n\t\t\t\tif ( attribs ) {\n\t\t\t\t\t// Elements marked as temporary are to be ignored.\n\t\t\t\t\tif ( attribs[ 'data-cke-temp' ] )\n\t\t\t\t\t\treturn false;\n\n\t\t\t\t\t// Remove duplicated attributes - #3789.\n\t\t\t\t\tvar attributeNames = [ 'name', 'href', 'src' ],\n\t\t\t\t\t\tsavedAttributeName;\n\t\t\t\t\tfor ( var i = 0; i < attributeNames.length; i++ ) {\n\t\t\t\t\t\tsavedAttributeName = 'data-cke-saved-' + attributeNames[ i ];\n\t\t\t\t\t\tsavedAttributeName in attribs && ( delete attribs[ attributeNames[ i ] ] );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn element;\n\t\t\t},\n\n\t\t\t// The contents of table should be in correct order (#4809).\n\t\t\ttable: function( element ) {\n\t\t\t\t// Clone the array as it would become empty during the sort call.\n\t\t\t\tvar children = element.children.slice( 0 );\n\n\t\t\t\tchildren.sort( function( node1, node2 ) {\n\t\t\t\t\tvar index1, index2;\n\n\t\t\t\t\t// Compare in the predefined order.\n\t\t\t\t\tif ( node1.type == CKEDITOR.NODE_ELEMENT && node2.type == node1.type ) {\n\t\t\t\t\t\tindex1 = CKEDITOR.tools.indexOf( tableOrder, node1.name );\n\t\t\t\t\t\tindex2 = CKEDITOR.tools.indexOf( tableOrder, node2.name );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Make sure the sort is stable, if no order can be established above.\n\t\t\t\t\tif ( !( index1 > -1 && index2 > -1 && index1 != index2 ) ) {\n\t\t\t\t\t\tindex1 = getNodeIndex( node1 );\n\t\t\t\t\t\tindex2 = getNodeIndex( node2 );\n\t\t\t\t\t}\n\n\t\t\t\t\treturn index1 > index2 ? 1 : -1;\n\t\t\t\t} );\n\t\t\t},\n\n\t\t\t// Restore param elements into self-closing.\n\t\t\tparam: function( param ) {\n\t\t\t\tparam.children = [];\n\t\t\t\tparam.isEmpty = true;\n\t\t\t\treturn param;\n\t\t\t},\n\n\t\t\t// Remove dummy span in webkit.\n\t\t\tspan: function( element ) {\n\t\t\t\tif ( element.attributes[ 'class' ] == 'Apple-style-span' )\n\t\t\t\t\tdelete element.name;\n\t\t\t},\n\n\t\t\thtml: function( element ) {\n\t\t\t\tdelete element.attributes.contenteditable;\n\t\t\t\tdelete element.attributes[ 'class' ];\n\t\t\t},\n\n\t\t\tbody: function( element ) {\n\t\t\t\tdelete element.attributes.spellcheck;\n\t\t\t\tdelete element.attributes.contenteditable;\n\t\t\t},\n\n\t\t\tstyle: function( element ) {\n\t\t\t\tvar child = element.children[ 0 ];\n\t\t\t\tif ( child && child.value )\n\t\t\t\t\tchild.value = CKEDITOR.tools.trim( child.value );\n\n\t\t\t\tif ( !element.attributes.type )\n\t\t\t\t\telement.attributes.type = 'text/css';\n\t\t\t},\n\n\t\t\ttitle: function( element ) {\n\t\t\t\tvar titleText = element.children[ 0 ];\n\n\t\t\t\t// Append text-node to title tag if not present (i.e. non-IEs) (#9882).\n\t\t\t\t!titleText && append( element, titleText = new CKEDITOR.htmlParser.text() );\n\n\t\t\t\t// Transfer data-saved title to title tag.\n\t\t\t\ttitleText.value = element.attributes[ 'data-cke-title' ] || '';\n\t\t\t},\n\n\t\t\tinput: unprotectReadyOnly,\n\t\t\ttextarea: unprotectReadyOnly\n\t\t},\n\n\t\tattributes: {\n\t\t\t'class': function( value ) {\n\t\t\t\t// Remove all class names starting with \"cke_\".\n\t\t\t\treturn CKEDITOR.tools.ltrim( value.replace( /(?:^|\\s+)cke_[^\\s]*/g, '' ) ) || false;\n\t\t\t}\n\t\t}\n\t};\n\n\tif ( CKEDITOR.env.ie ) {\n\t\t// IE outputs style attribute in capital letters. We should convert\n\t\t// them back to lower case, while not hurting the values (#5930)\n\t\tdefaultHtmlFilterRulesForAll.attributes.style = function( value ) {\n\t\t\treturn value.replace( /(^|;)([^\\:]+)/g, function( match ) {\n\t\t\t\treturn match.toLowerCase();\n\t\t\t} );\n\t\t};\n\t}\n\n\t// Disable form elements editing mode provided by some browsers. (#5746)\n\tfunction unprotectReadyOnly( element ) {\n\t\tvar attrs = element.attributes;\n\t\tswitch ( attrs[ 'data-cke-editable' ] ) {\n\t\t\tcase 'true':\n\t\t\t\tattrs.contenteditable = 'true';\n\t\t\t\tbreak;\n\t\t\tcase '1':\n\t\t\t\tdelete attrs.contenteditable;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t//\n\t// Preprocessor filters ---------------------------------------------------\n\t//\n\n\tvar protectElementRegex = /<(a|area|img|input|source)\\b([^>]*)>/gi,\n\t\t// Be greedy while looking for protected attributes. This will let us avoid an unfortunate\n\t\t// situation when \"nested attributes\", which may appear valid, are also protected.\n\t\t// I.e. if we consider the following HTML:\n\t\t//\n\t\t// \t<img data-x=\"&lt;a href=&quot;X&quot;\" />\n\t\t//\n\t\t// then the \"non-greedy match\" returns:\n\t\t//\n\t\t// \t'href' => '&quot;X&quot;' // It's wrong! Href is not an attribute of <img>.\n\t\t//\n\t\t// while greedy match returns:\n\t\t//\n\t\t// \t'data-x' => '&lt;a href=&quot;X&quot;'\n\t\t//\n\t\t// which, can be easily filtered out (#11508).\n\t\tprotectAttributeRegex = /([\\w-:]+)\\s*=\\s*(?:(?:\"[^\"]*\")|(?:'[^']*')|(?:[^ \"'>]+))/gi,\n\t\tprotectAttributeNameRegex = /^(href|src|name)$/i;\n\n\t\t// Note: we use lazy star '*?' to prevent eating everything up to the last occurrence of </style> or </textarea>.\n\tvar protectElementsRegex = /(?:<style(?=[ >])[^>]*>[\\s\\S]*?<\\/style>)|(?:<(:?link|meta|base)[^>]*>)/gi,\n\t\tprotectTextareaRegex = /(<textarea(?=[ >])[^>]*>)([\\s\\S]*?)(?:<\\/textarea>)/gi,\n\t\tencodedElementsRegex = /<cke:encoded>([^<]*)<\\/cke:encoded>/gi;\n\n\tvar protectElementNamesRegex = /(<\\/?)((?:object|embed|param|html|body|head|title)[^>]*>)/gi,\n\t\tunprotectElementNamesRegex = /(<\\/?)cke:((?:html|body|head|title)[^>]*>)/gi;\n\n\tvar protectSelfClosingRegex = /<cke:(param|embed)([^>]*?)\\/?>(?!\\s*<\\/cke:\\1)/gi;\n\n\tfunction protectAttributes( html ) {\n\t\treturn html.replace( protectElementRegex, function( element, tag, attributes ) {\n\t\t\treturn '<' + tag + attributes.replace( protectAttributeRegex, function( fullAttr, attrName ) {\n\t\t\t\t// Avoid corrupting the inline event attributes (#7243).\n\t\t\t\t// We should not rewrite the existed protected attributes, e.g. clipboard content from editor. (#5218)\n\t\t\t\tif ( protectAttributeNameRegex.test( attrName ) && attributes.indexOf( 'data-cke-saved-' + attrName ) == -1 )\n\t\t\t\t\treturn ' data-cke-saved-' + fullAttr + ' data-cke-' + CKEDITOR.rnd + '-' + fullAttr;\n\n\t\t\t\treturn fullAttr;\n\t\t\t} ) + '>';\n\t\t} );\n\t}\n\n\tfunction protectElements( html, regex ) {\n\t\treturn html.replace( regex, function( match, tag, content ) {\n\t\t\t// Encode < and > in textarea because this won't be done by a browser, since\n\t\t\t// textarea will be protected during passing data through fix bin.\n\t\t\tif ( match.indexOf( '<textarea' ) === 0 )\n\t\t\t\tmatch = tag + unprotectRealComments( content ).replace( /</g, '&lt;' ).replace( />/g, '&gt;' ) + '</textarea>';\n\n\t\t\treturn '<cke:encoded>' + encodeURIComponent( match ) + '</cke:encoded>';\n\t\t} );\n\t}\n\n\tfunction unprotectElements( html ) {\n\t\treturn html.replace( encodedElementsRegex, function( match, encoded ) {\n\t\t\treturn decodeURIComponent( encoded );\n\t\t} );\n\t}\n\n\tfunction protectElementsNames( html ) {\n\t\treturn html.replace( protectElementNamesRegex, '$1cke:$2' );\n\t}\n\n\tfunction unprotectElementNames( html ) {\n\t\treturn html.replace( unprotectElementNamesRegex, '$1$2' );\n\t}\n\n\tfunction protectSelfClosingElements( html ) {\n\t\treturn html.replace( protectSelfClosingRegex, '<cke:$1$2></cke:$1>' );\n\t}\n\n\tfunction protectPreFormatted( html ) {\n\t\treturn html.replace( /(<pre\\b[^>]*>)(\\r\\n|\\n)/g, '$1$2$2' );\n\t}\n\n\tfunction protectRealComments( html ) {\n\t\treturn html.replace( /<!--(?!{cke_protected})[\\s\\S]+?-->/g, function( match ) {\n\t\t\treturn '<!--' + protectedSourceMarker +\n\t\t\t\t'{C}' +\n\t\t\t\tencodeURIComponent( match ).replace( /--/g, '%2D%2D' ) +\n\t\t\t\t'-->';\n\t\t} );\n\t}\n\n\t// Replace all \"on\\w{3,}\" strings which are not:\n\t// * opening tags - e.g. `<onfoo`,\n\t// * closing tags - e.g. </onfoo> (tested in \"false positive 1\"),\n\t// * part of other attribute - e.g. `data-onfoo` or `fonfoo`.\n\tfunction protectInsecureAttributes( html ) {\n\t\treturn html.replace( /([^a-z0-9<\\-])(on\\w{3,})(?!>)/gi, '$1data-cke-' + CKEDITOR.rnd + '-$2' );\n\t}\n\n\tfunction unprotectRealComments( html ) {\n\t\treturn html.replace( /<!--\\{cke_protected\\}\\{C\\}([\\s\\S]+?)-->/g, function( match, data ) {\n\t\t\treturn decodeURIComponent( data );\n\t\t} );\n\t}\n\n\tfunction unprotectSource( html, editor ) {\n\t\tvar store = editor._.dataStore;\n\n\t\treturn html.replace( /<!--\\{cke_protected\\}([\\s\\S]+?)-->/g, function( match, data ) {\n\t\t\treturn decodeURIComponent( data );\n\t\t} ).replace( /\\{cke_protected_(\\d+)\\}/g, function( match, id ) {\n\t\t\treturn store && store[ id ] || '';\n\t\t} );\n\t}\n\n\tfunction protectSource( data, editor ) {\n\t\tvar protectedHtml = [],\n\t\t\tprotectRegexes = editor.config.protectedSource,\n\t\t\tstore = editor._.dataStore || ( editor._.dataStore = { id: 1 } ),\n\t\t\ttempRegex = /<\\!--\\{cke_temp(comment)?\\}(\\d*?)-->/g;\n\n\t\tvar regexes = [\n\t\t\t// Script tags will also be forced to be protected, otherwise\n\t\t\t// IE will execute them.\n\t\t\t( /<script[\\s\\S]*?(<\\/script>|$)/gi ),\n\n\t\t\t// <noscript> tags (get lost in IE and messed up in FF).\n\t\t\t/<noscript[\\s\\S]*?<\\/noscript>/gi,\n\n\t\t\t// Avoid meta tags being stripped (#8117).\n\t\t\t/<meta[\\s\\S]*?\\/?>/gi\n\t\t].concat( protectRegexes );\n\n\t\t// First of any other protection, we must protect all comments\n\t\t// to avoid loosing them (of course, IE related).\n\t\t// Note that we use a different tag for comments, as we need to\n\t\t// transform them when applying filters.\n\t\tdata = data.replace( ( /<!--[\\s\\S]*?-->/g ), function( match ) {\n\t\t\treturn '<!--{cke_tempcomment}' + ( protectedHtml.push( match ) - 1 ) + '-->';\n\t\t} );\n\n\t\tfor ( var i = 0; i < regexes.length; i++ ) {\n\t\t\tdata = data.replace( regexes[ i ], function( match ) {\n\t\t\t\tmatch = match.replace( tempRegex, // There could be protected source inside another one. (#3869).\n\t\t\t\tfunction( $, isComment, id ) {\n\t\t\t\t\treturn protectedHtml[ id ];\n\t\t\t\t} );\n\n\t\t\t\t// Avoid protecting over protected, e.g. /\\{.*?\\}/\n\t\t\t\treturn ( /cke_temp(comment)?/ ).test( match ) ? match : '<!--{cke_temp}' + ( protectedHtml.push( match ) - 1 ) + '-->';\n\t\t\t} );\n\t\t}\n\t\tdata = data.replace( tempRegex, function( $, isComment, id ) {\n\t\t\treturn '<!--' + protectedSourceMarker +\n\t\t\t\t( isComment ? '{C}' : '' ) +\n\t\t\t\tencodeURIComponent( protectedHtml[ id ] ).replace( /--/g, '%2D%2D' ) +\n\t\t\t\t'-->';\n\t\t} );\n\n\t\t// Different protection pattern is used for those that\n\t\t// live in attributes to avoid from being HTML encoded.\n\t\t// Why so serious? See #9205, #8216, #7805, #11754, #11846.\n\t\tdata = data.replace( /<\\w+(?:\\s+(?:(?:[^\\s=>]+\\s*=\\s*(?:[^'\"\\s>]+|'[^']*'|\"[^\"]*\"))|[^\\s=\\/>]+))+\\s*\\/?>/g, function( match ) {\n\t\t\treturn match.replace( /<!--\\{cke_protected\\}([^>]*)-->/g, function( match, data ) {\n\t\t\t\tstore[ store.id ] = decodeURIComponent( data );\n\t\t\t\treturn '{cke_protected_' + ( store.id++ ) + '}';\n\t\t\t} );\n\t\t} );\n\n\t\t// This RegExp searches for innerText in all the title/iframe/textarea elements.\n\t\t// This is because browser doesn't allow HTML in these elements, that's why we can't\n\t\t// nest comments in there. (#11223)\n\t\tdata = data.replace( /<(title|iframe|textarea)([^>]*)>([\\s\\S]*?)<\\/\\1>/g, function( match, tagName, tagAttributes, innerText ) {\n\t\t\treturn '<' + tagName + tagAttributes + '>' + unprotectSource( unprotectRealComments( innerText ), editor ) + '</' + tagName + '>';\n\t\t} );\n\n\t\treturn data;\n\t}\n\n\t// Creates a block if the root element is empty.\n\tfunction fixEmptyRoot( root, fixBodyTag ) {\n\t\tif ( !root.children.length && CKEDITOR.dtd[ root.name ][ fixBodyTag ] ) {\n\t\t\tvar fixBodyElement = new CKEDITOR.htmlParser.element( fixBodyTag );\n\t\t\troot.add( fixBodyElement );\n\t\t}\n\t}\n} )();\n\n/**\n * Whether a filler text (non-breaking space entity &mdash; `&nbsp;`) will be\n * inserted into empty block elements in HTML output.\n * This is used to render block elements properly with `line-height`.\n * When a function is specified instead, it will be passed a {@link CKEDITOR.htmlParser.element}\n * to decide whether adding the filler text by expecting a Boolean return value.\n *\n *\t\tconfig.fillEmptyBlocks = false; // Prevent filler nodes in all empty blocks.\n *\n *\t\t// Prevent filler node only in float cleaners.\n *\t\tconfig.fillEmptyBlocks = function( element ) {\n *\t\t\tif ( element.attributes[ 'class' ].indexOf( 'clear-both' ) != -1 )\n *\t\t\t\treturn false;\n *\t\t};\n *\n * @since 3.5\n * @cfg {Boolean/Function} [fillEmptyBlocks=true]\n * @member CKEDITOR.config\n */\n\n/**\n * This event is fired by the {@link CKEDITOR.htmlDataProcessor} when input HTML\n * is to be purified by the {@link CKEDITOR.htmlDataProcessor#toHtml} method.\n *\n * By adding listeners with different priorities it is possible\n * to process input HTML on different stages:\n *\n *\t* 1-4: Data is available in the original string format.\n *\t* 5: Data is initially filtered with regexp patterns and parsed to\n *\t\t{@link CKEDITOR.htmlParser.fragment} {@link CKEDITOR.htmlParser.element}.\n *\t* 5-9: Data is available in the parsed format, but {@link CKEDITOR.htmlDataProcessor#dataFilter}\n *\t\tis not applied yet.\n *\t* 6: Data is filtered with the {CKEDITOR.filter content filter}.\n *\t* 10: Data is processed with {@link CKEDITOR.htmlDataProcessor#dataFilter}.\n *\t* 10-14: Data is available in the parsed format and {@link CKEDITOR.htmlDataProcessor#dataFilter}\n *\t\thas already been applied.\n *\t* 15: Data is written back to an HTML string.\n *\t* 15-*: Data is available in an HTML string.\n *\n * For example to be able to process parsed, but not yet filtered data add listener this way:\n *\n *\t\teditor.on( 'toHtml', function( evt) {\n *\t\t\tevt.data.dataValue; // -> CKEDITOR.htmlParser.fragment instance\n *\t\t}, null, null, 7 );\n *\n * @since 4.1\n * @event toHtml\n * @member CKEDITOR.editor\n * @param {CKEDITOR.editor} editor This editor instance.\n * @param data\n * @param {String/CKEDITOR.htmlParser.fragment/CKEDITOR.htmlParser.element} data.dataValue Input data to be purified.\n * @param {String} data.context See {@link CKEDITOR.htmlDataProcessor#toHtml} The `context` argument.\n * @param {Boolean} data.fixForBody See {@link CKEDITOR.htmlDataProcessor#toHtml} The `fixForBody` argument.\n * @param {Boolean} data.dontFilter See {@link CKEDITOR.htmlDataProcessor#toHtml} The `dontFilter` argument.\n * @param {Boolean} data.filter See {@link CKEDITOR.htmlDataProcessor#toHtml} The `filter` argument.\n * @param {Boolean} data.enterMode See {@link CKEDITOR.htmlDataProcessor#toHtml} The `enterMode` argument.\n * @param {Boolean} [data.protectedWhitespaces] See {@link CKEDITOR.htmlDataProcessor#toHtml} The `protectedWhitespaces` argument.\n */\n\n/**\n * This event is fired when {@link CKEDITOR.htmlDataProcessor} is converting\n * internal HTML to output data HTML.\n *\n * By adding listeners with different priorities it is possible\n * to process input HTML on different stages:\n *\n *\t* 1-4: Data is available in the original string format.\n *\t* 5: Data is initially filtered with regexp patterns and parsed to\n *\t\t{@link CKEDITOR.htmlParser.fragment} {@link CKEDITOR.htmlParser.element}.\n *\t* 5-9: Data is available in the parsed format, but {@link CKEDITOR.htmlDataProcessor#htmlFilter}\n *\t\tis not applied yet.\n *\t* 10: Data is filtered with {@link CKEDITOR.htmlDataProcessor#htmlFilter}.\n *  * 11: Data is filtered with the {CKEDITOR.filter content filter} (on output the content filter makes\n *\t\tonly transformations, without filtering).\n *\t* 10-14: Data is available in the parsed format and {@link CKEDITOR.htmlDataProcessor#htmlFilter}\n *\t\thas already been applied.\n *\t* 15: Data is written back to an HTML string.\n *\t* 15-*: Data is available in an HTML string.\n *\n * For example to be able to process parsed and already processed data add listener this way:\n *\n *\t\teditor.on( 'toDataFormat', function( evt) {\n *\t\t\tevt.data.dataValue; // -> CKEDITOR.htmlParser.fragment instance\n *\t\t}, null, null, 12 );\n *\n * @since 4.1\n * @event toDataFormat\n * @member CKEDITOR.editor\n * @param {CKEDITOR.editor} editor This editor instance.\n * @param data\n * @param {String/CKEDITOR.htmlParser.fragment/CKEDITOR.htmlParser.element} data.dataValue Output data to be prepared.\n * @param {String} data.context See {@link CKEDITOR.htmlDataProcessor#toDataFormat} The `context` argument.\n * @param {Boolean} data.filter See {@link CKEDITOR.htmlDataProcessor#toDataFormat} The `filter` argument.\n * @param {Boolean} data.enterMode See {@link CKEDITOR.htmlDataProcessor#toDataFormat} The `enterMode` argument.\n */\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/htmldataprocessor.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n'use strict';\n\n/**\n * A lightweight representation of an HTML element.\n *\n * @class\n * @extends CKEDITOR.htmlParser.node\n * @constructor Creates an element class instance.\n * @param {String} name The element name.\n * @param {Object} attributes An object storing all attributes defined for\n * this element.\n */\nCKEDITOR.htmlParser.element = function( name, attributes ) {\n\t/**\n\t * The element name.\n\t *\n\t * @property {String}\n\t */\n\tthis.name = name;\n\n\t/**\n\t * Stores the attributes defined for this element.\n\t *\n\t * @property {Object}\n\t */\n\tthis.attributes = attributes || {};\n\n\t/**\n\t * The nodes that are direct children of this element.\n\t */\n\tthis.children = [];\n\n\t// Reveal the real semantic of our internal custom tag name (#6639),\n\t// when resolving whether it's block like.\n\tvar realName = name || '',\n\t\tprefixed = realName.match( /^cke:(.*)/ );\n\tprefixed && ( realName = prefixed[ 1 ] );\n\n\tvar isBlockLike = !!( CKEDITOR.dtd.$nonBodyContent[ realName ] || CKEDITOR.dtd.$block[ realName ] ||\n\t\tCKEDITOR.dtd.$listItem[ realName ] || CKEDITOR.dtd.$tableContent[ realName ] ||\n\t\tCKEDITOR.dtd.$nonEditable[ realName ] || realName == 'br' );\n\n\tthis.isEmpty = !!CKEDITOR.dtd.$empty[ name ];\n\tthis.isUnknown = !CKEDITOR.dtd[ name ];\n\n\t/** @private */\n\tthis._ = {\n\t\tisBlockLike: isBlockLike,\n\t\thasInlineStarted: this.isEmpty || !isBlockLike\n\t};\n};\n\n/**\n * Object presentation of CSS style declaration text.\n *\n * @class\n * @constructor Creates a `cssStyle` class instance.\n * @param {CKEDITOR.htmlParser.element/String} elementOrStyleText\n * An HTML parser element or the inline style text.\n */\nCKEDITOR.htmlParser.cssStyle = function() {\n\tvar styleText,\n\t\targ = arguments[ 0 ],\n\t\trules = {};\n\n\tstyleText = arg instanceof CKEDITOR.htmlParser.element ? arg.attributes.style : arg;\n\n\t// html-encoded quote might be introduced by 'font-family'\n\t// from MS-Word which confused the following regexp. e.g.\n\t//'font-family: &quot;Lucida, Console&quot;'\n\t// TODO reuse CSS methods from tools.\n\t( styleText || '' ).replace( /&quot;/g, '\"' ).replace( /\\s*([^ :;]+)\\s*:\\s*([^;]+)\\s*(?=;|$)/g, function( match, name, value ) {\n\t\tname == 'font-family' && ( value = value.replace( /[\"']/g, '' ) );\n\t\trules[ name.toLowerCase() ] = value;\n\t} );\n\n\treturn {\n\n\t\trules: rules,\n\n\t\t/**\n\t\t * Applies the styles to the specified element or object.\n\t\t *\n\t\t * @param {CKEDITOR.htmlParser.element/CKEDITOR.dom.element/Object} obj\n\t\t */\n\t\tpopulate: function( obj ) {\n\t\t\tvar style = this.toString();\n\t\t\tif ( style )\n\t\t\t\tobj instanceof CKEDITOR.dom.element ? obj.setAttribute( 'style', style ) : obj instanceof CKEDITOR.htmlParser.element ? obj.attributes.style = style : obj.style = style;\n\n\t\t},\n\n\t\t/**\n\t\t * Serializes CSS style declaration to a string.\n\t\t *\n\t\t * @returns {String}\n\t\t */\n\t\ttoString: function() {\n\t\t\tvar output = [];\n\t\t\tfor ( var i in rules )\n\t\t\t\trules[ i ] && output.push( i, ':', rules[ i ], ';' );\n\t\t\treturn output.join( '' );\n\t\t}\n\t};\n};\n\n/** @class CKEDITOR.htmlParser.element */\n( function() {\n\t// Used to sort attribute entries in an array, where the first element of\n\t// each object is the attribute name.\n\tvar sortAttribs = function( a, b ) {\n\t\t\ta = a[ 0 ];\n\t\t\tb = b[ 0 ];\n\t\t\treturn a < b ? -1 : a > b ? 1 : 0;\n\t\t},\n\t\tfragProto = CKEDITOR.htmlParser.fragment.prototype;\n\n\tCKEDITOR.htmlParser.element.prototype = CKEDITOR.tools.extend( new CKEDITOR.htmlParser.node(), {\n\t\t/**\n\t\t * The node type. This is a constant value set to {@link CKEDITOR#NODE_ELEMENT}.\n\t\t *\n\t\t * @readonly\n\t\t * @property {Number} [=CKEDITOR.NODE_ELEMENT]\n\t\t */\n\t\ttype: CKEDITOR.NODE_ELEMENT,\n\n\t\t/**\n\t\t * Adds a node to the element children list.\n\t\t *\n\t\t * @method\n\t\t * @param {CKEDITOR.htmlParser.node} node The node to be added.\n\t\t * @param {Number} [index] From where the insertion happens.\n\t\t */\n\t\tadd: fragProto.add,\n\n\t\t/**\n\t\t * Clones this element.\n\t\t *\n\t\t * @returns {CKEDITOR.htmlParser.element} The element clone.\n\t\t */\n\t\tclone: function() {\n\t\t\treturn new CKEDITOR.htmlParser.element( this.name, this.attributes );\n\t\t},\n\n\t\t/**\n\t\t * Filters this element and its children with the given filter.\n\t\t *\n\t\t * @since 4.1\n\t\t * @param {CKEDITOR.htmlParser.filter} filter\n\t\t * @returns {Boolean} The method returns `false` when this element has\n\t\t * been removed or replaced with another. This information means that\n\t\t * {@link #filterChildren} has to repeat the filter on the current\n\t\t * position in parent's children array.\n\t\t */\n\t\tfilter: function( filter, context ) {\n\t\t\tvar element = this,\n\t\t\t\toriginalName, name;\n\n\t\t\tcontext = element.getFilterContext( context );\n\n\t\t\t// Do not process elements with data-cke-processor attribute set to off.\n\t\t\tif ( context.off )\n\t\t\t\treturn true;\n\n\t\t\t// Filtering if it's the root node.\n\t\t\tif ( !element.parent )\n\t\t\t\tfilter.onRoot( context, element );\n\n\t\t\twhile ( true ) {\n\t\t\t\toriginalName = element.name;\n\n\t\t\t\tif ( !( name = filter.onElementName( context, originalName ) ) ) {\n\t\t\t\t\tthis.remove();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\telement.name = name;\n\n\t\t\t\tif ( !( element = filter.onElement( context, element ) ) ) {\n\t\t\t\t\tthis.remove();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// New element has been returned - replace current one\n\t\t\t\t// and process it (stop processing this and return false, what\n\t\t\t\t// means that element has been removed).\n\t\t\t\tif ( element !== this ) {\n\t\t\t\t\tthis.replaceWith( element );\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// If name has been changed - continue loop, so in next iteration\n\t\t\t\t// filters for new name will be applied to this element.\n\t\t\t\t// If name hasn't been changed - stop.\n\t\t\t\tif ( element.name == originalName )\n\t\t\t\t\tbreak;\n\n\t\t\t\t// If element has been replaced with something of a\n\t\t\t\t// different type, then make the replacement filter itself.\n\t\t\t\tif ( element.type != CKEDITOR.NODE_ELEMENT ) {\n\t\t\t\t\tthis.replaceWith( element );\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// This indicate that the element has been dropped by\n\t\t\t\t// filter but not the children.\n\t\t\t\tif ( !element.name ) {\n\t\t\t\t\tthis.replaceWithChildren();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar attributes = element.attributes,\n\t\t\t\ta, value, newAttrName;\n\n\t\t\tfor ( a in attributes ) {\n\t\t\t\tnewAttrName = a;\n\t\t\t\tvalue = attributes[ a ];\n\n\t\t\t\t// Loop until name isn't modified.\n\t\t\t\t// A little bit senseless, but IE would do that anyway\n\t\t\t\t// because it iterates with for-in loop even over properties\n\t\t\t\t// created during its run.\n\t\t\t\twhile ( true ) {\n\t\t\t\t\tif ( !( newAttrName = filter.onAttributeName( context, a ) ) ) {\n\t\t\t\t\t\tdelete attributes[ a ];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else if ( newAttrName != a ) {\n\t\t\t\t\t\tdelete attributes[ a ];\n\t\t\t\t\t\ta = newAttrName;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( newAttrName ) {\n\t\t\t\t\tif ( ( value = filter.onAttribute( context, element, newAttrName, value ) ) === false )\n\t\t\t\t\t\tdelete attributes[ newAttrName ];\n\t\t\t\t\telse\n\t\t\t\t\t\tattributes[ newAttrName ] = value;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( !element.isEmpty )\n\t\t\t\tthis.filterChildren( filter, false, context );\n\n\t\t\treturn true;\n\t\t},\n\n\t\t/**\n\t\t * Filters this element's children with the given filter.\n\t\t *\n\t\t * Element's children may only be filtered once by one\n\t\t * instance of the filter.\n\t\t *\n\t\t * @method filterChildren\n\t\t * @param {CKEDITOR.htmlParser.filter} filter\n\t\t */\n\t\tfilterChildren: fragProto.filterChildren,\n\n\t\t/**\n\t\t * Writes the element HTML to the CKEDITOR.htmlWriter.\n\t\t *\n\t\t * @param {CKEDITOR.htmlParser.basicWriter} writer The writer to which HTML will be written.\n\t\t * @param {CKEDITOR.htmlParser.filter} [filter] The filter to be applied to this node.\n\t\t * **Note:** It is unsafe to filter an offline (not appended) node.\n\t\t */\n\t\twriteHtml: function( writer, filter ) {\n\t\t\tif ( filter )\n\t\t\t\tthis.filter( filter );\n\n\t\t\tvar name = this.name,\n\t\t\t\tattribsArray = [],\n\t\t\t\tattributes = this.attributes,\n\t\t\t\tattrName,\n\t\t\t\tattr, i, l;\n\n\t\t\t// Open element tag.\n\t\t\twriter.openTag( name, attributes );\n\n\t\t\t// Copy all attributes to an array.\n\t\t\tfor ( attrName in attributes )\n\t\t\t\tattribsArray.push( [ attrName, attributes[ attrName ] ] );\n\n\t\t\t// Sort the attributes by name.\n\t\t\tif ( writer.sortAttributes )\n\t\t\t\tattribsArray.sort( sortAttribs );\n\n\t\t\t// Send the attributes.\n\t\t\tfor ( i = 0, l = attribsArray.length; i < l; i++ ) {\n\t\t\t\tattr = attribsArray[ i ];\n\t\t\t\twriter.attribute( attr[ 0 ], attr[ 1 ] );\n\t\t\t}\n\n\t\t\t// Close the tag.\n\t\t\twriter.openTagClose( name, this.isEmpty );\n\n\t\t\tthis.writeChildrenHtml( writer );\n\n\t\t\t// Close the element.\n\t\t\tif ( !this.isEmpty )\n\t\t\t\twriter.closeTag( name );\n\t\t},\n\n\t\t/**\n\t\t * Sends children of this element to the writer.\n\t\t *\n\t\t * @param {CKEDITOR.htmlParser.basicWriter} writer The writer to which HTML will be written.\n\t\t * @param {CKEDITOR.htmlParser.filter} [filter]\n\t\t */\n\t\twriteChildrenHtml: fragProto.writeChildrenHtml,\n\n\t\t/**\n\t\t * Replaces this element with its children.\n\t\t *\n\t\t * @since 4.1\n\t\t */\n\t\treplaceWithChildren: function() {\n\t\t\tvar children = this.children;\n\n\t\t\tfor ( var i = children.length; i; )\n\t\t\t\tchildren[ --i ].insertAfter( this );\n\n\t\t\tthis.remove();\n\t\t},\n\n\t\t/**\n\t\t * Executes a callback on each node (of the given type) in this element.\n\t\t *\n\t\t *\t\t// Create a <p> element with foo<b>bar</b>bom as its content.\n\t\t *\t\tvar elP = CKEDITOR.htmlParser.fragment.fromHtml( 'foo<b>bar</b>bom', 'p' );\n\t\t *\t\telP.forEach( function( node ) {\n\t\t *\t\t\tconsole.log( node );\n\t\t *\t\t} );\n\t\t *\t\t// Will log:\n\t\t *\t\t// 1. document fragment,\n\t\t *\t\t// 2. <p> element,\n\t\t *\t\t// 3. \"foo\" text node,\n\t\t *\t\t// 4. <b> element,\n\t\t *\t\t// 5. \"bar\" text node,\n\t\t *\t\t// 6. \"bom\" text node.\n\t\t *\n\t\t * @since 4.1\n\t\t * @param {Function} callback Function to be executed on every node.\n\t\t * **Since 4.3**: If `callback` returned `false`, the descendants of the current node will be ignored.\n\t\t * @param {CKEDITOR.htmlParser.node} callback.node Node passed as an argument.\n\t\t * @param {Number} [type] Whether the specified `callback` will be executed only on nodes of this type.\n\t\t * @param {Boolean} [skipRoot] Do not execute `callback` on this element.\n\t\t */\n\t\tforEach: fragProto.forEach,\n\n\t\t/**\n\t\t * Gets this element's first child. If `condition` is given, this method returns\n\t\t * the first child which satisfies that condition.\n\t\t *\n\t\t * @since 4.3\n\t\t * @param {String/Object/Function} condition Name of a child, a hash of names, or a validator function.\n\t\t * @returns {CKEDITOR.htmlParser.node}\n\t\t */\n\t\tgetFirst: function( condition ) {\n\t\t\tif ( !condition )\n\t\t\t\treturn this.children.length ? this.children[ 0 ] : null;\n\n\t\t\tif ( typeof condition != 'function' )\n\t\t\t\tcondition = nameCondition( condition );\n\n\t\t\tfor ( var i = 0, l = this.children.length; i < l; ++i ) {\n\t\t\t\tif ( condition( this.children[ i ] ) )\n\t\t\t\t\treturn this.children[ i ];\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\n\t\t/**\n\t\t * Gets this element's inner HTML.\n\t\t *\n\t\t * @since 4.3\n\t\t * @returns {String}\n\t\t */\n\t\tgetHtml: function() {\n\t\t\tvar writer = new CKEDITOR.htmlParser.basicWriter();\n\t\t\tthis.writeChildrenHtml( writer );\n\t\t\treturn writer.getHtml();\n\t\t},\n\n\t\t/**\n\t\t * Sets this element's inner HTML.\n\t\t *\n\t\t * @since 4.3\n\t\t * @param {String} html\n\t\t */\n\t\tsetHtml: function( html ) {\n\t\t\tvar children = this.children = CKEDITOR.htmlParser.fragment.fromHtml( html ).children;\n\n\t\t\tfor ( var i = 0, l = children.length; i < l; ++i )\n\t\t\t\tchildren[ i ].parent = this;\n\t\t},\n\n\t\t/**\n\t\t * Gets this element's outer HTML.\n\t\t *\n\t\t * @since 4.3\n\t\t * @returns {String}\n\t\t */\n\t\tgetOuterHtml: function() {\n\t\t\tvar writer = new CKEDITOR.htmlParser.basicWriter();\n\t\t\tthis.writeHtml( writer );\n\t\t\treturn writer.getHtml();\n\t\t},\n\n\t\t/**\n\t\t * Splits this element at the given index.\n\t\t *\n\t\t * @since 4.3\n\t\t * @param {Number} index Index at which the element will be split &mdash; `0` means the beginning,\n\t\t * `1` after first child node, etc.\n\t\t * @returns {CKEDITOR.htmlParser.element} The new element following this one.\n\t\t */\n\t\tsplit: function( index ) {\n\t\t\tvar cloneChildren = this.children.splice( index, this.children.length - index ),\n\t\t\t\tclone = this.clone();\n\n\t\t\tfor ( var i = 0; i < cloneChildren.length; ++i )\n\t\t\t\tcloneChildren[ i ].parent = clone;\n\n\t\t\tclone.children = cloneChildren;\n\n\t\t\tif ( cloneChildren[ 0 ] )\n\t\t\t\tcloneChildren[ 0 ].previous = null;\n\n\t\t\tif ( index > 0 )\n\t\t\t\tthis.children[ index - 1 ].next = null;\n\n\t\t\tthis.parent.add( clone, this.getIndex() + 1 );\n\n\t\t\treturn clone;\n\t\t},\n\n\t\t/**\n\t\t * Adds a class name to the list of classes.\n\t\t *\n\t\t * @since 4.4\n\t\t * @param {String} className The class name to be added.\n\t\t */\n\t\taddClass: function( className ) {\n\t\t\tif ( this.hasClass( className ) )\n\t\t\t\treturn;\n\n\t\t\tvar c = this.attributes[ 'class' ] || '';\n\n\t\t\tthis.attributes[ 'class' ] = c + ( c ? ' ' : '' ) + className;\n\t\t},\n\n\t\t/**\n\t\t * Removes a class name from the list of classes.\n\t\t *\n\t\t * @since 4.3\n\t\t * @param {String} className The class name to be removed.\n\t\t */\n\t\tremoveClass: function( className ) {\n\t\t\tvar classes = this.attributes[ 'class' ];\n\n\t\t\tif ( !classes )\n\t\t\t\treturn;\n\n\t\t\t// We can safely assume that className won't break regexp.\n\t\t\t// http://stackoverflow.com/questions/448981/what-characters-are-valid-in-css-class-names\n\t\t\tclasses = CKEDITOR.tools.trim( classes.replace( new RegExp( '(?:\\\\s+|^)' + className + '(?:\\\\s+|$)' ), ' ' ) );\n\n\t\t\tif ( classes )\n\t\t\t\tthis.attributes[ 'class' ] = classes;\n\t\t\telse\n\t\t\t\tdelete this.attributes[ 'class' ];\n\t\t},\n\n\t\t/**\n\t\t * Checkes whether this element has a class name.\n\t\t *\n\t\t * @since 4.3\n\t\t * @param {String} className The class name to be checked.\n\t\t * @returns {Boolean} Whether this element has a `className`.\n\t\t */\n\t\thasClass: function( className ) {\n\t\t\tvar classes = this.attributes[ 'class' ];\n\n\t\t\tif ( !classes )\n\t\t\t\treturn false;\n\n\t\t\treturn ( new RegExp( '(?:^|\\\\s)' + className + '(?=\\\\s|$)' ) ).test( classes );\n\t\t},\n\n\t\tgetFilterContext: function( ctx ) {\n\t\t\tvar changes = [];\n\n\t\t\tif ( !ctx ) {\n\t\t\t\tctx = {\n\t\t\t\t\toff: false,\n\t\t\t\t\tnonEditable: false,\n\t\t\t\t\tnestedEditable: false\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif ( !ctx.off && this.attributes[ 'data-cke-processor' ] == 'off' )\n\t\t\t\tchanges.push( 'off', true );\n\n\t\t\tif ( !ctx.nonEditable && this.attributes.contenteditable == 'false' )\n\t\t\t\tchanges.push( 'nonEditable', true );\n\t\t\t// A context to be given nestedEditable must be nonEditable first (by inheritance) (#11372, #11698).\n\t\t\t// Special case: #11504 - filter starts on <body contenteditable=true>,\n\t\t\t// so ctx.nonEditable has not been yet set to true.\n\t\t\telse if ( ctx.nonEditable && !ctx.nestedEditable && this.attributes.contenteditable == 'true' )\n\t\t\t\tchanges.push( 'nestedEditable', true );\n\n\t\t\tif ( changes.length ) {\n\t\t\t\tctx = CKEDITOR.tools.copy( ctx );\n\t\t\t\tfor ( var i = 0; i < changes.length; i += 2 )\n\t\t\t\t\tctx[ changes[ i ] ] = changes[ i + 1 ];\n\t\t\t}\n\n\t\t\treturn ctx;\n\t\t}\n\t}, true );\n\n\tfunction nameCondition( condition ) {\n\t\treturn function( el ) {\n\t\t\treturn el.type == CKEDITOR.NODE_ELEMENT &&\n\t\t\t\t( typeof condition == 'string' ? el.name == condition : el.name in condition );\n\t\t};\n\t}\n} )();\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/htmlparser/element.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Defines the {@link CKEDITOR.template} class, which represents\n * an UI template for an editor instance.\n */\n\n( function() {\n\tvar cache = {},\n\t\trePlaceholder = /{([^}]+)}/g,\n\t\treEscapableChars = /([\\\\'])/g,\n\t\treNewLine = /\\n/g,\n\t\treCarriageReturn = /\\r/g;\n\n\t/**\n\t * Lightweight template used to build the output string from variables.\n\t *\n\t *\t\t// HTML template for presenting a label UI.\n\t *\t\tvar tpl = new CKEDITOR.template( '<div class=\"{cls}\">{label}</div>' );\n\t *\t\talert( tpl.output( { cls: 'cke-label', label: 'foo'} ) ); // '<div class=\"cke-label\">foo</div>'\n\t *\n\t * @class\n\t * @constructor Creates a template class instance.\n\t * @param {String} source The template source.\n\t */\n\tCKEDITOR.template = function( source ) {\n\t\t// Builds an optimized function body for the output() method, focused on performance.\n\t\t// For example, if we have this \"source\":\n\t\t//\t'<div style=\"{style}\">{editorName}</div>'\n\t\t// ... the resulting function body will be (apart from the \"buffer\" handling):\n\t\t//\treturn [ '<div style=\"', data['style'] == undefined ? '{style}' : data['style'], '\">', data['editorName'] == undefined ? '{editorName}' : data['editorName'], '</div>' ].join('');\n\n\t\t// Try to read from the cache.\n\t\tif ( cache[ source ] )\n\t\t\tthis.output = cache[ source ];\n\t\telse {\n\t\t\tvar fn = source\n\t\t\t\t// Escape chars like slash \"\\\" or single quote \"'\".\n\t\t\t\t.replace( reEscapableChars, '\\\\$1' )\n\t\t\t\t.replace( reNewLine, '\\\\n' )\n\t\t\t\t.replace( reCarriageReturn, '\\\\r' )\n\t\t\t\t// Inject the template keys replacement.\n\t\t\t\t.replace( rePlaceholder, function( m, key ) {\n\t\t\t\t\treturn \"',data['\" + key + \"']==undefined?'{\" + key + \"}':data['\" + key + \"'],'\";\n\t\t\t\t} );\n\n\t\t\tfn = \"return buffer?buffer.push('\" + fn + \"'):['\" + fn + \"'].join('');\";\n\t\t\tthis.output = cache[ source ] = Function( 'data', 'buffer', fn );\n\t\t}\n\t};\n} )();\n\n/**\n * Processes the template, filling its variables with the provided data.\n *\n * @method output\n * @param {Object} data An object containing properties which values will be\n * used to fill the template variables. The property names must match the\n * template variables names. Variables without matching properties will be\n * kept untouched.\n * @param {Array} [buffer] An array into which the output data will be pushed into.\n * The number of entries appended to the array is unknown.\n * @returns {String/Number} If `buffer` has not been provided, the processed\n * template output data, otherwise the new length of `buffer`.\n */\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/template.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Contains the third and last part of the {@link CKEDITOR} object\n *\t\tdefinition.\n */\n\n/** @class CKEDITOR */\n\n// Remove the CKEDITOR.loadFullCore reference defined on ckeditor_basic.\ndelete CKEDITOR.loadFullCore;\n\n/**\n * Stores references to all editor instances created. The name of the properties\n * in this object correspond to instance names, and their values contain the\n * {@link CKEDITOR.editor} object representing them.\n *\n *\t\talert( CKEDITOR.instances.editor1.name ); // 'editor1'\n *\n * @property {Object}\n */\nCKEDITOR.instances = {};\n\n/**\n * The document of the window storing the CKEDITOR object.\n *\n *\t\talert( CKEDITOR.document.getBody().getName() ); // 'body'\n *\n * @property {CKEDITOR.dom.document}\n */\nCKEDITOR.document = new CKEDITOR.dom.document( document );\n\n/**\n * Adds an editor instance to the global {@link CKEDITOR} object. This function\n * is available for internal use mainly.\n *\n * @param {CKEDITOR.editor} editor The editor instance to be added.\n */\nCKEDITOR.add = function( editor ) {\n\tCKEDITOR.instances[ editor.name ] = editor;\n\n\teditor.on( 'focus', function() {\n\t\tif ( CKEDITOR.currentInstance != editor ) {\n\t\t\tCKEDITOR.currentInstance = editor;\n\t\t\tCKEDITOR.fire( 'currentInstance' );\n\t\t}\n\t} );\n\n\teditor.on( 'blur', function() {\n\t\tif ( CKEDITOR.currentInstance == editor ) {\n\t\t\tCKEDITOR.currentInstance = null;\n\t\t\tCKEDITOR.fire( 'currentInstance' );\n\t\t}\n\t} );\n\n\tCKEDITOR.fire( 'instance', null, editor );\n};\n\n/**\n * Removes an editor instance from the global {@link CKEDITOR} object. This function\n * is available for internal use only. External code must use {@link CKEDITOR.editor#method-destroy}.\n *\n * @private\n * @param {CKEDITOR.editor} editor The editor instance to be removed.\n */\nCKEDITOR.remove = function( editor ) {\n\tdelete CKEDITOR.instances[ editor.name ];\n};\n\n( function() {\n\tvar tpls = {};\n\n\t/**\n\t * Adds a named {@link CKEDITOR.template} instance to be reused among all editors.\n\t * This will return the existing one if a template with same name is already\n\t * defined. Additionally, it fires the \"template\" event to allow template source customization.\n\t *\n\t * @param {String} name The name which identifies a UI template.\n\t * @param {String} source The source string for constructing this template.\n\t * @returns {CKEDITOR.template} The created template instance.\n\t */\n\tCKEDITOR.addTemplate = function( name, source ) {\n\t\tvar tpl = tpls[ name ];\n\t\tif ( tpl )\n\t\t\treturn tpl;\n\n\t\t// Make it possible to customize the template through event.\n\t\tvar params = { name: name, source: source };\n\t\tCKEDITOR.fire( 'template', params );\n\n\t\treturn ( tpls[ name ] = new CKEDITOR.template( params.source ) );\n\t};\n\n\t/**\n\t * Retrieves a defined template created with {@link CKEDITOR#addTemplate}.\n\t *\n\t * @param {String} name The template name.\n\t */\n\tCKEDITOR.getTemplate = function( name ) {\n\t\treturn tpls[ name ];\n\t};\n} )();\n\n( function() {\n\tvar styles = [];\n\n\t/**\n\t * Adds CSS rules to be appended to the editor document.\n\t * This method is mostly used by plugins to add custom styles to the editor\n\t * document. For basic content styling the `contents.css` file should be\n\t * used instead.\n\t *\n\t * **Note:** This function should be called before the creation of editor instances.\n\t *\n\t *\t\t// Add styles for all headings inside editable contents.\n\t *\t\tCKEDITOR.addCss( '.cke_editable h1,.cke_editable h2,.cke_editable h3 { border-bottom: 1px dotted red }' );\n\t *\n\t * @param {String} css The style rules to be appended.\n\t * @see CKEDITOR.config#contentsCss\n\t */\n\tCKEDITOR.addCss = function( css ) {\n\t\tstyles.push( css );\n\t};\n\n\t/**\n\t * Returns a string will all CSS rules passed to the {@link CKEDITOR#addCss} method.\n\t *\n\t * @returns {String} A string containing CSS rules.\n\t */\n\tCKEDITOR.getCss = function() {\n\t\treturn styles.join( '\\n' );\n\t};\n} )();\n\n// Perform global clean up to free as much memory as possible\n// when there are no instances left\nCKEDITOR.on( 'instanceDestroyed', function() {\n\tif ( CKEDITOR.tools.isEmpty( this.instances ) )\n\t\tCKEDITOR.fire( 'reset' );\n} );\n\n// Load the bootstrap script.\nCKEDITOR.loader.load( '_bootstrap' ); // %REMOVE_LINE%\n\n// Tri-state constants.\n/**\n * Used to indicate the ON or ACTIVE state.\n *\n * @readonly\n * @property {Number} [=1]\n */\nCKEDITOR.TRISTATE_ON = 1;\n\n/**\n * Used to indicate the OFF or INACTIVE state.\n *\n * @readonly\n * @property {Number} [=2]\n */\nCKEDITOR.TRISTATE_OFF = 2;\n\n/**\n * Used to indicate the DISABLED state.\n *\n * @readonly\n * @property {Number} [=0]\n */\nCKEDITOR.TRISTATE_DISABLED = 0;\n\n/**\n * The editor which is currently active (has user focus).\n *\n *\t\tfunction showCurrentEditorName() {\n *\t\t\tif ( CKEDITOR.currentInstance )\n *\t\t\t\talert( CKEDITOR.currentInstance.name );\n *\t\t\telse\n *\t\t\t\talert( 'Please focus an editor first.' );\n *\t\t}\n *\n * @property {CKEDITOR.editor} currentInstance\n * @see CKEDITOR#event-currentInstance\n */\n\n/**\n * Fired when the CKEDITOR.currentInstance object reference changes. This may\n * happen when setting the focus on different editor instances in the page.\n *\n *\t\tvar editor; // A variable to store a reference to the current editor.\n *\t\tCKEDITOR.on( 'currentInstance', function() {\n *\t\t\teditor = CKEDITOR.currentInstance;\n *\t\t} );\n *\n * @event currentInstance\n */\n\n/**\n * Fired when the last instance has been destroyed. This event is used to perform\n * global memory cleanup.\n *\n * @event reset\n */\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/ckeditor.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n( function() {\n\t/** @class CKEDITOR */\n\n\t/**\n\t * Turns a DOM element with the `contenteditable` attribute set to `true` into a\n\t * CKEditor instance. Check {@link CKEDITOR.dtd#$editable} for a list of\n\t * allowed element names.\n\t *\n\t * **Note:** If the DOM element for which inline editing is being enabled does not have\n\t * the `contenteditable` attribute set to `true`, the editor will start in read-only mode.\n\t *\n\t *\t\t<div contenteditable=\"true\" id=\"content\">...</div>\n\t *\t\t...\n\t *\t\tCKEDITOR.inline( 'content' );\n\t *\n\t * It is also possible to create an inline editor from the `<textarea>` element.\n\t * If you do so, an additional `<div>` element with editable content will be created\n\t * directly after the `<textarea>` element and the `<textarea>` element will be hidden.\n\t *\n\t * @param {Object/String} element The DOM element or its ID.\n\t * @param {Object} [instanceConfig] The specific configurations to apply to this editor instance.\n\t * See {@link CKEDITOR.config}.\n\t * @returns {CKEDITOR.editor} The editor instance created.\n\t */\n\tCKEDITOR.inline = function( element, instanceConfig ) {\n\t\tif ( !CKEDITOR.env.isCompatible )\n\t\t\treturn null;\n\n\t\telement = CKEDITOR.dom.element.get( element );\n\n\t\t// Avoid multiple inline editor instances on the same element.\n\t\tif ( element.getEditor() )\n\t\t\tthrow 'The editor instance \"' + element.getEditor().name + '\" is already attached to the provided element.';\n\n\t\tvar editor = new CKEDITOR.editor( instanceConfig, element, CKEDITOR.ELEMENT_MODE_INLINE ),\n\t\t\ttextarea = element.is( 'textarea' ) ? element : null;\n\n\t\tif ( textarea ) {\n\t\t\teditor.setData( textarea.getValue(), null, true );\n\n\t\t\t//Change element from textarea to div\n\t\t\telement = CKEDITOR.dom.element.createFromHtml(\n\t\t\t\t'<div contenteditable=\"' + !!editor.readOnly + '\" class=\"cke_textarea_inline\">' +\n\t\t\t\t\ttextarea.getValue() +\n\t\t\t\t'</div>',\n\t\t\t\tCKEDITOR.document );\n\n\t\t\telement.insertAfter( textarea );\n\t\t\ttextarea.hide();\n\n\t\t\t// Attaching the concrete form.\n\t\t\tif ( textarea.$.form )\n\t\t\t\teditor._attachToForm();\n\t\t} else {\n\t\t\t// Initial editor data is simply loaded from the page element content to make\n\t\t\t// data retrieval possible immediately after the editor creation.\n\t\t\teditor.setData( element.getHtml(), null, true );\n\t\t}\n\n\t\t// Once the editor is loaded, start the UI.\n\t\teditor.on( 'loaded', function() {\n\t\t\teditor.fire( 'uiReady' );\n\n\t\t\t// Enable editing on the element.\n\t\t\teditor.editable( element );\n\n\t\t\t// Editable itself is the outermost element.\n\t\t\teditor.container = element;\n\t\t\teditor.ui.contentsElement = element;\n\n\t\t\t// Load and process editor data.\n\t\t\teditor.setData( editor.getData( 1 ) );\n\n\t\t\t// Clean on startup.\n\t\t\teditor.resetDirty();\n\n\t\t\teditor.fire( 'contentDom' );\n\n\t\t\t// Inline editing defaults to \"wysiwyg\" mode, so plugins don't\n\t\t\t// need to make special handling for this \"mode-less\" environment.\n\t\t\teditor.mode = 'wysiwyg';\n\t\t\teditor.fire( 'mode' );\n\n\t\t\t// The editor is completely loaded for interaction.\n\t\t\teditor.status = 'ready';\n\t\t\teditor.fireOnce( 'instanceReady' );\n\t\t\tCKEDITOR.fire( 'instanceReady', null, editor );\n\n\t\t\t// give priority to plugins that relay on editor#loaded for bootstrapping.\n\t\t}, null, null, 10000 );\n\n\t\t// Handle editor destroying.\n\t\teditor.on( 'destroy', function() {\n\t\t\t// Remove container from DOM if inline-textarea editor.\n\t\t\t// Show <textarea> back again.\n\t\t\tif ( textarea ) {\n\t\t\t\teditor.container.clearCustomData();\n\t\t\t\teditor.container.remove();\n\t\t\t\ttextarea.show();\n\t\t\t}\n\n\t\t\teditor.element.clearCustomData();\n\n\t\t\tdelete editor.element;\n\t\t} );\n\n\t\treturn editor;\n\t};\n\n\t/**\n\t * Calls {@link CKEDITOR#inline} for all page elements with\n\t * the `contenteditable` attribute set to `true`.\n\t *\n\t */\n\tCKEDITOR.inlineAll = function() {\n\t\tvar el, data;\n\n\t\tfor ( var name in CKEDITOR.dtd.$editable ) {\n\t\t\tvar elements = CKEDITOR.document.getElementsByTag( name );\n\n\t\t\tfor ( var i = 0, len = elements.count(); i < len; i++ ) {\n\t\t\t\tel = elements.getItem( i );\n\n\t\t\t\tif ( el.getAttribute( 'contenteditable' ) == 'true' ) {\n\t\t\t\t\t// Fire the \"inline\" event, making it possible to customize\n\t\t\t\t\t// the instance settings and eventually cancel the creation.\n\n\t\t\t\t\tdata = {\n\t\t\t\t\t\telement: el,\n\t\t\t\t\t\tconfig: {}\n\t\t\t\t\t};\n\n\t\t\t\t\tif ( CKEDITOR.fire( 'inline', data ) !== false )\n\t\t\t\t\t\tCKEDITOR.inline( el, data.config );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tCKEDITOR.domReady( function() {\n\t\t!CKEDITOR.disableAutoInline && CKEDITOR.inlineAll();\n\t} );\n} )();\n\n/**\n * Disables creating the inline editor automatically for elements with\n * the `contenteditable` attribute set to `true`.\n *\n *\t\tCKEDITOR.disableAutoInline = true;\n *\n * @cfg {Boolean} [disableAutoInline=false]\n */\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/creators/inline.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n /** @class CKEDITOR */\n\n/**\n * The class name used to identify `<textarea>` elements to be replaced\n * by CKEditor instances. Set it to empty/`null` to disable this feature.\n *\n *\t\tCKEDITOR.replaceClass = 'rich_editor';\n *\n * @cfg {String} [replaceClass='ckeditor']\n */\nCKEDITOR.replaceClass = 'ckeditor';\n\n( function() {\n\t/**\n\t * Replaces a `<textarea>` or a DOM element (`<div>`) with a CKEditor\n\t * instance. For textareas, the initial value in the editor will be the\n\t * textarea value. For DOM elements, their `innerHTML` will be used\n\t * instead. It is recommended to use `<textarea>` and `<div>` elements only.\n\t *\n\t *\t\t<textarea id=\"myfield\" name=\"myfield\"></textarea>\n\t *\t\t...\n\t *\t\tCKEDITOR.replace( 'myfield' );\n\t *\n\t *\t\tvar textarea = document.body.appendChild( document.createElement( 'textarea' ) );\n\t *\t\tCKEDITOR.replace( textarea );\n\t *\n\t * @param {Object/String} element The DOM element (textarea), its ID, or name.\n\t * @param {Object} [config] The specific configuration to apply to this\n\t * editor instance. Configuration set here will override the global CKEditor settings\n\t * (see {@link CKEDITOR.config}).\n\t * @returns {CKEDITOR.editor} The editor instance created.\n\t */\n\tCKEDITOR.replace = function( element, config ) {\n\t\treturn createInstance( element, config, null, CKEDITOR.ELEMENT_MODE_REPLACE );\n\t};\n\n\t/**\n\t * Creates a new editor instance at the end of a specific DOM element.\n\t *\n\t *\t\t<!DOCTYPE html>\n\t * \t\t<html>\n\t * \t\t\t<head>\n\t * \t\t\t\t<meta charset=\"utf-8\">\n\t * \t\t\t\t<title>CKEditor</title>\n\t * \t\t\t\t<!-- Make sure the path to CKEditor is correct. -->\n\t *\t\t\t\t<script src=\"/ckeditor/ckeditor.js\"></script>\n\t *\t\t\t</head>\n\t *\t\t\t<body>\n\t *\t\t\t\t<div id=\"editorSpace\"></div>\n\t *\t\t\t\t<script>\n\t *\t\t\t\t\tCKEDITOR.appendTo( 'editorSpace' );\n\t *\t\t\t\t</script>\n\t *\t\t\t</body>\n\t *\t\t</html>\n\t *\n\t * @param {Object/String} element The DOM element, its ID, or name.\n\t * @param {Object} [config] The specific configuration to apply to this\n\t * editor instance. Configuration set here will override the global CKEditor settings\n\t * (see {@link CKEDITOR.config}).\n\t * @param {String} [data] Since 3.3. Initial value for the instance.\n\t * @returns {CKEDITOR.editor} The editor instance created.\n\t */\n\tCKEDITOR.appendTo = function( element, config, data ) {\n\t\treturn createInstance( element, config, data, CKEDITOR.ELEMENT_MODE_APPENDTO );\n\t};\n\n\t/**\n\t * Replaces all `<textarea>` elements available in the document with\n\t * editor instances.\n\t *\n\t *\t\t// Replace all <textarea> elements in the page.\n\t *\t\tCKEDITOR.replaceAll();\n\t *\n\t *\t\t// Replace all <textarea class=\"myClassName\"> elements in the page.\n\t *\t\tCKEDITOR.replaceAll( 'myClassName' );\n\t *\n\t *\t\t// Selectively replace <textarea> elements, based on a custom evaluation function.\n\t *\t\tCKEDITOR.replaceAll( function( textarea, config ) {\n\t *\t\t\t// A function that needs to be evaluated for the <textarea>\n\t *\t\t\t// to be replaced. It must explicitly return \"false\" to ignore a\n\t *\t\t\t// specific <textarea>.\n\t *\t\t\t// You can also customize the editor instance by having the function\n\t *\t\t\t// modify the \"config\" parameter.\n\t *\t\t} );\n\t *\n\t *\t\t// Full page example where three <textarea> elements are replaced.\n\t *\t\t<!DOCTYPE html>\n\t *\t\t<html>\n\t *\t\t\t<head>\n\t *\t\t\t\t<meta charset=\"utf-8\">\n\t *\t\t\t\t<title>CKEditor</title>\n\t *\t\t\t\t<!-- Make sure the path to CKEditor is correct. -->\n\t *\t\t\t\t<script src=\"/ckeditor/ckeditor.js\"></script>\n\t *\t\t\t</head>\n\t *\t\t\t<body>\n\t *\t\t\t\t<textarea name=\"editor1\"></textarea>\n\t *\t\t\t\t<textarea name=\"editor2\"></textarea>\n\t *\t\t\t\t<textarea name=\"editor3\"></textarea>\n\t *\t\t\t\t<script>\n\t *\t\t\t\t\t// Replace all three <textarea> elements above with CKEditor instances.\n\t *\t\t\t\t\tCKEDITOR.replaceAll();\n\t *\t\t\t\t</script>\n\t *\t\t\t</body>\n\t *\t\t</html>\n\t *\n\t * @param {String} [className] The `<textarea>` class name.\n\t * @param {Function} [evaluator] An evaluation function that must return `true` for a `<textarea>`\n\t * to be replaced with the editor. If the function returns `false`, the `<textarea>` element\n\t * will not be replaced.\n\t */\n\tCKEDITOR.replaceAll = function() {\n\t\tvar textareas = document.getElementsByTagName( 'textarea' );\n\n\t\tfor ( var i = 0; i < textareas.length; i++ ) {\n\t\t\tvar config = null,\n\t\t\t\ttextarea = textareas[ i ];\n\n\t\t\t// The \"name\" and/or \"id\" attribute must exist.\n\t\t\tif ( !textarea.name && !textarea.id )\n\t\t\t\tcontinue;\n\n\t\t\tif ( typeof arguments[ 0 ] == 'string' ) {\n\t\t\t\t// The textarea class name could be passed as the function\n\t\t\t\t// parameter.\n\n\t\t\t\tvar classRegex = new RegExp( '(?:^|\\\\s)' + arguments[ 0 ] + '(?:$|\\\\s)' );\n\n\t\t\t\tif ( !classRegex.test( textarea.className ) )\n\t\t\t\t\tcontinue;\n\t\t\t} else if ( typeof arguments[ 0 ] == 'function' ) {\n\t\t\t\t// An evaluation function could be passed as the function parameter.\n\t\t\t\t// It must explicitly return \"false\" to ignore a specific <textarea>.\n\t\t\t\tconfig = {};\n\t\t\t\tif ( arguments[ 0 ]( textarea, config ) === false )\n\t\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.replace( textarea, config );\n\t\t}\n\t};\n\n\t/** @class CKEDITOR.editor */\n\n\t/**\n\t * Registers an editing mode. This function is to be used mainly by plugins.\n\t *\n\t * @param {String} mode The mode name.\n\t * @param {Function} exec The function that performs the actual mode change.\n\t */\n\tCKEDITOR.editor.prototype.addMode = function( mode, exec ) {\n\t\t( this._.modes || ( this._.modes = {} ) )[ mode ] = exec;\n\t};\n\n\t/**\n\t * Changes the editing mode of this editor instance.\n\t *\n\t * **Note:** The mode switch could be asynchronous depending on the mode provider.\n\t * Use the `callback` to hook subsequent code.\n\t *\n\t *\t\t// Switch to \"source\" view.\n\t *\t\tCKEDITOR.instances.editor1.setMode( 'source' );\n\t *\t\t// Switch to \"wysiwyg\" view and be notified on completion.\n\t *\t\tCKEDITOR.instances.editor1.setMode( 'wysiwyg', function() { alert( 'wysiwyg mode loaded!' ); } );\n\t *\n\t * @param {String} [newMode] If not specified, the {@link CKEDITOR.config#startupMode} will be used.\n\t * @param {Function} [callback] Optional callback function which is invoked once the mode switch has succeeded.\n\t */\n\tCKEDITOR.editor.prototype.setMode = function( newMode, callback ) {\n\t\tvar editor = this;\n\n\t\tvar modes = this._.modes;\n\n\t\t// Mode loading quickly fails.\n\t\tif ( newMode == editor.mode || !modes || !modes[ newMode ] )\n\t\t\treturn;\n\n\t\teditor.fire( 'beforeSetMode', newMode );\n\n\t\tif ( editor.mode ) {\n\t\t\tvar isDirty = editor.checkDirty(),\n\t\t\t\tpreviousModeData = editor._.previousModeData,\n\t\t\t\tcurrentData,\n\t\t\t\tunlockSnapshot = 0;\n\n\t\t\teditor.fire( 'beforeModeUnload' );\n\n\t\t\t// Detach the current editable. While detaching editable will set\n\t\t\t// cached editor's data (with internal setData call). We use this\n\t\t\t// data below to avoid two getData() calls in a row.\n\t\t\teditor.editable( 0 );\n\n\t\t\teditor._.previousMode = editor.mode;\n\t\t\t// Get cached data, which was set while detaching editable.\n\t\t\teditor._.previousModeData = currentData = editor.getData( 1 );\n\n\t\t\t// If data has not been modified in the mode which we are currently leaving,\n\t\t\t// avoid making snapshot right after initializing new mode.\n\t\t\t// http://dev.ckeditor.com/ticket/5217#comment:20\n\t\t\t// Tested by:\n\t\t\t// 'test switch mode with unrecoreded, inner HTML specific content (boguses)'\n\t\t\t// 'test switch mode with unrecoreded, inner HTML specific content (boguses) plus changes in source mode'\n\t\t\tif ( editor.mode == 'source' && previousModeData == currentData ) {\n\t\t\t\t// We need to make sure that unlockSnapshot will update the last snapshot\n\t\t\t\t// (will not create new one) if lockSnapshot is not called on outdated snapshots stack.\n\t\t\t\t// Additionally, forceUpdate prevents from making content image now, which is useless\n\t\t\t\t// (because it equals editor data not inner HTML).\n\t\t\t\teditor.fire( 'lockSnapshot', { forceUpdate: true } );\n\t\t\t\tunlockSnapshot = 1;\n\t\t\t}\n\n\t\t\t// Clear up the mode space.\n\t\t\teditor.ui.space( 'contents' ).setHtml( '' );\n\n\t\t\teditor.mode = '';\n\t\t} else {\n\t\t\teditor._.previousModeData = editor.getData( 1 );\n\t\t}\n\n\t\t// Fire the mode handler.\n\t\tthis._.modes[ newMode ]( function() {\n\t\t\t// Set the current mode.\n\t\t\teditor.mode = newMode;\n\n\t\t\tif ( isDirty !== undefined )\n\t\t\t\t!isDirty && editor.resetDirty();\n\n\t\t\tif ( unlockSnapshot )\n\t\t\t\teditor.fire( 'unlockSnapshot' );\n\t\t\t// Since snapshot made on dataReady (which normally catches changes done by setData)\n\t\t\t// won't work because editor.mode was not set yet (it's set in this function), we need\n\t\t\t// to make special snapshot for changes done in source mode here.\n\t\t\telse if ( newMode == 'wysiwyg' )\n\t\t\t\teditor.fire( 'saveSnapshot' );\n\n\t\t\t// Delay to avoid race conditions (setMode inside setMode).\n\t\t\tsetTimeout( function() {\n\t\t\t\teditor.fire( 'mode' );\n\t\t\t\tcallback && callback.call( editor );\n\t\t\t}, 0 );\n\t\t} );\n\t};\n\n\t/**\n\t * Resizes the editor interface.\n\t *\n\t *\t\teditor.resize( 900, 300 );\n\t *\n\t *\t\teditor.resize( '100%', 450, true );\n\t *\n\t * @param {Number/String} width The new width. It can be an integer denoting a value\n\t * in pixels or a CSS size value with unit.\n\t * @param {Number/String} height The new height. It can be an integer denoting a value\n\t * in pixels or a CSS size value with unit.\n\t * @param {Boolean} [isContentHeight] Indicates that the provided height is to\n\t * be applied to the editor content area, and not to the entire editor\n\t * interface. Defaults to `false`.\n\t * @param {Boolean} [resizeInner] Indicates that it is the inner interface\n\t * element that must be resized, not the outer element. The default theme\n\t * defines the editor interface inside a pair of `<span>` elements\n\t * (`<span><span>...</span></span>`). By default the first,\n\t * outer `<span>` element receives the sizes. If this parameter is set to\n\t * `true`, the second, inner `<span>` is resized instead.\n\t */\n\tCKEDITOR.editor.prototype.resize = function( width, height, isContentHeight, resizeInner ) {\n\t\tvar container = this.container,\n\t\t\tcontents = this.ui.space( 'contents' ),\n\t\t\tcontentsFrame = CKEDITOR.env.webkit && this.document && this.document.getWindow().$.frameElement,\n\t\t\touter;\n\n\t\tif ( resizeInner ) {\n\t\t\touter = this.container.getFirst( function( node ) {\n\t\t\t\treturn node.type == CKEDITOR.NODE_ELEMENT && node.hasClass( 'cke_inner' );\n\t\t\t} );\n\t\t} else {\n\t\t\touter = container;\n\t\t}\n\n\t\t// Set as border box width. (#5353)\n\t\touter.setSize( 'width', width, true );\n\n\t\t// WebKit needs to refresh the iframe size to avoid rendering issues. (1/2) (#8348)\n\t\tcontentsFrame && ( contentsFrame.style.width = '1%' );\n\n\t\t// Get the height delta between the outer table and the content area.\n\t\tvar contentsOuterDelta = ( outer.$.offsetHeight || 0 ) - ( contents.$.clientHeight || 0 ),\n\n\t\t// If we're setting the content area's height, then we don't need the delta.\n\t\t\tresultContentsHeight = Math.max( height - ( isContentHeight ? 0 : contentsOuterDelta ), 0 ),\n\t\t\tresultOuterHeight = ( isContentHeight ? height + contentsOuterDelta : height );\n\n\t\tcontents.setStyle( 'height', resultContentsHeight + 'px' );\n\n\t\t// WebKit needs to refresh the iframe size to avoid rendering issues. (2/2) (#8348)\n\t\tcontentsFrame && ( contentsFrame.style.width = '100%' );\n\n\t\t// Emit a resize event.\n\t\tthis.fire( 'resize', {\n\t\t\touterHeight: resultOuterHeight,\n\t\t\tcontentsHeight: resultContentsHeight,\n\t\t\t// Sometimes width is not provided.\n\t\t\touterWidth: width || outer.getSize( 'width' )\n\t\t} );\n\t};\n\n\t/**\n\t * Gets the element that can be used to check the editor size. This method\n\t * is mainly used by the [Editor Resize](http://ckeditor.com/addon/resize) plugin, which adds\n\t * a UI handle that can be used to resize the editor.\n\t *\n\t * @param {Boolean} forContents Whether to return the \"contents\" part of the theme instead of the container.\n\t * @returns {CKEDITOR.dom.element} The resizable element.\n\t */\n\tCKEDITOR.editor.prototype.getResizable = function( forContents ) {\n\t\treturn forContents ? this.ui.space( 'contents' ) : this.container;\n\t};\n\n\tfunction createInstance( element, config, data, mode ) {\n\t\tif ( !CKEDITOR.env.isCompatible )\n\t\t\treturn null;\n\n\t\telement = CKEDITOR.dom.element.get( element );\n\n\t\t// Avoid multiple inline editor instances on the same element.\n\t\tif ( element.getEditor() )\n\t\t\tthrow 'The editor instance \"' + element.getEditor().name + '\" is already attached to the provided element.';\n\n\t\t// Create the editor instance.\n\t\tvar editor = new CKEDITOR.editor( config, element, mode );\n\n\t\tif ( mode == CKEDITOR.ELEMENT_MODE_REPLACE ) {\n\t\t\t// Do not replace the textarea right now, just hide it. The effective\n\t\t\t// replacement will be done later in the editor creation lifecycle.\n\t\t\telement.setStyle( 'visibility', 'hidden' );\n\n\t\t\t// #8031 Remember if textarea was required and remove the attribute.\n\t\t\teditor._.required = element.hasAttribute( 'required' );\n\t\t\telement.removeAttribute( 'required' );\n\t\t}\n\n\t\tdata && editor.setData( data, null, true );\n\n\t\t// Once the editor is loaded, start the UI.\n\t\teditor.on( 'loaded', function() {\n\t\t\tloadTheme( editor );\n\n\t\t\tif ( mode == CKEDITOR.ELEMENT_MODE_REPLACE && editor.config.autoUpdateElement && element.$.form )\n\t\t\t\teditor._attachToForm();\n\n\t\t\teditor.setMode( editor.config.startupMode, function() {\n\t\t\t\t// Clean on startup.\n\t\t\t\teditor.resetDirty();\n\n\t\t\t\t// Editor is completely loaded for interaction.\n\t\t\t\teditor.status = 'ready';\n\t\t\t\teditor.fireOnce( 'instanceReady' );\n\t\t\t\tCKEDITOR.fire( 'instanceReady', null, editor );\n\t\t\t} );\n\t\t} );\n\n\t\teditor.on( 'destroy', destroy );\n\t\treturn editor;\n\t}\n\n\tfunction destroy() {\n\t\tvar editor = this,\n\t\t\tcontainer = editor.container,\n\t\t\telement = editor.element;\n\n\t\tif ( container ) {\n\t\t\tcontainer.clearCustomData();\n\t\t\tcontainer.remove();\n\t\t}\n\n\t\tif ( element ) {\n\t\t\telement.clearCustomData();\n\t\t\tif ( editor.elementMode == CKEDITOR.ELEMENT_MODE_REPLACE ) {\n\t\t\t\telement.show();\n\t\t\t\tif ( editor._.required )\n\t\t\t\t\telement.setAttribute( 'required', 'required' );\n\t\t\t}\n\t\t\tdelete editor.element;\n\t\t}\n\t}\n\n\tfunction loadTheme( editor ) {\n\t\tvar name = editor.name,\n\t\t\telement = editor.element,\n\t\t\telementMode = editor.elementMode;\n\n\t\t// Get the HTML for the predefined spaces.\n\t\tvar topHtml = editor.fire( 'uiSpace', { space: 'top', html: '' } ).html;\n\t\tvar bottomHtml = editor.fire( 'uiSpace', { space: 'bottom', html: '' } ).html;\n\n\t\tvar themedTpl = new CKEDITOR.template(\n\t\t\t'<{outerEl}' +\n\t\t\t\t' id=\"cke_{name}\"' +\n\t\t\t\t' class=\"{id} cke cke_reset cke_chrome cke_editor_{name} cke_{langDir} ' + CKEDITOR.env.cssClass + '\" ' +\n\t\t\t\t' dir=\"{langDir}\"' +\n\t\t\t\t' lang=\"{langCode}\"' +\n\t\t\t\t' role=\"application\"' +\n\t\t\t\t( editor.title ? ' aria-labelledby=\"cke_{name}_arialbl\"' : '' ) +\n\t\t\t\t'>' +\n\t\t\t\t( editor.title ? '<span id=\"cke_{name}_arialbl\" class=\"cke_voice_label\">{voiceLabel}</span>' : '' ) +\n\t\t\t\t'<{outerEl} class=\"cke_inner cke_reset\" role=\"presentation\">' +\n\t\t\t\t\t'{topHtml}' +\n\t\t\t\t\t'<{outerEl} id=\"{contentId}\" class=\"cke_contents cke_reset\" role=\"presentation\"></{outerEl}>' +\n\t\t\t\t\t'{bottomHtml}' +\n\t\t\t\t'</{outerEl}>' +\n\t\t\t'</{outerEl}>' );\n\n\t\tvar container = CKEDITOR.dom.element.createFromHtml( themedTpl.output( {\n\t\t\tid: editor.id,\n\t\t\tname: name,\n\t\t\tlangDir: editor.lang.dir,\n\t\t\tlangCode: editor.langCode,\n\t\t\tvoiceLabel: editor.title,\n\t\t\ttopHtml: topHtml ? '<span id=\"' + editor.ui.spaceId( 'top' ) + '\" class=\"cke_top cke_reset_all\" role=\"presentation\" style=\"height:auto\">' + topHtml + '</span>' : '',\n\t\t\tcontentId: editor.ui.spaceId( 'contents' ),\n\t\t\tbottomHtml: bottomHtml ? '<span id=\"' + editor.ui.spaceId( 'bottom' ) + '\" class=\"cke_bottom cke_reset_all\" role=\"presentation\">' + bottomHtml + '</span>' : '',\n\t\t\touterEl: CKEDITOR.env.ie ? 'span' : 'div'\t// #9571\n\t\t} ) );\n\n\t\tif ( elementMode == CKEDITOR.ELEMENT_MODE_REPLACE ) {\n\t\t\telement.hide();\n\t\t\tcontainer.insertAfter( element );\n\t\t} else {\n\t\t\telement.append( container );\n\t\t}\n\n\t\teditor.container = container;\n\t\teditor.ui.contentsElement = editor.ui.space( 'contents' );\n\n\t\t// Make top and bottom spaces unelectable, but not content space,\n\t\t// otherwise the editable area would be affected.\n\t\ttopHtml && editor.ui.space( 'top' ).unselectable();\n\t\tbottomHtml && editor.ui.space( 'bottom' ).unselectable();\n\n\t\tvar width = editor.config.width, height = editor.config.height;\n\t\tif ( width )\n\t\t\tcontainer.setStyle( 'width', CKEDITOR.tools.cssLength( width ) );\n\n\t\t// The editor height is applied to the contents space.\n\t\tif ( height )\n\t\t\teditor.ui.space( 'contents' ).setStyle( 'height', CKEDITOR.tools.cssLength( height ) );\n\n\t\t// Disable browser context menu for editor's chrome.\n\t\tcontainer.disableContextMenu();\n\n\t\t// Redirect the focus into editor for webkit. (#5713)\n\t\tCKEDITOR.env.webkit && container.on( 'focus', function() {\n\t\t\teditor.focus();\n\t\t} );\n\n\t\teditor.fireOnce( 'uiReady' );\n\t}\n\n\t// Replace all textareas with the default class name.\n\tCKEDITOR.domReady( function() {\n\t\tCKEDITOR.replaceClass && CKEDITOR.replaceAll( CKEDITOR.replaceClass );\n\t} );\n} )();\n\n/**\n * The current editing mode. An editing mode basically provides\n * different ways of editing or viewing the editor content.\n *\n *\t\talert( CKEDITOR.instances.editor1.mode ); // (e.g.) 'wysiwyg'\n *\n * @readonly\n * @property {String} mode\n */\n\n/**\n * The mode to load at the editor startup. It depends on the plugins\n * loaded. By default, the `wysiwyg` and `source` modes are available.\n *\n *\t\tconfig.startupMode = 'source';\n *\n * @cfg {String} [startupMode='wysiwyg']\n * @member CKEDITOR.config\n */\nCKEDITOR.config.startupMode = 'wysiwyg';\n\n/**\n * Fired after the editor instance is resized through\n * the {@link CKEDITOR.editor#method-resize CKEDITOR.resize} method.\n *\n * @event resize\n * @param {CKEDITOR.editor} editor This editor instance.\n * @param {Object} data Available since CKEditor 4.5.\n * @param {Number} data.outerHeight The height of the entire area that the editor covers.\n * @param {Number} data.contentsHeight Editable area height in pixels.\n * @param {Number} data.outerWidth The width of the entire area that the editor covers.\n */\n\n/**\n * Fired before changing the editing mode. See also\n * {@link #beforeSetMode} and {@link #event-mode}.\n *\n * @event beforeModeUnload\n * @param {CKEDITOR.editor} editor This editor instance.\n */\n\n/**\n * Fired before the editor mode is set. See also\n * {@link #event-mode} and {@link #beforeModeUnload}.\n *\n * @since 3.5.3\n * @event beforeSetMode\n * @param {CKEDITOR.editor} editor This editor instance.\n * @param {String} data The name of the mode which is about to be set.\n */\n\n/**\n * Fired after setting the editing mode. See also {@link #beforeSetMode} and {@link #beforeModeUnload}\n *\n * @event mode\n * @param {CKEDITOR.editor} editor This editor instance.\n */\n\n/**\n * Fired when the editor (replacing a `<textarea>` which has a `required` attribute) is empty during form submission.\n *\n * This event replaces native required fields validation that the browsers cannot\n * perform when CKEditor replaces `<textarea>` elements.\n *\n * You can cancel this event to prevent the page from submitting data.\n *\n *\t\teditor.on( 'required', function( evt ) {\n *\t\t\talert( 'Article content is required.' );\n *\t\t\tevt.cancel();\n *\t\t} );\n *\n * @event required\n * @param {CKEDITOR.editor} editor This editor instance.\n */\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/creators/themedui.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n( function() {\n\tvar isNotWhitespace, isNotBookmark, isEmpty, isBogus, emptyParagraphRegexp,\n\t\tinsert, fixTableAfterContentsDeletion, getHtmlFromRangeHelpers, extractHtmlFromRangeHelpers;\n\n\t/**\n\t * Editable class which provides all editing related activities by\n\t * the `contenteditable` element, dynamically get attached to editor instance.\n\t *\n\t * @class CKEDITOR.editable\n\t * @extends CKEDITOR.dom.element\n\t */\n\tCKEDITOR.editable = CKEDITOR.tools.createClass( {\n\t\tbase: CKEDITOR.dom.element,\n\t\t/**\n\t\t * The constructor only stores generic editable creation logic that is commonly shared among\n\t\t * all different editable elements.\n\t\t *\n\t\t * @constructor Creates an editable class instance.\n\t\t * @param {CKEDITOR.editor} editor The editor instance on which the editable operates.\n\t\t * @param {HTMLElement/CKEDITOR.dom.element} element Any DOM element that was as the editor's\n\t\t * editing container, e.g. it could be either an HTML element with the `contenteditable` attribute\n\t\t * set to the `true` that handles WYSIWYG editing or a `<textarea>` element that handles source editing.\n\t\t */\n\t\t$: function( editor, element ) {\n\t\t\t// Transform the element into a CKEDITOR.dom.element instance.\n\t\t\tthis.base( element.$ || element );\n\n\t\t\tthis.editor = editor;\n\n\t\t\t/**\n\t\t\t * Indicates the initialization status of the editable element. The following statuses are available:\n\t\t\t *\n\t\t\t *\t* **unloaded** &ndash; the initial state. The editable's instance was created but\n\t\t\t *\tis not fully loaded (in particular it has no data).\n\t\t\t *\t* **ready** &ndash; the editable is fully initialized. The `ready` status is set after\n\t\t\t *\tthe first {@link CKEDITOR.editor#method-setData} is called.\n\t\t\t *\t* **detached** &ndash; the editable was detached.\n\t\t\t *\n\t\t\t * @since 4.3.3\n\t\t\t * @readonly\n\t\t\t * @property {String}\n\t\t\t */\n\t\t\tthis.status = 'unloaded';\n\n\t\t\t/**\n\t\t\t * Indicates whether the editable element gained focus.\n\t\t\t *\n\t\t\t * @property {Boolean} hasFocus\n\t\t\t */\n\t\t\tthis.hasFocus = false;\n\n\t\t\t// The bootstrapping logic.\n\t\t\tthis.setup();\n\t\t},\n\n\t\tproto: {\n\t\t\tfocus: function() {\n\n\t\t\t\tvar active;\n\n\t\t\t\t// [Webkit] When DOM focus is inside of nested contenteditable elements,\n\t\t\t\t// apply focus on the main editable will compromise it's text selection.\n\t\t\t\tif ( CKEDITOR.env.webkit && !this.hasFocus ) {\n\t\t\t\t\t// Restore focus on element which we cached (on selectionCheck) as previously active.\n\t\t\t\t\tactive = this.editor._.previousActive || this.getDocument().getActive();\n\t\t\t\t\tif ( this.contains( active ) ) {\n\t\t\t\t\t\tactive.focus();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// [IE] Use instead \"setActive\" method to focus the editable if it belongs to\n\t\t\t\t// the host page document, to avoid bringing an unexpected scroll.\n\t\t\t\ttry {\n\t\t\t\t\tthis.$[ CKEDITOR.env.ie && this.getDocument().equals( CKEDITOR.document ) ? 'setActive' : 'focus' ]();\n\t\t\t\t} catch ( e ) {\n\t\t\t\t\t// IE throws unspecified error when focusing editable after closing dialog opened on nested editable.\n\t\t\t\t\tif ( !CKEDITOR.env.ie )\n\t\t\t\t\t\tthrow e;\n\t\t\t\t}\n\n\t\t\t\t// Remedy if Safari doens't applies focus properly. (#279)\n\t\t\t\tif ( CKEDITOR.env.safari && !this.isInline() ) {\n\t\t\t\t\tactive = CKEDITOR.document.getActive();\n\t\t\t\t\tif ( !active.equals( this.getWindow().getFrame() ) )\n\t\t\t\t\t\tthis.getWindow().focus();\n\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Overrides {@link CKEDITOR.dom.element#on} to have special `focus/blur` handling.\n\t\t\t * The `focusin/focusout` events are used in IE to replace regular `focus/blur` events\n\t\t\t * because we want to avoid the asynchronous nature of later ones.\n\t\t\t */\n\t\t\ton: function( name, fn ) {\n\t\t\t\tvar args = Array.prototype.slice.call( arguments, 0 );\n\n\t\t\t\tif ( CKEDITOR.env.ie && ( /^focus|blur$/ ).exec( name ) ) {\n\t\t\t\t\tname = name == 'focus' ? 'focusin' : 'focusout';\n\n\t\t\t\t\t// The \"focusin/focusout\" events bubbled, e.g. If there are elements with layout\n\t\t\t\t\t// they fire this event when clicking in to edit them but it must be ignored\n\t\t\t\t\t// to allow edit their contents. (#4682)\n\t\t\t\t\tfn = isNotBubbling( fn, this );\n\t\t\t\t\targs[ 0 ] = name;\n\t\t\t\t\targs[ 1 ] = fn;\n\t\t\t\t}\n\n\t\t\t\treturn CKEDITOR.dom.element.prototype.on.apply( this, args );\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Registers an event listener that needs to be removed when detaching this editable.\n\t\t\t * This means that it will be automatically removed when {@link #detach} is executed,\n\t\t\t * for example on {@link CKEDITOR.editor#setMode changing editor mode} or destroying editor.\n\t\t\t *\n\t\t\t * Except for `obj` all other arguments have the same meaning as in {@link CKEDITOR.event#on}.\n\t\t\t *\n\t\t\t * This method is strongly related to the {@link CKEDITOR.editor#contentDom} and\n\t\t\t * {@link CKEDITOR.editor#contentDomUnload} events, because they are fired\n\t\t\t * when an editable is being attached and detached. Therefore, this method is usually used\n\t\t\t * in the following way:\n\t\t\t *\n\t\t\t *\t\teditor.on( 'contentDom', function() {\n\t\t\t *\t\t\tvar editable = editor.editable();\n\t\t\t *\t\t\teditable.attachListener( editable, 'mousedown', function() {\n\t\t\t *\t\t\t\t// ...\n\t\t\t *\t\t\t} );\n\t\t\t *\t\t} );\n\t\t\t *\n\t\t\t * This code will attach the `mousedown` listener every time a new editable is attached\n\t\t\t * to the editor, which in classic (`iframe`-based) editor happens every time the\n\t\t\t * data or the mode is set. This listener will also be removed when that editable is detached.\n\t\t\t *\n\t\t\t * It is also possible to attach a listener to another object (e.g. to a document).\n\t\t\t *\n\t\t\t *\t\teditor.on( 'contentDom', function() {\n\t\t\t *\t\t\teditor.editable().attachListener( editor.document, 'mousedown', function() {\n\t\t\t *\t\t\t\t// ...\n\t\t\t *\t\t\t} );\n\t\t\t *\t\t} );\n\t\t\t *\n\t\t\t * @param {CKEDITOR.event} obj The element/object to which the listener will be attached. Every object\n\t\t\t * which inherits from {@link CKEDITOR.event} may be used including {@link CKEDITOR.dom.element},\n\t\t\t * {@link CKEDITOR.dom.document}, and {@link CKEDITOR.editable}.\n\t\t\t * @param {String} eventName The name of the event that will be listened to.\n\t\t\t * @param {Function} listenerFunction The function listening to the\n\t\t\t * event. A single {@link CKEDITOR.eventInfo} object instance\n\t\t\t * containing all the event data is passed to this function.\n\t\t\t * @param {Object} [scopeObj] The object used to scope the listener\n\t\t\t * call (the `this` object). If omitted, the current object is used.\n\t\t\t * @param {Object} [listenerData] Data to be sent as the\n\t\t\t * {@link CKEDITOR.eventInfo#listenerData} when calling the listener.\n\t\t\t * @param {Number} [priority=10] The listener priority. Lower priority\n\t\t\t * listeners are called first. Listeners with the same priority\n\t\t\t * value are called in the registration order.\n\t\t\t * @returns {Object} An object containing the `removeListener`\n\t\t\t * function that can be used to remove the listener at any time.\n\t\t\t */\n\t\t\tattachListener: function( obj /*, event, fn, scope, listenerData, priority*/ ) {\n\t\t\t\t!this._.listeners && ( this._.listeners = [] );\n\t\t\t\t// Register the listener.\n\t\t\t\tvar args = Array.prototype.slice.call( arguments, 1 ),\n\t\t\t\t\tlistener = obj.on.apply( obj, args );\n\n\t\t\t\tthis._.listeners.push( listener );\n\n\t\t\t\treturn listener;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Remove all event listeners registered from {@link #attachListener}.\n\t\t\t */\n\t\t\tclearListeners: function() {\n\t\t\t\tvar listeners = this._.listeners;\n\t\t\t\t// Don't get broken by this.\n\t\t\t\ttry {\n\t\t\t\t\twhile ( listeners.length )\n\t\t\t\t\t\tlisteners.pop().removeListener();\n\t\t\t\t} catch ( e ) {}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Restore all attribution changes made by {@link #changeAttr }.\n\t\t\t */\n\t\t\trestoreAttrs: function() {\n\t\t\t\tvar changes = this._.attrChanges, orgVal;\n\t\t\t\tfor ( var attr in changes ) {\n\t\t\t\t\tif ( changes.hasOwnProperty( attr ) ) {\n\t\t\t\t\t\torgVal = changes[ attr ];\n\t\t\t\t\t\t// Restore original attribute.\n\t\t\t\t\t\torgVal !== null ? this.setAttribute( attr, orgVal ) : this.removeAttribute( attr );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Adds a CSS class name to this editable that needs to be removed on detaching.\n\t\t\t *\n\t\t\t * @param {String} className The class name to be added.\n\t\t\t * @see CKEDITOR.dom.element#addClass\n\t\t\t */\n\t\t\tattachClass: function( cls ) {\n\t\t\t\tvar classes = this.getCustomData( 'classes' );\n\t\t\t\tif ( !this.hasClass( cls ) ) {\n\t\t\t\t\t!classes && ( classes = [] ), classes.push( cls );\n\t\t\t\t\tthis.setCustomData( 'classes', classes );\n\t\t\t\t\tthis.addClass( cls );\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Make an attribution change that would be reverted on editable detaching.\n\t\t\t * @param {String} attr The attribute name to be changed.\n\t\t\t * @param {String} val The value of specified attribute.\n\t\t\t */\n\t\t\tchangeAttr: function( attr, val ) {\n\t\t\t\tvar orgVal = this.getAttribute( attr );\n\t\t\t\tif ( val !== orgVal ) {\n\t\t\t\t\t!this._.attrChanges && ( this._.attrChanges = {} );\n\n\t\t\t\t\t// Saved the original attribute val.\n\t\t\t\t\tif ( !( attr in this._.attrChanges ) )\n\t\t\t\t\t\tthis._.attrChanges[ attr ] = orgVal;\n\n\t\t\t\t\tthis.setAttribute( attr, val );\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Low-level method for inserting text into the editable.\n\t\t\t * See the {@link CKEDITOR.editor#method-insertText} method which is the editor-level API\n\t\t\t * for this purpose.\n\t\t\t *\n\t\t\t * @param {String} text\n\t\t\t */\n\t\t\tinsertText: function( text ) {\n\t\t\t\t// Focus the editor before calling transformPlainTextToHtml. (#12726)\n\t\t\t\tthis.editor.focus();\n\t\t\t\tthis.insertHtml( this.transformPlainTextToHtml( text ), 'text' );\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Transforms plain text to HTML based on current selection and {@link CKEDITOR.editor#activeEnterMode}.\n\t\t\t *\n\t\t\t * @since 4.5\n\t\t\t * @param {String} text Text to transform.\n\t\t\t * @returns {String} HTML generated from the text.\n\t\t\t */\n\t\t\ttransformPlainTextToHtml: function( text ) {\n\t\t\t\tvar enterMode = this.editor.getSelection().getStartElement().hasAscendant( 'pre', true ) ?\n\t\t\t\t\tCKEDITOR.ENTER_BR :\n\t\t\t\t\tthis.editor.activeEnterMode;\n\n\t\t\t\treturn CKEDITOR.tools.transformPlainTextToHtml( text, enterMode );\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Low-level method for inserting HTML into the editable.\n\t\t\t * See the {@link CKEDITOR.editor#method-insertHtml} method which is the editor-level API\n\t\t\t * for this purpose.\n\t\t\t *\n\t\t\t * This method will insert HTML into the current selection or a given range. It also creates an undo snapshot,\n\t\t\t * scrolls the viewport to the insertion and selects the range next to the inserted content.\n\t\t\t * If you want to insert HTML without additional operations use {@link #method-insertHtmlIntoRange}.\n\t\t\t *\n\t\t\t * Fires the {@link CKEDITOR.editor#event-afterInsertHtml} event.\n\t\t\t *\n\t\t\t * @param {String} data The HTML to be inserted.\n\t\t\t * @param {String} [mode='html'] See {@link CKEDITOR.editor#method-insertHtml}'s param.\n\t\t\t * @param {CKEDITOR.dom.range} [range] If specified, the HTML will be inserted into the range\n\t\t\t * instead of into the selection. The selection will be placed at the end of the insertion (like in the normal case).\n\t\t\t * Introduced in CKEditor 4.5.\n\t\t\t */\n\t\t\tinsertHtml: function( data, mode, range ) {\n\t\t\t\tvar editor = this.editor;\n\n\t\t\t\teditor.focus();\n\t\t\t\teditor.fire( 'saveSnapshot' );\n\n\t\t\t\tif ( !range ) {\n\t\t\t\t\t// HTML insertion only considers the first range.\n\t\t\t\t\t// Note: getRanges will be overwritten for tests since we want to test\n\t\t\t\t\t// custom ranges and bypass native selections.\n\t\t\t\t\trange = editor.getSelection().getRanges()[ 0 ];\n\t\t\t\t}\n\n\t\t\t\t// Default mode is 'html'.\n\t\t\t\tinsert( this, mode || 'html', data, range );\n\n\t\t\t\t// Make the final range selection.\n\t\t\t\trange.select();\n\n\t\t\t\tafterInsert( this );\n\n\t\t\t\tthis.editor.fire( 'afterInsertHtml', {} );\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Inserts HTML into the position in the editor determined by the range.\n\t\t\t *\n\t\t\t * **Note:** This method does not {@link CKEDITOR.editor#saveSnapshot save undo snapshots} nor selects inserted\n\t\t\t * HTML. If you want to do it, use {@link #method-insertHtml}.\n\t\t\t *\n\t\t\t * Fires the {@link CKEDITOR.editor#event-afterInsertHtml} event.\n\t\t\t *\n\t\t\t * @since 4.5\n\t\t\t * @param {String} data HTML code to be inserted into the editor.\n\t\t\t * @param {CKEDITOR.dom.range} range The range as a place of insertion.\n\t\t\t * @param {String} [mode='html'] Mode in which HTML will be inserted.\n\t\t\t * See {@link CKEDITOR.editor#method-insertHtml}.\n\t\t\t */\n\t\t\tinsertHtmlIntoRange: function( data, range, mode ) {\n\t\t\t\t// Default mode is 'html'\n\t\t\t\tinsert( this, mode || 'html', data, range );\n\n\t\t\t\tthis.editor.fire( 'afterInsertHtml', { intoRange: range } );\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Low-level method for inserting an element into the editable.\n\t\t\t * See the {@link CKEDITOR.editor#method-insertElement} method which is the editor-level API\n\t\t\t * for this purpose.\n\t\t\t *\n\t\t\t * This method will insert the element into the current selection or a given range. It also creates an undo\n\t\t\t * snapshot, scrolls the viewport to the insertion and selects the range next to the inserted content.\n\t\t\t * If you want to insert an element without additional operations use {@link #method-insertElementIntoRange}.\n\t\t\t *\n\t\t\t * @param {CKEDITOR.dom.element} element The element to insert.\n\t\t\t * @param {CKEDITOR.dom.range} [range] If specified, the element will be inserted into the range\n\t\t\t * instead of into the selection.\n\t\t\t */\n\t\t\tinsertElement: function( element, range ) {\n\t\t\t\tvar editor = this.editor;\n\n\t\t\t\t// Prepare for the insertion. For example - focus editor (#11848).\n\t\t\t\teditor.focus();\n\t\t\t\teditor.fire( 'saveSnapshot' );\n\n\t\t\t\tvar enterMode = editor.activeEnterMode,\n\t\t\t\t\tselection = editor.getSelection(),\n\t\t\t\t\telementName = element.getName(),\n\t\t\t\t\tisBlock = CKEDITOR.dtd.$block[ elementName ];\n\n\t\t\t\tif ( !range ) {\n\t\t\t\t\trange = selection.getRanges()[ 0 ];\n\t\t\t\t}\n\n\t\t\t\t// Insert element into first range only and ignore the rest (#11183).\n\t\t\t\tif ( this.insertElementIntoRange( element, range ) ) {\n\t\t\t\t\trange.moveToPosition( element, CKEDITOR.POSITION_AFTER_END );\n\n\t\t\t\t\t// If we're inserting a block element, the new cursor position must be\n\t\t\t\t\t// optimized. (#3100,#5436,#8950)\n\t\t\t\t\tif ( isBlock ) {\n\t\t\t\t\t\t// Find next, meaningful element.\n\t\t\t\t\t\tvar next = element.getNext( function( node ) {\n\t\t\t\t\t\t\treturn isNotEmpty( node ) && !isBogus( node );\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\tif ( next && next.type == CKEDITOR.NODE_ELEMENT && next.is( CKEDITOR.dtd.$block ) ) {\n\t\t\t\t\t\t\t// If the next one is a text block, move cursor to the start of it's content.\n\t\t\t\t\t\t\tif ( next.getDtd()[ '#' ] )\n\t\t\t\t\t\t\t\trange.moveToElementEditStart( next );\n\t\t\t\t\t\t\t// Otherwise move cursor to the before end of the last element.\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\trange.moveToElementEditEnd( element );\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Open a new line if the block is inserted at the end of parent.\n\t\t\t\t\t\telse if ( !next && enterMode != CKEDITOR.ENTER_BR ) {\n\t\t\t\t\t\t\tnext = range.fixBlock( true, enterMode == CKEDITOR.ENTER_DIV ? 'div' : 'p' );\n\t\t\t\t\t\t\trange.moveToElementEditStart( next );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Set up the correct selection.\n\t\t\t\tselection.selectRanges( [ range ] );\n\n\t\t\t\tafterInsert( this );\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Alias for {@link #insertElement}.\n\t\t\t *\n\t\t\t * @deprecated\n\t\t\t * @param {CKEDITOR.dom.element} element The element to be inserted.\n\t\t\t */\n\t\t\tinsertElementIntoSelection: function( element ) {\n\t\t\t\tthis.insertElement( element );\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Inserts an element into the position in the editor determined by the range.\n\t\t\t *\n\t\t\t * **Note:** This method does not {@link CKEDITOR.editor#saveSnapshot save undo snapshots} nor selects the inserted\n\t\t\t * element. If you want to do it, use the {@link #method-insertElement} method.\n\t\t\t *\n\t\t\t * @param {CKEDITOR.dom.element} element The element to be inserted.\n\t\t\t * @param {CKEDITOR.dom.range} range The range as a place of insertion.\n\t\t\t * @returns {Boolean} Informs whether the insertion was successful.\n\t\t\t */\n\t\t\tinsertElementIntoRange: function( element, range ) {\n\t\t\t\tvar editor = this.editor,\n\t\t\t\t\tenterMode = editor.config.enterMode,\n\t\t\t\t\telementName = element.getName(),\n\t\t\t\t\tisBlock = CKEDITOR.dtd.$block[ elementName ];\n\n\t\t\t\tif ( range.checkReadOnly() )\n\t\t\t\t\treturn false;\n\n\t\t\t\t// Remove the original contents, merge split nodes.\n\t\t\t\trange.deleteContents( 1 );\n\n\t\t\t\t// If range is placed in inermediate element (not td or th), we need to do three things:\n\t\t\t\t// * fill emptied <td/th>s with if browser needs them,\n\t\t\t\t// * remove empty text nodes so IE8 won't crash (http://dev.ckeditor.com/ticket/11183#comment:8),\n\t\t\t\t// * fix structure and move range into the <td/th> element.\n\t\t\t\tif ( range.startContainer.type == CKEDITOR.NODE_ELEMENT && range.startContainer.is( { tr: 1, table: 1, tbody: 1, thead: 1, tfoot: 1 } ) )\n\t\t\t\t\tfixTableAfterContentsDeletion( range );\n\n\t\t\t\t// If we're inserting a block at dtd-violated position, split\n\t\t\t\t// the parent blocks until we reach blockLimit.\n\t\t\t\tvar current, dtd;\n\n\t\t\t\tif ( isBlock ) {\n\t\t\t\t\twhile ( ( current = range.getCommonAncestor( 0, 1 ) ) &&\n\t\t\t\t\t\t\t( dtd = CKEDITOR.dtd[ current.getName() ] ) &&\n\t\t\t\t\t\t\t!( dtd && dtd[ elementName ] ) ) {\n\t\t\t\t\t\t// Split up inline elements.\n\t\t\t\t\t\tif ( current.getName() in CKEDITOR.dtd.span )\n\t\t\t\t\t\t\trange.splitElement( current );\n\n\t\t\t\t\t\t// If we're in an empty block which indicate a new paragraph,\n\t\t\t\t\t\t// simply replace it with the inserting block.(#3664)\n\t\t\t\t\t\telse if ( range.checkStartOfBlock() && range.checkEndOfBlock() ) {\n\t\t\t\t\t\t\trange.setStartBefore( current );\n\t\t\t\t\t\t\trange.collapse( true );\n\t\t\t\t\t\t\tcurrent.remove();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trange.splitBlock( enterMode == CKEDITOR.ENTER_DIV ? 'div' : 'p', editor.editable() );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Insert the new node.\n\t\t\t\trange.insertNode( element );\n\n\t\t\t\t// Return true if insertion was successful.\n\t\t\t\treturn true;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * @see CKEDITOR.editor#setData\n\t\t\t */\n\t\t\tsetData: function( data, isSnapshot ) {\n\t\t\t\tif ( !isSnapshot )\n\t\t\t\t\tdata = this.editor.dataProcessor.toHtml( data );\n\n\t\t\t\tthis.setHtml( data );\n\t\t\t\tthis.fixInitialSelection();\n\n\t\t\t\t// Editable is ready after first setData.\n\t\t\t\tif ( this.status == 'unloaded' )\n\t\t\t\t\tthis.status = 'ready';\n\n\t\t\t\tthis.editor.fire( 'dataReady' );\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * @see CKEDITOR.editor#getData\n\t\t\t */\n\t\t\tgetData: function( isSnapshot ) {\n\t\t\t\tvar data = this.getHtml();\n\n\t\t\t\tif ( !isSnapshot )\n\t\t\t\t\tdata = this.editor.dataProcessor.toDataFormat( data );\n\n\t\t\t\treturn data;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Changes the read-only state of this editable.\n\t\t\t *\n\t\t\t * @param {Boolean} isReadOnly\n\t\t\t */\n\t\t\tsetReadOnly: function( isReadOnly ) {\n\t\t\t\tthis.setAttribute( 'contenteditable', !isReadOnly );\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Detaches this editable object from the DOM (removes classes, listeners, etc.)\n\t\t\t */\n\t\t\tdetach: function() {\n\t\t\t\t// Cleanup the element.\n\t\t\t\tthis.removeClass( 'cke_editable' );\n\n\t\t\t\tthis.status = 'detached';\n\n\t\t\t\t// Save the editor reference which will be lost after\n\t\t\t\t// calling detach from super class.\n\t\t\t\tvar editor = this.editor;\n\n\t\t\t\tthis._.detach();\n\n\t\t\t\tdelete editor.document;\n\t\t\t\tdelete editor.window;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Checks if the editable is one of the host page elements, indicates\n\t\t\t * an inline editing environment.\n\t\t\t *\n\t\t\t * @returns {Boolean}\n\t\t\t */\n\t\t\tisInline: function() {\n\t\t\t\treturn this.getDocument().equals( CKEDITOR.document );\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Fixes the selection and focus which may be in incorrect state after\n\t\t\t * editable's inner HTML was overwritten.\n\t\t\t *\n\t\t\t * If the editable did not have focus, then the selection will be fixed when the editable\n\t\t\t * is focused for the first time. If the editable already had focus, then the selection will\n\t\t\t * be fixed immediately.\n\t\t\t *\n\t\t\t * To understand the problem see:\n\t\t\t *\n\t\t\t * * http://tests.ckeditor.dev:1030/tests/core/selection/manual/focusaftersettingdata\n\t\t\t * * http://tests.ckeditor.dev:1030/tests/core/selection/manual/focusafterundoing\n\t\t\t * * http://tests.ckeditor.dev:1030/tests/core/selection/manual/selectionafterfocusing\n\t\t\t * * http://tests.ckeditor.dev:1030/tests/plugins/newpage/manual/selectionafternewpage\n\t\t\t *\n\t\t\t * @since 4.4.6\n\t\t\t * @private\n\t\t\t */\n\t\t\tfixInitialSelection: function() {\n\t\t\t\tvar that = this;\n\n\t\t\t\t// Deal with IE8- IEQM (the old MS selection) first.\n\t\t\t\tif ( CKEDITOR.env.ie && ( CKEDITOR.env.version < 9 || CKEDITOR.env.quirks ) ) {\n\t\t\t\t\tif ( this.hasFocus ) {\n\t\t\t\t\t\tthis.focus();\n\t\t\t\t\t\tfixMSSelection();\n\t\t\t\t\t}\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// If editable did not have focus, fix the selection when it is first focused.\n\t\t\t\tif ( !this.hasFocus ) {\n\t\t\t\t\tthis.once( 'focus', function() {\n\t\t\t\t\t\tfixSelection();\n\t\t\t\t\t}, null, null, -999 );\n\t\t\t\t// If editable had focus, fix the selection immediately.\n\t\t\t\t} else {\n\t\t\t\t\tthis.focus();\n\t\t\t\t\tfixSelection();\n\t\t\t\t}\n\n\t\t\t\tfunction fixSelection() {\n\t\t\t\t\tvar $doc = that.getDocument().$,\n\t\t\t\t\t\t$sel = $doc.getSelection();\n\n\t\t\t\t\tif ( requiresFix( $sel ) ) {\n\t\t\t\t\t\tvar range = new CKEDITOR.dom.range( that );\n\t\t\t\t\t\trange.moveToElementEditStart( that );\n\n\t\t\t\t\t\tvar $range = $doc.createRange();\n\t\t\t\t\t\t$range.setStart( range.startContainer.$, range.startOffset );\n\t\t\t\t\t\t$range.collapse( true );\n\n\t\t\t\t\t\t$sel.removeAllRanges();\n\t\t\t\t\t\t$sel.addRange( $range );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction requiresFix( $sel ) {\n\t\t\t\t\t// This condition covers most broken cases after setting data.\n\t\t\t\t\tif ( $sel.anchorNode && $sel.anchorNode == that.$ ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Fix for:\n\t\t\t\t\t// http://tests.ckeditor.dev:1030/tests/core/selection/manual/focusaftersettingdata\n\t\t\t\t\t// (the inline editor TC)\n\t\t\t\t\tif ( CKEDITOR.env.webkit ) {\n\t\t\t\t\t\tvar active = that.getDocument().getActive();\n\t\t\t\t\t\tif ( active && active.equals( that ) && !$sel.anchorNode ) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction fixMSSelection() {\n\t\t\t\t\tvar $doc = that.getDocument().$,\n\t\t\t\t\t\t$sel = $doc.selection,\n\t\t\t\t\t\tactive = that.getDocument().getActive();\n\n\t\t\t\t\tif ( $sel.type == 'None' && active.equals( that ) ) {\n\t\t\t\t\t\tvar range = new CKEDITOR.dom.range( that ),\n\t\t\t\t\t\t\tparentElement,\n\t\t\t\t\t\t\t$range = $doc.body.createTextRange();\n\n\t\t\t\t\t\trange.moveToElementEditStart( that );\n\n\t\t\t\t\t\tparentElement = range.startContainer;\n\t\t\t\t\t\tif ( parentElement.type != CKEDITOR.NODE_ELEMENT ) {\n\t\t\t\t\t\t\tparentElement = parentElement.getParent();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$range.moveToElementText( parentElement.$ );\n\t\t\t\t\t\t$range.collapse( true );\n\t\t\t\t\t\t$range.select();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * The base of the {@link CKEDITOR.editor#getSelectedHtml} method.\n\t\t\t *\n\t\t\t * @since 4.5\n\t\t\t * @method getHtmlFromRange\n\t\t\t * @param {CKEDITOR.dom.range} range\n\t\t\t * @returns {CKEDITOR.dom.documentFragment}\n\t\t\t */\n\t\t\tgetHtmlFromRange: function( range ) {\n\t\t\t\t// There's nothing to return if range is collapsed.\n\t\t\t\tif ( range.collapsed )\n\t\t\t\t\treturn new CKEDITOR.dom.documentFragment( range.document );\n\n\t\t\t\t// Info object passed between methods.\n\t\t\t\tvar that = {\n\t\t\t\t\tdoc: this.getDocument(),\n\t\t\t\t\t// Leave original range object untouched.\n\t\t\t\t\trange: range.clone()\n\t\t\t\t};\n\n\t\t\t\tgetHtmlFromRangeHelpers.eol.detect( that, this );\n\t\t\t\tgetHtmlFromRangeHelpers.bogus.exclude( that );\n\t\t\t\tgetHtmlFromRangeHelpers.cell.shrink( that );\n\n\t\t\t\tthat.fragment = that.range.cloneContents();\n\n\t\t\t\tgetHtmlFromRangeHelpers.tree.rebuild( that, this );\n\t\t\t\tgetHtmlFromRangeHelpers.eol.fix( that, this );\n\n\t\t\t\treturn new CKEDITOR.dom.documentFragment( that.fragment.$ );\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * The base of the {@link CKEDITOR.editor#extractSelectedHtml} method.\n\t\t\t *\n\t\t\t * **Note:** The range is modified so it matches the desired selection after extraction\n\t\t\t * even though the selection is not made.\n\t\t\t *\n\t\t\t * @since 4.5\n\t\t\t * @param {CKEDITOR.dom.range} range\n\t\t\t * @param {Boolean} [removeEmptyBlock=false] See {@link CKEDITOR.editor#extractSelectedHtml}'s parameter.\n\t\t\t * Note that the range will not be modified if this parameter is set to `true`.\n\t\t\t * @returns {CKEDITOR.dom.documentFragment} The extracted fragment of the editable content.\n\t\t\t */\n\t\t\textractHtmlFromRange: function( range, removeEmptyBlock ) {\n\t\t\t\tvar helpers = extractHtmlFromRangeHelpers,\n\t\t\t\t\tthat = {\n\t\t\t\t\t\trange: range,\n\t\t\t\t\t\tdoc: range.document\n\t\t\t\t\t},\n\t\t\t\t\t// Since it is quite hard to build a valid documentFragment\n\t\t\t\t\t// out of extracted contents because DOM changes, let's mimic\n\t\t\t\t\t// extracted HTML with #getHtmlFromRange. Yep. It's a hack.\n\t\t\t\t\textractedFragment = this.getHtmlFromRange( range );\n\n\t\t\t\t// Collapsed range means that there's nothing to extract.\n\t\t\t\tif ( range.collapsed ) {\n\t\t\t\t\trange.optimize();\n\t\t\t\t\treturn extractedFragment;\n\t\t\t\t}\n\n\t\t\t\t// Include inline element if possible.\n\t\t\t\trange.enlarge( CKEDITOR.ENLARGE_INLINE, 1 );\n\n\t\t\t\t// This got to be done before bookmarks are created because purging\n\t\t\t\t// depends on the position of the range at the boundaries of the table,\n\t\t\t\t// usually distorted by bookmark spans.\n\t\t\t\thelpers.table.detectPurge( that );\n\n\t\t\t\t// We'll play with DOM, let's hold the position of the range.\n\t\t\t\tthat.bookmark = range.createBookmark();\n\t\t\t\t// While bookmarked, make unaccessible, to make sure that none of the methods\n\t\t\t\t// will try to use it (they should use that.bookmark).\n\t\t\t\t// This is done because ranges get desynchronized with the DOM when more bookmarks\n\t\t\t\t// is created (as for instance that.targetBookmark).\n\t\t\t\tdelete that.range;\n\n\t\t\t\t// The range to be restored after extraction should be kept\n\t\t\t\t// outside of the range, so it's not removed by range.extractContents.\n\t\t\t\tvar targetRange = this.editor.createRange();\n\t\t\t\ttargetRange.moveToPosition( that.bookmark.startNode, CKEDITOR.POSITION_BEFORE_START );\n\t\t\t\tthat.targetBookmark = targetRange.createBookmark();\n\n\t\t\t\t// Execute content-specific detections.\n\t\t\t\thelpers.list.detectMerge( that, this );\n\t\t\t\thelpers.table.detectRanges( that, this );\n\t\t\t\thelpers.block.detectMerge( that, this );\n\n\t\t\t\t// Simply, do the job.\n\t\t\t\tif ( that.tableContentsRanges ) {\n\t\t\t\t\thelpers.table.deleteRanges( that );\n\n\t\t\t\t\t// Done here only to remove bookmark's spans.\n\t\t\t\t\trange.moveToBookmark( that.bookmark );\n\t\t\t\t\tthat.range = range;\n\t\t\t\t} else {\n\t\t\t\t\t// To use the range we need to restore the bookmark and make\n\t\t\t\t\t// the range accessible again.\n\t\t\t\t\trange.moveToBookmark( that.bookmark );\n\t\t\t\t\tthat.range = range;\n\t\t\t\t\trange.extractContents( helpers.detectExtractMerge( that ) );\n\t\t\t\t}\n\n\t\t\t\t// Move working range to desired, pre-computed position.\n\t\t\t\trange.moveToBookmark( that.targetBookmark );\n\n\t\t\t\t// Make sure range is always anchored in an element. For consistency.\n\t\t\t\trange.optimize();\n\n\t\t\t\t// It my happen that the uncollapsed range which referred to a valid selection,\n\t\t\t\t// will be placed in an uneditable location after being collapsed:\n\t\t\t\t// <tr>[<td>x</td>]</tr> -> <tr>[]<td>x</td></tr> -> <tr><td>[]x</td></tr>\n\t\t\t\thelpers.fixUneditableRangePosition( range );\n\n\t\t\t\t// Execute content-specific post-extract routines.\n\t\t\t\thelpers.list.merge( that, this );\n\t\t\t\thelpers.table.purge( that, this );\n\t\t\t\thelpers.block.merge( that, this );\n\n\t\t\t\t// Remove empty block, duh!\n\t\t\t\tif ( removeEmptyBlock ) {\n\t\t\t\t\tvar path = range.startPath();\n\n\t\t\t\t\t// <p><b>^</b></p> is empty block.\n\t\t\t\t\tif (\n\t\t\t\t\t\trange.checkStartOfBlock() &&\n\t\t\t\t\t\trange.checkEndOfBlock() &&\n\t\t\t\t\t\tpath.block &&\n\t\t\t\t\t\t!range.root.equals( path.block ) &&\n\t\t\t\t\t\t// Do not remove a block with bookmarks. (#13465)\n\t\t\t\t\t\t!hasBookmarks( path.block ) ) {\n\t\t\t\t\t\trange.moveToPosition( path.block, CKEDITOR.POSITION_BEFORE_START );\n\t\t\t\t\t\tpath.block.remove();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Auto paragraph, if needed.\n\t\t\t\t\thelpers.autoParagraph( this.editor, range );\n\n\t\t\t\t\t// Let's have a bogus next to the caret, if needed.\n\t\t\t\t\tif ( isEmpty( range.startContainer ) )\n\t\t\t\t\t\trange.startContainer.appendBogus();\n\t\t\t\t}\n\n\t\t\t\t// Merge inline siblings if any around the caret.\n\t\t\t\trange.startContainer.mergeSiblings();\n\n\t\t\t\treturn extractedFragment;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Editable element bootstrapping.\n\t\t\t *\n\t\t\t * @private\n\t\t\t */\n\t\t\tsetup: function() {\n\t\t\t\tvar editor = this.editor;\n\n\t\t\t\t// Handle the load/read of editor data/snapshot.\n\t\t\t\tthis.attachListener( editor, 'beforeGetData', function() {\n\t\t\t\t\tvar data = this.getData();\n\n\t\t\t\t\t// Post processing html output of wysiwyg editable.\n\t\t\t\t\tif ( !this.is( 'textarea' ) ) {\n\t\t\t\t\t\t// Reset empty if the document contains only one empty paragraph.\n\t\t\t\t\t\tif ( editor.config.ignoreEmptyParagraph !== false )\n\t\t\t\t\t\t\tdata = data.replace( emptyParagraphRegexp, function( match, lookback ) {\n\t\t\t\t\t\t\t\treturn lookback;\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t\teditor.setData( data, null, 1 );\n\t\t\t\t}, this );\n\n\t\t\t\tthis.attachListener( editor, 'getSnapshot', function( evt ) {\n\t\t\t\t\tevt.data = this.getData( 1 );\n\t\t\t\t}, this );\n\n\t\t\t\tthis.attachListener( editor, 'afterSetData', function() {\n\t\t\t\t\tthis.setData( editor.getData( 1 ) );\n\t\t\t\t}, this );\n\t\t\t\tthis.attachListener( editor, 'loadSnapshot', function( evt ) {\n\t\t\t\t\tthis.setData( evt.data, 1 );\n\t\t\t\t}, this );\n\n\t\t\t\t// Delegate editor focus/blur to editable.\n\t\t\t\tthis.attachListener( editor, 'beforeFocus', function() {\n\t\t\t\t\tvar sel = editor.getSelection(),\n\t\t\t\t\t\tieSel = sel && sel.getNative();\n\n\t\t\t\t\t// IE considers control-type element as separate\n\t\t\t\t\t// focus host when selected, avoid destroying the\n\t\t\t\t\t// selection in such case. (#5812) (#8949)\n\t\t\t\t\tif ( ieSel && ieSel.type == 'Control' )\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tthis.focus();\n\t\t\t\t}, this );\n\n\t\t\t\tthis.attachListener( editor, 'insertHtml', function( evt ) {\n\t\t\t\t\tthis.insertHtml( evt.data.dataValue, evt.data.mode, evt.data.range );\n\t\t\t\t}, this );\n\t\t\t\tthis.attachListener( editor, 'insertElement', function( evt ) {\n\t\t\t\t\tthis.insertElement( evt.data );\n\t\t\t\t}, this );\n\t\t\t\tthis.attachListener( editor, 'insertText', function( evt ) {\n\t\t\t\t\tthis.insertText( evt.data );\n\t\t\t\t}, this );\n\n\t\t\t\t// Update editable state.\n\t\t\t\tthis.setReadOnly( editor.readOnly );\n\n\t\t\t\t// The editable class.\n\t\t\t\tthis.attachClass( 'cke_editable' );\n\n\t\t\t\t// The element mode css class.\n\t\t\t\tif ( editor.elementMode == CKEDITOR.ELEMENT_MODE_INLINE ) {\n\t\t\t\t\tthis.attachClass( 'cke_editable_inline' );\n\t\t\t\t} else if ( editor.elementMode == CKEDITOR.ELEMENT_MODE_REPLACE ||\n\t\t\t\t\teditor.elementMode == CKEDITOR.ELEMENT_MODE_APPENDTO ) {\n\t\t\t\t\tthis.attachClass( 'cke_editable_themed' );\n\t\t\t\t}\n\n\t\t\t\tthis.attachClass( 'cke_contents_' + editor.config.contentsLangDirection );\n\n\t\t\t\t// Setup editor keystroke handlers on this element.\n\t\t\t\tvar keystrokeHandler = editor.keystrokeHandler;\n\n\t\t\t\t// If editor is read-only, then make sure that BACKSPACE key\n\t\t\t\t// is blocked to prevent browser history navigation.\n\t\t\t\tkeystrokeHandler.blockedKeystrokes[ 8 ] = +editor.readOnly;\n\n\t\t\t\teditor.keystrokeHandler.attach( this );\n\n\t\t\t\t// Update focus states.\n\t\t\t\tthis.on( 'blur', function() {\n\t\t\t\t\tthis.hasFocus = false;\n\t\t\t\t}, null, null, -1 );\n\n\t\t\t\tthis.on( 'focus', function() {\n\t\t\t\t\tthis.hasFocus = true;\n\t\t\t\t}, null, null, -1 );\n\n\t\t\t\t// Register to focus manager.\n\t\t\t\teditor.focusManager.add( this );\n\n\t\t\t\t// Inherit the initial focus on editable element.\n\t\t\t\tif ( this.equals( CKEDITOR.document.getActive() ) ) {\n\t\t\t\t\tthis.hasFocus = true;\n\t\t\t\t\t// Pending until this editable has attached.\n\t\t\t\t\teditor.once( 'contentDom', function() {\n\t\t\t\t\t\teditor.focusManager.focus( this );\n\t\t\t\t\t}, this );\n\t\t\t\t}\n\n\t\t\t\t// Apply tab index on demand, with original direction saved.\n\t\t\t\tif ( this.isInline() ) {\n\n\t\t\t\t\t// tabIndex of the editable is different than editor's one.\n\t\t\t\t\t// Update the attribute of the editable.\n\t\t\t\t\tthis.changeAttr( 'tabindex', editor.tabIndex );\n\t\t\t\t}\n\n\t\t\t\t// The above is all we'll be doing for a <textarea> editable.\n\t\t\t\tif ( this.is( 'textarea' ) )\n\t\t\t\t\treturn;\n\n\t\t\t\t// The DOM document which the editing acts upon.\n\t\t\t\teditor.document = this.getDocument();\n\t\t\t\teditor.window = this.getWindow();\n\n\t\t\t\tvar doc = editor.document;\n\n\t\t\t\tthis.changeAttr( 'spellcheck', !editor.config.disableNativeSpellChecker );\n\n\t\t\t\t// Apply contents direction on demand, with original direction saved.\n\t\t\t\tvar dir = editor.config.contentsLangDirection;\n\t\t\t\tif ( this.getDirection( 1 ) != dir )\n\t\t\t\t\tthis.changeAttr( 'dir', dir );\n\n\t\t\t\t// Create the content stylesheet for this document.\n\t\t\t\tvar styles = CKEDITOR.getCss();\n\t\t\t\tif ( styles ) {\n\t\t\t\t\tvar head = doc.getHead(),\n\t\t\t\t\t\tstylesElement = head.getCustomData( 'stylesheet' );\n\n\t\t\t\t\tif ( !stylesElement ) {\n\t\t\t\t\t\tvar sheet = doc.appendStyleText( styles );\n\t\t\t\t\t\tsheet = new CKEDITOR.dom.element( sheet.ownerNode || sheet.owningElement );\n\t\t\t\t\t\thead.setCustomData( 'stylesheet', sheet );\n\t\t\t\t\t\tsheet.data( 'cke-temp', 1 );\n\t\t\t\t\t} else if ( styles != stylesElement.getText() ) {\n\t\t\t\t\t\tCKEDITOR.env.ie && CKEDITOR.env.version < 9 ? stylesElement.$.styleSheet.cssText = styles : stylesElement.setText( styles );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Update the stylesheet sharing count.\n\t\t\t\tvar ref = doc.getCustomData( 'stylesheet_ref' ) || 0;\n\t\t\t\tdoc.setCustomData( 'stylesheet_ref', ref + 1 );\n\n\t\t\t\t// Pass this configuration to styles system.\n\t\t\t\tthis.setCustomData( 'cke_includeReadonly', !editor.config.disableReadonlyStyling );\n\n\t\t\t\t// Prevent the browser opening read-only links. (#6032 & #10912)\n\t\t\t\tthis.attachListener( this, 'click', function( evt ) {\n\t\t\t\t\tevt = evt.data;\n\n\t\t\t\t\tvar link = new CKEDITOR.dom.elementPath( evt.getTarget(), this ).contains( 'a' );\n\n\t\t\t\t\tif ( link && evt.$.button != 2 && link.isReadOnly() )\n\t\t\t\t\t\tevt.preventDefault();\n\t\t\t\t} );\n\n\t\t\t\tvar backspaceOrDelete = { 8: 1, 46: 1 };\n\n\t\t\t\t// Override keystrokes which should have deletion behavior\n\t\t\t\t//  on fully selected element . (#4047) (#7645)\n\t\t\t\tthis.attachListener( editor, 'key', function( evt ) {\n\t\t\t\t\tif ( editor.readOnly )\n\t\t\t\t\t\treturn true;\n\n\t\t\t\t\t// Use getKey directly in order to ignore modifiers.\n\t\t\t\t\t// Justification: http://dev.ckeditor.com/ticket/11861#comment:13\n\t\t\t\t\tvar keyCode = evt.data.domEvent.getKey(),\n\t\t\t\t\t\tisHandled;\n\n\t\t\t\t\t// Backspace OR Delete.\n\t\t\t\t\tif ( keyCode in backspaceOrDelete ) {\n\t\t\t\t\t\tvar sel = editor.getSelection(),\n\t\t\t\t\t\t\tselected,\n\t\t\t\t\t\t\trange = sel.getRanges()[ 0 ],\n\t\t\t\t\t\t\tpath = range.startPath(),\n\t\t\t\t\t\t\tblock,\n\t\t\t\t\t\t\tparent,\n\t\t\t\t\t\t\tnext,\n\t\t\t\t\t\t\trtl = keyCode == 8;\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t// [IE<11] Remove selected image/anchor/etc here to avoid going back in history. (#10055)\n\t\t\t\t\t\t\t\t( CKEDITOR.env.ie && CKEDITOR.env.version < 11 && ( selected = sel.getSelectedElement() ) ) ||\n\t\t\t\t\t\t\t\t// Remove the entire list/table on fully selected content. (#7645)\n\t\t\t\t\t\t\t\t( selected = getSelectedTableList( sel ) ) ) {\n\t\t\t\t\t\t\t// Make undo snapshot.\n\t\t\t\t\t\t\teditor.fire( 'saveSnapshot' );\n\n\t\t\t\t\t\t\t// Delete any element that 'hasLayout' (e.g. hr,table) in IE8 will\n\t\t\t\t\t\t\t// break up the selection, safely manage it here. (#4795)\n\t\t\t\t\t\t\trange.moveToPosition( selected, CKEDITOR.POSITION_BEFORE_START );\n\t\t\t\t\t\t\t// Remove the control manually.\n\t\t\t\t\t\t\tselected.remove();\n\t\t\t\t\t\t\trange.select();\n\n\t\t\t\t\t\t\teditor.fire( 'saveSnapshot' );\n\n\t\t\t\t\t\t\tisHandled = 1;\n\t\t\t\t\t\t} else if ( range.collapsed ) {\n\t\t\t\t\t\t\t// Handle the following special cases: (#6217)\n\t\t\t\t\t\t\t// 1. Del/Backspace key before/after table;\n\t\t\t\t\t\t\t// 2. Backspace Key after start of table.\n\t\t\t\t\t\t\tif ( ( block = path.block ) &&\n\t\t\t\t\t\t\t\t\t( next = block[ rtl ? 'getPrevious' : 'getNext' ]( isNotWhitespace ) ) &&\n\t\t\t\t\t\t\t\t\t( next.type == CKEDITOR.NODE_ELEMENT ) &&\n\t\t\t\t\t\t\t\t\tnext.is( 'table' ) &&\n\t\t\t\t\t\t\t\t\trange[ rtl ? 'checkStartOfBlock' : 'checkEndOfBlock' ]() ) {\n\t\t\t\t\t\t\t\teditor.fire( 'saveSnapshot' );\n\n\t\t\t\t\t\t\t\t// Remove the current empty block.\n\t\t\t\t\t\t\t\tif ( range[ rtl ? 'checkEndOfBlock' : 'checkStartOfBlock' ]() )\n\t\t\t\t\t\t\t\t\tblock.remove();\n\n\t\t\t\t\t\t\t\t// Move cursor to the beginning/end of table cell.\n\t\t\t\t\t\t\t\trange[ 'moveToElementEdit' + ( rtl ? 'End' : 'Start' ) ]( next );\n\t\t\t\t\t\t\t\trange.select();\n\n\t\t\t\t\t\t\t\teditor.fire( 'saveSnapshot' );\n\n\t\t\t\t\t\t\t\tisHandled = 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if ( path.blockLimit && path.blockLimit.is( 'td' ) &&\n\t\t\t\t\t\t\t\t\t( parent = path.blockLimit.getAscendant( 'table' ) ) &&\n\t\t\t\t\t\t\t\t\trange.checkBoundaryOfElement( parent, rtl ? CKEDITOR.START : CKEDITOR.END ) &&\n\t\t\t\t\t\t\t\t\t( next = parent[ rtl ? 'getPrevious' : 'getNext' ]( isNotWhitespace ) ) ) {\n\t\t\t\t\t\t\t\teditor.fire( 'saveSnapshot' );\n\n\t\t\t\t\t\t\t\t// Move cursor to the end of previous block.\n\t\t\t\t\t\t\t\trange[ 'moveToElementEdit' + ( rtl ? 'End' : 'Start' ) ]( next );\n\n\t\t\t\t\t\t\t\t// Remove any previous empty block.\n\t\t\t\t\t\t\t\tif ( range.checkStartOfBlock() && range.checkEndOfBlock() )\n\t\t\t\t\t\t\t\t\tnext.remove();\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\trange.select();\n\n\t\t\t\t\t\t\t\teditor.fire( 'saveSnapshot' );\n\n\t\t\t\t\t\t\t\tisHandled = 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// BACKSPACE/DEL pressed at the start/end of table cell.\n\t\t\t\t\t\t\telse if ( ( parent = path.contains( [ 'td', 'th', 'caption' ] ) ) &&\n\t\t\t\t\t\t\t\t\trange.checkBoundaryOfElement( parent, rtl ? CKEDITOR.START : CKEDITOR.END ) ) {\n\t\t\t\t\t\t\t\tisHandled = 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn !isHandled;\n\t\t\t\t} );\n\n\t\t\t\t// On IE>=11 we need to fill blockless editable with <br> if it was deleted.\n\t\t\t\tif ( editor.blockless && CKEDITOR.env.ie && CKEDITOR.env.needsBrFiller ) {\n\t\t\t\t\tthis.attachListener( this, 'keyup', function( evt ) {\n\t\t\t\t\t\tif ( evt.data.getKeystroke() in backspaceOrDelete && !this.getFirst( isNotEmpty ) ) {\n\t\t\t\t\t\t\tthis.appendBogus();\n\n\t\t\t\t\t\t\t// Set the selection before bogus, because IE tends to put it after.\n\t\t\t\t\t\t\tvar range = editor.createRange();\n\t\t\t\t\t\t\trange.moveToPosition( this, CKEDITOR.POSITION_AFTER_START );\n\t\t\t\t\t\t\trange.select();\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\tthis.attachListener( this, 'dblclick', function( evt ) {\n\t\t\t\t\tif ( editor.readOnly )\n\t\t\t\t\t\treturn false;\n\n\t\t\t\t\tvar data = { element: evt.data.getTarget() };\n\t\t\t\t\teditor.fire( 'doubleclick', data );\n\t\t\t\t} );\n\n\t\t\t\t// Prevent automatic submission in IE #6336\n\t\t\t\tCKEDITOR.env.ie && this.attachListener( this, 'click', blockInputClick );\n\n\t\t\t\t// Gecko/Webkit need some help when selecting control type elements. (#3448)\n\t\t\t\t// We apply same behavior for IE Edge. (#13386)\n\t\t\t\tif ( !CKEDITOR.env.ie || CKEDITOR.env.edge ) {\n\t\t\t\t\tthis.attachListener( this, 'mousedown', function( ev ) {\n\t\t\t\t\t\tvar control = ev.data.getTarget();\n\t\t\t\t\t\t// #11727. Note: htmlDP assures that input/textarea/select have contenteditable=false\n\t\t\t\t\t\t// attributes. However, they also have data-cke-editable attribute, so isReadOnly() returns false,\n\t\t\t\t\t\t// and therefore those elements are correctly selected by this code.\n\t\t\t\t\t\tif ( control.is( 'img', 'hr', 'input', 'textarea', 'select' ) && !control.isReadOnly() ) {\n\t\t\t\t\t\t\teditor.getSelection().selectElement( control );\n\n\t\t\t\t\t\t\t// Prevent focus from stealing from the editable. (#9515)\n\t\t\t\t\t\t\tif ( control.is( 'input', 'textarea', 'select' ) )\n\t\t\t\t\t\t\t\tev.data.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\t// For some reason, after click event is done, IE Edge loses focus on the selected element. (#13386)\n\t\t\t\tif ( CKEDITOR.env.edge ) {\n\t\t\t\t\tthis.attachListener( this, 'mouseup', function( ev ) {\n\t\t\t\t\t\tvar selectedElement = ev.data.getTarget();\n\t\t\t\t\t\tif ( selectedElement && selectedElement.is( 'img' ) ) {\n\t\t\t\t\t\t\teditor.getSelection().selectElement( selectedElement );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\t// Prevent right click from selecting an empty block even\n\t\t\t\t// when selection is anchored inside it. (#5845)\n\t\t\t\tif ( CKEDITOR.env.gecko ) {\n\t\t\t\t\tthis.attachListener( this, 'mouseup', function( ev ) {\n\t\t\t\t\t\tif ( ev.data.$.button == 2 ) {\n\t\t\t\t\t\t\tvar target = ev.data.getTarget();\n\n\t\t\t\t\t\t\tif ( !target.getOuterHtml().replace( emptyParagraphRegexp, '' ) ) {\n\t\t\t\t\t\t\t\tvar range = editor.createRange();\n\t\t\t\t\t\t\t\trange.moveToElementEditStart( target );\n\t\t\t\t\t\t\t\trange.select( true );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\t// Webkit: avoid from editing form control elements content.\n\t\t\t\tif ( CKEDITOR.env.webkit ) {\n\t\t\t\t\t// Prevent from tick checkbox/radiobox/select\n\t\t\t\t\tthis.attachListener( this, 'click', function( ev ) {\n\t\t\t\t\t\tif ( ev.data.getTarget().is( 'input', 'select' ) )\n\t\t\t\t\t\t\tev.data.preventDefault();\n\t\t\t\t\t} );\n\n\t\t\t\t\t// Prevent from editig textfield/textarea value.\n\t\t\t\t\tthis.attachListener( this, 'mouseup', function( ev ) {\n\t\t\t\t\t\tif ( ev.data.getTarget().is( 'input', 'textarea' ) )\n\t\t\t\t\t\t\tev.data.preventDefault();\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\t// Prevent Webkit/Blink from going rogue when joining\n\t\t\t\t// blocks on BACKSPACE/DEL (#11861,#9998).\n\t\t\t\tif ( CKEDITOR.env.webkit ) {\n\t\t\t\t\tthis.attachListener( editor, 'key', function( evt ) {\n\t\t\t\t\t\tif ( editor.readOnly ) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Use getKey directly in order to ignore modifiers.\n\t\t\t\t\t\t// Justification: http://dev.ckeditor.com/ticket/11861#comment:13\n\t\t\t\t\t\tvar key = evt.data.domEvent.getKey();\n\n\t\t\t\t\t\tif ( !( key in backspaceOrDelete ) )\n\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\tvar backspace = key == 8,\n\t\t\t\t\t\t\trange = editor.getSelection().getRanges()[ 0 ],\n\t\t\t\t\t\t\tstartPath = range.startPath();\n\n\t\t\t\t\t\tif ( range.collapsed ) {\n\t\t\t\t\t\t\tif ( !mergeBlocksCollapsedSelection( editor, range, backspace, startPath ) )\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif ( !mergeBlocksNonCollapsedSelection( editor, range, startPath ) )\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Scroll to the new position of the caret (#11960).\n\t\t\t\t\t\teditor.getSelection().scrollIntoView();\n\t\t\t\t\t\teditor.fire( 'saveSnapshot' );\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}, this, null, 100 ); // Later is better – do not override existing listeners.\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_: {\n\t\t\tdetach: function() {\n\t\t\t\t// Update the editor cached data with current data.\n\t\t\t\tthis.editor.setData( this.editor.getData(), 0, 1 );\n\n\t\t\t\tthis.clearListeners();\n\t\t\t\tthis.restoreAttrs();\n\n\t\t\t\t// Cleanup our custom classes.\n\t\t\t\tvar classes;\n\t\t\t\tif ( ( classes = this.removeCustomData( 'classes' ) ) ) {\n\t\t\t\t\twhile ( classes.length )\n\t\t\t\t\t\tthis.removeClass( classes.pop() );\n\t\t\t\t}\n\n\t\t\t\t// Remove contents stylesheet from document if it's the last usage.\n\t\t\t\tif ( !this.is( 'textarea' ) ) {\n\t\t\t\t\tvar doc = this.getDocument(),\n\t\t\t\t\t\thead = doc.getHead();\n\t\t\t\t\tif ( head.getCustomData( 'stylesheet' ) ) {\n\t\t\t\t\t\tvar refs = doc.getCustomData( 'stylesheet_ref' );\n\t\t\t\t\t\tif ( !( --refs ) ) {\n\t\t\t\t\t\t\tdoc.removeCustomData( 'stylesheet_ref' );\n\t\t\t\t\t\t\tvar sheet = head.removeCustomData( 'stylesheet' );\n\t\t\t\t\t\t\tsheet.remove();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdoc.setCustomData( 'stylesheet_ref', refs );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.editor.fire( 'contentDomUnload' );\n\n\t\t\t\t// Free up the editor reference.\n\t\t\t\tdelete this.editor;\n\t\t\t}\n\t\t}\n\t} );\n\n\t/**\n\t * Creates, retrieves or detaches an editable element of the editor.\n\t * This method should always be used instead of calling {@link CKEDITOR.editable} directly.\n\t *\n\t * @method editable\n\t * @member CKEDITOR.editor\n\t * @param {CKEDITOR.dom.element/CKEDITOR.editable} elementOrEditable The\n\t * DOM element to become the editable or a {@link CKEDITOR.editable} object.\n\t */\n\tCKEDITOR.editor.prototype.editable = function( element ) {\n\t\tvar editable = this._.editable;\n\n\t\t// This editor has already associated with\n\t\t// an editable element, silently fails.\n\t\tif ( editable && element )\n\t\t\treturn 0;\n\n\t\tif ( arguments.length ) {\n\t\t\teditable = this._.editable = element ? ( element instanceof CKEDITOR.editable ? element : new CKEDITOR.editable( this, element ) ) :\n\t\t\t// Detach the editable from editor.\n\t\t\t( editable && editable.detach(), null );\n\t\t}\n\n\t\t// Just retrieve the editable.\n\t\treturn editable;\n\t};\n\n\tCKEDITOR.on( 'instanceLoaded', function( evt ) {\n\t\tvar editor = evt.editor;\n\n\t\t// and flag that the element was locked by our code so it'll be editable by the editor functions (#6046).\n\t\teditor.on( 'insertElement', function( evt ) {\n\t\t\tvar element = evt.data;\n\t\t\tif ( element.type == CKEDITOR.NODE_ELEMENT && ( element.is( 'input' ) || element.is( 'textarea' ) ) ) {\n\t\t\t\t// // The element is still not inserted yet, force attribute-based check.\n\t\t\t\tif ( element.getAttribute( 'contentEditable' ) != 'false' )\n\t\t\t\t\telement.data( 'cke-editable', element.hasAttribute( 'contenteditable' ) ? 'true' : '1' );\n\t\t\t\telement.setAttribute( 'contentEditable', false );\n\t\t\t}\n\t\t} );\n\n\t\teditor.on( 'selectionChange', function( evt ) {\n\t\t\tif ( editor.readOnly )\n\t\t\t\treturn;\n\n\t\t\t// Auto fixing on some document structure weakness to enhance usabilities. (#3190 and #3189)\n\t\t\tvar sel = editor.getSelection();\n\t\t\t// Do it only when selection is not locked. (#8222)\n\t\t\tif ( sel && !sel.isLocked ) {\n\t\t\t\tvar isDirty = editor.checkDirty();\n\n\t\t\t\t// Lock undoM before touching DOM to prevent\n\t\t\t\t// recording these changes as separate snapshot.\n\t\t\t\teditor.fire( 'lockSnapshot' );\n\t\t\t\tfixDom( evt );\n\t\t\t\teditor.fire( 'unlockSnapshot' );\n\n\t\t\t\t!isDirty && editor.resetDirty();\n\t\t\t}\n\t\t} );\n\t} );\n\n\tCKEDITOR.on( 'instanceCreated', function( evt ) {\n\t\tvar editor = evt.editor;\n\n\t\teditor.on( 'mode', function() {\n\n\t\t\tvar editable = editor.editable();\n\n\t\t\t// Setup proper ARIA roles and properties for inline editable, classic\n\t\t\t// (iframe-based) editable is instead handled by plugin.\n\t\t\tif ( editable && editable.isInline() ) {\n\n\t\t\t\tvar ariaLabel = editor.title;\n\n\t\t\t\teditable.changeAttr( 'role', 'textbox' );\n\t\t\t\teditable.changeAttr( 'aria-label', ariaLabel );\n\n\t\t\t\tif ( ariaLabel )\n\t\t\t\t\teditable.changeAttr( 'title', ariaLabel );\n\n\t\t\t\tvar helpLabel = editor.fire( 'ariaEditorHelpLabel', {} ).label;\n\t\t\t\tif ( helpLabel ) {\n\t\t\t\t\t// Put the voice label in different spaces, depending on element mode, so\n\t\t\t\t\t// the DOM element get auto detached on mode reload or editor destroy.\n\t\t\t\t\tvar ct = this.ui.space( this.elementMode == CKEDITOR.ELEMENT_MODE_INLINE ? 'top' : 'contents' );\n\t\t\t\t\tif ( ct ) {\n\t\t\t\t\t\tvar ariaDescId = CKEDITOR.tools.getNextId(),\n\t\t\t\t\t\t\tdesc = CKEDITOR.dom.element.createFromHtml( '<span id=\"' + ariaDescId + '\" class=\"cke_voice_label\">' + helpLabel + '</span>' );\n\t\t\t\t\t\tct.append( desc );\n\t\t\t\t\t\teditable.changeAttr( 'aria-describedby', ariaDescId );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t} );\n\n\t// #9222: Show text cursor in Gecko.\n\t// Show default cursor over control elements on all non-IEs.\n\tCKEDITOR.addCss( '.cke_editable{cursor:text}.cke_editable img,.cke_editable input,.cke_editable textarea{cursor:default}' );\n\n\t//\n\t//\n\t// Bazillion helpers for the editable class and above listeners.\n\t//\n\t//\n\n\tisNotWhitespace = CKEDITOR.dom.walker.whitespaces( true ),\n\tisNotBookmark = CKEDITOR.dom.walker.bookmark( false, true ),\n\tisEmpty = CKEDITOR.dom.walker.empty(),\n\tisBogus = CKEDITOR.dom.walker.bogus(),\n\t// Matching an empty paragraph at the end of document.\n\temptyParagraphRegexp = /(^|<body\\b[^>]*>)\\s*<(p|div|address|h\\d|center|pre)[^>]*>\\s*(?:<br[^>]*>|&nbsp;|\\u00A0|&#160;)?\\s*(:?<\\/\\2>)?\\s*(?=$|<\\/body>)/gi;\n\n\t// Auto-fixing block-less content by wrapping paragraph (#3190), prevent\n\t// non-exitable-block by padding extra br.(#3189)\n\t// Returns truly value when dom was changed, falsy otherwise.\n\tfunction fixDom( evt ) {\n\t\tvar editor = evt.editor,\n\t\t\tpath = evt.data.path,\n\t\t\tblockLimit = path.blockLimit,\n\t\t\tselection = evt.data.selection,\n\t\t\trange = selection.getRanges()[ 0 ],\n\t\t\tselectionUpdateNeeded;\n\n\t\tif ( CKEDITOR.env.gecko || ( CKEDITOR.env.ie && CKEDITOR.env.needsBrFiller ) ) {\n\t\t\tvar blockNeedsFiller = needsBrFiller( selection, path );\n\t\t\tif ( blockNeedsFiller ) {\n\t\t\t\tblockNeedsFiller.appendBogus();\n\t\t\t\t// IE tends to place selection after appended bogus, so we need to\n\t\t\t\t// select the original range (placed before bogus).\n\t\t\t\tselectionUpdateNeeded = CKEDITOR.env.ie;\n\t\t\t}\n\t\t}\n\n\t\t// When we're in block enter mode, a new paragraph will be established\n\t\t// to encapsulate inline contents inside editable. (#3657)\n\t\t// Don't autoparagraph if browser (namely - IE) incorrectly anchored selection\n\t\t// inside non-editable content. This happens e.g. if non-editable block is the only\n\t\t// content of editable.\n\t\tif ( shouldAutoParagraph( editor, path.block, blockLimit ) && range.collapsed && !range.getCommonAncestor().isReadOnly() ) {\n\t\t\tvar testRng = range.clone();\n\t\t\ttestRng.enlarge( CKEDITOR.ENLARGE_BLOCK_CONTENTS );\n\t\t\tvar walker = new CKEDITOR.dom.walker( testRng );\n\t\t\twalker.guard = function( node ) {\n\t\t\t\treturn !isNotEmpty( node ) ||\n\t\t\t\t\tnode.type == CKEDITOR.NODE_COMMENT ||\n\t\t\t\t\tnode.isReadOnly();\n\t\t\t};\n\n\t\t\t// 1. Inline content discovered under cursor;\n\t\t\t// 2. Empty editable.\n\t\t\tif ( !walker.checkForward() || testRng.checkStartOfBlock() && testRng.checkEndOfBlock() ) {\n\t\t\t\tvar fixedBlock = range.fixBlock( true, editor.activeEnterMode == CKEDITOR.ENTER_DIV ? 'div' : 'p' );\n\n\t\t\t\t// For IE<11, we should remove any filler node which was introduced before.\n\t\t\t\tif ( !CKEDITOR.env.needsBrFiller ) {\n\t\t\t\t\tvar first = fixedBlock.getFirst( isNotEmpty );\n\t\t\t\t\tif ( first && isNbsp( first ) )\n\t\t\t\t\t\tfirst.remove();\n\t\t\t\t}\n\n\t\t\t\tselectionUpdateNeeded = 1;\n\n\t\t\t\t// Cancel this selection change in favor of the next (correct). (#6811)\n\t\t\t\tevt.cancel();\n\t\t\t}\n\t\t}\n\n\t\tif ( selectionUpdateNeeded )\n\t\t\trange.select();\n\t}\n\n\t// Checks whether current selection requires br filler to be appended.\n\t// @returns Block which needs filler or falsy value.\n\tfunction needsBrFiller( selection, path ) {\n\t\t// Fake selection does not need filler, because it is fake.\n\t\tif ( selection.isFake )\n\t\t\treturn 0;\n\n\t\t// Ensure bogus br could help to move cursor (out of styles) to the end of block. (#7041)\n\t\tvar pathBlock = path.block || path.blockLimit,\n\t\t\tlastNode = pathBlock && pathBlock.getLast( isNotEmpty );\n\n\t\t// Check some specialities of the current path block:\n\t\t// 1. It is really displayed as block; (#7221)\n\t\t// 2. It doesn't end with one inner block; (#7467)\n\t\t// 3. It doesn't have bogus br yet.\n\t\tif (\n\t\t\tpathBlock && pathBlock.isBlockBoundary() &&\n\t\t\t!( lastNode && lastNode.type == CKEDITOR.NODE_ELEMENT && lastNode.isBlockBoundary() ) &&\n\t\t\t!pathBlock.is( 'pre' ) && !pathBlock.getBogus()\n\t\t)\n\t\t\treturn pathBlock;\n\t}\n\n\tfunction blockInputClick( evt ) {\n\t\tvar element = evt.data.getTarget();\n\t\tif ( element.is( 'input' ) ) {\n\t\t\tvar type = element.getAttribute( 'type' );\n\t\t\tif ( type == 'submit' || type == 'reset' )\n\t\t\t\tevt.data.preventDefault();\n\t\t}\n\t}\n\n\tfunction isNotEmpty( node ) {\n\t\treturn isNotWhitespace( node ) && isNotBookmark( node );\n\t}\n\n\tfunction isNbsp( node ) {\n\t\treturn node.type == CKEDITOR.NODE_TEXT && CKEDITOR.tools.trim( node.getText() ).match( /^(?:&nbsp;|\\xa0)$/ );\n\t}\n\n\tfunction isNotBubbling( fn, src ) {\n\t\treturn function( evt ) {\n\t\t\tvar other = evt.data.$.toElement || evt.data.$.fromElement || evt.data.$.relatedTarget;\n\n\t\t\t// First of all, other may simply be null/undefined.\n\t\t\t// Second of all, at least early versions of Spartan returned empty objects from evt.relatedTarget,\n\t\t\t// so let's also check the node type.\n\t\t\tother = ( other && other.nodeType == CKEDITOR.NODE_ELEMENT ) ? new CKEDITOR.dom.element( other ) : null;\n\n\t\t\tif ( !( other && ( src.equals( other ) || src.contains( other ) ) ) )\n\t\t\t\tfn.call( this, evt );\n\t\t};\n\t}\n\n\tfunction hasBookmarks( element ) {\n\t\t// We use getElementsByTag() instead of find() to retain compatibility with IE quirks mode.\n\t\tvar potentialBookmarks = element.getElementsByTag( 'span' ),\n\t\t\ti = 0,\n\t\t\tchild;\n\n\t\tif ( potentialBookmarks ) {\n\t\t\twhile ( ( child = potentialBookmarks.getItem( i++ ) ) ) {\n\t\t\t\tif ( !isNotBookmark( child ) ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t// Check if the entire table/list contents is selected.\n\tfunction getSelectedTableList( sel ) {\n\t\tvar selected,\n\t\t\trange = sel.getRanges()[ 0 ],\n\t\t\teditable = sel.root,\n\t\t\tpath = range.startPath(),\n\t\t\tstructural = { table: 1, ul: 1, ol: 1, dl: 1 };\n\n\t\tif ( path.contains( structural ) ) {\n\t\t\t// Clone the original range.\n\t\t\tvar walkerRng = range.clone();\n\n\t\t\t// Enlarge the range: X<ul><li>[Y]</li></ul>X => [X<ul><li>]Y</li></ul>X\n\t\t\twalkerRng.collapse( 1 );\n\t\t\twalkerRng.setStartAt( editable, CKEDITOR.POSITION_AFTER_START );\n\n\t\t\t// Create a new walker.\n\t\t\tvar walker = new CKEDITOR.dom.walker( walkerRng );\n\n\t\t\t// Assign a new guard to the walker.\n\t\t\twalker.guard = guard();\n\n\t\t\t// Go backwards checking for selected structural node.\n\t\t\twalker.checkBackward();\n\n\t\t\t// If there's a selected structured element when checking backwards,\n\t\t\t// then check the same forwards.\n\t\t\tif ( selected ) {\n\t\t\t\t// Clone the original range.\n\t\t\t\twalkerRng = range.clone();\n\n\t\t\t\t// Enlarge the range (assuming <ul> is selected element from guard):\n\t\t\t\t//\n\t\t\t\t// \t   X<ul><li>[Y]</li></ul>X    =>    X<ul><li>Y[</li></ul>]X\n\t\t\t\t//\n\t\t\t\t// If the walker went deeper down DOM than a while ago when traversing\n\t\t\t\t// backwards, then it doesn't make sense: an element must be selected\n\t\t\t\t// symmetrically. By placing range end **after previously selected node**,\n\t\t\t\t// we make sure we don't go no deeper in DOM when going forwards.\n\t\t\t\twalkerRng.collapse();\n\t\t\t\twalkerRng.setEndAt( selected, CKEDITOR.POSITION_AFTER_END );\n\n\t\t\t\t// Create a new walker.\n\t\t\t\twalker = new CKEDITOR.dom.walker( walkerRng );\n\n\t\t\t\t// Assign a new guard to the walker.\n\t\t\t\twalker.guard = guard( true );\n\n\t\t\t\t// Reset selected node.\n\t\t\t\tselected = false;\n\n\t\t\t\t// Go forwards checking for selected structural node.\n\t\t\t\twalker.checkForward();\n\n\t\t\t\treturn selected;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\n\t\tfunction guard( forwardGuard ) {\n\t\t\treturn function( node, isWalkOut ) {\n\t\t\t\t// Save the encountered node as selected if going down the DOM structure\n\t\t\t\t// and the node is structured element.\n\t\t\t\tif ( isWalkOut && node.type == CKEDITOR.NODE_ELEMENT && node.is( structural ) )\n\t\t\t\t\tselected = node;\n\n\t\t\t\t// Stop the walker when either traversing another non-empty node at the same\n\t\t\t\t// DOM level as in previous step.\n\t\t\t\t// NOTE: When going forwards, stop if encountered a bogus.\n\t\t\t\tif ( !isWalkOut && isNotEmpty( node ) && !( forwardGuard && isBogus( node ) ) )\n\t\t\t\t\treturn false;\n\t\t\t};\n\t\t}\n\t}\n\n\t// Whether in given context (pathBlock, pathBlockLimit and editor settings)\n\t// editor should automatically wrap inline contents with blocks.\n\tfunction shouldAutoParagraph( editor, pathBlock, pathBlockLimit ) {\n\t\t// Check whether pathBlock equals pathBlockLimit to support nested editable (#12162).\n\t\treturn editor.config.autoParagraph !== false &&\n\t\t\teditor.activeEnterMode != CKEDITOR.ENTER_BR &&\n\t\t\t(\n\t\t\t\t( editor.editable().equals( pathBlockLimit ) && !pathBlock ) ||\n\t\t\t\t( pathBlock && pathBlock.getAttribute( 'contenteditable' ) == 'true' )\n\t\t\t);\n\t}\n\n\tfunction autoParagraphTag( editor ) {\n\t\treturn ( editor.activeEnterMode != CKEDITOR.ENTER_BR && editor.config.autoParagraph !== false ) ? editor.activeEnterMode == CKEDITOR.ENTER_DIV ? 'div' : 'p' : false;\n\t}\n\n\t//\n\t// Functions related to insertXXX methods\n\t//\n\tinsert = ( function() {\n\t\t'use strict';\n\n\t\tvar DTD = CKEDITOR.dtd;\n\n\t\t// Inserts the given (valid) HTML into the range position (with range content deleted),\n\t\t// guarantee it's result to be a valid DOM tree.\n\t\tfunction insert( editable, type, data, range ) {\n\t\t\tvar editor = editable.editor,\n\t\t\t\tdontFilter = false;\n\n\t\t\tif ( type == 'unfiltered_html' ) {\n\t\t\t\ttype = 'html';\n\t\t\t\tdontFilter = true;\n\t\t\t}\n\n\t\t\t// Check range spans in non-editable.\n\t\t\tif ( range.checkReadOnly() )\n\t\t\t\treturn;\n\n\t\t\t// RANGE PREPARATIONS\n\n\t\t\tvar path = new CKEDITOR.dom.elementPath( range.startContainer, range.root ),\n\t\t\t\t// Let root be the nearest block that's impossible to be split\n\t\t\t\t// during html processing.\n\t\t\t\tblockLimit = path.blockLimit || range.root,\n\t\t\t\t// The \"state\" value.\n\t\t\t\tthat = {\n\t\t\t\t\ttype: type,\n\t\t\t\t\tdontFilter: dontFilter,\n\t\t\t\t\teditable: editable,\n\t\t\t\t\teditor: editor,\n\t\t\t\t\trange: range,\n\t\t\t\t\tblockLimit: blockLimit,\n\t\t\t\t\t// During pre-processing / preparations startContainer of affectedRange should be placed\n\t\t\t\t\t// in this element in which inserted or moved (in case when we merge blocks) content\n\t\t\t\t\t// could create situation that will need merging inline elements.\n\t\t\t\t\t// Examples:\n\t\t\t\t\t// <div><b>A</b>^B</div> + <b>C</b> => <div><b>A</b><b>C</b>B</div> - affected container is <div>.\n\t\t\t\t\t// <p><b>A[B</b></p><p><b>C]D</b></p> + E => <p><b>AE</b></p><p><b>D</b></p> =>\n\t\t\t\t\t//\t\t<p><b>AE</b><b>D</b></p> - affected container is <p> (in text mode).\n\t\t\t\t\tmergeCandidates: [],\n\t\t\t\t\tzombies: []\n\t\t\t\t};\n\n\t\t\tprepareRangeToDataInsertion( that );\n\n\t\t\t// DATA PROCESSING\n\n\t\t\t// Select range and stop execution.\n\t\t\t// If data has been totally emptied after the filtering,\n\t\t\t// any insertion is pointless (#10339).\n\t\t\tif ( data && processDataForInsertion( that, data ) ) {\n\t\t\t\t// DATA INSERTION\n\t\t\t\tinsertDataIntoRange( that );\n\t\t\t}\n\n\t\t\t// FINAL CLEANUP\n\t\t\t// Set final range position and clean up.\n\n\t\t\tcleanupAfterInsertion( that );\n\t\t}\n\n\t\t// Prepare range to its data deletion.\n\t\t// Delete its contents.\n\t\t// Prepare it to insertion.\n\t\tfunction prepareRangeToDataInsertion( that ) {\n\t\t\tvar range = that.range,\n\t\t\t\tmergeCandidates = that.mergeCandidates,\n\t\t\t\tnode, marker, path, startPath, endPath, previous, bm;\n\n\t\t\t// If range starts in inline element then insert a marker, so empty\n\t\t\t// inline elements won't be removed while range.deleteContents\n\t\t\t// and we will be able to move range back into this element.\n\t\t\t// E.g. 'aa<b>[bb</b>]cc' -> (after deleting) 'aa<b><span/></b>cc'\n\t\t\tif ( that.type == 'text' && range.shrink( CKEDITOR.SHRINK_ELEMENT, true, false ) ) {\n\t\t\t\tmarker = CKEDITOR.dom.element.createFromHtml( '<span>&nbsp;</span>', range.document );\n\t\t\t\trange.insertNode( marker );\n\t\t\t\trange.setStartAfter( marker );\n\t\t\t}\n\n\t\t\t// By using path we can recover in which element was startContainer\n\t\t\t// before deleting contents.\n\t\t\t// Start and endPathElements will be used to squash selected blocks, after removing\n\t\t\t// selection contents. See rule 5.\n\t\t\tstartPath = new CKEDITOR.dom.elementPath( range.startContainer );\n\t\t\tthat.endPath = endPath = new CKEDITOR.dom.elementPath( range.endContainer );\n\n\t\t\tif ( !range.collapsed ) {\n\t\t\t\t// Anticipate the possibly empty block at the end of range after deletion.\n\t\t\t\tnode = endPath.block || endPath.blockLimit;\n\t\t\t\tvar ancestor = range.getCommonAncestor();\n\t\t\t\tif ( node && !( node.equals( ancestor ) || node.contains( ancestor ) ) && range.checkEndOfBlock() ) {\n\t\t\t\t\tthat.zombies.push( node );\n\t\t\t\t}\n\n\t\t\t\trange.deleteContents();\n\t\t\t}\n\n\t\t\t// Rule 4.\n\t\t\t// Move range into the previous block.\n\t\t\twhile (\n\t\t\t\t( previous = getRangePrevious( range ) ) && checkIfElement( previous ) && previous.isBlockBoundary() &&\n\t\t\t\t// Check if previousNode was parent of range's startContainer before deleteContents.\n\t\t\t\tstartPath.contains( previous )\n\t\t\t)\n\t\t\t\trange.moveToPosition( previous, CKEDITOR.POSITION_BEFORE_END );\n\n\t\t\t// Rule 5.\n\t\t\tmergeAncestorElementsOfSelectionEnds( range, that.blockLimit, startPath, endPath );\n\n\t\t\t// Rule 1.\n\t\t\tif ( marker ) {\n\t\t\t\t// If marker was created then move collapsed range into its place.\n\t\t\t\trange.setEndBefore( marker );\n\t\t\t\trange.collapse();\n\t\t\t\tmarker.remove();\n\t\t\t}\n\n\t\t\t// Split inline elements so HTML will be inserted with its own styles.\n\t\t\tpath = range.startPath();\n\t\t\tif ( ( node = path.contains( isInline, false, 1 ) ) ) {\n\t\t\t\trange.splitElement( node );\n\t\t\t\tthat.inlineStylesRoot = node;\n\t\t\t\tthat.inlineStylesPeak = path.lastElement;\n\t\t\t}\n\n\t\t\t// Record inline merging candidates for later cleanup in place.\n\t\t\tbm = range.createBookmark();\n\n\t\t\t// 1. Inline siblings.\n\t\t\tnode = bm.startNode.getPrevious( isNotEmpty );\n\t\t\tnode && checkIfElement( node ) && isInline( node ) && mergeCandidates.push( node );\n\t\t\tnode = bm.startNode.getNext( isNotEmpty );\n\t\t\tnode && checkIfElement( node ) && isInline( node ) && mergeCandidates.push( node );\n\n\t\t\t// 2. Inline parents.\n\t\t\tnode = bm.startNode;\n\t\t\twhile ( ( node = node.getParent() ) && isInline( node ) )\n\t\t\t\tmergeCandidates.push( node );\n\n\t\t\trange.moveToBookmark( bm );\n\t\t}\n\n\t\tfunction processDataForInsertion( that, data ) {\n\t\t\tvar range = that.range;\n\n\t\t\t// Rule 8. - wrap entire data in inline styles.\n\t\t\t// (e.g. <p><b>x^z</b></p> + <p>a</p><p>b</p> -> <b><p>a</p><p>b</p></b>)\n\t\t\t// Incorrect tags order will be fixed by htmlDataProcessor.\n\t\t\tif ( that.type == 'text' && that.inlineStylesRoot )\n\t\t\t\tdata = wrapDataWithInlineStyles( data, that );\n\n\n\t\t\tvar context = that.blockLimit.getName();\n\n\t\t\t// Wrap data to be inserted, to avoid losing leading whitespaces\n\t\t\t// when going through the below procedure.\n\t\t\tif ( /^\\s+|\\s+$/.test( data ) && 'span' in CKEDITOR.dtd[ context ] ) {\n\t\t\t\tvar protect = '<span data-cke-marker=\"1\">&nbsp;</span>';\n\t\t\t\tdata =  protect + data + protect;\n\t\t\t}\n\n\t\t\t// Process the inserted html, in context of the insertion root.\n\t\t\t// Don't use the \"fix for body\" feature as auto paragraphing must\n\t\t\t// be handled during insertion.\n\t\t\tdata = that.editor.dataProcessor.toHtml( data, {\n\t\t\t\tcontext: null,\n\t\t\t\tfixForBody: false,\n\t\t\t\tprotectedWhitespaces: !!protect,\n\t\t\t\tdontFilter: that.dontFilter,\n\t\t\t\t// Use the current, contextual settings.\n\t\t\t\tfilter: that.editor.activeFilter,\n\t\t\t\tenterMode: that.editor.activeEnterMode\n\t\t\t} );\n\n\n\t\t\t// Build the node list for insertion.\n\t\t\tvar doc = range.document,\n\t\t\t\twrapper = doc.createElement( 'body' );\n\n\t\t\twrapper.setHtml( data );\n\n\t\t\t// Eventually remove the temporaries.\n\t\t\tif ( protect ) {\n\t\t\t\twrapper.getFirst().remove();\n\t\t\t\twrapper.getLast().remove();\n\t\t\t}\n\n\t\t\t// Rule 7.\n\t\t\tvar block = range.startPath().block;\n\t\t\tif ( block &&\t\t\t\t\t\t\t\t\t\t\t\t\t// Apply when there exists path block after deleting selection's content...\n\t\t\t\t!( block.getChildCount() == 1 && block.getBogus() ) ) {\t\t// ... and the only content of this block isn't a bogus.\n\t\t\t\tstripBlockTagIfSingleLine( wrapper );\n\t\t\t}\n\n\t\t\tthat.dataWrapper = wrapper;\n\n\t\t\treturn data;\n\t\t}\n\n\t\tfunction insertDataIntoRange( that ) {\n\t\t\tvar range = that.range,\n\t\t\t\tdoc = range.document,\n\t\t\t\tpath,\n\t\t\t\tblockLimit = that.blockLimit,\n\t\t\t\tnodesData, nodeData, node,\n\t\t\t\tnodeIndex = 0,\n\t\t\t\tbogus,\n\t\t\t\tbogusNeededBlocks = [],\n\t\t\t\tpathBlock, fixBlock,\n\t\t\t\tsplittingContainer = 0,\n\t\t\t\tdontMoveCaret = 0,\n\t\t\t\tinsertionContainer, toSplit, newContainer,\n\t\t\t\tstartContainer = range.startContainer,\n\t\t\t\tendContainer = that.endPath.elements[ 0 ],\n\t\t\t\tfilteredNodes,\n\t\t\t\t// If endContainer was merged into startContainer: <p>a[b</p><p>c]d</p>\n\t\t\t\t// or it's equal to startContainer: <p>a^b</p>\n\t\t\t\t// or different situation happened :P\n\t\t\t\t// then there's no separate container for the end of selection.\n\t\t\t\tpos = endContainer.getPosition( startContainer ),\n\t\t\t\tseparateEndContainer = !!endContainer.getCommonAncestor( startContainer ) && // endC is not detached.\n\t\t\t\t\tpos != CKEDITOR.POSITION_IDENTICAL && !( pos & CKEDITOR.POSITION_CONTAINS + CKEDITOR.POSITION_IS_CONTAINED ); // endC & endS are in separate branches.\n\n\t\t\tnodesData = extractNodesData( that.dataWrapper, that );\n\n\t\t\tremoveBrsAdjacentToPastedBlocks( nodesData, range );\n\n\t\t\tfor ( ; nodeIndex < nodesData.length; nodeIndex++ ) {\n\t\t\t\tnodeData = nodesData[ nodeIndex ];\n\n\t\t\t\t// Ignore trailing <brs>\n\t\t\t\tif ( nodeData.isLineBreak && splitOnLineBreak( range, blockLimit, nodeData ) ) {\n\t\t\t\t\t// Do not move caret towards the text (in cleanupAfterInsertion),\n\t\t\t\t\t// because caret was placed after a line break.\n\t\t\t\t\tdontMoveCaret = nodeIndex > 0;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tpath = range.startPath();\n\n\t\t\t\t// Auto paragraphing.\n\t\t\t\tif ( !nodeData.isBlock && shouldAutoParagraph( that.editor, path.block, path.blockLimit ) && ( fixBlock = autoParagraphTag( that.editor ) ) ) {\n\t\t\t\t\tfixBlock = doc.createElement( fixBlock );\n\t\t\t\t\tfixBlock.appendBogus();\n\t\t\t\t\trange.insertNode( fixBlock );\n\t\t\t\t\tif ( CKEDITOR.env.needsBrFiller && ( bogus = fixBlock.getBogus() ) )\n\t\t\t\t\t\tbogus.remove();\n\t\t\t\t\trange.moveToPosition( fixBlock, CKEDITOR.POSITION_BEFORE_END );\n\t\t\t\t}\n\n\t\t\t\tnode = range.startPath().block;\n\n\t\t\t\t// Remove any bogus element on the current path block for now, and mark\n\t\t\t\t// it for later compensation.\n\t\t\t\tif ( node && !node.equals( pathBlock ) ) {\n\t\t\t\t\tbogus = node.getBogus();\n\t\t\t\t\tif ( bogus ) {\n\t\t\t\t\t\tbogus.remove();\n\t\t\t\t\t\tbogusNeededBlocks.push( node );\n\t\t\t\t\t}\n\n\t\t\t\t\tpathBlock = node;\n\t\t\t\t}\n\n\t\t\t\t// First not allowed node reached - start splitting original container\n\t\t\t\tif ( nodeData.firstNotAllowed )\n\t\t\t\t\tsplittingContainer = 1;\n\n\t\t\t\tif ( splittingContainer && nodeData.isElement ) {\n\t\t\t\t\tinsertionContainer = range.startContainer;\n\t\t\t\t\ttoSplit = null;\n\n\t\t\t\t\t// Find the first ancestor that can contain current node.\n\t\t\t\t\t// This one won't be split.\n\t\t\t\t\twhile ( insertionContainer && !DTD[ insertionContainer.getName() ][ nodeData.name ] ) {\n\t\t\t\t\t\tif ( insertionContainer.equals( blockLimit ) ) {\n\t\t\t\t\t\t\tinsertionContainer = null;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttoSplit = insertionContainer;\n\t\t\t\t\t\tinsertionContainer = insertionContainer.getParent();\n\t\t\t\t\t}\n\n\t\t\t\t\t// If split has to be done - do it and mark both ends as a possible zombies.\n\t\t\t\t\tif ( insertionContainer ) {\n\t\t\t\t\t\tif ( toSplit ) {\n\t\t\t\t\t\t\tnewContainer = range.splitElement( toSplit );\n\t\t\t\t\t\t\tthat.zombies.push( newContainer );\n\t\t\t\t\t\t\tthat.zombies.push( toSplit );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// Unable to make the insertion happen in place, resort to the content filter.\n\t\t\t\t\telse {\n\t\t\t\t\t\t// If everything worked fine insertionContainer == blockLimit here.\n\t\t\t\t\t\tfilteredNodes = filterElement( nodeData.node, blockLimit.getName(), !nodeIndex, nodeIndex == nodesData.length - 1 );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( filteredNodes ) {\n\t\t\t\t\twhile ( ( node = filteredNodes.pop() ) )\n\t\t\t\t\t\trange.insertNode( node );\n\t\t\t\t\tfilteredNodes = 0;\n\t\t\t\t} else {\n\t\t\t\t\t// Insert current node at the start of range.\n\t\t\t\t\trange.insertNode( nodeData.node );\n\t\t\t\t}\n\n\t\t\t\t// Move range to the endContainer for the final allowed elements.\n\t\t\t\tif ( nodeData.lastNotAllowed && nodeIndex < nodesData.length - 1 ) {\n\t\t\t\t\t// If separateEndContainer exists move range there.\n\t\t\t\t\t// Otherwise try to move range to container created during splitting.\n\t\t\t\t\t// If this doesn't work - don't move range.\n\t\t\t\t\tnewContainer = separateEndContainer ? endContainer : newContainer;\n\t\t\t\t\tnewContainer && range.setEndAt( newContainer, CKEDITOR.POSITION_AFTER_START );\n\t\t\t\t\tsplittingContainer = 0;\n\t\t\t\t}\n\n\t\t\t\t// Collapse range after insertion to end.\n\t\t\t\trange.collapse();\n\t\t\t}\n\n\t\t\t// Rule 9. Non-editable content should be selected as a whole.\n\t\t\tif ( isSingleNonEditableElement( nodesData ) ) {\n\t\t\t\tdontMoveCaret = true;\n\t\t\t\tnode = nodesData[ 0 ].node;\n\t\t\t\trange.setStartAt( node, CKEDITOR.POSITION_BEFORE_START );\n\t\t\t\trange.setEndAt( node, CKEDITOR.POSITION_AFTER_END );\n\t\t\t}\n\n\t\t\tthat.dontMoveCaret = dontMoveCaret;\n\t\t\tthat.bogusNeededBlocks = bogusNeededBlocks;\n\t\t}\n\n\t\tfunction cleanupAfterInsertion( that ) {\n\t\t\tvar range = that.range,\n\t\t\t\tnode, testRange, movedIntoInline,\n\t\t\t\tbogusNeededBlocks = that.bogusNeededBlocks,\n\t\t\t\t// Create a bookmark to defend against the following range deconstructing operations.\n\t\t\t\tbm = range.createBookmark();\n\n\t\t\t// Remove all elements that could be created while splitting nodes\n\t\t\t// with ranges at its start|end.\n\t\t\t// E.g. remove <div><p></p></div>\n\t\t\t// But not <div><p> </p></div>\n\t\t\t// And replace <div><p><span data=\"cke-bookmark\"/></p></div> with found bookmark.\n\t\t\twhile ( ( node = that.zombies.pop() ) ) {\n\t\t\t\t// Detached element.\n\t\t\t\tif ( !node.getParent() )\n\t\t\t\t\tcontinue;\n\n\t\t\t\ttestRange = range.clone();\n\t\t\t\ttestRange.moveToElementEditStart( node );\n\t\t\t\ttestRange.removeEmptyBlocksAtEnd();\n\t\t\t}\n\n\t\t\tif ( bogusNeededBlocks ) {\n\t\t\t\t// Bring back all block bogus nodes.\n\t\t\t\twhile ( ( node = bogusNeededBlocks.pop() ) ) {\n\t\t\t\t\tif ( CKEDITOR.env.needsBrFiller )\n\t\t\t\t\t\tnode.appendBogus();\n\t\t\t\t\telse\n\t\t\t\t\t\tnode.append( range.document.createText( '\\u00a0' ) );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Eventually merge identical inline elements.\n\t\t\twhile ( ( node = that.mergeCandidates.pop() ) )\n\t\t\t\tnode.mergeSiblings();\n\n\t\t\trange.moveToBookmark( bm );\n\n\t\t\t// Rule 3.\n\t\t\t// Shrink range to the BEFOREEND of previous innermost editable node in source order.\n\n\t\t\tif ( !that.dontMoveCaret ) {\n\t\t\t\tnode = getRangePrevious( range );\n\n\t\t\t\twhile ( node && checkIfElement( node ) && !node.is( DTD.$empty ) ) {\n\t\t\t\t\tif ( node.isBlockBoundary() )\n\t\t\t\t\t\trange.moveToPosition( node, CKEDITOR.POSITION_BEFORE_END );\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Don't move into inline element (which ends with a text node)\n\t\t\t\t\t\t// found which contains white-space at its end.\n\t\t\t\t\t\t// If not - move range's end to the end of this element.\n\t\t\t\t\t\tif ( isInline( node ) && node.getHtml().match( /(\\s|&nbsp;)$/g ) ) {\n\t\t\t\t\t\t\tmovedIntoInline = null;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmovedIntoInline = range.clone();\n\t\t\t\t\t\tmovedIntoInline.moveToPosition( node, CKEDITOR.POSITION_BEFORE_END );\n\t\t\t\t\t}\n\n\t\t\t\t\tnode = node.getLast( isNotEmpty );\n\t\t\t\t}\n\n\t\t\t\tmovedIntoInline && range.moveToRange( movedIntoInline );\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\t\t// HELPERS ------------------------------------------------------------\n\t\t//\n\n\t\tfunction checkIfElement( node ) {\n\t\t\treturn node.type == CKEDITOR.NODE_ELEMENT;\n\t\t}\n\n\t\tfunction extractNodesData( dataWrapper, that ) {\n\t\t\tvar node, sibling, nodeName, allowed,\n\t\t\t\tnodesData = [],\n\t\t\t\tstartContainer = that.range.startContainer,\n\t\t\t\tpath = that.range.startPath(),\n\t\t\t\tallowedNames = DTD[ startContainer.getName() ],\n\t\t\t\tnodeIndex = 0,\n\t\t\t\tnodesList = dataWrapper.getChildren(),\n\t\t\t\tnodesCount = nodesList.count(),\n\t\t\t\tfirstNotAllowed = -1,\n\t\t\t\tlastNotAllowed = -1,\n\t\t\t\tlineBreak = 0,\n\t\t\t\tblockSibling;\n\n\t\t\t// Selection start within a list.\n\t\t\tvar insideOfList = path.contains( DTD.$list );\n\n\t\t\tfor ( ; nodeIndex < nodesCount; ++nodeIndex ) {\n\t\t\t\tnode = nodesList.getItem( nodeIndex );\n\n\t\t\t\tif ( checkIfElement( node ) ) {\n\t\t\t\t\tnodeName = node.getName();\n\n\t\t\t\t\t// Extract only the list items, when insertion happens\n\t\t\t\t\t// inside of a list, reads as rearrange list items. (#7957)\n\t\t\t\t\tif ( insideOfList && nodeName in CKEDITOR.dtd.$list ) {\n\t\t\t\t\t\tnodesData = nodesData.concat( extractNodesData( node, that ) );\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tallowed = !!allowedNames[ nodeName ];\n\n\t\t\t\t\t// Mark <brs data-cke-eol=\"1\"> at the beginning and at the end.\n\t\t\t\t\tif ( nodeName == 'br' && node.data( 'cke-eol' ) && ( !nodeIndex || nodeIndex == nodesCount - 1 ) ) {\n\t\t\t\t\t\tsibling = nodeIndex ? nodesData[ nodeIndex - 1 ].node : nodesList.getItem( nodeIndex + 1 );\n\n\t\t\t\t\t\t// Line break has to have sibling which is not an <br>.\n\t\t\t\t\t\tlineBreak = sibling && ( !checkIfElement( sibling ) || !sibling.is( 'br' ) );\n\t\t\t\t\t\t// Line break has block element as a sibling.\n\t\t\t\t\t\tblockSibling = sibling && checkIfElement( sibling ) && DTD.$block[ sibling.getName() ];\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( firstNotAllowed == -1 && !allowed )\n\t\t\t\t\t\tfirstNotAllowed = nodeIndex;\n\t\t\t\t\tif ( !allowed )\n\t\t\t\t\t\tlastNotAllowed = nodeIndex;\n\n\t\t\t\t\tnodesData.push( {\n\t\t\t\t\t\tisElement: 1,\n\t\t\t\t\t\tisLineBreak: lineBreak,\n\t\t\t\t\t\tisBlock: node.isBlockBoundary(),\n\t\t\t\t\t\thasBlockSibling: blockSibling,\n\t\t\t\t\t\tnode: node,\n\t\t\t\t\t\tname: nodeName,\n\t\t\t\t\t\tallowed: allowed\n\t\t\t\t\t} );\n\n\t\t\t\t\tlineBreak = 0;\n\t\t\t\t\tblockSibling = 0;\n\t\t\t\t} else {\n\t\t\t\t\tnodesData.push( { isElement: 0, node: node, allowed: 1 } );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Mark first node that cannot be inserted directly into startContainer\n\t\t\t// and last node for which startContainer has to be split.\n\t\t\tif ( firstNotAllowed > -1 )\n\t\t\t\tnodesData[ firstNotAllowed ].firstNotAllowed = 1;\n\t\t\tif ( lastNotAllowed > -1 )\n\t\t\t\tnodesData[ lastNotAllowed ].lastNotAllowed = 1;\n\n\t\t\treturn nodesData;\n\t\t}\n\n\t\t// TODO: Review content transformation rules on filtering element.\n\t\tfunction filterElement( element, parentName, isFirst, isLast ) {\n\t\t\tvar nodes = filterElementInner( element, parentName ),\n\t\t\t\tnodes2 = [],\n\t\t\t\tnodesCount = nodes.length,\n\t\t\t\tnodeIndex = 0,\n\t\t\t\tnode,\n\t\t\t\tafterSpace = 0,\n\t\t\t\tlastSpaceIndex = -1;\n\n\t\t\t// Remove duplicated spaces and spaces at the:\n\t\t\t// * beginnig if filtered element isFirst (isFirst that's going to be inserted)\n\t\t\t// * end if filtered element isLast.\n\t\t\tfor ( ; nodeIndex < nodesCount; nodeIndex++ ) {\n\t\t\t\tnode = nodes[ nodeIndex ];\n\n\t\t\t\tif ( node == ' ' ) {\n\t\t\t\t\t// Don't push doubled space and if it's leading space for insertion.\n\t\t\t\t\tif ( !afterSpace && !( isFirst && !nodeIndex ) ) {\n\t\t\t\t\t\tnodes2.push( new CKEDITOR.dom.text( ' ' ) );\n\t\t\t\t\t\tlastSpaceIndex = nodes2.length;\n\t\t\t\t\t}\n\t\t\t\t\tafterSpace = 1;\n\t\t\t\t} else {\n\t\t\t\t\tnodes2.push( node );\n\t\t\t\t\tafterSpace = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Remove trailing space.\n\t\t\tif ( isLast && lastSpaceIndex == nodes2.length )\n\t\t\t\tnodes2.pop();\n\n\t\t\treturn nodes2;\n\t\t}\n\n\t\tfunction filterElementInner( element, parentName ) {\n\t\t\tvar nodes = [],\n\t\t\t\tchildren = element.getChildren(),\n\t\t\t\tchildrenCount = children.count(),\n\t\t\t\tchild,\n\t\t\t\tchildIndex = 0,\n\t\t\t\tallowedNames = DTD[ parentName ],\n\t\t\t\tsurroundBySpaces = !element.is( DTD.$inline ) || element.is( 'br' );\n\n\t\t\tif ( surroundBySpaces )\n\t\t\t\tnodes.push( ' ' );\n\n\t\t\tfor ( ; childIndex < childrenCount; childIndex++ ) {\n\t\t\t\tchild = children.getItem( childIndex );\n\n\t\t\t\tif ( checkIfElement( child ) && !child.is( allowedNames ) )\n\t\t\t\t\tnodes = nodes.concat( filterElementInner( child, parentName ) );\n\t\t\t\telse\n\t\t\t\t\tnodes.push( child );\n\t\t\t}\n\n\t\t\tif ( surroundBySpaces )\n\t\t\t\tnodes.push( ' ' );\n\n\t\t\treturn nodes;\n\t\t}\n\n\t\tfunction getRangePrevious( range ) {\n\t\t\treturn checkIfElement( range.startContainer ) && range.startContainer.getChild( range.startOffset - 1 );\n\t\t}\n\n\t\tfunction isInline( node ) {\n\t\t\treturn node && checkIfElement( node ) && ( node.is( DTD.$removeEmpty ) || node.is( 'a' ) && !node.isBlockBoundary() );\n\t\t}\n\n\t\t// Checks if only non-editable element is being inserted.\n\t\tfunction isSingleNonEditableElement( nodesData ) {\n\t\t\tif ( nodesData.length != 1 )\n\t\t\t\treturn false;\n\n\t\t\tvar nodeData = nodesData[ 0 ];\n\n\t\t\treturn nodeData.isElement && ( nodeData.node.getAttribute( 'contenteditable' ) == 'false' );\n\t\t}\n\n\t\tvar blockMergedTags = { p: 1, div: 1, h1: 1, h2: 1, h3: 1, h4: 1, h5: 1, h6: 1, ul: 1, ol: 1, li: 1, pre: 1, dl: 1, blockquote: 1 };\n\n\t\t// See rule 5. in TCs.\n\t\t// Initial situation:\n\t\t// <ul><li>AA^</li></ul><ul><li>BB</li></ul>\n\t\t// We're looking for 2nd <ul>, comparing with 1st <ul> and merging.\n\t\t// We're not merging if caret is between these elements.\n\t\tfunction mergeAncestorElementsOfSelectionEnds( range, blockLimit, startPath, endPath ) {\n\t\t\tvar walkerRange = range.clone(),\n\t\t\t\twalker, nextNode, previousNode;\n\n\t\t\twalkerRange.setEndAt( blockLimit, CKEDITOR.POSITION_BEFORE_END );\n\t\t\twalker = new CKEDITOR.dom.walker( walkerRange );\n\n\t\t\tif ( ( nextNode = walker.next() ) &&\t\t\t\t\t\t\t// Find next source node\n\t\t\t\tcheckIfElement( nextNode ) &&\t\t\t\t\t\t\t\t// which is an element\n\t\t\t\tblockMergedTags[ nextNode.getName() ] &&\t\t\t\t\t// that can be merged.\n\t\t\t\t( previousNode = nextNode.getPrevious() ) &&\t\t\t\t// Take previous one\n\t\t\t\tcheckIfElement( previousNode ) &&\t\t\t\t\t\t\t// which also has to be an element.\n\t\t\t\t!previousNode.getParent().equals( range.startContainer ) && // Fail if caret is on the same level.\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// This means that caret is between these nodes.\n\t\t\t\tstartPath.contains( previousNode ) &&\t\t\t\t\t\t// Elements path of start of selection has\n\t\t\t\tendPath.contains( nextNode ) &&\t\t\t\t\t\t\t\t// to contain prevNode and vice versa.\n\t\t\t\tnextNode.isIdentical( previousNode )\t\t\t\t\t\t// Check if elements are identical.\n\t\t\t) {\n\t\t\t\t// Merge blocks and repeat.\n\t\t\t\tnextNode.moveChildren( previousNode );\n\t\t\t\tnextNode.remove();\n\t\t\t\tmergeAncestorElementsOfSelectionEnds( range, blockLimit, startPath, endPath );\n\t\t\t}\n\t\t}\n\n\t\t// If last node that will be inserted is a block (but not a <br>)\n\t\t// and it will be inserted right before <br> remove this <br>.\n\t\t// Do the same for the first element that will be inserted and preceding <br>.\n\t\tfunction removeBrsAdjacentToPastedBlocks( nodesData, range ) {\n\t\t\tvar succeedingNode = range.endContainer.getChild( range.endOffset ),\n\t\t\t\tprecedingNode = range.endContainer.getChild( range.endOffset - 1 );\n\n\t\t\tif ( succeedingNode )\n\t\t\t\tremove( succeedingNode, nodesData[ nodesData.length - 1 ] );\n\n\t\t\tif ( precedingNode && remove( precedingNode, nodesData[ 0 ] ) ) {\n\t\t\t\t// If preceding <br> was removed - move range left.\n\t\t\t\trange.setEnd( range.endContainer, range.endOffset - 1 );\n\t\t\t\trange.collapse();\n\t\t\t}\n\n\t\t\tfunction remove( maybeBr, maybeBlockData ) {\n\t\t\t\tif ( maybeBlockData.isBlock && maybeBlockData.isElement && !maybeBlockData.node.is( 'br' ) &&\n\t\t\t\t\tcheckIfElement( maybeBr ) && maybeBr.is( 'br' ) ) {\n\t\t\t\t\tmaybeBr.remove();\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Return 1 if <br> should be skipped when inserting, 0 otherwise.\n\t\tfunction splitOnLineBreak( range, blockLimit, nodeData ) {\n\t\t\tvar firstBlockAscendant, pos;\n\n\t\t\tif ( nodeData.hasBlockSibling )\n\t\t\t\treturn 1;\n\n\t\t\tfirstBlockAscendant = range.startContainer.getAscendant( DTD.$block, 1 );\n\t\t\tif ( !firstBlockAscendant || !firstBlockAscendant.is( { div: 1, p: 1 } ) )\n\t\t\t\treturn 0;\n\n\t\t\tpos = firstBlockAscendant.getPosition( blockLimit );\n\n\t\t\tif ( pos == CKEDITOR.POSITION_IDENTICAL || pos == CKEDITOR.POSITION_CONTAINS )\n\t\t\t\treturn 0;\n\n\t\t\tvar newContainer = range.splitElement( firstBlockAscendant );\n\t\t\trange.moveToPosition( newContainer, CKEDITOR.POSITION_AFTER_START );\n\n\t\t\treturn 1;\n\t\t}\n\n\t\tvar stripSingleBlockTags = { p: 1, div: 1, h1: 1, h2: 1, h3: 1, h4: 1, h5: 1, h6: 1 },\n\t\t\tinlineButNotBr = CKEDITOR.tools.extend( {}, DTD.$inline );\n\t\tdelete inlineButNotBr.br;\n\n\t\t// Rule 7.\n\t\tfunction stripBlockTagIfSingleLine( dataWrapper ) {\n\t\t\tvar block, children;\n\n\t\t\tif ( dataWrapper.getChildCount() == 1 &&\t\t\t\t\t// Only one node bein inserted.\n\t\t\t\tcheckIfElement( block = dataWrapper.getFirst() ) &&\t\t// And it's an element.\n\t\t\t\tblock.is( stripSingleBlockTags ) &&\t\t\t\t\t\t// That's <p> or <div> or header.\n\t\t\t\t!block.hasAttribute( 'contenteditable' )\t\t\t\t// It's not a non-editable block or nested editable.\n\t\t\t) {\n\t\t\t\t// Check children not containing block.\n\t\t\t\tchildren = block.getElementsByTag( '*' );\n\t\t\t\tfor ( var i = 0, child, count = children.count(); i < count; i++ ) {\n\t\t\t\t\tchild = children.getItem( i );\n\t\t\t\t\tif ( !child.is( inlineButNotBr ) )\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tblock.moveChildren( block.getParent( 1 ) );\n\t\t\t\tblock.remove();\n\t\t\t}\n\t\t}\n\n\t\tfunction wrapDataWithInlineStyles( data, that ) {\n\t\t\tvar element = that.inlineStylesPeak,\n\t\t\t\tdoc = element.getDocument(),\n\t\t\t\twrapper = doc.createText( '{cke-peak}' ),\n\t\t\t\tlimit = that.inlineStylesRoot.getParent();\n\n\t\t\twhile ( !element.equals( limit ) ) {\n\t\t\t\twrapper = wrapper.appendTo( element.clone() );\n\t\t\t\telement = element.getParent();\n\t\t\t}\n\n\t\t\t// Don't use String.replace because it fails in IE7 if special replacement\n\t\t\t// characters ($$, $&, etc.) are in data (#10367).\n\t\t\treturn wrapper.getOuterHtml().split( '{cke-peak}' ).join( data );\n\t\t}\n\n\t\treturn insert;\n\t} )();\n\n\tfunction afterInsert( editable ) {\n\t\tvar editor = editable.editor;\n\n\t\t// Scroll using selection, not ranges, to affect native pastes.\n\t\teditor.getSelection().scrollIntoView();\n\n\t\t// Save snaps after the whole execution completed.\n\t\t// This's a workaround for make DOM modification's happened after\n\t\t// 'insertElement' to be included either, e.g. Form-based dialogs' 'commitContents'\n\t\t// call.\n\t\tsetTimeout( function() {\n\t\t\teditor.fire( 'saveSnapshot' );\n\t\t}, 0 );\n\t}\n\n\t// 1. Fixes a range which is a result of deleteContents() and is placed in an intermediate element (see dtd.$intermediate),\n\t// inside a table. A goal is to find a closest <td> or <th> element and when this fails, recreate the structure of the table.\n\t// 2. Fixes empty cells by appending bogus <br>s or deleting empty text nodes in IE<=8 case.\n\tfixTableAfterContentsDeletion = ( function() {\n\t\t// Creates an element walker which can only \"go deeper\". It won't\n\t\t// move out from any element. Therefore it can be used to find <td>x</td> in cases like:\n\t\t// <table><tbody><tr><td>x</td></tr></tbody>^<tfoot>...\n\t\tfunction getFixTableSelectionWalker( testRange ) {\n\t\t\tvar walker = new CKEDITOR.dom.walker( testRange );\n\t\t\twalker.guard = function( node, isMovingOut ) {\n\t\t\t\tif ( isMovingOut )\n\t\t\t\t\treturn false;\n\t\t\t\tif ( node.type == CKEDITOR.NODE_ELEMENT )\n\t\t\t\t\treturn node.is( CKEDITOR.dtd.$tableContent );\n\t\t\t};\n\t\t\twalker.evaluator = function( node ) {\n\t\t\t\treturn node.type == CKEDITOR.NODE_ELEMENT;\n\t\t\t};\n\n\t\t\treturn walker;\n\t\t}\n\n\t\tfunction fixTableStructure( element, newElementName, appendToStart ) {\n\t\t\tvar temp = element.getDocument().createElement( newElementName );\n\t\t\telement.append( temp, appendToStart );\n\t\t\treturn temp;\n\t\t}\n\n\t\t// Fix empty cells. This means:\n\t\t// * add bogus <br> if browser needs it\n\t\t// * remove empty text nodes on IE8, because it will crash (http://dev.ckeditor.com/ticket/11183#comment:8).\n\t\tfunction fixEmptyCells( cells ) {\n\t\t\tvar i = cells.count(),\n\t\t\t\tcell;\n\n\t\t\tfor ( i; i-- > 0; ) {\n\t\t\t\tcell = cells.getItem( i );\n\n\t\t\t\tif ( !CKEDITOR.tools.trim( cell.getHtml() ) ) {\n\t\t\t\t\tcell.appendBogus();\n\t\t\t\t\tif ( CKEDITOR.env.ie && CKEDITOR.env.version < 9 && cell.getChildCount() )\n\t\t\t\t\t\tcell.getFirst().remove();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn function( range ) {\n\t\t\tvar container = range.startContainer,\n\t\t\t\ttable = container.getAscendant( 'table', 1 ),\n\t\t\t\ttestRange,\n\t\t\t\tdeeperSibling,\n\t\t\t\tappendToStart = false;\n\n\t\t\tfixEmptyCells( table.getElementsByTag( 'td' ) );\n\t\t\tfixEmptyCells( table.getElementsByTag( 'th' ) );\n\n\t\t\t// Look left.\n\t\t\ttestRange = range.clone();\n\t\t\ttestRange.setStart( container, 0 );\n\t\t\tdeeperSibling = getFixTableSelectionWalker( testRange ).lastBackward();\n\n\t\t\t// If left is empty, look right.\n\t\t\tif ( !deeperSibling ) {\n\t\t\t\ttestRange = range.clone();\n\t\t\t\ttestRange.setEndAt( container, CKEDITOR.POSITION_BEFORE_END );\n\t\t\t\tdeeperSibling = getFixTableSelectionWalker( testRange ).lastForward();\n\t\t\t\tappendToStart = true;\n\t\t\t}\n\n\t\t\t// If there's no deeper nested element in both direction - container is empty - we'll use it then.\n\t\t\tif ( !deeperSibling )\n\t\t\t\tdeeperSibling = container;\n\n\t\t\t// Fix structure...\n\n\t\t\t// We found a table what means that it's empty - remove it completely.\n\t\t\tif ( deeperSibling.is( 'table' ) ) {\n\t\t\t\trange.setStartAt( deeperSibling, CKEDITOR.POSITION_BEFORE_START );\n\t\t\t\trange.collapse( true );\n\t\t\t\tdeeperSibling.remove();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Found an empty txxx element - append tr.\n\t\t\tif ( deeperSibling.is( { tbody: 1, thead: 1, tfoot: 1 } ) )\n\t\t\t\tdeeperSibling = fixTableStructure( deeperSibling, 'tr', appendToStart );\n\n\t\t\t// Found an empty tr element - append td/th.\n\t\t\tif ( deeperSibling.is( 'tr' ) )\n\t\t\t\tdeeperSibling = fixTableStructure( deeperSibling, deeperSibling.getParent().is( 'thead' ) ? 'th' : 'td', appendToStart );\n\n\t\t\t// To avoid setting selection after bogus, remove it from the current cell.\n\t\t\t// We can safely do that, because we'll insert element into that cell.\n\t\t\tvar bogus = deeperSibling.getBogus();\n\t\t\tif ( bogus )\n\t\t\t\tbogus.remove();\n\n\t\t\trange.moveToPosition( deeperSibling, appendToStart ? CKEDITOR.POSITION_AFTER_START : CKEDITOR.POSITION_BEFORE_END );\n\t\t};\n\t} )();\n\n\tfunction mergeBlocksCollapsedSelection( editor, range, backspace, startPath ) {\n\t\tvar startBlock = startPath.block;\n\n\t\t// Selection must be collapsed and to be anchored in a block.\n\t\tif ( !startBlock )\n\t\t\treturn false;\n\n\t\t// Exclude cases where, i.e. if pressed arrow key, selection\n\t\t// would move within the same block (merge inside a block).\n\t\tif ( !range[ backspace ? 'checkStartOfBlock' : 'checkEndOfBlock' ]() )\n\t\t\treturn false;\n\n\t\t// Make sure, there's an editable position to put selection,\n\t\t// which i.e. would be used if pressed arrow key, but abort\n\t\t// if such position exists but means a selected non-editable element.\n\t\tif ( !range.moveToClosestEditablePosition( startBlock, !backspace ) || !range.collapsed )\n\t\t\treturn false;\n\n\t\t// Handle special case, when block's sibling is a <hr>. Delete it and keep selection\n\t\t// in the same place (http://dev.ckeditor.com/ticket/11861#comment:9).\n\t\tif ( range.startContainer.type == CKEDITOR.NODE_ELEMENT ) {\n\t\t\tvar touched = range.startContainer.getChild( range.startOffset - ( backspace ? 1 : 0 ) );\n\t\t\tif ( touched && touched.type  == CKEDITOR.NODE_ELEMENT && touched.is( 'hr' ) ) {\n\t\t\t\teditor.fire( 'saveSnapshot' );\n\t\t\t\ttouched.remove();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tvar siblingBlock = range.startPath().block;\n\n\t\t// Abort if an editable position exists, but either it's not\n\t\t// in a block or that block is the parent of the start block\n\t\t// (merging child into parent).\n\t\tif ( !siblingBlock || ( siblingBlock && siblingBlock.contains( startBlock ) ) )\n\t\t\treturn;\n\n\t\teditor.fire( 'saveSnapshot' );\n\n\t\t// Remove bogus to avoid duplicated boguses.\n\t\tvar bogus;\n\t\tif ( ( bogus = ( backspace ? siblingBlock : startBlock ).getBogus() ) )\n\t\t\tbogus.remove();\n\n\t\t// Save selection. It will be restored.\n\t\tvar selection = editor.getSelection(),\n\t\t\tbookmarks = selection.createBookmarks();\n\n\t\t// Merge blocks.\n\t\t( backspace ? startBlock : siblingBlock ).moveChildren( backspace ? siblingBlock : startBlock, false );\n\n\t\t// Also merge children along with parents.\n\t\tstartPath.lastElement.mergeSiblings();\n\n\t\t// Cut off removable branch of the DOM tree.\n\t\tpruneEmptyDisjointAncestors( startBlock, siblingBlock, !backspace );\n\n\t\t// Restore selection.\n\t\tselection.selectBookmarks( bookmarks );\n\n\t\treturn true;\n\t}\n\n\tfunction mergeBlocksNonCollapsedSelection( editor, range, startPath ) {\n\t\tvar startBlock = startPath.block,\n\t\t\tendPath = range.endPath(),\n\t\t\tendBlock = endPath.block;\n\n\t\t// Selection must be anchored in two different blocks.\n\t\tif ( !startBlock || !endBlock || startBlock.equals( endBlock ) )\n\t\t\treturn false;\n\n\t\teditor.fire( 'saveSnapshot' );\n\n\t\t// Remove bogus to avoid duplicated boguses.\n\t\tvar bogus;\n\t\tif ( ( bogus = startBlock.getBogus() ) )\n\t\t\tbogus.remove();\n\n\t\t// Changing end container to element from text node (#12503).\n\t\trange.enlarge( CKEDITOR.ENLARGE_INLINE );\n\n\t\t// Delete range contents. Do NOT merge. Merging is weird.\n\t\trange.deleteContents();\n\n\t\t// If something has left of the block to be merged, clean it up.\n\t\t// It may happen when merging with list items.\n\t\tif ( endBlock.getParent() ) {\n\t\t\t// Move children to the first block.\n\t\t\tendBlock.moveChildren( startBlock, false );\n\n\t\t\t// ...and merge them if that's possible.\n\t\t\tstartPath.lastElement.mergeSiblings();\n\n\t\t\t// If expanded selection, things are always merged like with BACKSPACE.\n\t\t\tpruneEmptyDisjointAncestors( startBlock, endBlock, true );\n\t\t}\n\n\t\t// Make sure the result selection is collapsed.\n\t\trange = editor.getSelection().getRanges()[ 0 ];\n\t\trange.collapse( 1 );\n\n\t\t// Optimizing range containers from text nodes to elements (#12503).\n\t\trange.optimize();\n\t\tif ( range.startContainer.getHtml() === '' ) {\n\t\t\trange.startContainer.appendBogus();\n\t\t}\n\n\t\trange.select();\n\n\t\treturn true;\n\t}\n\n\t// Finds the innermost child of common parent, which,\n\t// if removed, removes nothing but the contents of the element.\n\t//\n\t//\tbefore: <div><p><strong>first</strong></p><p>second</p></div>\n\t//\tafter:  <div><p>second</p></div>\n\t//\n\t//\tbefore: <div><p>x<strong>first</strong></p><p>second</p></div>\n\t//\tafter:  <div><p>x</p><p>second</p></div>\n\t//\n\t//\tisPruneToEnd=true\n\t//\tbefore: <div><p><strong>first</strong></p><p>second</p></div>\n\t//\tafter:  <div><p><strong>first</strong></p></div>\n\t//\n\t// @param {CKEDITOR.dom.element} first\n\t// @param {CKEDITOR.dom.element} second\n\t// @param {Boolean} isPruneToEnd\n\tfunction pruneEmptyDisjointAncestors( first, second, isPruneToEnd ) {\n\t\tvar commonParent = first.getCommonAncestor( second ),\n\t\t\tnode = isPruneToEnd ? second : first,\n\t\t\tremovableParent = node;\n\n\t\twhile ( ( node = node.getParent() ) && !commonParent.equals( node ) && node.getChildCount() == 1 )\n\t\t\tremovableParent = node;\n\n\t\tremovableParent.remove();\n\t}\n\n\t//\n\t// Helpers for editable.getHtmlFromRange.\n\t//\n\tgetHtmlFromRangeHelpers = {\n\t\teol: {\n\t\t\tdetect: function( that, editable ) {\n\t\t\t\tvar range = that.range,\n\t\t\t\t\trangeStart = range.clone(),\n\t\t\t\t\trangeEnd = range.clone(),\n\n\t\t\t\t\tstartPath = new CKEDITOR.dom.elementPath( range.startContainer, editable ),\n\t\t\t\t\tendPath = new CKEDITOR.dom.elementPath( range.endContainer, editable );\n\n\t\t\t\t// Note: checkBoundaryOfElement will not work on original range as CKEDITOR.START|END\n\t\t\t\t// means that range start|end must be literally anchored at block start|end, e.g.\n\t\t\t\t//\n\t\t\t\t// \t\t<p>a{</p><p>}b</p>\n\t\t\t\t//\n\t\t\t\t// will return false for both paragraphs but two similar ranges\n\t\t\t\t//\n\t\t\t\t// \t\t<p>a{}</p><p>{}b</p>\n\t\t\t\t//\n\t\t\t\t// will return true if checked separately.\n\t\t\t\trangeStart.collapse( 1 );\n\t\t\t\trangeEnd.collapse();\n\n\t\t\t\tif ( startPath.block && rangeStart.checkBoundaryOfElement( startPath.block, CKEDITOR.END ) ) {\n\t\t\t\t\trange.setStartAfter( startPath.block );\n\t\t\t\t\tthat.prependEolBr = 1;\n\t\t\t\t}\n\n\t\t\t\tif ( endPath.block && rangeEnd.checkBoundaryOfElement( endPath.block, CKEDITOR.START ) ) {\n\t\t\t\t\trange.setEndBefore( endPath.block );\n\t\t\t\t\tthat.appendEolBr = 1;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tfix: function( that, editable ) {\n\t\t\t\tvar doc = editable.getDocument(),\n\t\t\t\t\tappended;\n\n\t\t\t\t// Append <br data-cke-eol=\"1\"> to the fragment.\n\t\t\t\tif ( that.appendEolBr ) {\n\t\t\t\t\tappended = this.createEolBr( doc );\n\t\t\t\t\tthat.fragment.append( appended );\n\t\t\t\t}\n\n\t\t\t\t// Prepend <br data-cke-eol=\"1\"> to the fragment but avoid duplicates. Such\n\t\t\t\t// elements should never follow each other in DOM.\n\t\t\t\tif ( that.prependEolBr && ( !appended || appended.getPrevious() ) ) {\n\t\t\t\t\tthat.fragment.append( this.createEolBr( doc ), 1 );\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tcreateEolBr: function( doc ) {\n\t\t\t\treturn doc.createElement( 'br', {\n\t\t\t\t\tattributes: {\n\t\t\t\t\t\t'data-cke-eol': 1\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t},\n\n\t\tbogus: {\n\t\t\texclude: function( that ) {\n\t\t\t\tvar boundaryNodes = that.range.getBoundaryNodes(),\n\t\t\t\t\tstartNode = boundaryNodes.startNode,\n\t\t\t\t\tendNode = boundaryNodes.endNode;\n\n\t\t\t\t// If bogus is the last node in range but not the only node, exclude it.\n\t\t\t\tif ( endNode && isBogus( endNode ) && ( !startNode || !startNode.equals( endNode ) ) )\n\t\t\t\t\tthat.range.setEndBefore( endNode );\n\t\t\t}\n\t\t},\n\n\t\ttree: {\n\t\t\trebuild: function( that, editable ) {\n\t\t\t\tvar range = that.range,\n\t\t\t\t\tnode = range.getCommonAncestor(),\n\n\t\t\t\t\t// A path relative to the common ancestor.\n\t\t\t\t\tcommonPath = new CKEDITOR.dom.elementPath( node, editable ),\n\t\t\t\t\tstartPath = new CKEDITOR.dom.elementPath( range.startContainer, editable ),\n\t\t\t\t\tendPath = new CKEDITOR.dom.elementPath( range.endContainer, editable ),\n\t\t\t\t\tlimit;\n\n\t\t\t\tif ( node.type == CKEDITOR.NODE_TEXT )\n\t\t\t\t\tnode = node.getParent();\n\n\t\t\t\t// Fix DOM of partially enclosed tables\n\t\t\t\t// \t\t<table><tbody><tr><td>a{b</td><td>c}d</td></tr></tbody></table>\n\t\t\t\t// Full table is returned\n\t\t\t\t// \t\t<table><tbody><tr><td>b</td><td>c</td></tr></tbody></table>\n\t\t\t\t// instead of\n\t\t\t\t// \t\t<td>b</td><td>c</td>\n\t\t\t\tif ( commonPath.blockLimit.is( { tr: 1, table: 1 } ) ) {\n\t\t\t\t\tvar tableParent = commonPath.contains( 'table' ).getParent();\n\n\t\t\t\t\tlimit = function( node ) {\n\t\t\t\t\t\treturn !node.equals( tableParent );\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\t// Fix DOM in the following case\n\t\t\t\t// \t\t<ol><li>a{b<ul><li>c}d</li></ul></li></ol>\n\t\t\t\t// Full list is returned\n\t\t\t\t// \t\t<ol><li>b<ul><li>c</li></ul></li></ol>\n\t\t\t\t// instead of\n\t\t\t\t// \t\tb<ul><li>c</li></ul>\n\t\t\t\telse if ( commonPath.block && commonPath.block.is( CKEDITOR.dtd.$listItem ) ) {\n\t\t\t\t\tvar startList = startPath.contains( CKEDITOR.dtd.$list ),\n\t\t\t\t\t\tendList = endPath.contains( CKEDITOR.dtd.$list );\n\n\t\t\t\t\tif ( !startList.equals( endList ) ) {\n\t\t\t\t\t\tvar listParent = commonPath.contains( CKEDITOR.dtd.$list ).getParent();\n\n\t\t\t\t\t\tlimit = function( node ) {\n\t\t\t\t\t\t\treturn !node.equals( listParent );\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// If not defined, use generic limit function.\n\t\t\t\tif ( !limit ) {\n\t\t\t\t\tlimit = function( node ) {\n\t\t\t\t\t\treturn !node.equals( commonPath.block ) && !node.equals( commonPath.blockLimit );\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tthis.rebuildFragment( that, editable, node, limit );\n\t\t\t},\n\n\t\t\trebuildFragment: function( that, editable, node, checkLimit ) {\n\t\t\t\tvar clone;\n\n\t\t\t\twhile ( node && !node.equals( editable ) && checkLimit( node ) ) {\n\t\t\t\t\t// Don't clone children. Preserve element ids.\n\t\t\t\t\tclone = node.clone( 0, 1 );\n\t\t\t\t\tthat.fragment.appendTo( clone );\n\t\t\t\t\tthat.fragment = clone;\n\n\t\t\t\t\tnode = node.getParent();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tcell: {\n\t\t\t// Handle range anchored in table row with a single cell enclosed:\n\t\t\t// \t\t<table><tbody><tr>[<td>a</td>]</tr></tbody></table>\n\t\t\t// becomes\n\t\t\t// \t\t<table><tbody><tr><td>{a}</td></tr></tbody></table>\n\t\t\tshrink: function( that ) {\n\t\t\t\tvar range = that.range,\n\t\t\t\t\tstartContainer = range.startContainer,\n\t\t\t\t\tendContainer = range.endContainer,\n\t\t\t\t\tstartOffset = range.startOffset,\n\t\t\t\t\tendOffset = range.endOffset;\n\n\t\t\t\tif ( startContainer.type == CKEDITOR.NODE_ELEMENT && startContainer.equals( endContainer ) && startContainer.is( 'tr' ) && ++startOffset == endOffset ) {\n\t\t\t\t\trange.shrink( CKEDITOR.SHRINK_TEXT );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\t//\n\t// Helpers for editable.extractHtmlFromRange.\n\t//\n\textractHtmlFromRangeHelpers = ( function() {\n\t\tfunction optimizeBookmarkNode( node, toStart ) {\n\t\t\tvar parent = node.getParent();\n\n\t\t\tif ( parent.is( CKEDITOR.dtd.$inline ) )\n\t\t\t\tnode[ toStart ? 'insertBefore' : 'insertAfter' ]( parent );\n\t\t}\n\n\t\tfunction mergeElements( merged, startBookmark, endBookmark ) {\n\t\t\toptimizeBookmarkNode( startBookmark );\n\t\t\toptimizeBookmarkNode( endBookmark, 1 );\n\n\t\t\tvar next;\n\t\t\twhile ( ( next = endBookmark.getNext() ) ) {\n\t\t\t\tnext.insertAfter( startBookmark );\n\n\t\t\t\t// Update startBookmark after insertion to avoid the reversal of nodes (#13449).\n\t\t\t\tstartBookmark = next;\n\t\t\t}\n\n\t\t\tif ( isEmpty( merged ) )\n\t\t\t\tmerged.remove();\n\t\t}\n\n\t\tfunction getPath( startElement, root ) {\n\t\t\treturn new CKEDITOR.dom.elementPath( startElement, root );\n\t\t}\n\n\t\t// Creates a range from a bookmark without removing the bookmark.\n\t\tfunction createRangeFromBookmark( root, bookmark ) {\n\t\t\tvar range = new CKEDITOR.dom.range( root );\n\t\t\trange.setStartAfter( bookmark.startNode );\n\t\t\trange.setEndBefore( bookmark.endNode );\n\t\t\treturn range;\n\t\t}\n\n\t\tvar list = {\n\t\t\tdetectMerge: function( that, editable ) {\n\t\t\t\tvar range = createRangeFromBookmark( editable, that.bookmark ),\n\t\t\t\t\tstartPath = range.startPath(),\n\t\t\t\t\tendPath = range.endPath(),\n\n\t\t\t\t\tstartList = startPath.contains( CKEDITOR.dtd.$list ),\n\t\t\t\t\tendList = endPath.contains( CKEDITOR.dtd.$list );\n\n\t\t\t\tthat.mergeList =\n\t\t\t\t\t// Both lists must exist\n\t\t\t\t\tstartList && endList &&\n\t\t\t\t\t// ...and be of the same type\n\t\t\t\t\t// startList.getName() == endList.getName() &&\n\t\t\t\t\t// ...and share the same parent (same level in the tree)\n\t\t\t\t\tstartList.getParent().equals( endList.getParent() ) &&\n\t\t\t\t\t// ...and must be different.\n\t\t\t\t\t!startList.equals( endList );\n\n\t\t\t\tthat.mergeListItems =\n\t\t\t\t\tstartPath.block && endPath.block &&\n\t\t\t\t\t// Both containers must be list items\n\t\t\t\t\tstartPath.block.is( CKEDITOR.dtd.$listItem ) && endPath.block.is( CKEDITOR.dtd.$listItem );\n\n\t\t\t\t// Create merge bookmark.\n\t\t\t\tif ( that.mergeList || that.mergeListItems ) {\n\t\t\t\t\tvar rangeClone = range.clone();\n\n\t\t\t\t\trangeClone.setStartBefore( that.bookmark.startNode );\n\t\t\t\t\trangeClone.setEndAfter( that.bookmark.endNode );\n\n\t\t\t\t\tthat.mergeListBookmark = rangeClone.createBookmark();\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tmerge: function( that, editable ) {\n\t\t\t\tif ( !that.mergeListBookmark )\n\t\t\t\t\treturn;\n\n\t\t\t\tvar startNode = that.mergeListBookmark.startNode,\n\t\t\t\t\tendNode = that.mergeListBookmark.endNode,\n\n\t\t\t\t\tstartPath = getPath( startNode, editable ),\n\t\t\t\t\tendPath = getPath( endNode, editable );\n\n\t\t\t\tif ( that.mergeList ) {\n\t\t\t\t\tvar firstList = startPath.contains( CKEDITOR.dtd.$list ),\n\t\t\t\t\t\tsecondList = endPath.contains( CKEDITOR.dtd.$list );\n\n\t\t\t\t\tif ( !firstList.equals( secondList ) ) {\n\t\t\t\t\t\tsecondList.moveChildren( firstList );\n\t\t\t\t\t\tsecondList.remove();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( that.mergeListItems ) {\n\t\t\t\t\tvar firstListItem = startPath.contains( CKEDITOR.dtd.$listItem ),\n\t\t\t\t\t\tsecondListItem = endPath.contains( CKEDITOR.dtd.$listItem );\n\n\t\t\t\t\tif ( !firstListItem.equals( secondListItem ) ) {\n\t\t\t\t\t\tmergeElements( secondListItem, startNode, endNode );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Remove bookmark nodes.\n\t\t\t\tstartNode.remove();\n\t\t\t\tendNode.remove();\n\t\t\t}\n\t\t};\n\n\t\tvar block = {\n\t\t\t// Detects whether blocks should be merged once contents are extracted.\n\t\t\tdetectMerge: function( that, editable ) {\n\t\t\t\t// Don't merge blocks if lists or tables are already involved.\n\t\t\t\tif ( that.tableContentsRanges || that.mergeListBookmark )\n\t\t\t\t\treturn;\n\n\t\t\t\tvar rangeClone = new CKEDITOR.dom.range( editable );\n\n\t\t\t\trangeClone.setStartBefore( that.bookmark.startNode );\n\t\t\t\trangeClone.setEndAfter( that.bookmark.endNode );\n\n\t\t\t\tthat.mergeBlockBookmark = rangeClone.createBookmark();\n\t\t\t},\n\n\t\t\tmerge: function( that, editable ) {\n\t\t\t\tif ( !that.mergeBlockBookmark || that.purgeTableBookmark )\n\t\t\t\t\treturn;\n\n\t\t\t\tvar startNode = that.mergeBlockBookmark.startNode,\n\t\t\t\t\tendNode = that.mergeBlockBookmark.endNode,\n\n\t\t\t\t\tstartPath = getPath( startNode, editable ),\n\t\t\t\t\tendPath = getPath( endNode, editable ),\n\n\t\t\t\t\tfirstBlock = startPath.block,\n\t\t\t\t\tsecondBlock = endPath.block;\n\n\t\t\t\tif ( firstBlock && secondBlock && !firstBlock.equals( secondBlock ) ) {\n\t\t\t\t\tmergeElements( secondBlock, startNode, endNode );\n\t\t\t\t}\n\n\t\t\t\t// Remove bookmark nodes.\n\t\t\t\tstartNode.remove();\n\t\t\t\tendNode.remove();\n\t\t\t}\n\t\t};\n\n\t\tvar table = ( function() {\n\t\t\tvar tableEditable = { td: 1, th: 1, caption: 1 };\n\n\t\t\t// Returns an array of ranges which should be entirely extracted.\n\t\t\t//\n\t\t\t// <table><tr>[<td>xx</td><td>y}y</td></tr></table>\n\t\t\t// will find:\n\t\t\t// <table><tr><td>[xx]</td><td>[y}y</td></tr></table>\n\t\t\tfunction findTableContentsRanges( range ) {\n\t\t\t\t// Leaving the below for debugging purposes.\n\t\t\t\t//\n\t\t\t\t// console.log( 'findTableContentsRanges' );\n\t\t\t\t// console.log( bender.tools.range.getWithHtml( range.root, range ) );\n\n\t\t\t\tvar contentsRanges = [],\n\t\t\t\t\teditableRange,\n\t\t\t\t\twalker = new CKEDITOR.dom.walker( range ),\n\t\t\t\t\tstartCell = range.startPath().contains( tableEditable ),\n\t\t\t\t\tendCell = range.endPath().contains( tableEditable ),\n\t\t\t\t\tdatabase = {};\n\n\t\t\t\twalker.guard = function( node, leaving ) {\n\t\t\t\t\t// Guard may be executed on some node boundaries multiple times,\n\t\t\t\t\t// what results in creating more than one range for each selected cell. (#12964)\n\t\t\t\t\tif ( node.type == CKEDITOR.NODE_ELEMENT ) {\n\t\t\t\t\t\tvar key = 'visited_' + ( leaving ? 'out' : 'in' );\n\t\t\t\t\t\tif ( node.getCustomData( key ) ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tCKEDITOR.dom.element.setMarker( database, node, key, 1 );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Handle partial selection in a cell in which the range starts:\n\t\t\t\t\t// <td><p>x{xx</p></td>...\n\t\t\t\t\t// will store:\n\t\t\t\t\t// <td><p>x{xx</p>]</td>\n\t\t\t\t\tif ( leaving && startCell && node.equals( startCell ) ) {\n\t\t\t\t\t\teditableRange = range.clone();\n\t\t\t\t\t\teditableRange.setEndAt( startCell, CKEDITOR.POSITION_BEFORE_END );\n\t\t\t\t\t\tcontentsRanges.push( editableRange );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Handle partial selection in a cell in which the range ends.\n\t\t\t\t\tif ( !leaving && endCell && node.equals( endCell ) ) {\n\t\t\t\t\t\teditableRange = range.clone();\n\t\t\t\t\t\teditableRange.setStartAt( endCell, CKEDITOR.POSITION_AFTER_START );\n\t\t\t\t\t\tcontentsRanges.push( editableRange );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Handle all other cells visited by the walker.\n\t\t\t\t\t// We need to check whether the cell is disjoint with\n\t\t\t\t\t// the start and end cells to correctly handle case like:\n\t\t\t\t\t// <td>x{x</td><td><table>..<td>y}y</td>..</table></td>\n\t\t\t\t\t// without the check the second cell's content would be entirely removed.\n\t\t\t\t\tif ( !leaving && checkRemoveCellContents( node ) ) {\n\t\t\t\t\t\teditableRange = range.clone();\n\t\t\t\t\t\teditableRange.selectNodeContents( node );\n\t\t\t\t\t\tcontentsRanges.push( editableRange );\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\twalker.lastForward();\n\n\t\t\t\t// Clear all markers so next extraction will not be affected by this one.\n\t\t\t\tCKEDITOR.dom.element.clearAllMarkers( database );\n\n\t\t\t\treturn contentsRanges;\n\n\t\t\t\tfunction checkRemoveCellContents( node ) {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t// Must be a cell.\n\t\t\t\t\t\tnode.type == CKEDITOR.NODE_ELEMENT && node.is( tableEditable ) &&\n\t\t\t\t\t\t// Must be disjoint with the range's startCell if exists.\n\t\t\t\t\t\t( !startCell || checkDisjointNodes( node, startCell ) ) &&\n\t\t\t\t\t\t// Must be disjoint with the range's endCell if exists.\n\t\t\t\t\t\t( !endCell || checkDisjointNodes( node, endCell ) )\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Returns a normalized common ancestor of a range.\n\t\t\t// If the real common ancestor is located somewhere in between a table and a td/th/caption,\n\t\t\t// then the table will be returned.\n\t\t\tfunction getNormalizedAncestor( range ) {\n\t\t\t\tvar common = range.getCommonAncestor();\n\n\t\t\t\tif ( common.is( CKEDITOR.dtd.$tableContent ) && !common.is( tableEditable ) ) {\n\t\t\t\t\tcommon = common.getAscendant( 'table', true );\n\t\t\t\t}\n\n\t\t\t\treturn common;\n\t\t\t}\n\n\t\t\t// Check whether node1 and node2 are disjoint, so are:\n\t\t\t// * not identical,\n\t\t\t// * not contained in each other.\n\t\t\tfunction checkDisjointNodes( node1, node2 ) {\n\t\t\t\tvar disallowedPositions = CKEDITOR.POSITION_CONTAINS + CKEDITOR.POSITION_IS_CONTAINED,\n\t\t\t\t\tpos = node1.getPosition( node2 );\n\n\t\t\t\t// Baaah... IDENTICAL is 0, so we can't simplify this ;/.\n\t\t\t\treturn pos === CKEDITOR.POSITION_IDENTICAL ?\n\t\t\t\t\tfalse :\n\t\t\t\t\t( ( pos & disallowedPositions ) === 0 );\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\t// Detects whether to purge entire list.\n\t\t\t\tdetectPurge: function( that ) {\n\t\t\t\t\tvar range = that.range,\n\t\t\t\t\t\twalkerRange = range.clone();\n\n\t\t\t\t\twalkerRange.enlarge( CKEDITOR.ENLARGE_ELEMENT );\n\n\t\t\t\t\tvar walker = new CKEDITOR.dom.walker( walkerRange ),\n\t\t\t\t\t\teditablesCount = 0;\n\n\t\t\t\t\t// Count the number of table editables in the range. If there's more than one,\n\t\t\t\t\t// table MAY be removed completely (it's a cross-cell range). Otherwise, only\n\t\t\t\t\t// the contents of the cell are usually removed.\n\t\t\t\t\twalker.evaluator = function( node ) {\n\t\t\t\t\t\tif ( node.type == CKEDITOR.NODE_ELEMENT && node.is( tableEditable ) ) {\n\t\t\t\t\t\t\t++editablesCount;\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\twalker.checkForward();\n\n\t\t\t\t\tif ( editablesCount > 1 ) {\n\t\t\t\t\t\tvar startTable = range.startPath().contains( 'table' ),\n\t\t\t\t\t\t\tendTable = range.endPath().contains( 'table' );\n\n\t\t\t\t\t\tif ( startTable && endTable && range.checkBoundaryOfElement( startTable, CKEDITOR.START ) && range.checkBoundaryOfElement( endTable, CKEDITOR.END ) ) {\n\t\t\t\t\t\t\tvar rangeClone = that.range.clone();\n\n\t\t\t\t\t\t\trangeClone.setStartBefore( startTable );\n\t\t\t\t\t\t\trangeClone.setEndAfter( endTable );\n\n\t\t\t\t\t\t\tthat.purgeTableBookmark = rangeClone.createBookmark();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t// The magic.\n\t\t\t\t//\n\t\t\t\t// This method tries to discover whether the range starts or ends somewhere in a table\n\t\t\t\t// (it is not interested whether the range contains a table, because in such case\n\t\t\t\t// the extractContents() methods does the job correctly).\n\t\t\t\t// If the range meets these criteria, then the method tries to discover and store the following:\n\t\t\t\t//\n\t\t\t\t// * that.tableSurroundingRange - a part of the range which is located outside of any table which\n\t\t\t\t// will be touched (note: when range is located in a single cell it does not touch the table).\n\t\t\t\t// This range can be placed at:\n\t\t\t\t//\t\t* at the beginning: <p>he{re</p><table>..]..</table>\n\t\t\t\t//\t\t* in the middle: <table>..[..</table><p>here</p><table>..]..</table>\n\t\t\t\t//\t\t* at the end: <table>..[..</table><p>he}re</p>\n\t\t\t\t// * that.tableContentsRanges - an array of ranges with contents of td/th/caption that should be removed.\n\t\t\t\t// This assures that calling extractContents() does not change the structure of the table(s).\n\t\t\t\tdetectRanges: function( that, editable ) {\n\t\t\t\t\tvar range = createRangeFromBookmark( editable, that.bookmark ),\n\t\t\t\t\t\tsurroundingRange = range.clone(),\n\t\t\t\t\t\tleftRange,\n\t\t\t\t\t\trightRange,\n\n\t\t\t\t\t\t// Find a common ancestor and normalize it (so the following paths contain tables).\n\t\t\t\t\t\tcommonAncestor = getNormalizedAncestor( range ),\n\n\t\t\t\t\t\t// Create paths using the normalized ancestor, so tables beyond the context\n\t\t\t\t\t\t// of the input range are not found.\n\t\t\t\t\t\tstartPath = new CKEDITOR.dom.elementPath( range.startContainer, commonAncestor ),\n\t\t\t\t\t\tendPath = new CKEDITOR.dom.elementPath( range.endContainer, commonAncestor ),\n\n\t\t\t\t\t\tstartTable = startPath.contains( 'table' ),\n\t\t\t\t\t\tendTable = endPath.contains( 'table' ),\n\n\t\t\t\t\t\ttableContentsRanges;\n\n\t\t\t\t\t// Nothing to do here - the range doesn't touch any table or\n\t\t\t\t\t// it contains a table, but that table is fully selected so it will be simply fully removed\n\t\t\t\t\t// by the normal algorithm.\n\t\t\t\t\tif ( !startTable && !endTable ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Handle two disjoint tables case:\n\t\t\t\t\t// <table>..[..</table><p>ab</p><table>..]..</table>\n\t\t\t\t\t// is handled as (respectively: findTableContents( left ), surroundingRange, findTableContents( right )):\n\t\t\t\t\t// <table>..[..</table>][<p>ab</p>][<table>..]..</table>\n\t\t\t\t\t// Check that tables are disjoint to exclude a case when start equals end or one is contained\n\t\t\t\t\t// in the other.\n\t\t\t\t\tif ( startTable && endTable && checkDisjointNodes( startTable, endTable ) ) {\n\t\t\t\t\t\tthat.tableSurroundingRange = surroundingRange;\n\t\t\t\t\t\tsurroundingRange.setStartAt( startTable, CKEDITOR.POSITION_AFTER_END );\n\t\t\t\t\t\tsurroundingRange.setEndAt( endTable, CKEDITOR.POSITION_BEFORE_START );\n\n\t\t\t\t\t\tleftRange = range.clone();\n\t\t\t\t\t\tleftRange.setEndAt( startTable, CKEDITOR.POSITION_AFTER_END );\n\n\t\t\t\t\t\trightRange = range.clone();\n\t\t\t\t\t\trightRange.setStartAt( endTable, CKEDITOR.POSITION_BEFORE_START );\n\n\t\t\t\t\t\ttableContentsRanges = findTableContentsRanges( leftRange ).concat( findTableContentsRanges( rightRange ) );\n\t\t\t\t\t}\n\t\t\t\t\t// Divide the initial range into two parts:\n\t\t\t\t\t// * range which contains the part containing the table,\n\t\t\t\t\t// * surroundingRange which contains the part outside the table.\n\t\t\t\t\t//\n\t\t\t\t\t// The surroundingRange exists only if one of the range ends is\n\t\t\t\t\t// located outside the table.\n\t\t\t\t\t//\n\t\t\t\t\t// <p>a{b</p><table>..]..</table><p>cd</p>\n\t\t\t\t\t// becomes (respectively: surroundingRange, range):\n\t\t\t\t\t// <p>a{b</p>][<table>..]..</table><p>cd</p>\n\t\t\t\t\telse if ( !startTable ) {\n\t\t\t\t\t\tthat.tableSurroundingRange = surroundingRange;\n\t\t\t\t\t\tsurroundingRange.setEndAt( endTable, CKEDITOR.POSITION_BEFORE_START );\n\n\t\t\t\t\t\trange.setStartAt( endTable, CKEDITOR.POSITION_AFTER_START );\n\t\t\t\t\t}\n\t\t\t\t\t// <p>ab</p><table>..[..</table><p>c}d</p>\n\t\t\t\t\t// becomes (respectively range, surroundingRange):\n\t\t\t\t\t// <p>ab</p><table>..[..</table>][<p>c}d</p>\n\t\t\t\t\telse if ( !endTable ) {\n\t\t\t\t\t\tthat.tableSurroundingRange = surroundingRange;\n\t\t\t\t\t\tsurroundingRange.setStartAt( startTable, CKEDITOR.POSITION_AFTER_END );\n\n\t\t\t\t\t\trange.setEndAt( startTable, CKEDITOR.POSITION_AFTER_END );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Use already calculated or calculate for the remaining range.\n\t\t\t\t\tthat.tableContentsRanges = tableContentsRanges ? tableContentsRanges : findTableContentsRanges( range );\n\n\t\t\t\t\t// Leaving the below for debugging purposes.\n\t\t\t\t\t//\n\t\t\t\t\t// if ( that.tableSurroundingRange ) {\n\t\t\t\t\t// \tconsole.log( 'tableSurroundingRange' );\n\t\t\t\t\t// \tconsole.log( bender.tools.range.getWithHtml( that.tableSurroundingRange.root, that.tableSurroundingRange ) );\n\t\t\t\t\t// }\n\t\t\t\t\t//\n\t\t\t\t\t// console.log( 'tableContentsRanges' );\n\t\t\t\t\t// that.tableContentsRanges.forEach( function( range ) {\n\t\t\t\t\t// \tconsole.log( bender.tools.range.getWithHtml( range.root, range ) );\n\t\t\t\t\t// } );\n\t\t\t\t},\n\n\t\t\t\tdeleteRanges: function( that ) {\n\t\t\t\t\tvar range;\n\n\t\t\t\t\t// Delete table cell contents.\n\t\t\t\t\twhile ( ( range = that.tableContentsRanges.pop() ) ) {\n\t\t\t\t\t\trange.extractContents();\n\n\t\t\t\t\t\tif ( isEmpty( range.startContainer ) )\n\t\t\t\t\t\t\trange.startContainer.appendBogus();\n\t\t\t\t\t}\n\n\t\t\t\t\t// Finally delete surroundings of the table.\n\t\t\t\t\tif ( that.tableSurroundingRange ) {\n\t\t\t\t\t\tthat.tableSurroundingRange.extractContents();\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tpurge: function( that ) {\n\t\t\t\t\tif ( !that.purgeTableBookmark )\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tvar doc = that.doc,\n\t\t\t\t\t\trange = that.range,\n\t\t\t\t\t\trangeClone = range.clone(),\n\t\t\t\t\t\t// How about different enter modes?\n\t\t\t\t\t\tblock = doc.createElement( 'p' );\n\n\t\t\t\t\tblock.insertBefore( that.purgeTableBookmark.startNode );\n\n\t\t\t\t\trangeClone.moveToBookmark( that.purgeTableBookmark );\n\t\t\t\t\trangeClone.deleteContents();\n\n\t\t\t\t\tthat.range.moveToPosition( block, CKEDITOR.POSITION_AFTER_START );\n\t\t\t\t}\n\t\t\t};\n\t\t} )();\n\n\t\treturn {\n\t\t\tlist: list,\n\t\t\tblock: block,\n\t\t\ttable: table,\n\n\t\t\t// Detects whether use \"mergeThen\" argument in range.extractContents().\n\t\t\tdetectExtractMerge: function( that ) {\n\t\t\t\t// Don't merge if playing with lists.\n\t\t\t\treturn !(\n\t\t\t\t\tthat.range.startPath().contains( CKEDITOR.dtd.$listItem ) &&\n\t\t\t\t\tthat.range.endPath().contains( CKEDITOR.dtd.$listItem )\n\t\t\t\t);\n\t\t\t},\n\n\t\t\tfixUneditableRangePosition: function( range ) {\n\t\t\t\tif ( !range.startContainer.getDtd()[ '#' ] ) {\n\t\t\t\t\trange.moveToClosestEditablePosition( null, true );\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// Perform auto paragraphing if needed.\n\t\t\tautoParagraph: function( editor, range ) {\n\t\t\t\tvar path = range.startPath(),\n\t\t\t\t\tfixBlock;\n\n\t\t\t\tif ( shouldAutoParagraph( editor, path.block, path.blockLimit ) && ( fixBlock = autoParagraphTag( editor ) ) ) {\n\t\t\t\t\tfixBlock = range.document.createElement( fixBlock );\n\t\t\t\t\tfixBlock.appendBogus();\n\t\t\t\t\trange.insertNode( fixBlock );\n\t\t\t\t\trange.moveToPosition( fixBlock, CKEDITOR.POSITION_AFTER_START );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} )();\n\n} )();\n\n/**\n * Whether the editor must output an empty value (`''`) if its content only consists\n * of an empty paragraph.\n *\n *\t\tconfig.ignoreEmptyParagraph = false;\n *\n * @cfg {Boolean} [ignoreEmptyParagraph=true]\n * @member CKEDITOR.config\n */\n\n/**\n * Event fired by the editor in order to get accessibility help label.\n * The event is responded to by a component which provides accessibility\n * help (i.e. the `a11yhelp` plugin) hence the editor is notified whether\n * accessibility help is available.\n *\n * Providing info:\n *\n *\t\teditor.on( 'ariaEditorHelpLabel', function( evt ) {\n *\t\t\t\tevt.data.label = editor.lang.common.editorHelp;\n *\t\t} );\n *\n * Getting label:\n *\n *\t\tvar helpLabel = editor.fire( 'ariaEditorHelpLabel', {} ).label;\n *\n * @since 4.4.3\n * @event ariaEditorHelpLabel\n * @param {String} label The label to be used.\n * @member CKEDITOR.editor\n */\n\n/**\n * Event fired when the user double-clicks in the editable area.\n * The event allows to open a dialog window for a clicked element in a convenient way:\n *\n *\t\teditor.on( 'doubleclick', function( evt ) {\n *\t\t\tvar element = evt.data.element;\n *\n *\t\t\tif ( element.is( 'table' ) )\n *\t\t\t\tevt.data.dialog = 'tableProperties';\n *\t\t} );\n *\n * **Note:** To handle double-click on a widget use {@link CKEDITOR.plugins.widget#doubleclick}.\n *\n * @event doubleclick\n * @param data\n * @param {CKEDITOR.dom.element} data.element The double-clicked element.\n * @param {String} data.dialog The dialog window to be opened. If set by the listener,\n * the specified dialog window will be opened.\n * @member CKEDITOR.editor\n */\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/editable.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n( function() {\n\t// #### checkSelectionChange : START\n\n\t// The selection change check basically saves the element parent tree of\n\t// the current node and check it on successive requests. If there is any\n\t// change on the tree, then the selectionChange event gets fired.\n\tfunction checkSelectionChange() {\n\t\t// A possibly available fake-selection.\n\t\tvar sel = this._.fakeSelection,\n\t\t\trealSel;\n\n\t\tif ( sel ) {\n\t\t\trealSel = this.getSelection( 1 );\n\n\t\t\t// If real (not locked/stored) selection was moved from hidden container,\n\t\t\t// then the fake-selection must be invalidated.\n\t\t\tif ( !realSel || !realSel.isHidden() ) {\n\t\t\t\t// Remove the cache from fake-selection references in use elsewhere.\n\t\t\t\tsel.reset();\n\n\t\t\t\t// Have the code using the native selection.\n\t\t\t\tsel = 0;\n\t\t\t}\n\t\t}\n\n\t\t// If not fake-selection is available then get the native selection.\n\t\tif ( !sel ) {\n\t\t\tsel = realSel || this.getSelection( 1 );\n\n\t\t\t// Editor may have no selection at all.\n\t\t\tif ( !sel || sel.getType() == CKEDITOR.SELECTION_NONE )\n\t\t\t\treturn;\n\t\t}\n\n\t\tthis.fire( 'selectionCheck', sel );\n\n\t\tvar currentPath = this.elementPath();\n\t\tif ( !currentPath.compare( this._.selectionPreviousPath ) ) {\n\t\t\t// Cache the active element, which we'll eventually lose on Webkit.\n\t\t\tif ( CKEDITOR.env.webkit )\n\t\t\t\tthis._.previousActive = this.document.getActive();\n\n\t\t\tthis._.selectionPreviousPath = currentPath;\n\t\t\tthis.fire( 'selectionChange', { selection: sel, path: currentPath } );\n\t\t}\n\t}\n\n\tvar checkSelectionChangeTimer, checkSelectionChangeTimeoutPending;\n\n\tfunction checkSelectionChangeTimeout() {\n\t\t// Firing the \"OnSelectionChange\" event on every key press started to\n\t\t// be too slow. This function guarantees that there will be at least\n\t\t// 200ms delay between selection checks.\n\n\t\tcheckSelectionChangeTimeoutPending = true;\n\n\t\tif ( checkSelectionChangeTimer )\n\t\t\treturn;\n\n\t\tcheckSelectionChangeTimeoutExec.call( this );\n\n\t\tcheckSelectionChangeTimer = CKEDITOR.tools.setTimeout( checkSelectionChangeTimeoutExec, 200, this );\n\t}\n\n\tfunction checkSelectionChangeTimeoutExec() {\n\t\tcheckSelectionChangeTimer = null;\n\n\t\tif ( checkSelectionChangeTimeoutPending ) {\n\t\t\t// Call this with a timeout so the browser properly moves the\n\t\t\t// selection after the mouseup. It happened that the selection was\n\t\t\t// being moved after the mouseup when clicking inside selected text\n\t\t\t// with Firefox.\n\t\t\tCKEDITOR.tools.setTimeout( checkSelectionChange, 0, this );\n\n\t\t\tcheckSelectionChangeTimeoutPending = false;\n\t\t}\n\t}\n\n\t// #### checkSelectionChange : END\n\n\tvar isVisible = CKEDITOR.dom.walker.invisible( 1 );\n\n\t// May absorb the caret if:\n\t// * is a visible node,\n\t// * is a non-empty element (this rule will accept elements like <strong></strong> because they\n\t//\tthey were not accepted by the isVisible() check, not not <br> which cannot absorb the caret).\n\t//\tSee #12621.\n\tfunction mayAbsorbCaret( node ) {\n\t\tif ( isVisible( node ) )\n\t\t\treturn true;\n\n\t\tif ( node.type == CKEDITOR.NODE_ELEMENT && !node.is( CKEDITOR.dtd.$empty ) )\n\t\t\treturn true;\n\n\t\treturn false;\n\t}\n\n\tfunction rangeRequiresFix( range ) {\n\t\t// Whether we must prevent from absorbing caret by this context node.\n\t\t// Also checks whether there's an editable position next to that node.\n\t\tfunction ctxRequiresFix( node, isAtEnd ) {\n\t\t\t// It's ok for us if a text node absorbs the caret, because\n\t\t\t// the caret container element isn't changed then.\n\t\t\tif ( !node || node.type == CKEDITOR.NODE_TEXT )\n\t\t\t\treturn false;\n\n\t\t\tvar testRng = range.clone();\n\t\t\treturn testRng[ 'moveToElementEdit' + ( isAtEnd ? 'End' : 'Start' ) ]( node );\n\t\t}\n\n\t\t// Range root must be the editable element, it's to avoid creating filler char\n\t\t// on any temporary internal selection.\n\t\tif ( !( range.root instanceof CKEDITOR.editable ) )\n\t\t\treturn false;\n\n\t\tvar ct = range.startContainer;\n\n\t\tvar previous = range.getPreviousNode( mayAbsorbCaret, null, ct ),\n\t\t\tnext = range.getNextNode( mayAbsorbCaret, null, ct );\n\n\t\t// Any adjacent text container may absorb the caret, e.g.\n\t\t// <p><strong>text</strong>^foo</p>\n\t\t// <p>foo^<strong>text</strong></p>\n\t\t// <div>^<p>foo</p></div>\n\t\tif ( ctxRequiresFix( previous ) || ctxRequiresFix( next, 1 ) )\n\t\t\treturn true;\n\n\t\t// Empty block/inline element is also affected. <span>^</span>, <p>^</p> (#7222)\n\t\t// If you found this line confusing check #12655.\n\t\tif ( !( previous || next ) && !( ct.type == CKEDITOR.NODE_ELEMENT && ct.isBlockBoundary() && ct.getBogus() ) )\n\t\t\treturn true;\n\n\t\treturn false;\n\t}\n\n\tfunction createFillingCharSequenceNode( editable ) {\n\t\tremoveFillingCharSequenceNode( editable, false );\n\n\t\tvar fillingChar = editable.getDocument().createText( fillingCharSequence );\n\t\teditable.setCustomData( 'cke-fillingChar', fillingChar );\n\n\t\treturn fillingChar;\n\t}\n\n\t// Checks if a filling char has been used, eventualy removing it (#1272).\n\tfunction checkFillingCharSequenceNodeReady( editable ) {\n\t\tvar fillingChar = editable.getCustomData( 'cke-fillingChar' );\n\n\t\tif ( fillingChar ) {\n\t\t\t// Use this flag to avoid removing the filling char right after\n\t\t\t// creating it.\n\t\t\tif ( fillingChar.getCustomData( 'ready' ) ) {\n\t\t\t\tremoveFillingCharSequenceNode( editable );\n\t\t\t} else {\n\t\t\t\tfillingChar.setCustomData( 'ready', 1 );\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction removeFillingCharSequenceNode( editable, keepSelection ) {\n\t\tvar fillingChar = editable && editable.removeCustomData( 'cke-fillingChar' );\n\n\t\tif ( fillingChar ) {\n\t\t\t// Text selection position might get mangled by\n\t\t\t// subsequent dom modification, save it now for restoring. (#8617)\n\t\t\tif ( keepSelection !== false ) {\n\t\t\t\tvar sel = editable.getDocument().getSelection().getNative(),\n\t\t\t\t\t// Be error proof.\n\t\t\t\t\trange = sel && sel.type != 'None' && sel.getRangeAt( 0 ),\n\t\t\t\t\tfillingCharSeqLength = fillingCharSequence.length;\n\n\t\t\t\t// If there's some text other than the sequence in the FC text node and the range\n\t\t\t\t// intersects with that node...\n\t\t\t\tif ( fillingChar.getLength() > fillingCharSeqLength && range && range.intersectsNode( fillingChar.$ ) ) {\n\t\t\t\t\tvar bm = createNativeSelectionBookmark( sel );\n\n\t\t\t\t\t// Correct start offset anticipating the removal of FC.\n\t\t\t\t\tif ( sel.anchorNode == fillingChar.$ && sel.anchorOffset > fillingCharSeqLength ) {\n\t\t\t\t\t\tbm[ 0 ].offset -= fillingCharSeqLength;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Correct end offset anticipating the removal of FC.\n\t\t\t\t\tif ( sel.focusNode == fillingChar.$ && sel.focusOffset > fillingCharSeqLength ) {\n\t\t\t\t\t\tbm[ 1 ].offset -= fillingCharSeqLength;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// We can't simply remove the filling node because the user\n\t\t\t// will actually enlarge it when typing, so we just remove the\n\t\t\t// invisible char from it.\n\t\t\tfillingChar.setText( removeFillingCharSequenceString( fillingChar.getText(), 1 ) );\n\n\t\t\t// Restore the bookmark preserving selection's direction.\n\t\t\tif ( bm ) {\n\t\t\t\tmoveNativeSelectionToBookmark( editable.getDocument().$, bm );\n\t\t\t}\n\t\t}\n\t}\n\n\t// #13816\n\tfunction removeFillingCharSequenceString( str, nbspAware ) {\n\t\tif ( nbspAware ) {\n\t\t\treturn str.replace( fillingCharSequenceRegExp, function( m, p ) {\n\t\t\t\t// #10291 if filling char is followed by a space replace it with NBSP.\n\t\t\t\treturn p ? '\\xa0' : '';\n\t\t\t} );\n\t\t} else {\n\t\t\treturn str.replace( fillingCharSequence, '' );\n\t\t}\n\t}\n\n\tfunction createNativeSelectionBookmark( sel ) {\n\t\treturn [\n\t\t\t{ node: sel.anchorNode, offset: sel.anchorOffset },\n\t\t\t{ node: sel.focusNode, offset: sel.focusOffset }\n\t\t];\n\t}\n\n\tfunction moveNativeSelectionToBookmark( document, bm ) {\n\t\tvar sel = document.getSelection(),\n\t\t\trange = document.createRange();\n\n\t\trange.setStart( bm[ 0 ].node, bm[ 0 ].offset );\n\t\trange.collapse( true );\n\t\tsel.removeAllRanges();\n\t\tsel.addRange( range );\n\t\tsel.extend( bm[ 1 ].node, bm[ 1 ].offset );\n\t}\n\n\t// Creates cke_hidden_sel container and puts real selection there.\n\tfunction hideSelection( editor, ariaLabel ) {\n\t\tvar content = ariaLabel || '&nbsp;',\n\t\t\tstyle = CKEDITOR.env.ie ? 'display:none' : 'position:fixed;top:0;left:-1000px',\n\t\t\thiddenEl = CKEDITOR.dom.element.createFromHtml(\n\t\t\t\t'<div data-cke-hidden-sel=\"1\" data-cke-temp=\"1\" style=\"' + style + '\">' + content + '</div>',\n\t\t\t\teditor.document );\n\n\t\teditor.fire( 'lockSnapshot' );\n\n\t\teditor.editable().append( hiddenEl );\n\n\t\t\t// Always use real selection to avoid overriding locked one (http://dev.ckeditor.com/ticket/11104#comment:13).\n\t\tvar sel = editor.getSelection( 1 ),\n\t\t\trange = editor.createRange(),\n\t\t\t// Cancel selectionchange fired by selectRanges - prevent from firing selectionChange.\n\t\t\tlistener = sel.root.on( 'selectionchange', function( evt ) {\n\t\t\t\tevt.cancel();\n\t\t\t}, null, null, 0 );\n\n\t\trange.setStartAt( hiddenEl, CKEDITOR.POSITION_AFTER_START );\n\t\trange.setEndAt( hiddenEl, CKEDITOR.POSITION_BEFORE_END );\n\t\tsel.selectRanges( [ range ] );\n\n\t\tlistener.removeListener();\n\n\t\teditor.fire( 'unlockSnapshot' );\n\n\t\t// Set this value at the end, so reset() executed by selectRanges()\n\t\t// will clean up old hidden selection container.\n\t\teditor._.hiddenSelectionContainer = hiddenEl;\n\t}\n\n\tfunction removeHiddenSelectionContainer( editor ) {\n\t\tvar hiddenEl = editor._.hiddenSelectionContainer;\n\n\t\tif ( hiddenEl ) {\n\t\t\tvar isDirty = editor.checkDirty();\n\n\t\t\teditor.fire( 'lockSnapshot' );\n\t\t\thiddenEl.remove();\n\t\t\teditor.fire( 'unlockSnapshot' );\n\n\t\t\t!isDirty && editor.resetDirty();\n\t\t}\n\n\t\tdelete editor._.hiddenSelectionContainer;\n\t}\n\n\t// Object containing keystroke handlers for fake selection.\n\tvar fakeSelectionDefaultKeystrokeHandlers = ( function() {\n\t\tfunction leave( right ) {\n\t\t\treturn function( evt ) {\n\t\t\t\tvar range = evt.editor.createRange();\n\n\t\t\t\t// Move selection only if there's a editable place for it.\n\t\t\t\t// It no, then do nothing (keystroke will be blocked, widget selection kept).\n\t\t\t\tif ( range.moveToClosestEditablePosition( evt.selected, right ) )\n\t\t\t\t\tevt.editor.getSelection().selectRanges( [ range ] );\n\n\t\t\t\t// Prevent default.\n\t\t\t\treturn false;\n\t\t\t};\n\t\t}\n\n\t\tfunction del( right ) {\n\t\t\treturn function( evt ) {\n\t\t\t\tvar editor = evt.editor,\n\t\t\t\t\trange = editor.createRange(),\n\t\t\t\t\tfound;\n\n\t\t\t\t// If haven't found place for caret on the default side,\n\t\t\t\t// try to find it on the other side.\n\t\t\t\tif ( !( found = range.moveToClosestEditablePosition( evt.selected, right ) ) )\n\t\t\t\t\tfound = range.moveToClosestEditablePosition( evt.selected, !right );\n\n\t\t\t\tif ( found )\n\t\t\t\t\teditor.getSelection().selectRanges( [ range ] );\n\n\t\t\t\t// Save the state before removing selected element.\n\t\t\t\teditor.fire( 'saveSnapshot' );\n\n\t\t\t\tevt.selected.remove();\n\n\t\t\t\t// Haven't found any editable space before removing element,\n\t\t\t\t// try to place the caret anywhere (most likely, in empty editable).\n\t\t\t\tif ( !found ) {\n\t\t\t\t\trange.moveToElementEditablePosition( editor.editable() );\n\t\t\t\t\teditor.getSelection().selectRanges( [ range ] );\n\t\t\t\t}\n\n\t\t\t\teditor.fire( 'saveSnapshot' );\n\n\t\t\t\t// Prevent default.\n\t\t\t\treturn false;\n\t\t\t};\n\t\t}\n\n\t\tvar leaveLeft = leave(),\n\t\t\tleaveRight = leave( 1 );\n\n\t\treturn {\n\t\t\t37: leaveLeft,\t\t// LEFT\n\t\t\t38: leaveLeft,\t\t// UP\n\t\t\t39: leaveRight,\t\t// RIGHT\n\t\t\t40: leaveRight,\t\t// DOWN\n\t\t\t8: del(),\t\t\t// BACKSPACE\n\t\t\t46: del( 1 )\t\t// DELETE\n\t\t};\n\t} )();\n\n\t// Handle left, right, delete and backspace keystrokes next to non-editable elements\n\t// by faking selection on them.\n\tfunction getOnKeyDownListener( editor ) {\n\t\tvar keystrokes = { 37: 1, 39: 1, 8: 1, 46: 1 };\n\n\t\treturn function( evt ) {\n\t\t\tvar keystroke = evt.data.getKeystroke();\n\n\t\t\t// Handle only left/right/del/bspace keys.\n\t\t\tif ( !keystrokes[ keystroke ] )\n\t\t\t\treturn;\n\n\t\t\tvar sel = editor.getSelection(),\n\t\t\t\tranges = sel.getRanges(),\n\t\t\t\trange = ranges[ 0 ];\n\n\t\t\t// Handle only single range and it has to be collapsed.\n\t\t\tif ( ranges.length != 1 || !range.collapsed )\n\t\t\t\treturn;\n\n\t\t\tvar next = range[ keystroke < 38 ? 'getPreviousEditableNode' : 'getNextEditableNode' ]();\n\n\t\t\tif ( next && next.type == CKEDITOR.NODE_ELEMENT && next.getAttribute( 'contenteditable' ) == 'false' ) {\n\t\t\t\teditor.getSelection().fake( next );\n\t\t\t\tevt.data.preventDefault();\n\t\t\t\tevt.cancel();\n\t\t\t}\n\t\t};\n\t}\n\n\t// If fake selection should be applied this function will return instance of\n\t// CKEDITOR.dom.element which should gain fake selection.\n\tfunction getNonEditableFakeSelectionReceiver( ranges ) {\n\t\tvar enclosedNode, shrinkedNode, clone, range;\n\n\t\tif ( ranges.length == 1 && !( range = ranges[ 0 ] ).collapsed &&\n\t\t\t( enclosedNode = range.getEnclosedNode() ) && enclosedNode.type == CKEDITOR.NODE_ELEMENT ) {\n\t\t\t// So far we can't say that enclosed element is non-editable. Before checking,\n\t\t\t// we'll shrink range (clone). Shrinking will stop on non-editable range, or\n\t\t\t// innermost element (#11114).\n\t\t\tclone = range.clone();\n\t\t\tclone.shrink( CKEDITOR.SHRINK_ELEMENT, true );\n\n\t\t\t// If shrinked range still encloses an element, check this one (shrink stops only on non-editable elements).\n\t\t\tif ( ( shrinkedNode = clone.getEnclosedNode() ) && shrinkedNode.type == CKEDITOR.NODE_ELEMENT )\n\t\t\t\tenclosedNode = shrinkedNode;\n\n\t\t\tif ( enclosedNode.getAttribute( 'contenteditable' ) == 'false' )\n\t\t\t\treturn enclosedNode;\n\t\t}\n\t}\n\n\t// Fix ranges which may end after hidden selection container.\n\t// Note: this function may only be used if hidden selection container\n\t// is not in DOM any more.\n\tfunction fixRangesAfterHiddenSelectionContainer( ranges, root ) {\n\t\tvar range;\n\t\tfor ( var i = 0; i < ranges.length; ++i ) {\n\t\t\trange = ranges[ i ];\n\t\t\tif ( range.endContainer.equals( root ) ) {\n\t\t\t\t// We can use getChildCount() because hidden selection container is not in DOM.\n\t\t\t\trange.endOffset = Math.min( range.endOffset, root.getChildCount() );\n\t\t\t}\n\t\t}\n\t}\n\n\t// Extract only editable part or ranges.\n\t// Note: this function modifies ranges list!\n\t// @param {CKEDITOR.dom.rangeList} ranges\n\tfunction extractEditableRanges( ranges ) {\n\t\tfor ( var i = 0; i < ranges.length; i++ ) {\n\t\t\tvar range = ranges[ i ];\n\n\t\t\t// Drop range spans inside one ready-only node.\n\t\t\tvar parent = range.getCommonAncestor();\n\t\t\tif ( parent.isReadOnly() )\n\t\t\t\tranges.splice( i, 1 );\n\n\t\t\tif ( range.collapsed )\n\t\t\t\tcontinue;\n\n\t\t\t// Range may start inside a non-editable element,\n\t\t\t// replace the range start after it.\n\t\t\tif ( range.startContainer.isReadOnly() ) {\n\t\t\t\tvar current = range.startContainer,\n\t\t\t\t\tisElement;\n\n\t\t\t\twhile ( current ) {\n\t\t\t\t\tisElement = current.type == CKEDITOR.NODE_ELEMENT;\n\n\t\t\t\t\tif ( ( isElement && current.is( 'body' ) ) || !current.isReadOnly() )\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tif ( isElement && current.getAttribute( 'contentEditable' ) == 'false' )\n\t\t\t\t\t\trange.setStartAfter( current );\n\n\t\t\t\t\tcurrent = current.getParent();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar startContainer = range.startContainer,\n\t\t\t\tendContainer = range.endContainer,\n\t\t\t\tstartOffset = range.startOffset,\n\t\t\t\tendOffset = range.endOffset,\n\t\t\t\twalkerRange = range.clone();\n\n\t\t\t// Enlarge range start/end with text node to avoid walker\n\t\t\t// being DOM destructive, it doesn't interfere our checking\n\t\t\t// of elements below as well.\n\t\t\tif ( startContainer && startContainer.type == CKEDITOR.NODE_TEXT ) {\n\t\t\t\tif ( startOffset >= startContainer.getLength() )\n\t\t\t\t\twalkerRange.setStartAfter( startContainer );\n\t\t\t\telse\n\t\t\t\t\twalkerRange.setStartBefore( startContainer );\n\t\t\t}\n\n\t\t\tif ( endContainer && endContainer.type == CKEDITOR.NODE_TEXT ) {\n\t\t\t\tif ( !endOffset )\n\t\t\t\t\twalkerRange.setEndBefore( endContainer );\n\t\t\t\telse\n\t\t\t\t\twalkerRange.setEndAfter( endContainer );\n\t\t\t}\n\n\t\t\t// Looking for non-editable element inside the range.\n\t\t\tvar walker = new CKEDITOR.dom.walker( walkerRange );\n\t\t\twalker.evaluator = function( node ) {\n\t\t\t\tif ( node.type == CKEDITOR.NODE_ELEMENT && node.isReadOnly() ) {\n\t\t\t\t\tvar newRange = range.clone();\n\t\t\t\t\trange.setEndBefore( node );\n\n\t\t\t\t\t// Drop collapsed range around read-only elements,\n\t\t\t\t\t// it make sure the range list empty when selecting\n\t\t\t\t\t// only non-editable elements.\n\t\t\t\t\tif ( range.collapsed )\n\t\t\t\t\t\tranges.splice( i--, 1 );\n\n\t\t\t\t\t// Avoid creating invalid range.\n\t\t\t\t\tif ( !( node.getPosition( walkerRange.endContainer ) & CKEDITOR.POSITION_CONTAINS ) ) {\n\t\t\t\t\t\tnewRange.setStartAfter( node );\n\t\t\t\t\t\tif ( !newRange.collapsed )\n\t\t\t\t\t\t\tranges.splice( i + 1, 0, newRange );\n\t\t\t\t\t}\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\twalker.next();\n\t\t}\n\n\t\treturn ranges;\n\t}\n\n\t// Setup all editor instances for the necessary selection hooks.\n\tCKEDITOR.on( 'instanceCreated', function( ev ) {\n\t\tvar editor = ev.editor;\n\n\t\teditor.on( 'contentDom', function() {\n\t\t\tvar doc = editor.document,\n\t\t\t\touterDoc = CKEDITOR.document,\n\t\t\t\teditable = editor.editable(),\n\t\t\t\tbody = doc.getBody(),\n\t\t\t\thtml = doc.getDocumentElement();\n\n\t\t\tvar isInline = editable.isInline();\n\n\t\t\tvar restoreSel,\n\t\t\t\tlastSel;\n\n\t\t\t// Give the editable an initial selection on first focus,\n\t\t\t// put selection at a consistent position at the start\n\t\t\t// of the contents. (#9507)\n\t\t\tif ( CKEDITOR.env.gecko ) {\n\t\t\t\teditable.attachListener( editable, 'focus', function( evt ) {\n\t\t\t\t\tevt.removeListener();\n\n\t\t\t\t\tif ( restoreSel !== 0 ) {\n\t\t\t\t\t\tvar nativ = editor.getSelection().getNative();\n\t\t\t\t\t\t// Do it only if the native selection is at an unwanted\n\t\t\t\t\t\t// place (at the very start of the editable). #10119\n\t\t\t\t\t\tif ( nativ && nativ.isCollapsed && nativ.anchorNode == editable.$ ) {\n\t\t\t\t\t\t\tvar rng = editor.createRange();\n\t\t\t\t\t\t\trng.moveToElementEditStart( editable );\n\t\t\t\t\t\t\trng.select();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, null, null, -2 );\n\t\t\t}\n\n\t\t\t// Plays the magic here to restore/save dom selection on editable focus/blur.\n\t\t\teditable.attachListener( editable, CKEDITOR.env.webkit ? 'DOMFocusIn' : 'focus', function() {\n\t\t\t\t// On Webkit we use DOMFocusIn which is fired more often than focus - e.g. when moving from main editable\n\t\t\t\t// to nested editable (or the opposite). Unlock selection all, but restore only when it was locked\n\t\t\t\t// for the same active element, what will e.g. mean restoring after displaying dialog.\n\t\t\t\tif ( restoreSel && CKEDITOR.env.webkit )\n\t\t\t\t\trestoreSel = editor._.previousActive && editor._.previousActive.equals( doc.getActive() );\n\n\t\t\t\teditor.unlockSelection( restoreSel );\n\t\t\t\trestoreSel = 0;\n\t\t\t}, null, null, -1 );\n\n\t\t\t// Disable selection restoring when clicking in.\n\t\t\teditable.attachListener( editable, 'mousedown', function() {\n\t\t\t\trestoreSel = 0;\n\t\t\t} );\n\n\t\t\t// Save a cloned version of current selection.\n\t\t\tfunction saveSel() {\n\t\t\t\tlastSel = new CKEDITOR.dom.selection( editor.getSelection() );\n\t\t\t\tlastSel.lock();\n\t\t\t}\n\n\t\t\t// Browsers could loose the selection once the editable lost focus,\n\t\t\t// in such case we need to reproduce it by saving a locked selection\n\t\t\t// and restoring it upon focus gain.\n\t\t\tif ( CKEDITOR.env.ie || isInline ) {\n\t\t\t\t// For old IEs, we can retrieve the last correct DOM selection upon the \"beforedeactivate\" event.\n\t\t\t\t// For the rest, a more frequent check is required for each selection change made.\n\t\t\t\tif ( isMSSelection )\n\t\t\t\t\teditable.attachListener( editable, 'beforedeactivate', saveSel, null, null, -1 );\n\t\t\t\telse\n\t\t\t\t\teditable.attachListener( editor, 'selectionCheck', saveSel, null, null, -1 );\n\n\t\t\t\t// Lock the selection and mark it to be restored.\n\t\t\t\t// On Webkit we use DOMFocusOut which is fired more often than blur. I.e. it will also be\n\t\t\t\t// fired when nested editable is blurred.\n\t\t\t\teditable.attachListener( editable, CKEDITOR.env.webkit ? 'DOMFocusOut' : 'blur', function() {\n\t\t\t\t\teditor.lockSelection( lastSel );\n\t\t\t\t\trestoreSel = 1;\n\t\t\t\t}, null, null, -1 );\n\n\t\t\t\t// Disable selection restoring when clicking in.\n\t\t\t\teditable.attachListener( editable, 'mousedown', function() {\n\t\t\t\t\trestoreSel = 0;\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\t// The following selection-related fixes only apply to classic (`iframe`-based) editable.\n\t\t\tif ( CKEDITOR.env.ie && !isInline ) {\n\t\t\t\tvar scroll;\n\t\t\t\teditable.attachListener( editable, 'mousedown', function( evt ) {\n\t\t\t\t\t// IE scrolls document to top on right mousedown\n\t\t\t\t\t// when editor has no focus, remember this scroll\n\t\t\t\t\t// position and revert it before context menu opens. (#5778)\n\t\t\t\t\tif ( evt.data.$.button == 2 ) {\n\t\t\t\t\t\tvar sel = editor.document.getSelection();\n\t\t\t\t\t\tif ( !sel || sel.getType() == CKEDITOR.SELECTION_NONE )\n\t\t\t\t\t\t\tscroll = editor.window.getScrollPosition();\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t\teditable.attachListener( editable, 'mouseup', function( evt ) {\n\t\t\t\t\t// Restore recorded scroll position when needed on right mouseup.\n\t\t\t\t\tif ( evt.data.$.button == 2 && scroll ) {\n\t\t\t\t\t\teditor.document.$.documentElement.scrollLeft = scroll.x;\n\t\t\t\t\t\teditor.document.$.documentElement.scrollTop = scroll.y;\n\t\t\t\t\t}\n\t\t\t\t\tscroll = null;\n\t\t\t\t} );\n\n\t\t\t\t// When content doc is in standards mode, IE doesn't focus the editor when\n\t\t\t\t// clicking at the region below body (on html element) content, we emulate\n\t\t\t\t// the normal behavior on old IEs. (#1659, #7932)\n\t\t\t\tif ( doc.$.compatMode != 'BackCompat' ) {\n\t\t\t\t\tif ( CKEDITOR.env.ie7Compat || CKEDITOR.env.ie6Compat ) {\n\t\t\t\t\t\thtml.on( 'mousedown', function( evt ) {\n\t\t\t\t\t\t\tevt = evt.data;\n\n\t\t\t\t\t\t\t// Expand the text range along with mouse move.\n\t\t\t\t\t\t\tfunction onHover( evt ) {\n\t\t\t\t\t\t\t\tevt = evt.data.$;\n\t\t\t\t\t\t\t\tif ( textRng ) {\n\t\t\t\t\t\t\t\t\t// Read the current cursor.\n\t\t\t\t\t\t\t\t\tvar rngEnd = body.$.createTextRange();\n\n\t\t\t\t\t\t\t\t\tmoveRangeToPoint( rngEnd, evt.clientX, evt.clientY );\n\n\t\t\t\t\t\t\t\t\t// Handle drag directions.\n\t\t\t\t\t\t\t\t\ttextRng.setEndPoint(\n\t\t\t\t\t\t\t\t\t\tstartRng.compareEndPoints( 'StartToStart', rngEnd ) < 0 ?\n\t\t\t\t\t\t\t\t\t\t'EndToEnd' : 'StartToStart', rngEnd );\n\n\t\t\t\t\t\t\t\t\t// Update selection with new range.\n\t\t\t\t\t\t\t\t\ttextRng.select();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tfunction removeListeners() {\n\t\t\t\t\t\t\t\touterDoc.removeListener( 'mouseup', onSelectEnd );\n\t\t\t\t\t\t\t\thtml.removeListener( 'mouseup', onSelectEnd );\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tfunction onSelectEnd() {\n\t\t\t\t\t\t\t\thtml.removeListener( 'mousemove', onHover );\n\t\t\t\t\t\t\t\tremoveListeners();\n\n\t\t\t\t\t\t\t\t// Make it in effect on mouse up. (#9022)\n\t\t\t\t\t\t\t\ttextRng.select();\n\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t\t// We're sure that the click happens at the region\n\t\t\t\t\t\t\t// below body, but not on scrollbar.\n\t\t\t\t\t\t\tif ( evt.getTarget().is( 'html' ) &&\n\t\t\t\t\t\t\t\t\tevt.$.y < html.$.clientHeight &&\n\t\t\t\t\t\t\t\t\tevt.$.x < html.$.clientWidth ) {\n\t\t\t\t\t\t\t\t// Start to build the text range.\n\t\t\t\t\t\t\t\tvar textRng = body.$.createTextRange();\n\t\t\t\t\t\t\t\tmoveRangeToPoint( textRng, evt.$.clientX, evt.$.clientY );\n\n\t\t\t\t\t\t\t\t// Records the dragging start of the above text range.\n\t\t\t\t\t\t\t\tvar startRng = textRng.duplicate();\n\n\t\t\t\t\t\t\t\thtml.on( 'mousemove', onHover );\n\t\t\t\t\t\t\t\touterDoc.on( 'mouseup', onSelectEnd );\n\t\t\t\t\t\t\t\thtml.on( 'mouseup', onSelectEnd );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t\t// It's much simpler for IE8+, we just need to reselect the reported range.\n\t\t\t\t\t// This hack does not work on IE>=11 because there's no old selection&range APIs.\n\t\t\t\t\tif ( CKEDITOR.env.version > 7 && CKEDITOR.env.version < 11 ) {\n\t\t\t\t\t\thtml.on( 'mousedown', function( evt ) {\n\t\t\t\t\t\t\tif ( evt.data.getTarget().is( 'html' ) ) {\n\t\t\t\t\t\t\t\t// Limit the text selection mouse move inside of editable. (#9715)\n\t\t\t\t\t\t\t\touterDoc.on( 'mouseup', onSelectEnd );\n\t\t\t\t\t\t\t\thtml.on( 'mouseup', onSelectEnd );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// We check the selection change:\n\t\t\t// 1. Upon \"selectionchange\" event from the editable element. (which might be faked event fired by our code)\n\t\t\t// 2. After the accomplish of keyboard and mouse events.\n\t\t\teditable.attachListener( editable, 'selectionchange', checkSelectionChange, editor );\n\t\t\teditable.attachListener( editable, 'keyup', checkSelectionChangeTimeout, editor );\n\t\t\t// Always fire the selection change on focus gain.\n\t\t\t// On Webkit do this on DOMFocusIn, because the selection is unlocked on it too and\n\t\t\t// we need synchronization between those listeners to not lost cached editor._.previousActive property\n\t\t\t// (which is updated on selectionCheck).\n\t\t\teditable.attachListener( editable, CKEDITOR.env.webkit ? 'DOMFocusIn' : 'focus', function() {\n\t\t\t\teditor.forceNextSelectionCheck();\n\t\t\t\teditor.selectionChange( 1 );\n\t\t\t} );\n\n\t\t\t// #9699: On Webkit&Gecko in inline editor we have to check selection when it was changed\n\t\t\t// by dragging and releasing mouse button outside editable. Dragging (mousedown)\n\t\t\t// has to be initialized in editable, but for mouseup we listen on document element.\n\t\t\tif ( isInline && ( CKEDITOR.env.webkit || CKEDITOR.env.gecko ) ) {\n\t\t\t\tvar mouseDown;\n\t\t\t\teditable.attachListener( editable, 'mousedown', function() {\n\t\t\t\t\tmouseDown = 1;\n\t\t\t\t} );\n\t\t\t\teditable.attachListener( doc.getDocumentElement(), 'mouseup', function() {\n\t\t\t\t\tif ( mouseDown )\n\t\t\t\t\t\tcheckSelectionChangeTimeout.call( editor );\n\t\t\t\t\tmouseDown = 0;\n\t\t\t\t} );\n\t\t\t}\n\t\t\t// In all other cases listen on simple mouseup over editable, as we did before #9699.\n\t\t\t//\n\t\t\t// Use document instead of editable in non-IEs for observing mouseup\n\t\t\t// since editable won't fire the event if selection process started within iframe and ended out\n\t\t\t// of the editor (#9851).\n\t\t\telse {\n\t\t\t\teditable.attachListener( CKEDITOR.env.ie ? editable : doc.getDocumentElement(), 'mouseup', checkSelectionChangeTimeout, editor );\n\t\t\t}\n\n\t\t\tif ( CKEDITOR.env.webkit ) {\n\t\t\t\t// Before keystroke is handled by editor, check to remove the filling char.\n\t\t\t\teditable.attachListener( doc, 'keydown', function( evt ) {\n\t\t\t\t\tvar key = evt.data.getKey();\n\t\t\t\t\t// Remove the filling char before some keys get\n\t\t\t\t\t// executed, so they'll not get blocked by it.\n\t\t\t\t\tswitch ( key ) {\n\t\t\t\t\t\tcase 13: // ENTER\n\t\t\t\t\t\tcase 33: // PAGEUP\n\t\t\t\t\t\tcase 34: // PAGEDOWN\n\t\t\t\t\t\tcase 35: // HOME\n\t\t\t\t\t\tcase 36: // END\n\t\t\t\t\t\tcase 37: // LEFT-ARROW\n\t\t\t\t\t\tcase 39: // RIGHT-ARROW\n\t\t\t\t\t\tcase 8: // BACKSPACE\n\t\t\t\t\t\tcase 45: // INS\n\t\t\t\t\t\tcase 46: // DEl\n\t\t\t\t\t\t\tremoveFillingCharSequenceNode( editable );\n\t\t\t\t\t}\n\n\t\t\t\t}, null, null, -1 );\n\t\t\t}\n\n\t\t\t// Automatically select non-editable element when navigating into\n\t\t\t// it by left/right or backspace/del keys.\n\t\t\teditable.attachListener( editable, 'keydown', getOnKeyDownListener( editor ), null, null, -1 );\n\n\t\t\tfunction moveRangeToPoint( range, x, y ) {\n\t\t\t\t// Error prune in IE7. (#9034, #9110)\n\t\t\t\ttry {\n\t\t\t\t\trange.moveToPoint( x, y );\n\t\t\t\t} catch ( e ) {}\n\t\t\t}\n\n\t\t\tfunction removeListeners() {\n\t\t\t\touterDoc.removeListener( 'mouseup', onSelectEnd );\n\t\t\t\thtml.removeListener( 'mouseup', onSelectEnd );\n\t\t\t}\n\n\t\t\tfunction onSelectEnd() {\n\t\t\t\tremoveListeners();\n\n\t\t\t\t// The event is not fired when clicking on the scrollbars,\n\t\t\t\t// so we can safely check the following to understand\n\t\t\t\t// whether the empty space following <body> has been clicked.\n\t\t\t\tvar sel = CKEDITOR.document.$.selection,\n\t\t\t\t\trange = sel.createRange();\n\n\t\t\t\t// The selection range is reported on host, but actually it should applies to the content doc.\n\t\t\t\tif ( sel.type != 'None' && range.parentElement().ownerDocument == doc.$ )\n\t\t\t\t\trange.select();\n\t\t\t}\n\t\t} );\n\n\t\teditor.on( 'setData', function() {\n\t\t\t// Invalidate locked selection when unloading DOM.\n\t\t\t// (#9521, #5217#comment:32 and #11500#comment:11)\n\t\t\teditor.unlockSelection();\n\n\t\t\t// Webkit's selection will mess up after the data loading.\n\t\t\tif ( CKEDITOR.env.webkit )\n\t\t\t\tclearSelection();\n\t\t} );\n\n\t\t// Catch all the cases which above setData listener couldn't catch.\n\t\t// For example: switching to source mode and destroying editor.\n\t\teditor.on( 'contentDomUnload', function() {\n\t\t\teditor.unlockSelection();\n\t\t} );\n\n\t\t// IE9 might cease to work if there's an object selection inside the iframe (#7639).\n\t\tif ( CKEDITOR.env.ie9Compat )\n\t\t\teditor.on( 'beforeDestroy', clearSelection, null, null, 9 );\n\n\t\t// Check selection change on data reload.\n\t\teditor.on( 'dataReady', function() {\n\t\t\t// Clean up fake selection after setting data.\n\t\t\tdelete editor._.fakeSelection;\n\t\t\tdelete editor._.hiddenSelectionContainer;\n\n\t\t\teditor.selectionChange( 1 );\n\t\t} );\n\n\t\t// When loaded data are ready check whether hidden selection container was not loaded.\n\t\teditor.on( 'loadSnapshot', function() {\n\t\t\tvar isElement = CKEDITOR.dom.walker.nodeType( CKEDITOR.NODE_ELEMENT ),\n\t\t\t\t// TODO replace with el.find() which will be introduced in #9764,\n\t\t\t\t// because it may happen that hidden sel container won't be the last element.\n\t\t\t\tlast = editor.editable().getLast( isElement );\n\n\t\t\tif ( last && last.hasAttribute( 'data-cke-hidden-sel' ) ) {\n\t\t\t\tlast.remove();\n\n\t\t\t\t// Firefox does a very unfortunate thing. When a non-editable element is the only\n\t\t\t\t// element in the editable, when we remove the hidden selection container, Firefox\n\t\t\t\t// will insert a bogus <br> at the beginning of the editable...\n\t\t\t\t// See: https://bugzilla.mozilla.org/show_bug.cgi?id=911201\n\t\t\t\t//\n\t\t\t\t// This behavior is never desired because this <br> pushes the content lower, but in\n\t\t\t\t// this case it is especially dangerous, because it happens when a bookmark is being restored.\n\t\t\t\t// Since this <br> is inserted at the beginning it changes indexes and thus breaks the bookmark2\n\t\t\t\t// what results in errors.\n\t\t\t\t//\n\t\t\t\t// So... let's revert what Firefox broke.\n\t\t\t\tif ( CKEDITOR.env.gecko ) {\n\t\t\t\t\tvar first = editor.editable().getFirst( isElement );\n\t\t\t\t\tif ( first && first.is( 'br' ) && first.getAttribute( '_moz_editor_bogus_node' ) ) {\n\t\t\t\t\t\tfirst.remove();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, null, null, 100 );\n\n\t\teditor.on( 'key', function( evt ) {\n\t\t\tif ( editor.mode != 'wysiwyg' )\n\t\t\t\treturn;\n\n\t\t\tvar sel = editor.getSelection();\n\t\t\tif ( !sel.isFake )\n\t\t\t\treturn;\n\n\t\t\tvar handler = fakeSelectionDefaultKeystrokeHandlers[ evt.data.keyCode ];\n\t\t\tif ( handler )\n\t\t\t\treturn handler( { editor: editor, selected: sel.getSelectedElement(), selection: sel, keyEvent: evt } );\n\t\t} );\n\n\t\tfunction clearSelection() {\n\t\t\tvar sel = editor.getSelection();\n\t\t\tsel && sel.removeAllRanges();\n\t\t}\n\t} );\n\n\t// On WebKit only, we need a special \"filling\" char on some situations\n\t// (#1272). Here we set the events that should invalidate that char.\n\tif ( CKEDITOR.env.webkit ) {\n\t\tCKEDITOR.on( 'instanceReady', function( evt ) {\n\t\t\tvar editor = evt.editor;\n\n\t\t\teditor.on( 'selectionChange', function() {\n\t\t\t\tcheckFillingCharSequenceNodeReady( editor.editable() );\n\t\t\t}, null, null, -1 );\n\n\t\t\teditor.on( 'beforeSetMode', function() {\n\t\t\t\tremoveFillingCharSequenceNode( editor.editable() );\n\t\t\t}, null, null, -1 );\n\n\t\t\t// Filter Undo snapshot's HTML to get rid of Filling Char Sequence.\n\t\t\t// Note: CKEDITOR.dom.range.createBookmark2() normalizes snapshot's\n\t\t\t// bookmarks to anticipate the removal of FCSeq from the snapshot's HTML (#13816).\n\t\t\teditor.on( 'getSnapshot', function( evt ) {\n\t\t\t\tif ( evt.data ) {\n\t\t\t\t\tevt.data = removeFillingCharSequenceString( evt.data );\n\t\t\t\t}\n\t\t\t}, editor, null, 20 );\n\n\t\t\t// Filter data to get rid of Filling Char Sequence. Filter on #toDataFormat\n\t\t\t// instead of #getData because once removed, FCSeq may leave an empty element,\n\t\t\t// which should be pruned by the dataProcessor (#13816).\n\t\t\t// Note: Used low priority to filter when dataProcessor works on strings,\n\t\t\t// not pseudo–DOM.\n\t\t\teditor.on( 'toDataFormat', function( evt ) {\n\t\t\t\tevt.data.dataValue = removeFillingCharSequenceString( evt.data.dataValue );\n\t\t\t}, null, null, 0 );\n\t\t} );\n\t}\n\n\t/**\n\t * Check the selection change in editor and potentially fires\n\t * the {@link CKEDITOR.editor#event-selectionChange} event.\n\t *\n\t * @method\n\t * @member CKEDITOR.editor\n\t * @param {Boolean} [checkNow=false] Force the check to happen immediately\n\t * instead of coming with a timeout delay (default).\n\t */\n\tCKEDITOR.editor.prototype.selectionChange = function( checkNow ) {\n\t\t( checkNow ? checkSelectionChange : checkSelectionChangeTimeout ).call( this );\n\t};\n\n\t/**\n\t * Retrieve the editor selection in scope of editable element.\n\t *\n\t * **Note:** Since the native browser selection provides only one single\n\t * selection at a time per document, so if editor's editable element has lost focus,\n\t * this method will return a null value unless the {@link CKEDITOR.editor#lockSelection}\n\t * has been called beforehand so the saved selection is retrieved.\n\t *\n\t *\t\tvar selection = CKEDITOR.instances.editor1.getSelection();\n\t *\t\talert( selection.getType() );\n\t *\n\t * @method\n\t * @member CKEDITOR.editor\n\t * @param {Boolean} forceRealSelection Return real selection, instead of saved or fake one.\n\t * @returns {CKEDITOR.dom.selection} A selection object or null if not available for the moment.\n\t */\n\tCKEDITOR.editor.prototype.getSelection = function( forceRealSelection ) {\n\n\t\t// Check if there exists a locked or fake selection.\n\t\tif ( ( this._.savedSelection || this._.fakeSelection ) && !forceRealSelection )\n\t\t\treturn this._.savedSelection || this._.fakeSelection;\n\n\t\t// Editable element might be absent or editor might not be in a wysiwyg mode.\n\t\tvar editable = this.editable();\n\t\treturn editable && this.mode == 'wysiwyg' ? new CKEDITOR.dom.selection( editable ) : null;\n\t};\n\n\t/**\n\t * Locks the selection made in the editor in order to make it possible to\n\t * manipulate it without browser interference. A locked selection is\n\t * cached and remains unchanged until it is released with the\n\t * {@link CKEDITOR.editor#unlockSelection} method.\n\t *\n\t * @method\n\t * @member CKEDITOR.editor\n\t * @param {CKEDITOR.dom.selection} [sel] Specify the selection to be locked.\n\t * @returns {Boolean} `true` if selection was locked.\n\t */\n\tCKEDITOR.editor.prototype.lockSelection = function( sel ) {\n\t\tsel = sel || this.getSelection( 1 );\n\t\tif ( sel.getType() != CKEDITOR.SELECTION_NONE ) {\n\t\t\t!sel.isLocked && sel.lock();\n\t\t\tthis._.savedSelection = sel;\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t};\n\n\t/**\n\t * Unlocks the selection made in the editor and locked with the\n\t * {@link CKEDITOR.editor#unlockSelection} method. An unlocked selection\n\t * is no longer cached and can be changed.\n\t *\n\t * @method\n\t * @member CKEDITOR.editor\n\t * @param {Boolean} [restore] If set to `true`, the selection is\n\t * restored back to the selection saved earlier by using the\n\t * {@link CKEDITOR.dom.selection#lock} method.\n\t */\n\tCKEDITOR.editor.prototype.unlockSelection = function( restore ) {\n\t\tvar sel = this._.savedSelection;\n\t\tif ( sel ) {\n\t\t\tsel.unlock( restore );\n\t\t\tdelete this._.savedSelection;\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t};\n\n\t/**\n\t * @method\n\t * @member CKEDITOR.editor\n\t * @todo\n\t */\n\tCKEDITOR.editor.prototype.forceNextSelectionCheck = function() {\n\t\tdelete this._.selectionPreviousPath;\n\t};\n\n\t/**\n\t * Gets the current selection in context of the document's body element.\n\t *\n\t *\t\tvar selection = CKEDITOR.instances.editor1.document.getSelection();\n\t *\t\talert( selection.getType() );\n\t *\n\t * @method\n\t * @member CKEDITOR.dom.document\n\t * @returns {CKEDITOR.dom.selection} A selection object.\n\t */\n\tCKEDITOR.dom.document.prototype.getSelection = function() {\n\t\treturn new CKEDITOR.dom.selection( this );\n\t};\n\n\t/**\n\t * Select this range as the only one with {@link CKEDITOR.dom.selection#selectRanges}.\n\t *\n\t * @method\n\t * @returns {CKEDITOR.dom.selection}\n\t * @member CKEDITOR.dom.range\n\t */\n\tCKEDITOR.dom.range.prototype.select = function() {\n\t\tvar sel = this.root instanceof CKEDITOR.editable ? this.root.editor.getSelection() : new CKEDITOR.dom.selection( this.root );\n\n\t\tsel.selectRanges( [ this ] );\n\n\t\treturn sel;\n\t};\n\n\t/**\n\t * No selection.\n\t *\n\t *\t\tif ( editor.getSelection().getType() == CKEDITOR.SELECTION_NONE )\n\t *\t\t\talert( 'Nothing is selected' );\n\t *\n\t * @readonly\n\t * @property {Number} [=1]\n\t * @member CKEDITOR\n\t */\n\tCKEDITOR.SELECTION_NONE = 1;\n\n\t/**\n\t * A text or a collapsed selection.\n\t *\n\t *\t\tif ( editor.getSelection().getType() == CKEDITOR.SELECTION_TEXT )\n\t *\t\t\talert( 'A text is selected' );\n\t *\n\t * @readonly\n\t * @property {Number} [=2]\n\t * @member CKEDITOR\n\t */\n\tCKEDITOR.SELECTION_TEXT = 2;\n\n\t/**\n\t * Element selection.\n\t *\n\t *\t\tif ( editor.getSelection().getType() == CKEDITOR.SELECTION_ELEMENT )\n\t *\t\t\talert( 'An element is selected' );\n\t *\n\t * @readonly\n\t * @property {Number} [=3]\n\t * @member CKEDITOR\n\t */\n\tCKEDITOR.SELECTION_ELEMENT = 3;\n\n\tvar isMSSelection = typeof window.getSelection != 'function',\n\t\tnextRev = 1;\n\n\t/**\n\t * Manipulates the selection within a DOM element. If the current browser selection\n\t * spans outside of the element, an empty selection object is returned.\n\t *\n\t * Despite the fact that selection's constructor allows to create selection instances,\n\t * usually it's better to get selection from the editor instance:\n\t *\n\t *\t\tvar sel = editor.getSelection();\n\t *\n\t * See {@link CKEDITOR.editor#getSelection}.\n\t *\n\t * @class\n\t * @constructor Creates a selection class instance.\n\t *\n\t *\t\t// Selection scoped in document.\n\t *\t\tvar sel = new CKEDITOR.dom.selection( CKEDITOR.document );\n\t *\n\t *\t\t// Selection scoped in element with 'editable' id.\n\t *\t\tvar sel = new CKEDITOR.dom.selection( CKEDITOR.document.getById( 'editable' ) );\n\t *\n\t *\t\t// Cloning selection.\n\t *\t\tvar clone = new CKEDITOR.dom.selection( sel );\n\t *\n\t * @param {CKEDITOR.dom.document/CKEDITOR.dom.element/CKEDITOR.dom.selection} target\n\t * The DOM document/element that the DOM selection is restrained to. Only selection which spans\n\t * within the target element is considered as valid.\n\t *\n\t * If {@link CKEDITOR.dom.selection} is passed, then its clone will be created.\n\t */\n\tCKEDITOR.dom.selection = function( target ) {\n\t\t// Target is a selection - clone it.\n\t\tif ( target instanceof CKEDITOR.dom.selection ) {\n\t\t\tvar selection = target;\n\t\t\ttarget = target.root;\n\t\t}\n\n\t\tvar isElement = target instanceof CKEDITOR.dom.element,\n\t\t\troot;\n\n\t\tthis.rev = selection ? selection.rev : nextRev++;\n\t\tthis.document = target instanceof CKEDITOR.dom.document ? target : target.getDocument();\n\t\tthis.root = root = isElement ? target : this.document.getBody();\n\t\tthis.isLocked = 0;\n\t\tthis._ = {\n\t\t\tcache: {}\n\t\t};\n\n\t\t// Clone selection.\n\t\tif ( selection ) {\n\t\t\tCKEDITOR.tools.extend( this._.cache, selection._.cache );\n\t\t\tthis.isFake = selection.isFake;\n\t\t\tthis.isLocked = selection.isLocked;\n\t\t\treturn this;\n\t\t}\n\n\t\t// Check whether browser focus is really inside of the editable element.\n\n\t\tvar nativeSel = this.getNative(),\n\t\t\trangeParent,\n\t\t\trange;\n\n\t\tif ( nativeSel ) {\n\t\t\tif ( nativeSel.getRangeAt ) {\n\t\t\t\trange = nativeSel.rangeCount && nativeSel.getRangeAt( 0 );\n\t\t\t\trangeParent = range && new CKEDITOR.dom.node( range.commonAncestorContainer );\n\t\t\t}\n\t\t\t// For old IEs.\n\t\t\telse {\n\t\t\t\t// Sometimes, mostly when selection is close to the table or hr,\n\t\t\t\t// IE throws \"Unspecified error\".\n\t\t\t\ttry {\n\t\t\t\t\trange = nativeSel.createRange();\n\t\t\t\t} catch ( err ) {}\n\t\t\t\trangeParent = range && CKEDITOR.dom.element.get( range.item && range.item( 0 ) || range.parentElement() );\n\t\t\t}\n\t\t}\n\n\t\t// Selection out of concerned range, empty the selection.\n\t\t// TODO check whether this condition cannot be reverted to its old\n\t\t// form (commented out) after we closed #10438.\n\t\t//if ( !( rangeParent && ( root.equals( rangeParent ) || root.contains( rangeParent ) ) ) ) {\n\t\tif ( !(\n\t\t\trangeParent &&\n\t\t\t( rangeParent.type == CKEDITOR.NODE_ELEMENT || rangeParent.type == CKEDITOR.NODE_TEXT ) &&\n\t\t\t( this.root.equals( rangeParent ) || this.root.contains( rangeParent ) )\n\t\t) ) {\n\n\t\t\tthis._.cache.type = CKEDITOR.SELECTION_NONE;\n\t\t\tthis._.cache.startElement = null;\n\t\t\tthis._.cache.selectedElement = null;\n\t\t\tthis._.cache.selectedText = '';\n\t\t\tthis._.cache.ranges = new CKEDITOR.dom.rangeList();\n\t\t}\n\n\t\treturn this;\n\t};\n\n\tvar styleObjectElements = { img: 1, hr: 1, li: 1, table: 1, tr: 1, td: 1, th: 1, embed: 1, object: 1, ol: 1, ul: 1,\n\t\t\ta: 1, input: 1, form: 1, select: 1, textarea: 1, button: 1, fieldset: 1, thead: 1, tfoot: 1 };\n\n\t// #13816\n\tvar fillingCharSequence = CKEDITOR.tools.repeat( '\\u200b', 7 ),\n\t\tfillingCharSequenceRegExp = new RegExp( fillingCharSequence + '( )?', 'g' );\n\n\tCKEDITOR.tools.extend( CKEDITOR.dom.selection, {\n\t\t_removeFillingCharSequenceString: removeFillingCharSequenceString,\n\t\t_createFillingCharSequenceNode: createFillingCharSequenceNode,\n\n\t\t/**\n\t\t * The sequence used in a WebKit-based browser to create a Filling Character. By default it is\n\t\t * a string of 7 zero-width space characters (U+200B).\n\t\t *\n\t\t * @since 4.5.7\n\t\t * @readonly\n\t\t * @property {String}\n\t\t */\n\t\tFILLING_CHAR_SEQUENCE: fillingCharSequence\n\t} );\n\n\tCKEDITOR.dom.selection.prototype = {\n\t\t/**\n\t\t * Gets the native selection object from the browser.\n\t\t *\n\t\t *\t\tvar selection = editor.getSelection().getNative();\n\t\t *\n\t\t * @returns {Object} The native browser selection object.\n\t\t */\n\t\tgetNative: function() {\n\t\t\tif ( this._.cache.nativeSel !== undefined )\n\t\t\t\treturn this._.cache.nativeSel;\n\n\t\t\treturn ( this._.cache.nativeSel = isMSSelection ? this.document.$.selection : this.document.getWindow().$.getSelection() );\n\t\t},\n\n\t\t/**\n\t\t * Gets the type of the current selection. The following values are\n\t\t * available:\n\t\t *\n\t\t * * {@link CKEDITOR#SELECTION_NONE} (1): No selection.\n\t\t * * {@link CKEDITOR#SELECTION_TEXT} (2): A text or a collapsed selection is selected.\n\t\t * * {@link CKEDITOR#SELECTION_ELEMENT} (3): An element is selected.\n\t\t *\n\t\t * Example:\n\t\t *\n\t\t *\t\tif ( editor.getSelection().getType() == CKEDITOR.SELECTION_TEXT )\n\t\t *\t\t\talert( 'A text is selected' );\n\t\t *\n\t\t * @method\n\t\t * @returns {Number} One of the following constant values: {@link CKEDITOR#SELECTION_NONE},\n\t\t * {@link CKEDITOR#SELECTION_TEXT} or {@link CKEDITOR#SELECTION_ELEMENT}.\n\t\t */\n\t\tgetType: isMSSelection ?\n\t\tfunction() {\n\t\t\tvar cache = this._.cache;\n\t\t\tif ( cache.type )\n\t\t\t\treturn cache.type;\n\n\t\t\tvar type = CKEDITOR.SELECTION_NONE;\n\n\t\t\ttry {\n\t\t\t\tvar sel = this.getNative(),\n\t\t\t\t\tieType = sel.type;\n\n\t\t\t\tif ( ieType == 'Text' )\n\t\t\t\t\ttype = CKEDITOR.SELECTION_TEXT;\n\n\t\t\t\tif ( ieType == 'Control' )\n\t\t\t\t\ttype = CKEDITOR.SELECTION_ELEMENT;\n\n\t\t\t\t// It is possible that we can still get a text range\n\t\t\t\t// object even when type == 'None' is returned by IE.\n\t\t\t\t// So we'd better check the object returned by\n\t\t\t\t// createRange() rather than by looking at the type.\n\t\t\t\tif ( sel.createRange().parentElement() )\n\t\t\t\t\ttype = CKEDITOR.SELECTION_TEXT;\n\t\t\t} catch ( e ) {}\n\n\t\t\treturn ( cache.type = type );\n\t\t} : function() {\n\t\t\tvar cache = this._.cache;\n\t\t\tif ( cache.type )\n\t\t\t\treturn cache.type;\n\n\t\t\tvar type = CKEDITOR.SELECTION_TEXT;\n\n\t\t\tvar sel = this.getNative();\n\n\t\t\tif ( !( sel && sel.rangeCount ) )\n\t\t\t\ttype = CKEDITOR.SELECTION_NONE;\n\t\t\telse if ( sel.rangeCount == 1 ) {\n\t\t\t\t// Check if the actual selection is a control (IMG,\n\t\t\t\t// TABLE, HR, etc...).\n\n\t\t\t\tvar range = sel.getRangeAt( 0 ),\n\t\t\t\t\tstartContainer = range.startContainer;\n\n\t\t\t\tif ( startContainer == range.endContainer && startContainer.nodeType == 1 &&\n\t\t\t\t\t( range.endOffset - range.startOffset ) == 1 &&\n\t\t\t\t\tstyleObjectElements[ startContainer.childNodes[ range.startOffset ].nodeName.toLowerCase() ] ) {\n\t\t\t\t\ttype = CKEDITOR.SELECTION_ELEMENT;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn ( cache.type = type );\n\t\t},\n\n\t\t/**\n\t\t * Retrieves the {@link CKEDITOR.dom.range} instances that represent the current selection.\n\t\t *\n\t\t * Note: Some browsers return multiple ranges even for a continuous selection. Firefox, for example, returns\n\t\t * one range for each table cell when one or more table rows are selected.\n\t\t *\n\t\t *\t\tvar ranges = selection.getRanges();\n\t\t *\t\talert( ranges.length );\n\t\t *\n\t\t * @method\n\t\t * @param {Boolean} [onlyEditables] If set to `true`, this function retrives editable ranges only.\n\t\t * @returns {Array} Range instances that represent the current selection.\n\t\t */\n\t\tgetRanges: ( function() {\n\t\t\tvar func = isMSSelection ? ( function() {\n\t\t\t\tfunction getNodeIndex( node ) {\n\t\t\t\t\treturn new CKEDITOR.dom.node( node ).getIndex();\n\t\t\t\t}\n\n\t\t\t\t// Finds the container and offset for a specific boundary\n\t\t\t\t// of an IE range.\n\t\t\t\tvar getBoundaryInformation = function( range, start ) {\n\t\t\t\t\t// Creates a collapsed range at the requested boundary.\n\t\t\t\t\trange = range.duplicate();\n\t\t\t\t\trange.collapse( start );\n\n\t\t\t\t\t// Gets the element that encloses the range entirely.\n\t\t\t\t\tvar parent = range.parentElement();\n\n\t\t\t\t\t// Empty parent element, e.g. <i>^</i>\n\t\t\t\t\tif ( !parent.hasChildNodes() )\n\t\t\t\t\t\treturn { container: parent, offset: 0 };\n\n\t\t\t\t\tvar siblings = parent.children,\n\t\t\t\t\t\tchild, sibling,\n\t\t\t\t\t\ttestRange = range.duplicate(),\n\t\t\t\t\t\tstartIndex = 0,\n\t\t\t\t\t\tendIndex = siblings.length - 1,\n\t\t\t\t\t\tindex = -1,\n\t\t\t\t\t\tposition, distance, container;\n\n\t\t\t\t\t// Binary search over all element childs to test the range to see whether\n\t\t\t\t\t// range is right on the boundary of one element.\n\t\t\t\t\twhile ( startIndex <= endIndex ) {\n\t\t\t\t\t\tindex = Math.floor( ( startIndex + endIndex ) / 2 );\n\t\t\t\t\t\tchild = siblings[ index ];\n\t\t\t\t\t\ttestRange.moveToElementText( child );\n\t\t\t\t\t\tposition = testRange.compareEndPoints( 'StartToStart', range );\n\n\t\t\t\t\t\tif ( position > 0 )\n\t\t\t\t\t\t\tendIndex = index - 1;\n\t\t\t\t\t\telse if ( position < 0 )\n\t\t\t\t\t\t\tstartIndex = index + 1;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\treturn { container: parent, offset: getNodeIndex( child ) };\n\t\t\t\t\t}\n\n\t\t\t\t\t// All childs are text nodes,\n\t\t\t\t\t// or to the right hand of test range are all text nodes. (#6992)\n\t\t\t\t\tif ( index == -1 || index == siblings.length - 1 && position < 0 ) {\n\t\t\t\t\t\t// Adapt test range to embrace the entire parent contents.\n\t\t\t\t\t\ttestRange.moveToElementText( parent );\n\t\t\t\t\t\ttestRange.setEndPoint( 'StartToStart', range );\n\n\t\t\t\t\t\t// IE report line break as CRLF with range.text but\n\t\t\t\t\t\t// only LF with textnode.nodeValue, normalize them to avoid\n\t\t\t\t\t\t// breaking character counting logic below. (#3949)\n\t\t\t\t\t\tdistance = testRange.text.replace( /(\\r\\n|\\r)/g, '\\n' ).length;\n\n\t\t\t\t\t\tsiblings = parent.childNodes;\n\n\t\t\t\t\t\t// Actual range anchor right beside test range at the boundary of text node.\n\t\t\t\t\t\tif ( !distance ) {\n\t\t\t\t\t\t\tchild = siblings[ siblings.length - 1 ];\n\n\t\t\t\t\t\t\tif ( child.nodeType != CKEDITOR.NODE_TEXT )\n\t\t\t\t\t\t\t\treturn { container: parent, offset: siblings.length };\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\treturn { container: child, offset: child.nodeValue.length };\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Start the measuring until distance overflows, meanwhile count the text nodes.\n\t\t\t\t\t\tvar i = siblings.length;\n\t\t\t\t\t\twhile ( distance > 0 && i > 0 ) {\n\t\t\t\t\t\t\tsibling = siblings[ --i ];\n\t\t\t\t\t\t\tif ( sibling.nodeType == CKEDITOR.NODE_TEXT ) {\n\t\t\t\t\t\t\t\tcontainer = sibling;\n\t\t\t\t\t\t\t\tdistance -= sibling.nodeValue.length;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn { container: container, offset: -distance };\n\t\t\t\t\t}\n\t\t\t\t\t// Test range was one offset beyond OR behind the anchored text node.\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Adapt one side of test range to the actual range\n\t\t\t\t\t\t// for measuring the offset between them.\n\t\t\t\t\t\ttestRange.collapse( position > 0 ? true : false );\n\t\t\t\t\t\ttestRange.setEndPoint( position > 0 ? 'StartToStart' : 'EndToStart', range );\n\n\t\t\t\t\t\t// IE report line break as CRLF with range.text but\n\t\t\t\t\t\t// only LF with textnode.nodeValue, normalize them to avoid\n\t\t\t\t\t\t// breaking character counting logic below. (#3949)\n\t\t\t\t\t\tdistance = testRange.text.replace( /(\\r\\n|\\r)/g, '\\n' ).length;\n\n\t\t\t\t\t\t// Actual range anchor right beside test range at the inner boundary of text node.\n\t\t\t\t\t\tif ( !distance )\n\t\t\t\t\t\t\treturn { container: parent, offset: getNodeIndex( child ) + ( position > 0 ? 0 : 1 ) };\n\n\t\t\t\t\t\t// Start the measuring until distance overflows, meanwhile count the text nodes.\n\t\t\t\t\t\twhile ( distance > 0 ) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tsibling = child[ position > 0 ? 'previousSibling' : 'nextSibling' ];\n\t\t\t\t\t\t\t\tif ( sibling.nodeType == CKEDITOR.NODE_TEXT ) {\n\t\t\t\t\t\t\t\t\tdistance -= sibling.nodeValue.length;\n\t\t\t\t\t\t\t\t\tcontainer = sibling;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tchild = sibling;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// Measurement in IE could be somtimes wrong because of <select> element. (#4611)\n\t\t\t\t\t\t\tcatch ( e ) {\n\t\t\t\t\t\t\t\treturn { container: parent, offset: getNodeIndex( child ) };\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn { container: container, offset: position > 0 ? -distance : container.nodeValue.length + distance };\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\treturn function() {\n\t\t\t\t\t// IE doesn't have range support (in the W3C way), so we\n\t\t\t\t\t// need to do some magic to transform selections into\n\t\t\t\t\t// CKEDITOR.dom.range instances.\n\n\t\t\t\t\tvar sel = this.getNative(),\n\t\t\t\t\t\tnativeRange = sel && sel.createRange(),\n\t\t\t\t\t\ttype = this.getType(),\n\t\t\t\t\t\trange;\n\n\t\t\t\t\tif ( !sel )\n\t\t\t\t\t\treturn [];\n\n\t\t\t\t\tif ( type == CKEDITOR.SELECTION_TEXT ) {\n\t\t\t\t\t\trange = new CKEDITOR.dom.range( this.root );\n\n\t\t\t\t\t\tvar boundaryInfo = getBoundaryInformation( nativeRange, true );\n\t\t\t\t\t\trange.setStart( new CKEDITOR.dom.node( boundaryInfo.container ), boundaryInfo.offset );\n\n\t\t\t\t\t\tboundaryInfo = getBoundaryInformation( nativeRange );\n\t\t\t\t\t\trange.setEnd( new CKEDITOR.dom.node( boundaryInfo.container ), boundaryInfo.offset );\n\n\t\t\t\t\t\t// Correct an invalid IE range case on empty list item. (#5850)\n\t\t\t\t\t\tif ( range.endContainer.getPosition( range.startContainer ) & CKEDITOR.POSITION_PRECEDING && range.endOffset <= range.startContainer.getIndex() )\n\t\t\t\t\t\t\trange.collapse();\n\n\t\t\t\t\t\treturn [ range ];\n\t\t\t\t\t} else if ( type == CKEDITOR.SELECTION_ELEMENT ) {\n\t\t\t\t\t\tvar retval = [];\n\n\t\t\t\t\t\tfor ( var i = 0; i < nativeRange.length; i++ ) {\n\t\t\t\t\t\t\tvar element = nativeRange.item( i ),\n\t\t\t\t\t\t\t\tparentElement = element.parentNode,\n\t\t\t\t\t\t\t\tj = 0;\n\n\t\t\t\t\t\t\trange = new CKEDITOR.dom.range( this.root );\n\n\t\t\t\t\t\t\tfor ( ; j < parentElement.childNodes.length && parentElement.childNodes[ j ] != element; j++ ) {\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\trange.setStart( new CKEDITOR.dom.node( parentElement ), j );\n\t\t\t\t\t\t\trange.setEnd( new CKEDITOR.dom.node( parentElement ), j + 1 );\n\t\t\t\t\t\t\tretval.push( range );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn retval;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn [];\n\t\t\t\t};\n\t\t\t} )() :\n\t\t\tfunction() {\n\t\t\t\t// On browsers implementing the W3C range, we simply\n\t\t\t\t// tranform the native ranges in CKEDITOR.dom.range\n\t\t\t\t// instances.\n\n\t\t\t\tvar ranges = [],\n\t\t\t\t\trange,\n\t\t\t\t\tsel = this.getNative();\n\n\t\t\t\tif ( !sel )\n\t\t\t\t\treturn ranges;\n\n\t\t\t\tfor ( var i = 0; i < sel.rangeCount; i++ ) {\n\t\t\t\t\tvar nativeRange = sel.getRangeAt( i );\n\n\t\t\t\t\trange = new CKEDITOR.dom.range( this.root );\n\n\t\t\t\t\trange.setStart( new CKEDITOR.dom.node( nativeRange.startContainer ), nativeRange.startOffset );\n\t\t\t\t\trange.setEnd( new CKEDITOR.dom.node( nativeRange.endContainer ), nativeRange.endOffset );\n\t\t\t\t\tranges.push( range );\n\t\t\t\t}\n\t\t\t\treturn ranges;\n\t\t\t};\n\n\t\t\treturn function( onlyEditables ) {\n\t\t\t\tvar cache = this._.cache,\n\t\t\t\t\tranges = cache.ranges;\n\n\t\t\t\tif ( !ranges )\n\t\t\t\t\tcache.ranges = ranges = new CKEDITOR.dom.rangeList( func.call( this ) );\n\n\t\t\t\tif ( !onlyEditables )\n\t\t\t\t\treturn ranges;\n\n\t\t\t\t// Split range into multiple by read-only nodes.\n\t\t\t\t// Clone ranges array to avoid changing cached ranges (#11493).\n\t\t\t\treturn extractEditableRanges( new CKEDITOR.dom.rangeList( ranges.slice() ) );\n\t\t\t};\n\t\t} )(),\n\n\t\t/**\n\t\t * Gets the DOM element in which the selection starts.\n\t\t *\n\t\t *\t\tvar element = editor.getSelection().getStartElement();\n\t\t *\t\talert( element.getName() );\n\t\t *\n\t\t * @returns {CKEDITOR.dom.element} The element at the beginning of the selection.\n\t\t */\n\t\tgetStartElement: function() {\n\t\t\tvar cache = this._.cache;\n\t\t\tif ( cache.startElement !== undefined )\n\t\t\t\treturn cache.startElement;\n\n\t\t\tvar node;\n\n\t\t\tswitch ( this.getType() ) {\n\t\t\t\tcase CKEDITOR.SELECTION_ELEMENT:\n\t\t\t\t\treturn this.getSelectedElement();\n\n\t\t\t\tcase CKEDITOR.SELECTION_TEXT:\n\n\t\t\t\t\tvar range = this.getRanges()[ 0 ];\n\n\t\t\t\t\tif ( range ) {\n\t\t\t\t\t\tif ( !range.collapsed ) {\n\t\t\t\t\t\t\trange.optimize();\n\n\t\t\t\t\t\t\t// Decrease the range content to exclude particial\n\t\t\t\t\t\t\t// selected node on the start which doesn't have\n\t\t\t\t\t\t\t// visual impact. ( #3231 )\n\t\t\t\t\t\t\twhile ( 1 ) {\n\t\t\t\t\t\t\t\tvar startContainer = range.startContainer,\n\t\t\t\t\t\t\t\t\tstartOffset = range.startOffset;\n\t\t\t\t\t\t\t\t// Limit the fix only to non-block elements.(#3950)\n\t\t\t\t\t\t\t\tif ( startOffset == ( startContainer.getChildCount ? startContainer.getChildCount() : startContainer.getLength() ) && !startContainer.isBlockBoundary() )\n\t\t\t\t\t\t\t\t\trange.setStartAfter( startContainer );\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tnode = range.startContainer;\n\n\t\t\t\t\t\t\tif ( node.type != CKEDITOR.NODE_ELEMENT )\n\t\t\t\t\t\t\t\treturn node.getParent();\n\n\t\t\t\t\t\t\tnode = node.getChild( range.startOffset );\n\n\t\t\t\t\t\t\tif ( !node || node.type != CKEDITOR.NODE_ELEMENT )\n\t\t\t\t\t\t\t\tnode = range.startContainer;\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tvar child = node.getFirst();\n\t\t\t\t\t\t\t\twhile ( child && child.type == CKEDITOR.NODE_ELEMENT ) {\n\t\t\t\t\t\t\t\t\tnode = child;\n\t\t\t\t\t\t\t\t\tchild = child.getFirst();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnode = range.startContainer;\n\t\t\t\t\t\t\tif ( node.type != CKEDITOR.NODE_ELEMENT )\n\t\t\t\t\t\t\t\tnode = node.getParent();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tnode = node.$;\n\t\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn cache.startElement = ( node ? new CKEDITOR.dom.element( node ) : null );\n\t\t},\n\n\t\t/**\n\t\t * Gets the currently selected element.\n\t\t *\n\t\t *\t\tvar element = editor.getSelection().getSelectedElement();\n\t\t *\t\talert( element.getName() );\n\t\t *\n\t\t * @returns {CKEDITOR.dom.element} The selected element. Null if no\n\t\t * selection is available or the selection type is not {@link CKEDITOR#SELECTION_ELEMENT}.\n\t\t */\n\t\tgetSelectedElement: function() {\n\t\t\tvar cache = this._.cache;\n\t\t\tif ( cache.selectedElement !== undefined )\n\t\t\t\treturn cache.selectedElement;\n\n\t\t\tvar self = this;\n\n\t\t\tvar node = CKEDITOR.tools.tryThese(\n\t\t\t\t// Is it native IE control type selection?\n\t\t\t\tfunction() {\n\t\t\t\t\treturn self.getNative().createRange().item( 0 );\n\t\t\t\t},\n\t\t\t\t// Figure it out by checking if there's a single enclosed\n\t\t\t\t// node of the range.\n\t\t\t\tfunction() {\n\t\t\t\t\tvar range = self.getRanges()[ 0 ].clone(),\n\t\t\t\t\t\tenclosed, selected;\n\n\t\t\t\t\t// Check first any enclosed element, e.g. <ul>[<li><a href=\"#\">item</a></li>]</ul>\n\t\t\t\t\tfor ( var i = 2; i && !( ( enclosed = range.getEnclosedNode() ) && ( enclosed.type == CKEDITOR.NODE_ELEMENT ) && styleObjectElements[ enclosed.getName() ] && ( selected = enclosed ) ); i-- ) {\n\t\t\t\t\t\t// Then check any deep wrapped element, e.g. [<b><i><img /></i></b>]\n\t\t\t\t\t\trange.shrink( CKEDITOR.SHRINK_ELEMENT );\n\t\t\t\t\t}\n\n\t\t\t\t\treturn selected && selected.$;\n\t\t\t\t}\n\t\t\t);\n\n\t\t\treturn cache.selectedElement = ( node ? new CKEDITOR.dom.element( node ) : null );\n\t\t},\n\n\t\t/**\n\t\t * Retrieves the text contained within the range. An empty string is returned for non-text selection.\n\t\t *\n\t\t *\t\tvar text = editor.getSelection().getSelectedText();\n\t\t *\t\talert( text );\n\t\t *\n\t\t * @since 3.6.1\n\t\t * @returns {String} A string of text within the current selection.\n\t\t */\n\t\tgetSelectedText: function() {\n\t\t\tvar cache = this._.cache;\n\t\t\tif ( cache.selectedText !== undefined )\n\t\t\t\treturn cache.selectedText;\n\n\t\t\tvar nativeSel = this.getNative(),\n\t\t\t\ttext = isMSSelection ? nativeSel.type == 'Control' ? '' : nativeSel.createRange().text : nativeSel.toString();\n\n\t\t\treturn ( cache.selectedText = text );\n\t\t},\n\n\t\t/**\n\t\t * Locks the selection made in the editor in order to make it possible to\n\t\t * manipulate it without browser interference. A locked selection is\n\t\t * cached and remains unchanged until it is released with the {@link #unlock} method.\n\t\t *\n\t\t *\t\teditor.getSelection().lock();\n\t\t */\n\t\tlock: function() {\n\t\t\t// Call all cacheable function.\n\t\t\tthis.getRanges();\n\t\t\tthis.getStartElement();\n\t\t\tthis.getSelectedElement();\n\t\t\tthis.getSelectedText();\n\n\t\t\t// The native selection is not available when locked.\n\t\t\tthis._.cache.nativeSel = null;\n\n\t\t\tthis.isLocked = 1;\n\t\t},\n\n\t\t/**\n\t\t * @todo\n\t\t */\n\t\tunlock: function( restore ) {\n\t\t\tif ( !this.isLocked )\n\t\t\t\treturn;\n\n\t\t\tif ( restore ) {\n\t\t\t\tvar selectedElement = this.getSelectedElement(),\n\t\t\t\t\tranges = !selectedElement && this.getRanges(),\n\t\t\t\t\tfaked = this.isFake;\n\t\t\t}\n\n\t\t\tthis.isLocked = 0;\n\t\t\tthis.reset();\n\n\t\t\tif ( restore ) {\n\t\t\t\t// Saved selection may be outdated (e.g. anchored in offline nodes).\n\t\t\t\t// Avoid getting broken by such.\n\t\t\t\tvar common = selectedElement || ranges[ 0 ] && ranges[ 0 ].getCommonAncestor();\n\t\t\t\tif ( !( common && common.getAscendant( 'body', 1 ) ) )\n\t\t\t\t\treturn;\n\n\t\t\t\tif ( faked )\n\t\t\t\t\tthis.fake( selectedElement );\n\t\t\t\telse if ( selectedElement )\n\t\t\t\t\tthis.selectElement( selectedElement );\n\t\t\t\telse\n\t\t\t\t\tthis.selectRanges( ranges );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Clears the selection cache.\n\t\t *\n\t\t *\t\teditor.getSelection().reset();\n\t\t */\n\t\treset: function() {\n\t\t\tthis._.cache = {};\n\t\t\tthis.isFake = 0;\n\n\t\t\tvar editor = this.root.editor;\n\n\t\t\t// Invalidate any fake selection available in the editor.\n\t\t\tif ( editor && editor._.fakeSelection ) {\n\t\t\t\t// Test whether this selection is the one that was\n\t\t\t\t// faked or its clone.\n\t\t\t\tif ( this.rev == editor._.fakeSelection.rev ) {\n\t\t\t\t\tdelete editor._.fakeSelection;\n\n\t\t\t\t\tremoveHiddenSelectionContainer( editor );\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tCKEDITOR.warn( 'selection-fake-reset' );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.rev = nextRev++;\n\t\t},\n\n\t\t/**\n\t\t * Makes the current selection of type {@link CKEDITOR#SELECTION_ELEMENT} by enclosing the specified element.\n\t\t *\n\t\t *\t\tvar element = editor.document.getById( 'sampleElement' );\n\t\t *\t\teditor.getSelection().selectElement( element );\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} element The element to enclose in the selection.\n\t\t */\n\t\tselectElement: function( element ) {\n\t\t\tvar range = new CKEDITOR.dom.range( this.root );\n\t\t\trange.setStartBefore( element );\n\t\t\trange.setEndAfter( element );\n\t\t\tthis.selectRanges( [ range ] );\n\t\t},\n\n\t\t/**\n\t\t * Clears the original selection and adds the specified ranges to the document selection.\n\t\t *\n\t\t * \t\t// Move selection to the end of the editable element.\n\t\t *\t\tvar range = editor.createRange();\n\t\t *\t\trange.moveToPosition( range.root, CKEDITOR.POSITION_BEFORE_END );\n\t\t *\t\teditor.getSelection().selectRanges( [ ranges ] );\n\t\t *\n\t\t * @param {Array} ranges An array of {@link CKEDITOR.dom.range} instances\n\t\t * representing ranges to be added to the document.\n\t\t */\n\t\tselectRanges: function( ranges ) {\n\t\t\tvar editor = this.root.editor,\n\t\t\t\thadHiddenSelectionContainer = editor && editor._.hiddenSelectionContainer;\n\n\t\t\tthis.reset();\n\n\t\t\t// Check if there's a hiddenSelectionContainer in editable at some index.\n\t\t\t// Some ranges may be anchored after the hiddenSelectionContainer and,\n\t\t\t// once the container is removed while resetting the selection, they\n\t\t\t// may need new endOffset (one element less within the range) (#11021 #11393).\n\t\t\tif ( hadHiddenSelectionContainer )\n\t\t\t\tfixRangesAfterHiddenSelectionContainer( ranges, this.root );\n\n\t\t\tif ( !ranges.length )\n\t\t\t\treturn;\n\n\t\t\t// Refresh the locked selection.\n\t\t\tif ( this.isLocked ) {\n\t\t\t\t// making a new DOM selection will force the focus on editable in certain situation,\n\t\t\t\t// we have to save the currently focused element for later recovery.\n\t\t\t\tvar focused = CKEDITOR.document.getActive();\n\t\t\t\tthis.unlock();\n\t\t\t\tthis.selectRanges( ranges );\n\t\t\t\tthis.lock();\n\t\t\t\t// Return to the previously focused element.\n\t\t\t\tfocused && !focused.equals( this.root ) && focused.focus();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Handle special case - automatic fake selection on non-editable elements.\n\t\t\tvar receiver = getNonEditableFakeSelectionReceiver( ranges );\n\n\t\t\tif ( receiver ) {\n\t\t\t\tthis.fake( receiver );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( isMSSelection ) {\n\t\t\t\tvar notWhitespaces = CKEDITOR.dom.walker.whitespaces( true ),\n\t\t\t\t\tfillerTextRegex = /\\ufeff|\\u00a0/,\n\t\t\t\t\tnonCells = { table: 1, tbody: 1, tr: 1 };\n\n\t\t\t\tif ( ranges.length > 1 ) {\n\t\t\t\t\t// IE doesn't accept multiple ranges selection, so we join all into one.\n\t\t\t\t\tvar last = ranges[ ranges.length - 1 ];\n\t\t\t\t\tranges[ 0 ].setEnd( last.endContainer, last.endOffset );\n\t\t\t\t}\n\n\t\t\t\tvar range = ranges[ 0 ];\n\t\t\t\tvar collapsed = range.collapsed,\n\t\t\t\t\tisStartMarkerAlone, dummySpan, ieRange;\n\n\t\t\t\t// Try to make a object selection, be careful with selecting phase element in IE\n\t\t\t\t// will breaks the selection in non-framed environment.\n\t\t\t\tvar selected = range.getEnclosedNode();\n\t\t\t\tif ( selected && selected.type == CKEDITOR.NODE_ELEMENT && selected.getName() in styleObjectElements &&\n\t\t\t\t\t!( selected.is( 'a' ) && selected.getText() ) ) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tieRange = selected.$.createControlRange();\n\t\t\t\t\t\tieRange.addElement( selected.$ );\n\t\t\t\t\t\tieRange.select();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} catch ( er ) {}\n\t\t\t\t}\n\n\t\t\t\t// IE doesn't support selecting the entire table row/cell, move the selection into cells, e.g.\n\t\t\t\t// <table><tbody><tr>[<td>cell</b></td>... => <table><tbody><tr><td>[cell</td>...\n\t\t\t\tif ( range.startContainer.type == CKEDITOR.NODE_ELEMENT && range.startContainer.getName() in nonCells ||\n\t\t\t\t\trange.endContainer.type == CKEDITOR.NODE_ELEMENT && range.endContainer.getName() in nonCells ) {\n\t\t\t\t\trange.shrink( CKEDITOR.NODE_ELEMENT, true );\n\t\t\t\t\t// The range might get collapsed (#7975). Update cached variable.\n\t\t\t\t\tcollapsed = range.collapsed;\n\t\t\t\t}\n\n\t\t\t\tvar bookmark = range.createBookmark();\n\n\t\t\t\t// Create marker tags for the start and end boundaries.\n\t\t\t\tvar startNode = bookmark.startNode;\n\n\t\t\t\tvar endNode;\n\t\t\t\tif ( !collapsed )\n\t\t\t\t\tendNode = bookmark.endNode;\n\n\t\t\t\t// Create the main range which will be used for the selection.\n\t\t\t\tieRange = range.document.$.body.createTextRange();\n\n\t\t\t\t// Position the range at the start boundary.\n\t\t\t\tieRange.moveToElementText( startNode.$ );\n\t\t\t\tieRange.moveStart( 'character', 1 );\n\n\t\t\t\tif ( endNode ) {\n\t\t\t\t\t// Create a tool range for the end.\n\t\t\t\t\tvar ieRangeEnd = range.document.$.body.createTextRange();\n\n\t\t\t\t\t// Position the tool range at the end.\n\t\t\t\t\tieRangeEnd.moveToElementText( endNode.$ );\n\n\t\t\t\t\t// Move the end boundary of the main range to match the tool range.\n\t\t\t\t\tieRange.setEndPoint( 'EndToEnd', ieRangeEnd );\n\t\t\t\t\tieRange.moveEnd( 'character', -1 );\n\t\t\t\t} else {\n\t\t\t\t\t// The isStartMarkerAlone logic comes from V2. It guarantees that the lines\n\t\t\t\t\t// will expand and that the cursor will be blinking on the right place.\n\t\t\t\t\t// Actually, we are using this flag just to avoid using this hack in all\n\t\t\t\t\t// situations, but just on those needed.\n\t\t\t\t\tvar next = startNode.getNext( notWhitespaces );\n\t\t\t\t\tvar inPre = startNode.hasAscendant( 'pre' );\n\t\t\t\t\tisStartMarkerAlone = ( !( next && next.getText && next.getText().match( fillerTextRegex ) ) && // already a filler there?\n\t\t\t\t\t\t( inPre || !startNode.hasPrevious() || ( startNode.getPrevious().is && startNode.getPrevious().is( 'br' ) ) ) );\n\n\t\t\t\t\t// Append a temporary <span>&#65279;</span> before the selection.\n\t\t\t\t\t// This is needed to avoid IE destroying selections inside empty\n\t\t\t\t\t// inline elements, like <b></b> (#253).\n\t\t\t\t\t// It is also needed when placing the selection right after an inline\n\t\t\t\t\t// element to avoid the selection moving inside of it.\n\t\t\t\t\tdummySpan = range.document.createElement( 'span' );\n\t\t\t\t\tdummySpan.setHtml( '&#65279;' ); // Zero Width No-Break Space (U+FEFF). See #1359.\n\t\t\t\t\tdummySpan.insertBefore( startNode );\n\n\t\t\t\t\tif ( isStartMarkerAlone ) {\n\t\t\t\t\t\t// To expand empty blocks or line spaces after <br>, we need\n\t\t\t\t\t\t// instead to have any char, which will be later deleted using the\n\t\t\t\t\t\t// selection.\n\t\t\t\t\t\t// \\ufeff = Zero Width No-Break Space (U+FEFF). (#1359)\n\t\t\t\t\t\trange.document.createText( '\\ufeff' ).insertBefore( startNode );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Remove the markers (reset the position, because of the changes in the DOM tree).\n\t\t\t\trange.setStartBefore( startNode );\n\t\t\t\tstartNode.remove();\n\n\t\t\t\tif ( collapsed ) {\n\t\t\t\t\tif ( isStartMarkerAlone ) {\n\t\t\t\t\t\t// Move the selection start to include the temporary \\ufeff.\n\t\t\t\t\t\tieRange.moveStart( 'character', -1 );\n\n\t\t\t\t\t\tieRange.select();\n\n\t\t\t\t\t\t// Remove our temporary stuff.\n\t\t\t\t\t\trange.document.$.selection.clear();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tieRange.select();\n\t\t\t\t\t}\n\n\t\t\t\t\trange.moveToPosition( dummySpan, CKEDITOR.POSITION_BEFORE_START );\n\t\t\t\t\tdummySpan.remove();\n\t\t\t\t} else {\n\t\t\t\t\trange.setEndBefore( endNode );\n\t\t\t\t\tendNode.remove();\n\t\t\t\t\tieRange.select();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar sel = this.getNative();\n\n\t\t\t\t// getNative() returns null if iframe is \"display:none\" in FF. (#6577)\n\t\t\t\tif ( !sel )\n\t\t\t\t\treturn;\n\n\t\t\t\tthis.removeAllRanges();\n\n\t\t\t\tfor ( var i = 0; i < ranges.length; i++ ) {\n\t\t\t\t\t// Joining sequential ranges introduced by\n\t\t\t\t\t// readonly elements protection.\n\t\t\t\t\tif ( i < ranges.length - 1 ) {\n\t\t\t\t\t\tvar left = ranges[ i ],\n\t\t\t\t\t\t\tright = ranges[ i + 1 ],\n\t\t\t\t\t\t\tbetween = left.clone();\n\t\t\t\t\t\tbetween.setStart( left.endContainer, left.endOffset );\n\t\t\t\t\t\tbetween.setEnd( right.startContainer, right.startOffset );\n\n\t\t\t\t\t\t// Don't confused by Firefox adjancent multi-ranges\n\t\t\t\t\t\t// introduced by table cells selection.\n\t\t\t\t\t\tif ( !between.collapsed ) {\n\t\t\t\t\t\t\tbetween.shrink( CKEDITOR.NODE_ELEMENT, true );\n\t\t\t\t\t\t\tvar ancestor = between.getCommonAncestor(),\n\t\t\t\t\t\t\t\tenclosed = between.getEnclosedNode();\n\n\t\t\t\t\t\t\t// The following cases has to be considered:\n\t\t\t\t\t\t\t// 1. <span contenteditable=\"false\">[placeholder]</span>\n\t\t\t\t\t\t\t// 2. <input contenteditable=\"false\"  type=\"radio\"/> (#6621)\n\t\t\t\t\t\t\tif ( ancestor.isReadOnly() || enclosed && enclosed.isReadOnly() ) {\n\t\t\t\t\t\t\t\tright.setStart( left.startContainer, left.startOffset );\n\t\t\t\t\t\t\t\tranges.splice( i--, 1 );\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\trange = ranges[ i ];\n\n\t\t\t\t\tvar nativeRange = this.document.$.createRange();\n\n\t\t\t\t\tif ( range.collapsed && CKEDITOR.env.webkit && rangeRequiresFix( range ) ) {\n\t\t\t\t\t\t// Append a zero-width space so WebKit will not try to\n\t\t\t\t\t\t// move the selection by itself (#1272).\n\t\t\t\t\t\tvar fillingChar = createFillingCharSequenceNode( this.root );\n\t\t\t\t\t\trange.insertNode( fillingChar );\n\n\t\t\t\t\t\tnext = fillingChar.getNext();\n\n\t\t\t\t\t\t// If the filling char is followed by a <br>, whithout\n\t\t\t\t\t\t// having something before it, it'll not blink.\n\t\t\t\t\t\t// Let's remove it in this case.\n\t\t\t\t\t\tif ( next && !fillingChar.getPrevious() && next.type == CKEDITOR.NODE_ELEMENT && next.getName() == 'br' ) {\n\t\t\t\t\t\t\tremoveFillingCharSequenceNode( this.root );\n\t\t\t\t\t\t\trange.moveToPosition( next, CKEDITOR.POSITION_BEFORE_START );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trange.moveToPosition( fillingChar, CKEDITOR.POSITION_AFTER_END );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tnativeRange.setStart( range.startContainer.$, range.startOffset );\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tnativeRange.setEnd( range.endContainer.$, range.endOffset );\n\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\t// There is a bug in Firefox implementation (it would be too easy\n\t\t\t\t\t\t// otherwise). The new start can't be after the end (W3C says it can).\n\t\t\t\t\t\t// So, let's create a new range and collapse it to the desired point.\n\t\t\t\t\t\tif ( e.toString().indexOf( 'NS_ERROR_ILLEGAL_VALUE' ) >= 0 ) {\n\t\t\t\t\t\t\trange.collapse( 1 );\n\t\t\t\t\t\t\tnativeRange.setEnd( range.endContainer.$, range.endOffset );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthrow e;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Select the range.\n\t\t\t\t\tsel.addRange( nativeRange );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.reset();\n\n\t\t\t// Fakes the IE DOM event \"selectionchange\" on editable.\n\t\t\tthis.root.fire( 'selectionchange' );\n\t\t},\n\n\t\t/**\n\t\t * Makes a \"fake selection\" of an element.\n\t\t *\n\t\t * A fake selection does not render UI artifacts over the selected\n\t\t * element. Additionally, the browser native selection system is not\n\t\t * aware of the fake selection. In practice, the native selection is\n\t\t * moved to a hidden place where no native selection UI artifacts are\n\t\t * displayed to the user.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} element The element to be \"selected\".\n\t\t * @param {String} [ariaLabel] A string to be used by the screen reader to describe the selection.\n\t\t */\n\t\tfake: function( element, ariaLabel ) {\n\t\t\tvar editor = this.root.editor;\n\n\t\t\t// Attempt to retreive aria-label if possible (#14539).\n\t\t\tif ( ariaLabel === undefined && element.hasAttribute( 'aria-label' ) ) {\n\t\t\t\tariaLabel = element.getAttribute( 'aria-label' );\n\t\t\t}\n\n\t\t\t// Cleanup after previous selection - e.g. remove hidden sel container.\n\t\t\tthis.reset();\n\n\t\t\thideSelection( editor, ariaLabel );\n\n\t\t\t// Set this value after executing hiseSelection, because it may\n\t\t\t// cause reset() which overwrites cache.\n\t\t\tvar cache = this._.cache;\n\n\t\t\t// Caches a range than holds the element.\n\t\t\tvar range = new CKEDITOR.dom.range( this.root );\n\t\t\trange.setStartBefore( element );\n\t\t\trange.setEndAfter( element );\n\t\t\tcache.ranges = new CKEDITOR.dom.rangeList( range );\n\n\t\t\t// Put this element in the cache.\n\t\t\tcache.selectedElement = cache.startElement = element;\n\t\t\tcache.type = CKEDITOR.SELECTION_ELEMENT;\n\n\t\t\t// Properties that will not be available when isFake.\n\t\t\tcache.selectedText = cache.nativeSel = null;\n\n\t\t\tthis.isFake = 1;\n\t\t\tthis.rev = nextRev++;\n\n\t\t\t// Save this selection, so it can be returned by editor.getSelection().\n\t\t\teditor._.fakeSelection = this;\n\n\t\t\t// Fire selectionchange, just like a normal selection.\n\t\t\tthis.root.fire( 'selectionchange' );\n\t\t},\n\n\t\t/**\n\t\t * Checks whether selection is placed in hidden element.\n\t\t *\n\t\t * This method is to be used to verify whether fake selection\n\t\t * (see {@link #fake}) is still hidden.\n\t\t *\n\t\t * **Note:** this method should be executed on real selection - e.g.:\n\t\t *\n\t\t *\t\teditor.getSelection( true ).isHidden();\n\t\t *\n\t\t * @returns {Boolean}\n\t\t */\n\t\tisHidden: function() {\n\t\t\tvar el = this.getCommonAncestor();\n\n\t\t\tif ( el && el.type == CKEDITOR.NODE_TEXT )\n\t\t\t\tel = el.getParent();\n\n\t\t\treturn !!( el && el.data( 'cke-hidden-sel' ) );\n\t\t},\n\n\t\t/**\n\t\t * Creates a bookmark for each range of this selection (from {@link #getRanges})\n\t\t * by calling the {@link CKEDITOR.dom.range#createBookmark} method,\n\t\t * with extra care taken to avoid interference among those ranges. The arguments\n\t\t * received are the same as with the underlying range method.\n\t\t *\n\t\t *\t\tvar bookmarks = editor.getSelection().createBookmarks();\n\t\t *\n\t\t * @returns {Array} Array of bookmarks for each range.\n\t\t */\n\t\tcreateBookmarks: function( serializable ) {\n\t\t\tvar bookmark = this.getRanges().createBookmarks( serializable );\n\t\t\tthis.isFake && ( bookmark.isFake = 1 );\n\t\t\treturn bookmark;\n\t\t},\n\n\t\t/**\n\t\t * Creates a bookmark for each range of this selection (from {@link #getRanges})\n\t\t * by calling the {@link CKEDITOR.dom.range#createBookmark2} method,\n\t\t * with extra care taken to avoid interference among those ranges. The arguments\n\t\t * received are the same as with the underlying range method.\n\t\t *\n\t\t *\t\tvar bookmarks = editor.getSelection().createBookmarks2();\n\t\t *\n\t\t * @returns {Array} Array of bookmarks for each range.\n\t\t */\n\t\tcreateBookmarks2: function( normalized ) {\n\t\t\tvar bookmark = this.getRanges().createBookmarks2( normalized );\n\t\t\tthis.isFake && ( bookmark.isFake = 1 );\n\t\t\treturn bookmark;\n\t\t},\n\n\t\t/**\n\t\t * Selects the virtual ranges denoted by the bookmarks by calling {@link #selectRanges}.\n\t\t *\n\t\t *\t\tvar bookmarks = editor.getSelection().createBookmarks();\n\t\t *\t\teditor.getSelection().selectBookmarks( bookmarks );\n\t\t *\n\t\t * @param {Array} bookmarks The bookmarks representing ranges to be selected.\n\t\t * @returns {CKEDITOR.dom.selection} This selection object, after the ranges were selected.\n\t\t */\n\t\tselectBookmarks: function( bookmarks ) {\n\t\t\tvar ranges = [],\n\t\t\t\tnode;\n\n\t\t\tfor ( var i = 0; i < bookmarks.length; i++ ) {\n\t\t\t\tvar range = new CKEDITOR.dom.range( this.root );\n\t\t\t\trange.moveToBookmark( bookmarks[ i ] );\n\t\t\t\tranges.push( range );\n\t\t\t}\n\n\t\t\t// It may happen that the content change during loading, before selection is set so bookmark leads to text node.\n\t\t\tif ( bookmarks.isFake ) {\n\t\t\t\tnode = ranges[ 0 ].getEnclosedNode();\n\t\t\t\tif ( !node || node.type != CKEDITOR.NODE_ELEMENT ) {\n\t\t\t\t\tCKEDITOR.warn( 'selection-not-fake' );\n\t\t\t\t\tbookmarks.isFake = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( bookmarks.isFake )\n\t\t\t\tthis.fake( node );\n\t\t\telse\n\t\t\t\tthis.selectRanges( ranges );\n\n\t\t\treturn this;\n\t\t},\n\n\t\t/**\n\t\t * Retrieves the common ancestor node of the first range and the last range.\n\t\t *\n\t\t *\t\tvar ancestor = editor.getSelection().getCommonAncestor();\n\t\t *\n\t\t * @returns {CKEDITOR.dom.element} The common ancestor of the selection or `null` if selection is empty.\n\t\t */\n\t\tgetCommonAncestor: function() {\n\t\t\tvar ranges = this.getRanges();\n\t\t\tif ( !ranges.length )\n\t\t\t\treturn null;\n\n\t\t\tvar startNode = ranges[ 0 ].startContainer,\n\t\t\t\tendNode = ranges[ ranges.length - 1 ].endContainer;\n\t\t\treturn startNode.getCommonAncestor( endNode );\n\t\t},\n\n\t\t/**\n\t\t * Moves the scrollbar to the starting position of the current selection.\n\t\t *\n\t\t *\t\teditor.getSelection().scrollIntoView();\n\t\t */\n\t\tscrollIntoView: function() {\n\t\t\t// Scrolls the first range into view.\n\t\t\tif ( this.type != CKEDITOR.SELECTION_NONE )\n\t\t\t\tthis.getRanges()[ 0 ].scrollIntoView();\n\t\t},\n\n\t\t/**\n\t\t * Remove all the selection ranges from the document.\n\t\t */\n\t\tremoveAllRanges: function() {\n\t\t\t// Don't clear selection outside this selection's root (#11500).\n\t\t\tif ( this.getType() == CKEDITOR.SELECTION_NONE )\n\t\t\t\treturn;\n\n\t\t\tvar nativ = this.getNative();\n\n\t\t\ttry {\n\t\t\t\tnativ && nativ[ isMSSelection ? 'empty' : 'removeAllRanges' ]();\n\t\t\t} catch ( er ) {}\n\n\t\t\tthis.reset();\n\t\t}\n\t};\n\n} )();\n\n\n/**\n * Fired when selection inside editor has been changed. Note that this event\n * is fired only when selection's start element (container of a selecion start)\n * changes, not on every possible selection change. Thanks to that `selectionChange`\n * is fired less frequently, but on every context\n * (the {@link CKEDITOR.editor#elementPath elements path} holding selection's start) change.\n *\n * @event selectionChange\n * @member CKEDITOR.editor\n * @param {CKEDITOR.editor} editor This editor instance.\n * @param data\n * @param {CKEDITOR.dom.selection} data.selection\n * @param {CKEDITOR.dom.elementPath} data.path\n */\n\n/**\n * Selection's revision. This value is incremented every time new\n * selection is created or existing one is modified.\n *\n * @since 4.3\n * @readonly\n * @property {Number} rev\n */\n\n/**\n * Document in which selection is anchored.\n *\n * @readonly\n * @property {CKEDITOR.dom.document} document\n */\n\n/**\n * Selection's root element.\n *\n * @readonly\n * @property {CKEDITOR.dom.element} root\n */\n\n/**\n * Whether selection is locked (cannot be modified).\n *\n * See {@link #lock} and {@link #unlock} methods.\n *\n * @readonly\n * @property {Boolean} isLocked\n */\n\n/**\n * Whether selection is a fake selection.\n *\n * See {@link #fake} method.\n *\n * @readonly\n * @property {Boolean} isFake\n */\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/selection.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n'use strict';\n\n/**\n * Block style type.\n *\n * Read more in the {@link CKEDITOR.style} class documentation.\n *\n * @readonly\n * @property {Number} [=1]\n * @member CKEDITOR\n */\nCKEDITOR.STYLE_BLOCK = 1;\n\n/**\n * Inline style type.\n *\n * Read more in the {@link CKEDITOR.style} class documentation.\n *\n * @readonly\n * @property {Number} [=2]\n * @member CKEDITOR\n */\nCKEDITOR.STYLE_INLINE = 2;\n\n/**\n * Object style type.\n *\n * Read more in the {@link CKEDITOR.style} class documentation.\n *\n * @readonly\n * @property {Number} [=3]\n * @member CKEDITOR\n */\nCKEDITOR.STYLE_OBJECT = 3;\n\n( function() {\n\tvar blockElements = {\n\t\t\taddress: 1, div: 1, h1: 1, h2: 1, h3: 1, h4: 1, h5: 1, h6: 1, p: 1,\n\t\t\tpre: 1, section: 1, header: 1, footer: 1, nav: 1, article: 1, aside: 1, figure: 1,\n\t\t\tdialog: 1, hgroup: 1, time: 1, meter: 1, menu: 1, command: 1, keygen: 1, output: 1,\n\t\t\tprogress: 1, details: 1, datagrid: 1, datalist: 1\n\t\t},\n\n\t\tobjectElements = {\n\t\t\ta: 1, blockquote: 1, embed: 1, hr: 1, img: 1, li: 1, object: 1, ol: 1, table: 1, td: 1,\n\t\t\ttr: 1, th: 1, ul: 1, dl: 1, dt: 1, dd: 1, form: 1, audio: 1, video: 1\n\t\t};\n\n\tvar semicolonFixRegex = /\\s*(?:;\\s*|$)/,\n\t\tvarRegex = /#\\((.+?)\\)/g;\n\n\tvar notBookmark = CKEDITOR.dom.walker.bookmark( 0, 1 ),\n\t\tnonWhitespaces = CKEDITOR.dom.walker.whitespaces( 1 );\n\n\t/**\n\t * A class representing a style instance for the specific style definition.\n\t * In this approach, a style is a set of properties, like attributes and styles,\n\t * which can be applied to and removed from a {@link CKEDITOR.dom.selection selection} through\n\t * {@link CKEDITOR.editor editor} methods: {@link CKEDITOR.editor#applyStyle} and {@link CKEDITOR.editor#removeStyle},\n\t * respectively.\n\t *\n\t * Three default style types are available: {@link CKEDITOR#STYLE_BLOCK STYLE_BLOCK}, {@link CKEDITOR#STYLE_INLINE STYLE_INLINE},\n\t * and {@link CKEDITOR#STYLE_OBJECT STYLE_OBJECT}. Based on its type, a style heavily changes its behavior.\n\t * You can read more about style types in the [Style Types section of the Styles guide](#!/guide/dev_styles-section-style-types).\n\t *\n\t * It is possible to define a custom style type by subclassing this class by using the {@link #addCustomHandler} method.\n\t * However, because of great complexity of the styles handling job, it is only possible in very specific cases.\n\t *\n\t * ### Usage\n\t *\n\t * Basic usage:\n\t *\n\t *\t\t// Define a block style.\n\t *\t\tvar style = new CKEDITOR.style( { element: 'h1' } );\n\t *\n\t *\t\t// Considering the following selection:\n\t *\t\t// <p>Foo</p><p>Bar^</p>\n\t *\t\t// Executing:\n\t *\t\teditor.applyStyle( style );\n\t *\t\t// Will give:\n\t *\t\t// <p>Foo</p><h1>Bar^</h1>\n\t *\t\tstyle.checkActive( editor.elementPath(), editor ); // -> true\n\t *\n\t *\t\teditor.removeStyle( style );\n\t *\t\t// Will give:\n\t *\t\t// <p>Foo</p><p>Bar^</p>\n\t *\n\t *\t\tstyle.checkActive( editor.elementPath(), editor ); // -> false\n\t *\n\t * Object style:\n\t *\n\t *\t\t// Define an object style.\n\t *\t\tvar style = new CKEDITOR.style( { element: 'img', attributes: { 'class': 'foo' } } );\n\t *\n\t *\t\t// Considering the following selection:\n\t *\t\t// <p><img src=\"bar.png\" alt=\"\" />Foo^</p>\n\t *\t\t// Executing:\n\t *\t\teditor.applyStyle( style );\n\t *\t\t// Will not apply the style, because the image is not selected.\n\t *\t\t// You can check if a style can be applied on the current selection with:\n\t *\t\tstyle.checkApplicable( editor.elementPath(), editor ); // -> false\n\t *\n\t *\t\t// Considering the following selection:\n\t *\t\t// <p>[<img src=\"bar.png\" alt=\"\" />]Foo</p>\n\t *\t\t// Executing\n\t *\t\teditor.applyStyle( style );\n\t *\t\t// Will give:\n\t *\t\t// <p>[<img src=\"bar.png\" alt=\"\" class=\"foo\" />]Foo</p>\n\t *\n\t * ### API changes introduced in CKEditor 4.4\n\t *\n\t * Before CKEditor 4.4 all style instances had no access at all to the {@link CKEDITOR.editor editor instance}\n\t * within which the style is used. Neither the style constructor, nor style methods were requiring\n\t * passing the editor instance which made styles independent of the editor and hence its settings and state.\n\t * This design decision came from CKEditor 3; it started causing problems and became an unsolvable obstacle for\n\t * the {@link CKEDITOR.style.customHandlers.widget widget style handler} which we introduced in CKEditor 4.4.\n\t *\n\t * There were two possible solutions. Passing an editor instance to the style constructor or to every method.\n\t * The first approach would be clean, however, having in mind the backward compatibility, we did not decide\n\t * to go for it. It would bind the style to one editor instance, making it unusable with other editor instances.\n\t * That could break many implementations reusing styles between editors. Therefore, we decided to take the longer\n\t * but safer path &mdash; the editor instance became an argument for nearly all style methods, however,\n\t * for backward compatibility reasons, all these methods will work without it. Even the newly\n\t * implemented {@link CKEDITOR.style.customHandlers.widget widget style handler}'s methods will not fail,\n\t * although they will also not work by aborting at an early stage.\n\t *\n\t * Therefore, you can safely upgrade to CKEditor 4.4 even if you use style methods without providing\n\t * the editor instance. You must only align your code if your implementation should handle widget styles\n\t * or any other custom style handler. Of course, we recommend doing this in any case to avoid potential\n\t * problems in the future.\n\t *\n\t * @class\n\t * @constructor Creates a style class instance.\n\t * @param styleDefinition\n\t * @param variablesValues\n\t */\n\tCKEDITOR.style = function( styleDefinition, variablesValues ) {\n\t\tif ( typeof styleDefinition.type == 'string' )\n\t\t\treturn new CKEDITOR.style.customHandlers[ styleDefinition.type ]( styleDefinition );\n\n\t\t// Inline style text as attribute should be converted\n\t\t// to styles object.\n\t\tvar attrs = styleDefinition.attributes;\n\t\tif ( attrs && attrs.style ) {\n\t\t\tstyleDefinition.styles = CKEDITOR.tools.extend( {},\n\t\t\t\tstyleDefinition.styles, CKEDITOR.tools.parseCssText( attrs.style ) );\n\t\t\tdelete attrs.style;\n\t\t}\n\n\t\tif ( variablesValues ) {\n\t\t\tstyleDefinition = CKEDITOR.tools.clone( styleDefinition );\n\n\t\t\treplaceVariables( styleDefinition.attributes, variablesValues );\n\t\t\treplaceVariables( styleDefinition.styles, variablesValues );\n\t\t}\n\n\t\tvar element = this.element = styleDefinition.element ?\n\t\t\t(\n\t\t\t\ttypeof styleDefinition.element == 'string' ?\n\t\t\t\t\tstyleDefinition.element.toLowerCase() : styleDefinition.element\n\t\t\t) : '*';\n\n\t\tthis.type = styleDefinition.type ||\n\t\t\t(\n\t\t\t\tblockElements[ element ] ? CKEDITOR.STYLE_BLOCK :\n\t\t\t\tobjectElements[ element ] ? CKEDITOR.STYLE_OBJECT :\n\t\t\t\tCKEDITOR.STYLE_INLINE\n\t\t\t);\n\n\t\t// If the 'element' property is an object with a set of possible element, it will be applied like an object style: only to existing elements\n\t\tif ( typeof this.element == 'object' )\n\t\t\tthis.type = CKEDITOR.STYLE_OBJECT;\n\n\t\tthis._ = {\n\t\t\tdefinition: styleDefinition\n\t\t};\n\t};\n\n\tCKEDITOR.style.prototype = {\n\t\t/**\n\t\t * Applies the style on the editor's current selection.\n\t\t *\n\t\t * Before the style is applied, the method checks if the {@link #checkApplicable style is applicable}.\n\t\t *\n\t\t * **Note:** The recommended way of applying the style is by using the\n\t\t * {@link CKEDITOR.editor#applyStyle} method, which is a shorthand for this method.\n\t\t *\n\t\t * @param {CKEDITOR.editor/CKEDITOR.dom.document} editor The editor instance in which\n\t\t * the style will be applied.\n\t\t * A {@link CKEDITOR.dom.document} instance is accepted for backward compatibility\n\t\t * reasons, although since CKEditor 4.4 this type of argument is deprecated. Read more about\n\t\t * the signature change in the {@link CKEDITOR.style} documentation.\n\t\t */\n\t\tapply: function( editor ) {\n\t\t\t// Backward compatibility.\n\t\t\tif ( editor instanceof CKEDITOR.dom.document )\n\t\t\t\treturn applyStyleOnSelection.call( this, editor.getSelection() );\n\n\t\t\tif ( this.checkApplicable( editor.elementPath(), editor ) ) {\n\t\t\t\tvar initialEnterMode = this._.enterMode;\n\n\t\t\t\t// See comment in removeStyle.\n\t\t\t\tif ( !initialEnterMode )\n\t\t\t\t\tthis._.enterMode = editor.activeEnterMode;\n\t\t\t\tapplyStyleOnSelection.call( this, editor.getSelection(), 0, editor );\n\t\t\t\tthis._.enterMode = initialEnterMode;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Removes the style from the editor's current selection.\n\t\t *\n\t\t * Before the style is applied, the method checks if {@link #checkApplicable style could be applied}.\n\t\t *\n\t\t * **Note:** The recommended way of removing the style is by using the\n\t\t * {@link CKEDITOR.editor#removeStyle} method, which is a shorthand for this method.\n\t\t *\n\t\t * @param {CKEDITOR.editor/CKEDITOR.dom.document} editor The editor instance in which\n\t\t * the style will be removed.\n\t\t * A {@link CKEDITOR.dom.document} instance is accepted for backward compatibility\n\t\t * reasons, although since CKEditor 4.4 this type of argument is deprecated. Read more about\n\t\t * the signature change in the {@link CKEDITOR.style} documentation.\n\t\t */\n\t\tremove: function( editor ) {\n\t\t\t// Backward compatibility.\n\t\t\tif ( editor instanceof CKEDITOR.dom.document )\n\t\t\t\treturn applyStyleOnSelection.call( this, editor.getSelection(), 1 );\n\n\t\t\tif ( this.checkApplicable( editor.elementPath(), editor ) ) {\n\t\t\t\tvar initialEnterMode = this._.enterMode;\n\n\t\t\t\t// Before CKEditor 4.4 style knew nothing about editor, so in order to provide enterMode\n\t\t\t\t// which should be used developers were forced to hack the style object (see #10190).\n\t\t\t\t// Since CKEditor 4.4 style knows about editor (at least when it's being applied/removed), but we\n\t\t\t\t// use _.enterMode for backward compatibility with those hacks.\n\t\t\t\t// Note: we should not change style's enter mode if it was already set.\n\t\t\t\tif ( !initialEnterMode )\n\t\t\t\t\tthis._.enterMode = editor.activeEnterMode;\n\t\t\t\tapplyStyleOnSelection.call( this, editor.getSelection(), 1, editor );\n\t\t\t\tthis._.enterMode = initialEnterMode;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Applies the style on the provided range. Unlike {@link #apply} this\n\t\t * method does not take care of setting the selection, however, the range\n\t\t * is updated to the correct place.\n\t\t *\n\t\t * **Note:** If you want to apply the style on the editor selection,\n\t\t * you probably want to use {@link CKEDITOR.editor#applyStyle}.\n\t\t *\n\t\t * @param {CKEDITOR.dom.range} range\n\t\t * @param {CKEDITOR.editor} editor The editor instance. Required argument since\n\t\t * CKEditor 4.4. The style system will work without it, but it is highly\n\t\t * recommended to provide it for integration with all features.  Read more about\n\t\t * the signature change in the {@link CKEDITOR.style} documentation.\n\t\t */\n\t\tapplyToRange: function( range ) {\n\t\t\tthis.applyToRange =\n\t\t\t\tthis.type == CKEDITOR.STYLE_INLINE ? applyInlineStyle :\n\t\t\t\tthis.type == CKEDITOR.STYLE_BLOCK ? applyBlockStyle :\n\t\t\t\tthis.type == CKEDITOR.STYLE_OBJECT ? applyObjectStyle :\n\t\t\t\tnull;\n\n\t\t\treturn this.applyToRange( range );\n\t\t},\n\n\t\t/**\n\t\t * Removes the style from the provided range. Unlike {@link #remove} this\n\t\t * method does not take care of setting the selection, however, the range\n\t\t * is updated to the correct place.\n\t\t *\n\t\t * **Note:** If you want to remove the style from the editor selection,\n\t\t * you probably want to use {@link CKEDITOR.editor#removeStyle}.\n\t\t *\n\t\t * @param {CKEDITOR.dom.range} range\n\t\t * @param {CKEDITOR.editor} editor The editor instance. Required argument since\n\t\t * CKEditor 4.4. The style system will work without it, but it is highly\n\t\t * recommended to provide it for integration with all features. Read more about\n\t\t * the signature change in the {@link CKEDITOR.style} documentation.\n\t\t */\n\t\tremoveFromRange: function( range ) {\n\t\t\tthis.removeFromRange =\n\t\t\t\tthis.type == CKEDITOR.STYLE_INLINE ? removeInlineStyle :\n\t\t\t\tthis.type == CKEDITOR.STYLE_BLOCK ? removeBlockStyle :\n\t\t\t\tthis.type == CKEDITOR.STYLE_OBJECT ? removeObjectStyle :\n\t\t\t\tnull;\n\n\t\t\treturn this.removeFromRange( range );\n\t\t},\n\n\t\t/**\n\t\t * Applies the style to the element. This method bypasses all checks\n\t\t * and applies the style attributes directly on the provided element. Use with caution.\n\t\t *\n\t\t * See {@link CKEDITOR.editor#applyStyle}.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} element\n\t\t * @param {CKEDITOR.editor} editor The editor instance. Required argument since\n\t\t * CKEditor 4.4. The style system will work without it, but it is highly\n\t\t * recommended to provide it for integration with all features. Read more about\n\t\t * the signature change in the {@link CKEDITOR.style} documentation.\n\t\t */\n\t\tapplyToObject: function( element ) {\n\t\t\tsetupElement( element, this );\n\t\t},\n\n\t\t/**\n\t\t * Gets the style state inside the elements path.\n\t\t *\n\t\t * @param {CKEDITOR.dom.elementPath} elementPath\n\t\t * @param {CKEDITOR.editor} editor The editor instance. Required argument since\n\t\t * CKEditor 4.4. The style system will work without it, but it is highly\n\t\t * recommended to provide it for integration with all features. Read more about\n\t\t * the signature change in the {@link CKEDITOR.style} documentation.\n\t\t * @returns {Boolean} `true` if the element is active in the elements path.\n\t\t */\n\t\tcheckActive: function( elementPath, editor ) {\n\t\t\tswitch ( this.type ) {\n\t\t\t\tcase CKEDITOR.STYLE_BLOCK:\n\t\t\t\t\treturn this.checkElementRemovable( elementPath.block || elementPath.blockLimit, true, editor );\n\n\t\t\t\tcase CKEDITOR.STYLE_OBJECT:\n\t\t\t\tcase CKEDITOR.STYLE_INLINE:\n\n\t\t\t\t\tvar elements = elementPath.elements;\n\n\t\t\t\t\tfor ( var i = 0, element; i < elements.length; i++ ) {\n\t\t\t\t\t\telement = elements[ i ];\n\n\t\t\t\t\t\tif ( this.type == CKEDITOR.STYLE_INLINE && ( element == elementPath.block || element == elementPath.blockLimit ) )\n\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\tif ( this.type == CKEDITOR.STYLE_OBJECT ) {\n\t\t\t\t\t\t\tvar name = element.getName();\n\t\t\t\t\t\t\tif ( !( typeof this.element == 'string' ? name == this.element : name in this.element ) )\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( this.checkElementRemovable( element, true, editor ) )\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\n\t\t/**\n\t\t * Whether this style can be applied at the specified elements path.\n\t\t *\n\t\t * @param {CKEDITOR.dom.elementPath} elementPath The elements path to\n\t\t * check the style against.\n\t\t * @param {CKEDITOR.editor} editor The editor instance. Required argument since\n\t\t * CKEditor 4.4. The style system will work without it, but it is highly\n\t\t * recommended to provide it for integration with all features. Read more about\n\t\t * the signature change in the {@link CKEDITOR.style} documentation.\n\t\t * @param {CKEDITOR.filter} [filter] If defined, the style will be\n\t\t * checked against this filter as well.\n\t\t * @returns {Boolean} `true` if this style can be applied at the elements path.\n\t\t */\n\t\tcheckApplicable: function( elementPath, editor, filter ) {\n\t\t\t// Backward compatibility.\n\t\t\tif ( editor && editor instanceof CKEDITOR.filter )\n\t\t\t\tfilter = editor;\n\n\t\t\tif ( filter && !filter.check( this ) )\n\t\t\t\treturn false;\n\n\t\t\tswitch ( this.type ) {\n\t\t\t\tcase CKEDITOR.STYLE_OBJECT:\n\t\t\t\t\treturn !!elementPath.contains( this.element );\n\t\t\t\tcase CKEDITOR.STYLE_BLOCK:\n\t\t\t\t\treturn !!elementPath.blockLimit.getDtd()[ this.element ];\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\t/**\n\t\t * Checks if the element matches the current style definition.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} element\n\t\t * @param {Boolean} fullMatch\n\t\t * @param {CKEDITOR.editor} editor The editor instance. Required argument since\n\t\t * CKEditor 4.4. The style system will work without it, but it is highly\n\t\t * recommended to provide it for integration with all features. Read more about\n\t\t * the signature change in the {@link CKEDITOR.style} documentation.\n\t\t * @returns {Boolean}\n\t\t */\n\t\tcheckElementMatch: function( element, fullMatch ) {\n\t\t\tvar def = this._.definition;\n\n\t\t\tif ( !element || !def.ignoreReadonly && element.isReadOnly() )\n\t\t\t\treturn false;\n\n\t\t\tvar attribs,\n\t\t\t\tname = element.getName();\n\n\t\t\t// If the element name is the same as the style name.\n\t\t\tif ( typeof this.element == 'string' ? name == this.element : name in this.element ) {\n\t\t\t\t// If no attributes are defined in the element.\n\t\t\t\tif ( !fullMatch && !element.hasAttributes() )\n\t\t\t\t\treturn true;\n\n\t\t\t\tattribs = getAttributesForComparison( def );\n\n\t\t\t\tif ( attribs._length ) {\n\t\t\t\t\tfor ( var attName in attribs ) {\n\t\t\t\t\t\tif ( attName == '_length' )\n\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\tvar elementAttr = element.getAttribute( attName ) || '';\n\n\t\t\t\t\t\t// Special treatment for 'style' attribute is required.\n\t\t\t\t\t\tif ( attName == 'style' ? compareCssText( attribs[ attName ], elementAttr ) : attribs[ attName ] == elementAttr ) {\n\t\t\t\t\t\t\tif ( !fullMatch )\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t} else if ( fullMatch ) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif ( fullMatch )\n\t\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\n\t\t/**\n\t\t * Checks if an element, or any of its attributes, is removable by the\n\t\t * current style definition.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} element\n\t\t * @param {Boolean} fullMatch\n\t\t * @param {CKEDITOR.editor} editor The editor instance. Required argument since\n\t\t * CKEditor 4.4. The style system will work without it, but it is highly\n\t\t * recommended to provide it for integration with all features. Read more about\n\t\t * the signature change in the {@link CKEDITOR.style} documentation.\n\t\t * @returns {Boolean}\n\t\t */\n\t\tcheckElementRemovable: function( element, fullMatch, editor ) {\n\t\t\t// Check element matches the style itself.\n\t\t\tif ( this.checkElementMatch( element, fullMatch, editor ) )\n\t\t\t\treturn true;\n\n\t\t\t// Check if the element matches the style overrides.\n\t\t\tvar override = getOverrides( this )[ element.getName() ];\n\t\t\tif ( override ) {\n\t\t\t\tvar attribs, attName;\n\n\t\t\t\t// If no attributes have been defined, remove the element.\n\t\t\t\tif ( !( attribs = override.attributes ) )\n\t\t\t\t\treturn true;\n\n\t\t\t\tfor ( var i = 0; i < attribs.length; i++ ) {\n\t\t\t\t\tattName = attribs[ i ][ 0 ];\n\t\t\t\t\tvar actualAttrValue = element.getAttribute( attName );\n\t\t\t\t\tif ( actualAttrValue ) {\n\t\t\t\t\t\tvar attValue = attribs[ i ][ 1 ];\n\n\t\t\t\t\t\t// Remove the attribute if:\n\t\t\t\t\t\t//    - The override definition value is null;\n\t\t\t\t\t\t//    - The override definition value is a string that\n\t\t\t\t\t\t//      matches the attribute value exactly.\n\t\t\t\t\t\t//    - The override definition value is a regex that\n\t\t\t\t\t\t//      has matches in the attribute value.\n\t\t\t\t\t\tif ( attValue === null )\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\tif ( typeof attValue == 'string' ) {\n\t\t\t\t\t\t\tif ( actualAttrValue == attValue )\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t} else if ( attValue.test( actualAttrValue ) ) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\n\t\t/**\n\t\t * Builds the preview HTML based on the styles definition.\n\t\t *\n\t\t * @param {String} [label] The label used in the style preview.\n\t\t * @return {String} The HTML of preview.\n\t\t */\n\t\tbuildPreview: function( label ) {\n\t\t\tvar styleDefinition = this._.definition,\n\t\t\t\thtml = [],\n\t\t\t\telementName = styleDefinition.element;\n\n\t\t\t// Avoid <bdo> in the preview.\n\t\t\tif ( elementName == 'bdo' )\n\t\t\t\telementName = 'span';\n\n\t\t\thtml = [ '<', elementName ];\n\n\t\t\t// Assign all defined attributes.\n\t\t\tvar attribs = styleDefinition.attributes;\n\t\t\tif ( attribs ) {\n\t\t\t\tfor ( var att in attribs )\n\t\t\t\t\thtml.push( ' ', att, '=\"', attribs[ att ], '\"' );\n\t\t\t}\n\n\t\t\t// Assign the style attribute.\n\t\t\tvar cssStyle = CKEDITOR.style.getStyleText( styleDefinition );\n\t\t\tif ( cssStyle )\n\t\t\t\thtml.push( ' style=\"', cssStyle, '\"' );\n\n\t\t\thtml.push( '>', ( label || styleDefinition.name ), '</', elementName, '>' );\n\n\t\t\treturn html.join( '' );\n\t\t},\n\n\t\t/**\n\t\t * Returns the style definition.\n\t\t *\n\t\t * @since 4.1\n\t\t * @returns {Object}\n\t\t */\n\t\tgetDefinition: function() {\n\t\t\treturn this._.definition;\n\t\t}\n\n\t\t/**\n\t\t * If defined (for example by {@link CKEDITOR.style#addCustomHandler custom style handler}), it returns\n\t\t * the {@link CKEDITOR.filter.allowedContentRules allowed content rules} which should be added to the\n\t\t * {@link CKEDITOR.filter} when enabling this style.\n\t\t *\n\t\t * **Note:** This method is not defined in the {@link CKEDITOR.style} class.\n\t\t *\n\t\t * @since 4.4\n\t\t * @method toAllowedContentRules\n\t\t * @param {CKEDITOR.editor} [editor] The editor instance.\n\t\t * @returns {CKEDITOR.filter.allowedContentRules} The rules that should represent this style in the {@link CKEDITOR.filter}.\n\t\t */\n\t};\n\n\t/**\n\t * Builds the inline style text based on the style definition.\n\t *\n\t * @static\n\t * @param styleDefinition\n\t * @returns {String} Inline style text.\n\t */\n\tCKEDITOR.style.getStyleText = function( styleDefinition ) {\n\t\t// If we have already computed it, just return it.\n\t\tvar stylesDef = styleDefinition._ST;\n\t\tif ( stylesDef )\n\t\t\treturn stylesDef;\n\n\t\tstylesDef = styleDefinition.styles;\n\n\t\t// Builds the StyleText.\n\t\tvar stylesText = ( styleDefinition.attributes && styleDefinition.attributes.style ) || '',\n\t\t\tspecialStylesText = '';\n\n\t\tif ( stylesText.length )\n\t\t\tstylesText = stylesText.replace( semicolonFixRegex, ';' );\n\n\t\tfor ( var style in stylesDef ) {\n\t\t\tvar styleVal = stylesDef[ style ],\n\t\t\t\ttext = ( style + ':' + styleVal ).replace( semicolonFixRegex, ';' );\n\n\t\t\t// Some browsers don't support 'inherit' property value, leave them intact. (#5242)\n\t\t\tif ( styleVal == 'inherit' )\n\t\t\t\tspecialStylesText += text;\n\t\t\telse\n\t\t\t\tstylesText += text;\n\t\t}\n\n\t\t// Browsers make some changes to the style when applying them. So, here\n\t\t// we normalize it to the browser format.\n\t\tif ( stylesText.length )\n\t\t\tstylesText = CKEDITOR.tools.normalizeCssText( stylesText, true );\n\n\t\tstylesText += specialStylesText;\n\n\t\t// Return it, saving it to the next request.\n\t\treturn ( styleDefinition._ST = stylesText );\n\t};\n\n\t/**\n\t * Namespace containing custom style handlers added with {@link CKEDITOR.style#addCustomHandler}.\n\t *\n\t * @since 4.4\n\t * @class\n\t * @singleton\n\t */\n\tCKEDITOR.style.customHandlers = {};\n\n\t/**\n\t * Creates a {@link CKEDITOR.style} subclass and registers it in the style system.\n\t * Registered class will be used as a handler for a style of this type. This allows\n\t * to extend the styles system, which by default uses only the {@link CKEDITOR.style}, with\n\t * new functionality. Registered classes are accessible in the {@link CKEDITOR.style.customHandlers}.\n\t *\n\t * ### The Style Class Definition\n\t *\n\t * The definition object is used to override properties in a prototype inherited\n\t * from the {@link CKEDITOR.style} class. It must contain a `type` property which is\n\t * a name of the new type and therefore it must be unique. The default style types\n\t * ({@link CKEDITOR#STYLE_BLOCK STYLE_BLOCK}, {@link CKEDITOR#STYLE_INLINE STYLE_INLINE},\n\t * and {@link CKEDITOR#STYLE_OBJECT STYLE_OBJECT}) are integers, but for easier identification\n\t * it is recommended to use strings as custom type names.\n\t *\n\t * Besides `type`, the definition may contain two more special properties:\n\t *\n\t *  * `setup {Function}` &ndash; An optional callback executed when a style instance is created.\n\t * Like the style constructor, it is executed in style context and with the style definition as an argument.\n\t *  * `assignedTo {Number}` &ndash; Can be set to one of the default style types. Some editor\n\t * features like the Styles drop-down assign styles to one of the default groups based on\n\t * the style type. By using this property it is possible to notify them to which group this\n\t * custom style should be assigned. It defaults to the {@link CKEDITOR#STYLE_OBJECT}.\n\t *\n\t * Other properties of the definition object will just be used to extend the prototype inherited\n\t * from the {@link CKEDITOR.style} class. So if the definition contains an `apply` method, it will\n\t * override the {@link CKEDITOR.style#apply} method.\n\t *\n\t * ### Usage\n\t *\n\t * Registering a basic handler:\n\t *\n\t *\t\tvar styleClass = CKEDITOR.style.addCustomHandler( {\n\t *\t\t\ttype: 'custom'\n\t *\t\t} );\n\t *\n\t *\t\tvar style = new styleClass( { ... } );\n\t *\t\tstyle instanceof styleClass; // -> true\n\t *\t\tstyle instanceof CKEDITOR.style; // -> true\n\t *\t\tstyle.type; // -> 'custom'\n\t *\n\t * The {@link CKEDITOR.style} constructor used as a factory:\n\t *\n\t *\t\tvar styleClass = CKEDITOR.style.addCustomHandler( {\n\t *\t\t\ttype: 'custom'\n\t *\t\t} );\n\t *\n\t *\t\t// Style constructor accepts style definition (do not confuse with style class definition).\n\t *\t\tvar style = new CKEDITOR.style( { type: 'custom', attributes: ... } );\n\t *\t\tstyle instanceof styleClass; // -> true\n\t *\n\t * Thanks to that, integration code using styles does not need to know\n\t * which style handler it should use. It is determined by the {@link CKEDITOR.style} constructor.\n\t *\n\t * Overriding existing {@link CKEDITOR.style} methods:\n\t *\n\t *\t\tvar styleClass = CKEDITOR.style.addCustomHandler( {\n\t *\t\t\ttype: 'custom',\n\t *\t\t\tapply: function( editor ) {\n\t *\t\t\t\tconsole.log( 'apply' );\n\t *\t\t\t},\n\t *\t\t\tremove: function( editor ) {\n\t *\t\t\t\tconsole.log( 'remove' );\n\t *\t\t\t}\n\t *\t\t} );\n\t *\n\t *\t\tvar style = new CKEDITOR.style( { type: 'custom', attributes: ... } );\n\t *\t\teditor.applyStyle( style ); // logged 'apply'\n\t *\n\t *\t\tstyle = new CKEDITOR.style( { element: 'img', attributes: { 'class': 'foo' } } );\n\t *\t\teditor.applyStyle( style ); // style is really applied if image was selected\n\t *\n\t * ### Practical Recommendations\n\t *\n\t * The style handling job, which includes such tasks as applying, removing, checking state, and\n\t * checking if a style can be applied, is very complex. Therefore without deep knowledge\n\t * about DOM and especially {@link CKEDITOR.dom.range ranges} and {@link CKEDITOR.dom.walker DOM walker} it is impossible\n\t * to implement a completely custom style handler able to handle block, inline, and object type styles.\n\t * However, it is possible to customize the default implementation by overriding default methods and\n\t * reusing them.\n\t *\n\t * The only style handler which can be implemented from scratch without huge effort is a style\n\t * applicable to objects ([read more about types](http://docs.ckeditor.com/#!/guide/dev_styles-section-style-types)).\n\t * Such style can only be applied when a specific object is selected. An example implementation can\n\t * be found in the [widget plugin](https://github.com/ckeditor/ckeditor-dev/blob/master/plugins/widget/plugin.js).\n\t *\n\t * When implementing a style handler from scratch at least the following methods must be defined:\n\t *\n\t * * {@link CKEDITOR.style#apply apply} and {@link CKEDITOR.style#remove remove},\n\t * * {@link CKEDITOR.style#checkElementRemovable checkElementRemovable} and\n\t * {@link CKEDITOR.style#checkElementMatch checkElementMatch} &ndash; Note that both methods reuse the same logic,\n\t * * {@link CKEDITOR.style#checkActive checkActive} &ndash; Reuses\n\t * {@link CKEDITOR.style#checkElementMatch checkElementMatch},\n\t * * {@link CKEDITOR.style#toAllowedContentRules toAllowedContentRules} &ndash; Not required, but very useful in\n\t * case of a custom style that has to notify the {@link CKEDITOR.filter} which rules it allows when registered.\n\t *\n\t * @since 4.4\n\t * @static\n\t * @member CKEDITOR.style\n\t * @param definition The style class definition.\n\t * @returns {CKEDITOR.style} The new style class created for the provided definition.\n\t */\n\tCKEDITOR.style.addCustomHandler = function( definition ) {\n\t\tvar styleClass = function( styleDefinition ) {\n\t\t\tthis._ = {\n\t\t\t\tdefinition: styleDefinition\n\t\t\t};\n\n\t\t\tif ( this.setup )\n\t\t\t\tthis.setup( styleDefinition );\n\t\t};\n\n\t\tstyleClass.prototype = CKEDITOR.tools.extend(\n\t\t\t// Prototype of CKEDITOR.style.\n\t\t\tCKEDITOR.tools.prototypedCopy( CKEDITOR.style.prototype ),\n\t\t\t// Defaults.\n\t\t\t{\n\t\t\t\tassignedTo: CKEDITOR.STYLE_OBJECT\n\t\t\t},\n\t\t\t// Passed definition - overrides.\n\t\t\tdefinition,\n\t\t\ttrue\n\t\t);\n\n\t\tthis.customHandlers[ definition.type ] = styleClass;\n\n\t\treturn styleClass;\n\t};\n\n\t// Gets the parent element which blocks the styling for an element. This\n\t// can be done through read-only elements (contenteditable=false) or\n\t// elements with the \"data-nostyle\" attribute.\n\tfunction getUnstylableParent( element, root ) {\n\t\tvar unstylable, editable;\n\n\t\twhile ( ( element = element.getParent() ) ) {\n\t\t\tif ( element.equals( root ) )\n\t\t\t\tbreak;\n\n\t\t\tif ( element.getAttribute( 'data-nostyle' ) )\n\t\t\t\tunstylable = element;\n\t\t\telse if ( !editable ) {\n\t\t\t\tvar contentEditable = element.getAttribute( 'contentEditable' );\n\n\t\t\t\tif ( contentEditable == 'false' )\n\t\t\t\t\tunstylable = element;\n\t\t\t\telse if ( contentEditable == 'true' )\n\t\t\t\t\teditable = 1;\n\t\t\t}\n\t\t}\n\n\t\treturn unstylable;\n\t}\n\n\tvar posPrecedingIdenticalContained =\n\t\t\tCKEDITOR.POSITION_PRECEDING | CKEDITOR.POSITION_IDENTICAL | CKEDITOR.POSITION_IS_CONTAINED,\n\t\tposFollowingIdenticalContained =\n\t\t\tCKEDITOR.POSITION_FOLLOWING | CKEDITOR.POSITION_IDENTICAL | CKEDITOR.POSITION_IS_CONTAINED;\n\n\t// Checks if the current node can be a child of the style element.\n\tfunction checkIfNodeCanBeChildOfStyle( def, currentNode, lastNode, nodeName, dtd, nodeIsNoStyle, nodeIsReadonly, includeReadonly ) {\n\t\t// Style can be applied to text node.\n\t\tif ( !nodeName )\n\t\t\treturn 1;\n\n\t\t// Style definitely cannot be applied if DTD or data-nostyle do not allow.\n\t\tif ( !dtd[ nodeName ] || nodeIsNoStyle  )\n\t\t\treturn 0;\n\n\t\t// Non-editable element cannot be styled is we shouldn't include readonly elements.\n\t\tif ( nodeIsReadonly && !includeReadonly  )\n\t\t\treturn 0;\n\n\t\t// Check that we haven't passed lastNode yet and that style's childRule allows this style on current element.\n\t\treturn checkPositionAndRule( currentNode, lastNode, def, posPrecedingIdenticalContained );\n\t}\n\n\t// Check if the style element can be a child of the current\n\t// node parent or if the element is not defined in the DTD.\n\tfunction checkIfStyleCanBeChildOf( def, currentParent, elementName, isUnknownElement ) {\n\t\treturn currentParent &&\n\t\t\t( ( currentParent.getDtd() || CKEDITOR.dtd.span )[ elementName ] || isUnknownElement ) &&\n\t\t\t( !def.parentRule || def.parentRule( currentParent ) );\n\t}\n\n\tfunction checkIfStartsRange( nodeName, currentNode, lastNode ) {\n\t\treturn (\n\t\t\t!nodeName || !CKEDITOR.dtd.$removeEmpty[ nodeName ] ||\n\t\t\t( currentNode.getPosition( lastNode ) | posPrecedingIdenticalContained ) == posPrecedingIdenticalContained\n\t\t);\n\t}\n\n\tfunction checkIfTextOrReadonlyOrEmptyElement( currentNode, nodeIsReadonly ) {\n\t\tvar nodeType = currentNode.type;\n\t\treturn nodeType == CKEDITOR.NODE_TEXT || nodeIsReadonly || ( nodeType == CKEDITOR.NODE_ELEMENT && !currentNode.getChildCount() );\n\t}\n\n\t// Checks if position is a subset of posBitFlags and that nodeA fulfills style def rule.\n\tfunction checkPositionAndRule( nodeA, nodeB, def, posBitFlags ) {\n\t\treturn ( nodeA.getPosition( nodeB ) | posBitFlags ) == posBitFlags &&\n\t\t\t( !def.childRule || def.childRule( nodeA ) );\n\t}\n\n\tfunction applyInlineStyle( range ) {\n\t\tvar document = range.document;\n\n\t\tif ( range.collapsed ) {\n\t\t\t// Create the element to be inserted in the DOM.\n\t\t\tvar collapsedElement = getElement( this, document );\n\n\t\t\t// Insert the empty element into the DOM at the range position.\n\t\t\trange.insertNode( collapsedElement );\n\n\t\t\t// Place the selection right inside the empty element.\n\t\t\trange.moveToPosition( collapsedElement, CKEDITOR.POSITION_BEFORE_END );\n\n\t\t\treturn;\n\t\t}\n\n\t\tvar elementName = this.element,\n\t\t\tdef = this._.definition,\n\t\t\tisUnknownElement;\n\n\t\t// Indicates that fully selected read-only elements are to be included in the styling range.\n\t\tvar ignoreReadonly = def.ignoreReadonly,\n\t\t\tincludeReadonly = ignoreReadonly || def.includeReadonly;\n\n\t\t// If the read-only inclusion is not available in the definition, try\n\t\t// to get it from the root data (most often it's the editable).\n\t\tif ( includeReadonly == null )\n\t\t\tincludeReadonly = range.root.getCustomData( 'cke_includeReadonly' );\n\n\t\t// Get the DTD definition for the element. Defaults to \"span\".\n\t\tvar dtd = CKEDITOR.dtd[ elementName ];\n\t\tif ( !dtd ) {\n\t\t\tisUnknownElement = true;\n\t\t\tdtd = CKEDITOR.dtd.span;\n\t\t}\n\n\t\t// Expand the range.\n\t\trange.enlarge( CKEDITOR.ENLARGE_INLINE, 1 );\n\t\trange.trim();\n\n\t\t// Get the first node to be processed and the last, which concludes the processing.\n\t\tvar boundaryNodes = range.createBookmark(),\n\t\t\tfirstNode = boundaryNodes.startNode,\n\t\t\tlastNode = boundaryNodes.endNode,\n\t\t\tcurrentNode = firstNode,\n\t\t\tstyleRange;\n\n\t\tif ( !ignoreReadonly ) {\n\t\t\t// Check if the boundaries are inside non stylable elements.\n\t\t\tvar root = range.getCommonAncestor(),\n\t\t\t\tfirstUnstylable = getUnstylableParent( firstNode, root ),\n\t\t\t\tlastUnstylable = getUnstylableParent( lastNode, root );\n\n\t\t\t// If the first element can't be styled, we'll start processing right\n\t\t\t// after its unstylable root.\n\t\t\tif ( firstUnstylable )\n\t\t\t\tcurrentNode = firstUnstylable.getNextSourceNode( true );\n\n\t\t\t// If the last element can't be styled, we'll stop processing on its\n\t\t\t// unstylable root.\n\t\t\tif ( lastUnstylable )\n\t\t\t\tlastNode = lastUnstylable;\n\t\t}\n\n\t\t// Do nothing if the current node now follows the last node to be processed.\n\t\tif ( currentNode.getPosition( lastNode ) == CKEDITOR.POSITION_FOLLOWING )\n\t\t\tcurrentNode = 0;\n\n\t\twhile ( currentNode ) {\n\t\t\tvar applyStyle = false;\n\n\t\t\tif ( currentNode.equals( lastNode ) ) {\n\t\t\t\tcurrentNode = null;\n\t\t\t\tapplyStyle = true;\n\t\t\t} else {\n\t\t\t\tvar nodeName = currentNode.type == CKEDITOR.NODE_ELEMENT ? currentNode.getName() : null,\n\t\t\t\t\tnodeIsReadonly = nodeName && ( currentNode.getAttribute( 'contentEditable' ) == 'false' ),\n\t\t\t\t\tnodeIsNoStyle = nodeName && currentNode.getAttribute( 'data-nostyle' );\n\n\t\t\t\t// Skip bookmarks.\n\t\t\t\tif ( nodeName && currentNode.data( 'cke-bookmark' ) ) {\n\t\t\t\t\tcurrentNode = currentNode.getNextSourceNode( true );\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Find all nested editables of a non-editable block and apply this style inside them.\n\t\t\t\tif ( nodeIsReadonly && includeReadonly && CKEDITOR.dtd.$block[ nodeName ] )\n\t\t\t\t\tapplyStyleOnNestedEditables.call( this, currentNode );\n\n\t\t\t\t// Check if the current node can be a child of the style element.\n\t\t\t\tif ( checkIfNodeCanBeChildOfStyle( def, currentNode, lastNode, nodeName, dtd, nodeIsNoStyle, nodeIsReadonly, includeReadonly ) ) {\n\t\t\t\t\tvar currentParent = currentNode.getParent();\n\n\t\t\t\t\t// Check if the style element can be a child of the current\n\t\t\t\t\t// node parent or if the element is not defined in the DTD.\n\t\t\t\t\tif ( checkIfStyleCanBeChildOf( def, currentParent, elementName, isUnknownElement ) ) {\n\t\t\t\t\t\t// This node will be part of our range, so if it has not\n\t\t\t\t\t\t// been started, place its start right before the node.\n\t\t\t\t\t\t// In the case of an element node, it will be included\n\t\t\t\t\t\t// only if it is entirely inside the range.\n\t\t\t\t\t\tif ( !styleRange && checkIfStartsRange( nodeName, currentNode, lastNode ) ) {\n\t\t\t\t\t\t\tstyleRange = range.clone();\n\t\t\t\t\t\t\tstyleRange.setStartBefore( currentNode );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Non element nodes, readonly elements, or empty\n\t\t\t\t\t\t// elements can be added completely to the range.\n\t\t\t\t\t\tif ( checkIfTextOrReadonlyOrEmptyElement( currentNode, nodeIsReadonly ) ) {\n\t\t\t\t\t\t\tvar includedNode = currentNode;\n\t\t\t\t\t\t\tvar parentNode;\n\n\t\t\t\t\t\t\t// This node is about to be included completelly, but,\n\t\t\t\t\t\t\t// if this is the last node in its parent, we must also\n\t\t\t\t\t\t\t// check if the parent itself can be added completelly\n\t\t\t\t\t\t\t// to the range, otherwise apply the style immediately.\n\t\t\t\t\t\t\twhile (\n\t\t\t\t\t\t\t\t( applyStyle = !includedNode.getNext( notBookmark ) ) &&\n\t\t\t\t\t\t\t\t( parentNode = includedNode.getParent(), dtd[ parentNode.getName() ] ) &&\n\t\t\t\t\t\t\t\tcheckPositionAndRule( parentNode, firstNode, def, posFollowingIdenticalContained )\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tincludedNode = parentNode;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tstyleRange.setEndAfter( includedNode );\n\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tapplyStyle = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Style isn't applicable to current element, so apply style to\n\t\t\t\t// range ending at previously chosen position, or nowhere if we haven't\n\t\t\t\t// yet started styleRange.\n\t\t\t\telse {\n\t\t\t\t\tapplyStyle = true;\n\t\t\t\t}\n\n\t\t\t\t// Get the next node to be processed.\n\t\t\t\t// If we're currently on a non-editable element or non-styleable element,\n\t\t\t\t// then we'll be moved to current node's sibling (or even further), so we'll\n\t\t\t\t// avoid messing up its content.\n\t\t\t\tcurrentNode = currentNode.getNextSourceNode( nodeIsNoStyle || nodeIsReadonly );\n\t\t\t}\n\n\t\t\t// Apply the style if we have something to which apply it.\n\t\t\tif ( applyStyle && styleRange && !styleRange.collapsed ) {\n\t\t\t\t// Build the style element, based on the style object definition.\n\t\t\t\tvar styleNode = getElement( this, document ),\n\t\t\t\t\tstyleHasAttrs = styleNode.hasAttributes();\n\n\t\t\t\t// Get the element that holds the entire range.\n\t\t\t\tvar parent = styleRange.getCommonAncestor();\n\n\t\t\t\tvar removeList = {\n\t\t\t\t\tstyles: {},\n\t\t\t\t\tattrs: {},\n\t\t\t\t\t// Styles cannot be removed.\n\t\t\t\t\tblockedStyles: {},\n\t\t\t\t\t// Attrs cannot be removed.\n\t\t\t\t\tblockedAttrs: {}\n\t\t\t\t};\n\n\t\t\t\tvar attName, styleName, value;\n\n\t\t\t\t// Loop through the parents, removing the redundant attributes\n\t\t\t\t// from the element to be applied.\n\t\t\t\twhile ( styleNode && parent ) {\n\t\t\t\t\tif ( parent.getName() == elementName ) {\n\t\t\t\t\t\tfor ( attName in def.attributes ) {\n\t\t\t\t\t\t\tif ( removeList.blockedAttrs[ attName ] || !( value = parent.getAttribute( styleName ) ) )\n\t\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\t\tif ( styleNode.getAttribute( attName ) == value )\n\t\t\t\t\t\t\t\tremoveList.attrs[ attName ] = 1;\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tremoveList.blockedAttrs[ attName ] = 1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfor ( styleName in def.styles ) {\n\t\t\t\t\t\t\tif ( removeList.blockedStyles[ styleName ] || !( value = parent.getStyle( styleName ) ) )\n\t\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\t\tif ( styleNode.getStyle( styleName ) == value )\n\t\t\t\t\t\t\t\tremoveList.styles[ styleName ] = 1;\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tremoveList.blockedStyles[ styleName ] = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tparent = parent.getParent();\n\t\t\t\t}\n\n\t\t\t\tfor ( attName in removeList.attrs )\n\t\t\t\t\tstyleNode.removeAttribute( attName );\n\n\t\t\t\tfor ( styleName in removeList.styles )\n\t\t\t\t\tstyleNode.removeStyle( styleName );\n\n\t\t\t\tif ( styleHasAttrs && !styleNode.hasAttributes() )\n\t\t\t\t\tstyleNode = null;\n\n\t\t\t\tif ( styleNode ) {\n\t\t\t\t\t// Move the contents of the range to the style element.\n\t\t\t\t\tstyleRange.extractContents().appendTo( styleNode );\n\n\t\t\t\t\t// Insert it into the range position (it is collapsed after\n\t\t\t\t\t// extractContents.\n\t\t\t\t\tstyleRange.insertNode( styleNode );\n\n\t\t\t\t\t// Here we do some cleanup, removing all duplicated\n\t\t\t\t\t// elements from the style element.\n\t\t\t\t\tremoveFromInsideElement.call( this, styleNode );\n\n\t\t\t\t\t// Let's merge our new style with its neighbors, if possible.\n\t\t\t\t\tstyleNode.mergeSiblings();\n\n\t\t\t\t\t// As the style system breaks text nodes constantly, let's normalize\n\t\t\t\t\t// things for performance.\n\t\t\t\t\t// With IE, some paragraphs get broken when calling normalize()\n\t\t\t\t\t// repeatedly. Also, for IE, we must normalize body, not documentElement.\n\t\t\t\t\t// IE is also known for having a \"crash effect\" with normalize().\n\t\t\t\t\t// We should try to normalize with IE too in some way, somewhere.\n\t\t\t\t\tif ( !CKEDITOR.env.ie )\n\t\t\t\t\t\tstyleNode.$.normalize();\n\t\t\t\t}\n\t\t\t\t// Style already inherit from parents, left just to clear up any internal overrides. (#5931)\n\t\t\t\telse {\n\t\t\t\t\tstyleNode = new CKEDITOR.dom.element( 'span' );\n\t\t\t\t\tstyleRange.extractContents().appendTo( styleNode );\n\t\t\t\t\tstyleRange.insertNode( styleNode );\n\t\t\t\t\tremoveFromInsideElement.call( this, styleNode );\n\t\t\t\t\tstyleNode.remove( true );\n\t\t\t\t}\n\n\t\t\t\t// Style applied, let's release the range, so it gets\n\t\t\t\t// re-initialization in the next loop.\n\t\t\t\tstyleRange = null;\n\t\t\t}\n\t\t}\n\n\t\t// Remove the bookmark nodes.\n\t\trange.moveToBookmark( boundaryNodes );\n\n\t\t// Minimize the result range to exclude empty text nodes. (#5374)\n\t\trange.shrink( CKEDITOR.SHRINK_TEXT );\n\n\t\t// Get inside the remaining element if range.shrink( TEXT ) has failed because of non-editable elements inside.\n\t\t// E.g. range.shrink( TEXT ) will not get inside:\n\t\t// [<b><i contenteditable=\"false\">x</i></b>]\n\t\t// but range.shrink( ELEMENT ) will.\n\t\trange.shrink( CKEDITOR.NODE_ELEMENT, true );\n\t}\n\n\tfunction removeInlineStyle( range ) {\n\t\t// Make sure our range has included all \"collpased\" parent inline nodes so\n\t\t// that our operation logic can be simpler.\n\t\trange.enlarge( CKEDITOR.ENLARGE_INLINE, 1 );\n\n\t\tvar bookmark = range.createBookmark(),\n\t\t\tstartNode = bookmark.startNode;\n\n\t\tif ( range.collapsed ) {\n\t\t\tvar startPath = new CKEDITOR.dom.elementPath( startNode.getParent(), range.root ),\n\t\t\t\t// The topmost element in elementspatch which we should jump out of.\n\t\t\t\tboundaryElement;\n\n\n\t\t\tfor ( var i = 0, element; i < startPath.elements.length && ( element = startPath.elements[ i ] ); i++ ) {\n\t\t\t\t// 1. If it's collaped inside text nodes, try to remove the style from the whole element.\n\t\t\t\t//\n\t\t\t\t// 2. Otherwise if it's collapsed on element boundaries, moving the selection\n\t\t\t\t//  outside the styles instead of removing the whole tag,\n\t\t\t\t//  also make sure other inner styles were well preserverd.(#3309)\n\t\t\t\tif ( element == startPath.block || element == startPath.blockLimit )\n\t\t\t\t\tbreak;\n\n\t\t\t\tif ( this.checkElementRemovable( element ) ) {\n\t\t\t\t\tvar isStart;\n\n\t\t\t\t\tif ( range.collapsed && ( range.checkBoundaryOfElement( element, CKEDITOR.END ) || ( isStart = range.checkBoundaryOfElement( element, CKEDITOR.START ) ) ) ) {\n\t\t\t\t\t\tboundaryElement = element;\n\t\t\t\t\t\tboundaryElement.match = isStart ? 'start' : 'end';\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Before removing the style node, there may be a sibling to the style node\n\t\t\t\t\t\t// that's exactly the same to the one to be removed. To the user, it makes\n\t\t\t\t\t\t// no difference that they're separate entities in the DOM tree. So, merge\n\t\t\t\t\t\t// them before removal.\n\t\t\t\t\t\telement.mergeSiblings();\n\t\t\t\t\t\tif ( element.is( this.element ) )\n\t\t\t\t\t\t\tremoveFromElement.call( this, element );\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tremoveOverrides( element, getOverrides( this )[ element.getName() ] );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Re-create the style tree after/before the boundary element,\n\t\t\t// the replication start from bookmark start node to define the\n\t\t\t// new range.\n\t\t\tif ( boundaryElement ) {\n\t\t\t\tvar clonedElement = startNode;\n\t\t\t\tfor ( i = 0; ; i++ ) {\n\t\t\t\t\tvar newElement = startPath.elements[ i ];\n\t\t\t\t\tif ( newElement.equals( boundaryElement ) )\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t// Avoid copying any matched element.\n\t\t\t\t\telse if ( newElement.match )\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\telse\n\t\t\t\t\t\tnewElement = newElement.clone();\n\t\t\t\t\tnewElement.append( clonedElement );\n\t\t\t\t\tclonedElement = newElement;\n\t\t\t\t}\n\t\t\t\tclonedElement[ boundaryElement.match == 'start' ? 'insertBefore' : 'insertAfter' ]( boundaryElement );\n\t\t\t}\n\t\t} else {\n\t\t\t// Now our range isn't collapsed. Lets walk from the start node to the end\n\t\t\t// node via DFS and remove the styles one-by-one.\n\t\t\tvar endNode = bookmark.endNode,\n\t\t\t\tme = this;\n\n\t\t\tbreakNodes();\n\n\t\t\t// Now, do the DFS walk.\n\t\t\tvar currentNode = startNode;\n\t\t\twhile ( !currentNode.equals( endNode ) ) {\n\t\t\t\t// Need to get the next node first because removeFromElement() can remove\n\t\t\t\t// the current node from DOM tree.\n\t\t\t\tvar nextNode = currentNode.getNextSourceNode();\n\t\t\t\tif ( currentNode.type == CKEDITOR.NODE_ELEMENT && this.checkElementRemovable( currentNode ) ) {\n\t\t\t\t\t// Remove style from element or overriding element.\n\t\t\t\t\tif ( currentNode.getName() == this.element )\n\t\t\t\t\t\tremoveFromElement.call( this, currentNode );\n\t\t\t\t\telse\n\t\t\t\t\t\tremoveOverrides( currentNode, getOverrides( this )[ currentNode.getName() ] );\n\n\t\t\t\t\t// removeFromElement() may have merged the next node with something before\n\t\t\t\t\t// the startNode via mergeSiblings(). In that case, the nextNode would\n\t\t\t\t\t// contain startNode and we'll have to call breakNodes() again and also\n\t\t\t\t\t// reassign the nextNode to something after startNode.\n\t\t\t\t\tif ( nextNode.type == CKEDITOR.NODE_ELEMENT && nextNode.contains( startNode ) ) {\n\t\t\t\t\t\tbreakNodes();\n\t\t\t\t\t\tnextNode = startNode.getNext();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcurrentNode = nextNode;\n\t\t\t}\n\t\t}\n\n\t\trange.moveToBookmark( bookmark );\n\t\t// See the comment for range.shrink in applyInlineStyle.\n\t\trange.shrink( CKEDITOR.NODE_ELEMENT, true );\n\n\t\t// Find out the style ancestor that needs to be broken down at startNode\n\t\t// and endNode.\n\t\tfunction breakNodes() {\n\t\t\tvar startPath = new CKEDITOR.dom.elementPath( startNode.getParent() ),\n\t\t\t\tendPath = new CKEDITOR.dom.elementPath( endNode.getParent() ),\n\t\t\t\tbreakStart = null,\n\t\t\t\tbreakEnd = null;\n\n\t\t\tfor ( var i = 0; i < startPath.elements.length; i++ ) {\n\t\t\t\tvar element = startPath.elements[ i ];\n\n\t\t\t\tif ( element == startPath.block || element == startPath.blockLimit )\n\t\t\t\t\tbreak;\n\n\t\t\t\tif ( me.checkElementRemovable( element, true ) )\n\t\t\t\t\tbreakStart = element;\n\t\t\t}\n\n\t\t\tfor ( i = 0; i < endPath.elements.length; i++ ) {\n\t\t\t\telement = endPath.elements[ i ];\n\n\t\t\t\tif ( element == endPath.block || element == endPath.blockLimit )\n\t\t\t\t\tbreak;\n\n\t\t\t\tif ( me.checkElementRemovable( element, true ) )\n\t\t\t\t\tbreakEnd = element;\n\t\t\t}\n\n\t\t\tif ( breakEnd )\n\t\t\t\tendNode.breakParent( breakEnd );\n\t\t\tif ( breakStart )\n\t\t\t\tstartNode.breakParent( breakStart );\n\t\t}\n\t}\n\n\t// Apply style to nested editables inside editablesContainer.\n\t// @param {CKEDITOR.dom.element} editablesContainer\n\t// @context CKEDITOR.style\n\tfunction applyStyleOnNestedEditables( editablesContainer ) {\n\t\tvar editables = findNestedEditables( editablesContainer ),\n\t\t\teditable,\n\t\t\tl = editables.length,\n\t\t\ti = 0,\n\t\t\trange = l && new CKEDITOR.dom.range( editablesContainer.getDocument() );\n\n\t\tfor ( ; i < l; ++i ) {\n\t\t\teditable = editables[ i ];\n\t\t\t// Check if style is allowed by this editable's ACF.\n\t\t\tif ( checkIfAllowedInEditable( editable, this ) ) {\n\t\t\t\trange.selectNodeContents( editable );\n\t\t\t\tapplyInlineStyle.call( this, range );\n\t\t\t}\n\t\t}\n\t}\n\n\t// Finds nested editables within container. Does not return\n\t// editables nested in another editable (twice).\n\tfunction findNestedEditables( container ) {\n\t\tvar editables = [];\n\n\t\tcontainer.forEach( function( element ) {\n\t\t\tif ( element.getAttribute( 'contenteditable' ) == 'true' ) {\n\t\t\t\teditables.push( element );\n\t\t\t\treturn false; // Skip children.\n\t\t\t}\n\t\t}, CKEDITOR.NODE_ELEMENT, true );\n\n\t\treturn editables;\n\t}\n\n\t// Checks if style is allowed in this editable.\n\tfunction checkIfAllowedInEditable( editable, style ) {\n\t\tvar filter = CKEDITOR.filter.instances[ editable.data( 'cke-filter' ) ];\n\n\t\treturn filter ? filter.check( style ) : 1;\n\t}\n\n\t// Checks if style is allowed by iterator's active filter.\n\tfunction checkIfAllowedByIterator( iterator, style ) {\n\t\treturn iterator.activeFilter ? iterator.activeFilter.check( style ) : 1;\n\t}\n\n\tfunction applyObjectStyle( range ) {\n\t\t// Selected or parent element. (#9651)\n\t\tvar start = range.getEnclosedNode() || range.getCommonAncestor( false, true ),\n\t\t\telement = new CKEDITOR.dom.elementPath( start, range.root ).contains( this.element, 1 );\n\n\t\telement && !element.isReadOnly() && setupElement( element, this );\n\t}\n\n\tfunction removeObjectStyle( range ) {\n\t\tvar parent = range.getCommonAncestor( true, true ),\n\t\t\telement = new CKEDITOR.dom.elementPath( parent, range.root ).contains( this.element, 1 );\n\n\t\tif ( !element )\n\t\t\treturn;\n\n\t\tvar style = this,\n\t\t\tdef = style._.definition,\n\t\t\tattributes = def.attributes;\n\n\t\t// Remove all defined attributes.\n\t\tif ( attributes ) {\n\t\t\tfor ( var att in attributes )\n\t\t\t\telement.removeAttribute( att, attributes[ att ] );\n\t\t}\n\n\t\t// Assign all defined styles.\n\t\tif ( def.styles ) {\n\t\t\tfor ( var i in def.styles ) {\n\t\t\t\tif ( def.styles.hasOwnProperty( i ) )\n\t\t\t\t\telement.removeStyle( i );\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction applyBlockStyle( range ) {\n\t\t// Serializible bookmarks is needed here since\n\t\t// elements may be merged.\n\t\tvar bookmark = range.createBookmark( true );\n\n\t\tvar iterator = range.createIterator();\n\t\titerator.enforceRealBlocks = true;\n\n\t\t// make recognize <br /> tag as a separator in ENTER_BR mode (#5121)\n\t\tif ( this._.enterMode )\n\t\t\titerator.enlargeBr = ( this._.enterMode != CKEDITOR.ENTER_BR );\n\n\t\tvar block,\n\t\t\tdoc = range.document,\n\t\t\tnewBlock;\n\n\t\twhile ( ( block = iterator.getNextParagraph() ) ) {\n\t\t\tif ( !block.isReadOnly() && checkIfAllowedByIterator( iterator, this ) ) {\n\t\t\t\tnewBlock = getElement( this, doc, block );\n\t\t\t\treplaceBlock( block, newBlock );\n\t\t\t}\n\t\t}\n\n\t\trange.moveToBookmark( bookmark );\n\t}\n\n\tfunction removeBlockStyle( range ) {\n\t\t// Serializible bookmarks is needed here since\n\t\t// elements may be merged.\n\t\tvar bookmark = range.createBookmark( 1 );\n\n\t\tvar iterator = range.createIterator();\n\t\titerator.enforceRealBlocks = true;\n\t\titerator.enlargeBr = this._.enterMode != CKEDITOR.ENTER_BR;\n\n\t\tvar block,\n\t\t\tnewBlock;\n\n\t\twhile ( ( block = iterator.getNextParagraph() ) ) {\n\t\t\tif ( this.checkElementRemovable( block ) ) {\n\t\t\t\t// <pre> get special treatment.\n\t\t\t\tif ( block.is( 'pre' ) ) {\n\t\t\t\t\tnewBlock = this._.enterMode == CKEDITOR.ENTER_BR ? null :\n\t\t\t\t\t\t\trange.document.createElement( this._.enterMode == CKEDITOR.ENTER_P ? 'p' : 'div' );\n\n\t\t\t\t\tnewBlock && block.copyAttributes( newBlock );\n\t\t\t\t\treplaceBlock( block, newBlock );\n\t\t\t\t} else {\n\t\t\t\t\tremoveFromElement.call( this, block );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\trange.moveToBookmark( bookmark );\n\t}\n\n\t// Replace the original block with new one, with special treatment\n\t// for <pre> blocks to make sure content format is well preserved, and merging/splitting adjacent\n\t// when necessary. (#3188)\n\tfunction replaceBlock( block, newBlock ) {\n\t\t// Block is to be removed, create a temp element to\n\t\t// save contents.\n\t\tvar removeBlock = !newBlock;\n\t\tif ( removeBlock ) {\n\t\t\tnewBlock = block.getDocument().createElement( 'div' );\n\t\t\tblock.copyAttributes( newBlock );\n\t\t}\n\n\t\tvar newBlockIsPre = newBlock && newBlock.is( 'pre' ),\n\t\t\tblockIsPre = block.is( 'pre' ),\n\t\t\tisToPre = newBlockIsPre && !blockIsPre,\n\t\t\tisFromPre = !newBlockIsPre && blockIsPre;\n\n\t\tif ( isToPre )\n\t\t\tnewBlock = toPre( block, newBlock );\n\t\telse if ( isFromPre )\n\t\t\t// Split big <pre> into pieces before start to convert.\n\t\t\tnewBlock = fromPres( removeBlock ? [ block.getHtml() ] : splitIntoPres( block ), newBlock );\n\t\telse\n\t\t\tblock.moveChildren( newBlock );\n\n\t\tnewBlock.replace( block );\n\n\t\tif ( newBlockIsPre ) {\n\t\t\t// Merge previous <pre> blocks.\n\t\t\tmergePre( newBlock );\n\t\t} else if ( removeBlock ) {\n\t\t\tremoveNoAttribsElement( newBlock );\n\t\t}\n\t}\n\n\t// Merge a <pre> block with a previous sibling if available.\n\tfunction mergePre( preBlock ) {\n\t\tvar previousBlock;\n\t\tif ( !( ( previousBlock = preBlock.getPrevious( nonWhitespaces ) ) && previousBlock.type == CKEDITOR.NODE_ELEMENT && previousBlock.is( 'pre' ) ) )\n\t\t\treturn;\n\n\t\t// Merge the previous <pre> block contents into the current <pre>\n\t\t// block.\n\t\t//\n\t\t// Another thing to be careful here is that currentBlock might contain\n\t\t// a '\\n' at the beginning, and previousBlock might contain a '\\n'\n\t\t// towards the end. These new lines are not normally displayed but they\n\t\t// become visible after merging.\n\t\tvar mergedHtml = replace( previousBlock.getHtml(), /\\n$/, '' ) + '\\n\\n' +\n\t\t\treplace( preBlock.getHtml(), /^\\n/, '' );\n\n\t\t// Krugle: IE normalizes innerHTML from <pre>, breaking whitespaces.\n\t\tif ( CKEDITOR.env.ie )\n\t\t\tpreBlock.$.outerHTML = '<pre>' + mergedHtml + '</pre>';\n\t\telse\n\t\t\tpreBlock.setHtml( mergedHtml );\n\n\t\tpreviousBlock.remove();\n\t}\n\n\t// Split into multiple <pre> blocks separated by double line-break.\n\tfunction splitIntoPres( preBlock ) {\n\t\t// Exclude the ones at header OR at tail,\n\t\t// and ignore bookmark content between them.\n\t\tvar duoBrRegex = /(\\S\\s*)\\n(?:\\s|(<span[^>]+data-cke-bookmark.*?\\/span>))*\\n(?!$)/gi,\n\t\t\tpres = [],\n\t\t\tsplitedHtml = replace( preBlock.getOuterHtml(), duoBrRegex, function( match, charBefore, bookmark ) {\n\t\t\t\treturn charBefore + '</pre>' + bookmark + '<pre>';\n\t\t\t} );\n\n\t\tsplitedHtml.replace( /<pre\\b.*?>([\\s\\S]*?)<\\/pre>/gi, function( match, preContent ) {\n\t\t\tpres.push( preContent );\n\t\t} );\n\t\treturn pres;\n\t}\n\n\t// Wrapper function of String::replace without considering of head/tail bookmarks nodes.\n\tfunction replace( str, regexp, replacement ) {\n\t\tvar headBookmark = '',\n\t\t\ttailBookmark = '';\n\n\t\tstr = str.replace( /(^<span[^>]+data-cke-bookmark.*?\\/span>)|(<span[^>]+data-cke-bookmark.*?\\/span>$)/gi, function( str, m1, m2 ) {\n\t\t\tm1 && ( headBookmark = m1 );\n\t\t\tm2 && ( tailBookmark = m2 );\n\t\t\treturn '';\n\t\t} );\n\t\treturn headBookmark + str.replace( regexp, replacement ) + tailBookmark;\n\t}\n\n\t// Converting a list of <pre> into blocks with format well preserved.\n\tfunction fromPres( preHtmls, newBlock ) {\n\t\tvar docFrag;\n\t\tif ( preHtmls.length > 1 )\n\t\t\tdocFrag = new CKEDITOR.dom.documentFragment( newBlock.getDocument() );\n\n\t\tfor ( var i = 0; i < preHtmls.length; i++ ) {\n\t\t\tvar blockHtml = preHtmls[ i ];\n\n\t\t\t// 1. Trim the first and last line-breaks immediately after and before <pre>,\n\t\t\t// they're not visible.\n\t\t\tblockHtml = blockHtml.replace( /(\\r\\n|\\r)/g, '\\n' );\n\t\t\tblockHtml = replace( blockHtml, /^[ \\t]*\\n/, '' );\n\t\t\tblockHtml = replace( blockHtml, /\\n$/, '' );\n\t\t\t// 2. Convert spaces or tabs at the beginning or at the end to &nbsp;\n\t\t\tblockHtml = replace( blockHtml, /^[ \\t]+|[ \\t]+$/g, function( match, offset ) {\n\t\t\t\tif ( match.length == 1 ) // one space, preserve it\n\t\t\t\t\treturn '&nbsp;';\n\t\t\t\telse if ( !offset ) // beginning of block\n\t\t\t\t\treturn CKEDITOR.tools.repeat( '&nbsp;', match.length - 1 ) + ' ';\n\t\t\t\telse // end of block\n\t\t\t\t\treturn ' ' + CKEDITOR.tools.repeat( '&nbsp;', match.length - 1 );\n\t\t\t} );\n\n\t\t\t// 3. Convert \\n to <BR>.\n\t\t\t// 4. Convert contiguous (i.e. non-singular) spaces or tabs to &nbsp;\n\t\t\tblockHtml = blockHtml.replace( /\\n/g, '<br>' );\n\t\t\tblockHtml = blockHtml.replace( /[ \\t]{2,}/g, function( match ) {\n\t\t\t\treturn CKEDITOR.tools.repeat( '&nbsp;', match.length - 1 ) + ' ';\n\t\t\t} );\n\n\t\t\tif ( docFrag ) {\n\t\t\t\tvar newBlockClone = newBlock.clone();\n\t\t\t\tnewBlockClone.setHtml( blockHtml );\n\t\t\t\tdocFrag.append( newBlockClone );\n\t\t\t} else {\n\t\t\t\tnewBlock.setHtml( blockHtml );\n\t\t\t}\n\t\t}\n\n\t\treturn docFrag || newBlock;\n\t}\n\n\t// Converting from a non-PRE block to a PRE block in formatting operations.\n\tfunction toPre( block, newBlock ) {\n\t\tvar bogus = block.getBogus();\n\t\tbogus && bogus.remove();\n\n\t\t// First trim the block content.\n\t\tvar preHtml = block.getHtml();\n\n\t\t// 1. Trim head/tail spaces, they're not visible.\n\t\tpreHtml = replace( preHtml, /(?:^[ \\t\\n\\r]+)|(?:[ \\t\\n\\r]+$)/g, '' );\n\t\t// 2. Delete ANSI whitespaces immediately before and after <BR> because\n\t\t//    they are not visible.\n\t\tpreHtml = preHtml.replace( /[ \\t\\r\\n]*(<br[^>]*>)[ \\t\\r\\n]*/gi, '$1' );\n\t\t// 3. Compress other ANSI whitespaces since they're only visible as one\n\t\t//    single space previously.\n\t\t// 4. Convert &nbsp; to spaces since &nbsp; is no longer needed in <PRE>.\n\t\tpreHtml = preHtml.replace( /([ \\t\\n\\r]+|&nbsp;)/g, ' ' );\n\t\t// 5. Convert any <BR /> to \\n. This must not be done earlier because\n\t\t//    the \\n would then get compressed.\n\t\tpreHtml = preHtml.replace( /<br\\b[^>]*>/gi, '\\n' );\n\n\t\t// Krugle: IE normalizes innerHTML to <pre>, breaking whitespaces.\n\t\tif ( CKEDITOR.env.ie ) {\n\t\t\tvar temp = block.getDocument().createElement( 'div' );\n\t\t\ttemp.append( newBlock );\n\t\t\tnewBlock.$.outerHTML = '<pre>' + preHtml + '</pre>';\n\t\t\tnewBlock.copyAttributes( temp.getFirst() );\n\t\t\tnewBlock = temp.getFirst().remove();\n\t\t} else {\n\t\t\tnewBlock.setHtml( preHtml );\n\t\t}\n\n\t\treturn newBlock;\n\t}\n\n\t// Removes a style from an element itself, don't care about its subtree.\n\tfunction removeFromElement( element, keepDataAttrs ) {\n\t\tvar def = this._.definition,\n\t\t\tattributes = def.attributes,\n\t\t\tstyles = def.styles,\n\t\t\toverrides = getOverrides( this )[ element.getName() ],\n\t\t\t// If the style is only about the element itself, we have to remove the element.\n\t\t\tremoveEmpty = CKEDITOR.tools.isEmpty( attributes ) && CKEDITOR.tools.isEmpty( styles );\n\n\t\t// Remove definition attributes/style from the elemnt.\n\t\tfor ( var attName in attributes ) {\n\t\t\t// The 'class' element value must match (#1318).\n\t\t\tif ( ( attName == 'class' || this._.definition.fullMatch ) && element.getAttribute( attName ) != normalizeProperty( attName, attributes[ attName ] ) )\n\t\t\t\tcontinue;\n\n\t\t\t// Do not touch data-* attributes (#11011) (#11258).\n\t\t\tif ( keepDataAttrs && attName.slice( 0, 5 ) == 'data-' )\n\t\t\t\tcontinue;\n\n\t\t\tremoveEmpty = element.hasAttribute( attName );\n\t\t\telement.removeAttribute( attName );\n\t\t}\n\n\t\tfor ( var styleName in styles ) {\n\t\t\t// Full match style insist on having fully equivalence. (#5018)\n\t\t\tif ( this._.definition.fullMatch && element.getStyle( styleName ) != normalizeProperty( styleName, styles[ styleName ], true ) )\n\t\t\t\tcontinue;\n\n\t\t\tremoveEmpty = removeEmpty || !!element.getStyle( styleName );\n\t\t\telement.removeStyle( styleName );\n\t\t}\n\n\t\t// Remove overrides, but don't remove the element if it's a block element\n\t\tremoveOverrides( element, overrides, blockElements[ element.getName() ] );\n\n\t\tif ( removeEmpty ) {\n\t\t\tif ( this._.definition.alwaysRemoveElement )\n\t\t\t\tremoveNoAttribsElement( element, 1 );\n\t\t\telse {\n\t\t\t\tif ( !CKEDITOR.dtd.$block[ element.getName() ] || this._.enterMode == CKEDITOR.ENTER_BR && !element.hasAttributes() )\n\t\t\t\t\tremoveNoAttribsElement( element );\n\t\t\t\telse\n\t\t\t\t\telement.renameNode( this._.enterMode == CKEDITOR.ENTER_P ? 'p' : 'div' );\n\t\t\t}\n\t\t}\n\t}\n\n\t// Removes a style from inside an element. Called on applyStyle to make cleanup\n\t// before apply. During clean up this function keep data-* attribute in contrast\n\t// to removeFromElement.\n\tfunction removeFromInsideElement( element ) {\n\t\tvar overrides = getOverrides( this ),\n\t\t\tinnerElements = element.getElementsByTag( this.element ),\n\t\t\tinnerElement;\n\n\t\tfor ( var i = innerElements.count(); --i >= 0; ) {\n\t\t\tinnerElement = innerElements.getItem( i );\n\n\t\t\t// Do not remove elements which are read only (e.g. duplicates inside widgets).\n\t\t\tif ( !innerElement.isReadOnly() )\n\t\t\t\tremoveFromElement.call( this, innerElement, true );\n\t\t}\n\n\t\t// Now remove any other element with different name that is\n\t\t// defined to be overriden.\n\t\tfor ( var overrideElement in overrides ) {\n\t\t\tif ( overrideElement != this.element ) {\n\t\t\t\tinnerElements = element.getElementsByTag( overrideElement );\n\n\t\t\t\tfor ( i = innerElements.count() - 1; i >= 0; i-- ) {\n\t\t\t\t\tinnerElement = innerElements.getItem( i );\n\n\t\t\t\t\t// Do not remove elements which are read only (e.g. duplicates inside widgets).\n\t\t\t\t\tif ( !innerElement.isReadOnly() )\n\t\t\t\t\t\tremoveOverrides( innerElement, overrides[ overrideElement ] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Remove overriding styles/attributes from the specific element.\n\t// Note: Remove the element if no attributes remain.\n\t// @param {Object} element\n\t// @param {Object} overrides\n\t// @param {Boolean} Don't remove the element\n\tfunction removeOverrides( element, overrides, dontRemove ) {\n\t\tvar attributes = overrides && overrides.attributes;\n\n\t\tif ( attributes ) {\n\t\t\tfor ( var i = 0; i < attributes.length; i++ ) {\n\t\t\t\tvar attName = attributes[ i ][ 0 ],\n\t\t\t\t\tactualAttrValue;\n\n\t\t\t\tif ( ( actualAttrValue = element.getAttribute( attName ) ) ) {\n\t\t\t\t\tvar attValue = attributes[ i ][ 1 ];\n\n\t\t\t\t\t// Remove the attribute if:\n\t\t\t\t\t//    - The override definition value is null ;\n\t\t\t\t\t//    - The override definition valie is a string that\n\t\t\t\t\t//      matches the attribute value exactly.\n\t\t\t\t\t//    - The override definition value is a regex that\n\t\t\t\t\t//      has matches in the attribute value.\n\t\t\t\t\tif ( attValue === null || ( attValue.test && attValue.test( actualAttrValue ) ) || ( typeof attValue == 'string' && actualAttrValue == attValue ) )\n\t\t\t\t\t\telement.removeAttribute( attName );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ( !dontRemove )\n\t\t\tremoveNoAttribsElement( element );\n\t}\n\n\t// If the element has no more attributes, remove it.\n\tfunction removeNoAttribsElement( element, forceRemove ) {\n\t\t// If no more attributes remained in the element, remove it,\n\t\t// leaving its children.\n\t\tif ( !element.hasAttributes() || forceRemove ) {\n\t\t\tif ( CKEDITOR.dtd.$block[ element.getName() ] ) {\n\t\t\t\tvar previous = element.getPrevious( nonWhitespaces ),\n\t\t\t\t\tnext = element.getNext( nonWhitespaces );\n\n\t\t\t\tif ( previous && ( previous.type == CKEDITOR.NODE_TEXT || !previous.isBlockBoundary( { br: 1 } ) ) )\n\t\t\t\t\telement.append( 'br', 1 );\n\t\t\t\tif ( next && ( next.type == CKEDITOR.NODE_TEXT || !next.isBlockBoundary( { br: 1 } ) ) )\n\t\t\t\t\telement.append( 'br' );\n\n\t\t\t\telement.remove( true );\n\t\t\t} else {\n\t\t\t\t// Removing elements may open points where merging is possible,\n\t\t\t\t// so let's cache the first and last nodes for later checking.\n\t\t\t\tvar firstChild = element.getFirst();\n\t\t\t\tvar lastChild = element.getLast();\n\n\t\t\t\telement.remove( true );\n\n\t\t\t\tif ( firstChild ) {\n\t\t\t\t\t// Check the cached nodes for merging.\n\t\t\t\t\tfirstChild.type == CKEDITOR.NODE_ELEMENT && firstChild.mergeSiblings();\n\n\t\t\t\t\tif ( lastChild && !firstChild.equals( lastChild ) && lastChild.type == CKEDITOR.NODE_ELEMENT )\n\t\t\t\t\t\tlastChild.mergeSiblings();\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction getElement( style, targetDocument, element ) {\n\t\tvar el,\n\t\t\telementName = style.element;\n\n\t\t// The \"*\" element name will always be a span for this function.\n\t\tif ( elementName == '*' )\n\t\t\telementName = 'span';\n\n\t\t// Create the element.\n\t\tel = new CKEDITOR.dom.element( elementName, targetDocument );\n\n\t\t// #6226: attributes should be copied before the new ones are applied\n\t\tif ( element )\n\t\t\telement.copyAttributes( el );\n\n\t\tel = setupElement( el, style );\n\n\t\t// Avoid ID duplication.\n\t\tif ( targetDocument.getCustomData( 'doc_processing_style' ) && el.hasAttribute( 'id' ) )\n\t\t\tel.removeAttribute( 'id' );\n\t\telse\n\t\t\ttargetDocument.setCustomData( 'doc_processing_style', 1 );\n\n\t\treturn el;\n\t}\n\n\tfunction setupElement( el, style ) {\n\t\tvar def = style._.definition,\n\t\t\tattributes = def.attributes,\n\t\t\tstyles = CKEDITOR.style.getStyleText( def );\n\n\t\t// Assign all defined attributes.\n\t\tif ( attributes ) {\n\t\t\tfor ( var att in attributes )\n\t\t\t\tel.setAttribute( att, attributes[ att ] );\n\t\t}\n\n\t\t// Assign all defined styles.\n\t\tif ( styles )\n\t\t\tel.setAttribute( 'style', styles );\n\n\t\treturn el;\n\t}\n\n\tfunction replaceVariables( list, variablesValues ) {\n\t\tfor ( var item in list ) {\n\t\t\tlist[ item ] = list[ item ].replace( varRegex, function( match, varName ) {\n\t\t\t\treturn variablesValues[ varName ];\n\t\t\t} );\n\t\t}\n\t}\n\n\t// Returns an object that can be used for style matching comparison.\n\t// Attributes names and values are all lowercased, and the styles get\n\t// merged with the style attribute.\n\tfunction getAttributesForComparison( styleDefinition ) {\n\t\t// If we have already computed it, just return it.\n\t\tvar attribs = styleDefinition._AC;\n\t\tif ( attribs )\n\t\t\treturn attribs;\n\n\t\tattribs = {};\n\n\t\tvar length = 0;\n\n\t\t// Loop through all defined attributes.\n\t\tvar styleAttribs = styleDefinition.attributes;\n\t\tif ( styleAttribs ) {\n\t\t\tfor ( var styleAtt in styleAttribs ) {\n\t\t\t\tlength++;\n\t\t\t\tattribs[ styleAtt ] = styleAttribs[ styleAtt ];\n\t\t\t}\n\t\t}\n\n\t\t// Includes the style definitions.\n\t\tvar styleText = CKEDITOR.style.getStyleText( styleDefinition );\n\t\tif ( styleText ) {\n\t\t\tif ( !attribs.style )\n\t\t\t\tlength++;\n\t\t\tattribs.style = styleText;\n\t\t}\n\n\t\t// Appends the \"length\" information to the object.\n\t\tattribs._length = length;\n\n\t\t// Return it, saving it to the next request.\n\t\treturn ( styleDefinition._AC = attribs );\n\t}\n\n\t// Get the the collection used to compare the elements and attributes,\n\t// defined in this style overrides, with other element. All information in\n\t// it is lowercased.\n\t// @param {CKEDITOR.style} style\n\tfunction getOverrides( style ) {\n\t\tif ( style._.overrides )\n\t\t\treturn style._.overrides;\n\n\t\tvar overrides = ( style._.overrides = {} ),\n\t\t\tdefinition = style._.definition.overrides;\n\n\t\tif ( definition ) {\n\t\t\t// The override description can be a string, object or array.\n\t\t\t// Internally, well handle arrays only, so transform it if needed.\n\t\t\tif ( !CKEDITOR.tools.isArray( definition ) )\n\t\t\t\tdefinition = [ definition ];\n\n\t\t\t// Loop through all override definitions.\n\t\t\tfor ( var i = 0; i < definition.length; i++ ) {\n\t\t\t\tvar override = definition[ i ],\n\t\t\t\t\telementName,\n\t\t\t\t\toverrideEl,\n\t\t\t\t\tattrs;\n\n\t\t\t\t// If can be a string with the element name.\n\t\t\t\tif ( typeof override == 'string' )\n\t\t\t\t\telementName = override.toLowerCase();\n\t\t\t\t// Or an object.\n\t\t\t\telse {\n\t\t\t\t\telementName = override.element ? override.element.toLowerCase() : style.element;\n\t\t\t\t\tattrs = override.attributes;\n\t\t\t\t}\n\n\t\t\t\t// We can have more than one override definition for the same\n\t\t\t\t// element name, so we attempt to simply append information to\n\t\t\t\t// it if it already exists.\n\t\t\t\toverrideEl = overrides[ elementName ] || ( overrides[ elementName ] = {} );\n\n\t\t\t\tif ( attrs ) {\n\t\t\t\t\t// The returning attributes list is an array, because we\n\t\t\t\t\t// could have different override definitions for the same\n\t\t\t\t\t// attribute name.\n\t\t\t\t\tvar overrideAttrs = ( overrideEl.attributes = overrideEl.attributes || [] );\n\t\t\t\t\tfor ( var attName in attrs ) {\n\t\t\t\t\t\t// Each item in the attributes array is also an array,\n\t\t\t\t\t\t// where [0] is the attribute name and [1] is the\n\t\t\t\t\t\t// override value.\n\t\t\t\t\t\toverrideAttrs.push( [ attName.toLowerCase(), attrs[ attName ] ] );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn overrides;\n\t}\n\n\t// Make the comparison of attribute value easier by standardizing it.\n\tfunction normalizeProperty( name, value, isStyle ) {\n\t\tvar temp = new CKEDITOR.dom.element( 'span' );\n\t\ttemp[ isStyle ? 'setStyle' : 'setAttribute' ]( name, value );\n\t\treturn temp[ isStyle ? 'getStyle' : 'getAttribute' ]( name );\n\t}\n\n\t// Compare two bunch of styles, with the speciality that value 'inherit'\n\t// is treated as a wildcard which will match any value.\n\t// @param {Object/String} source\n\t// @param {Object/String} target\n\t// @returns {Boolean}\n\tfunction compareCssText( source, target ) {\n\t\tfunction filter( string, propertyName ) {\n\t\t\t// In case of font-families we'll skip quotes. (#10750)\n\t\t\treturn propertyName.toLowerCase() == 'font-family' ? string.replace( /[\"']/g, '' ) : string;\n\t\t}\n\n\t\tif ( typeof source == 'string' )\n\t\t\tsource = CKEDITOR.tools.parseCssText( source );\n\t\tif ( typeof target == 'string' )\n\t\t\ttarget = CKEDITOR.tools.parseCssText( target, true );\n\n\t\tfor ( var name in source ) {\n\t\t\tif ( !( name in target ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif ( !( filter( target[ name ], name ) == filter( source[ name ], name ) ||\n\t\t\t\tsource[ name ] == 'inherit' ||\n\t\t\t\ttarget[ name ] == 'inherit' ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tfunction applyStyleOnSelection( selection, remove, editor ) {\n\t\tvar doc = selection.document,\n\t\t\tranges = selection.getRanges(),\n\t\t\tfunc = remove ? this.removeFromRange : this.applyToRange,\n\t\t\trange;\n\n\t\tvar iterator = ranges.createIterator();\n\t\twhile ( ( range = iterator.getNextRange() ) )\n\t\t\tfunc.call( this, range, editor );\n\n\t\tselection.selectRanges( ranges );\n\t\tdoc.removeCustomData( 'doc_processing_style' );\n\t}\n} )();\n\n/**\n * Generic style command. It applies a specific style when executed.\n *\n *\t\tvar boldStyle = new CKEDITOR.style( { element: 'strong' } );\n *\t\t// Register the \"bold\" command, which applies the bold style.\n *\t\teditor.addCommand( 'bold', new CKEDITOR.styleCommand( boldStyle ) );\n *\n * @class\n * @constructor Creates a styleCommand class instance.\n * @extends CKEDITOR.commandDefinition\n * @param {CKEDITOR.style} style The style to be applied when command is executed.\n * @param {Object} [ext] Additional command definition's properties.\n */\nCKEDITOR.styleCommand = function( style, ext ) {\n\tthis.style = style;\n\tthis.allowedContent = style;\n\tthis.requiredContent = style;\n\n\tCKEDITOR.tools.extend( this, ext, true );\n};\n\n/**\n * @param {CKEDITOR.editor} editor\n * @todo\n */\nCKEDITOR.styleCommand.prototype.exec = function( editor ) {\n\teditor.focus();\n\n\tif ( this.state == CKEDITOR.TRISTATE_OFF )\n\t\teditor.applyStyle( this.style );\n\telse if ( this.state == CKEDITOR.TRISTATE_ON )\n\t\teditor.removeStyle( this.style );\n};\n\n/**\n * Manages styles registration and loading. See also {@link CKEDITOR.config#stylesSet}.\n *\n *\t\t// The set of styles for the <b>Styles</b> drop-down list.\n *\t\tCKEDITOR.stylesSet.add( 'default', [\n *\t\t\t// Block Styles\n *\t\t\t{ name: 'Blue Title',\t\telement: 'h3',\t\tstyles: { 'color': 'Blue' } },\n *\t\t\t{ name: 'Red Title',\t\telement: 'h3',\t\tstyles: { 'color': 'Red' } },\n *\n *\t\t\t// Inline Styles\n *\t\t\t{ name: 'Marker: Yellow',\telement: 'span',\tstyles: { 'background-color': 'Yellow' } },\n *\t\t\t{ name: 'Marker: Green',\telement: 'span',\tstyles: { 'background-color': 'Lime' } },\n *\n *\t\t\t// Object Styles\n *\t\t\t{\n *\t\t\t\tname: 'Image on Left',\n *\t\t\t\telement: 'img',\n *\t\t\t\tattributes: {\n *\t\t\t\t\tstyle: 'padding: 5px; margin-right: 5px',\n *\t\t\t\t\tborder: '2',\n *\t\t\t\t\talign: 'left'\n *\t\t\t\t}\n *\t\t\t}\n *\t\t] );\n *\n * @since 3.2\n * @class\n * @singleton\n * @extends CKEDITOR.resourceManager\n */\nCKEDITOR.stylesSet = new CKEDITOR.resourceManager( '', 'stylesSet' );\n\n// Backward compatibility (#5025).\nCKEDITOR.addStylesSet = CKEDITOR.tools.bind( CKEDITOR.stylesSet.add, CKEDITOR.stylesSet );\nCKEDITOR.loadStylesSet = function( name, url, callback ) {\n\tCKEDITOR.stylesSet.addExternal( name, url, '' );\n\tCKEDITOR.stylesSet.load( name, callback );\n};\n\nCKEDITOR.tools.extend( CKEDITOR.editor.prototype, {\n\t/**\n\t * Registers a function to be called whenever the selection position changes in the\n\t * editing area. The current state is passed to the function. The possible\n\t * states are {@link CKEDITOR#TRISTATE_ON} and {@link CKEDITOR#TRISTATE_OFF}.\n\t *\n\t *\t\t// Create a style object for the <b> element.\n\t *\t\tvar style = new CKEDITOR.style( { element: 'b' } );\n\t *\t\tvar editor = CKEDITOR.instances.editor1;\n\t *\t\teditor.attachStyleStateChange( style, function( state ) {\n\t *\t\t\tif ( state == CKEDITOR.TRISTATE_ON )\n\t *\t\t\t\talert( 'The current state for the B element is ON' );\n\t *\t\t\telse\n\t *\t\t\t\talert( 'The current state for the B element is OFF' );\n\t *\t\t} );\n\t *\n\t * @member CKEDITOR.editor\n\t * @param {CKEDITOR.style} style The style to be watched.\n\t * @param {Function} callback The function to be called.\n\t */\n\tattachStyleStateChange: function( style, callback ) {\n\t\t// Try to get the list of attached callbacks.\n\t\tvar styleStateChangeCallbacks = this._.styleStateChangeCallbacks;\n\n\t\t// If it doesn't exist, it means this is the first call. So, let's create\n\t\t// all the structure to manage the style checks and the callback calls.\n\t\tif ( !styleStateChangeCallbacks ) {\n\t\t\t// Create the callbacks array.\n\t\t\tstyleStateChangeCallbacks = this._.styleStateChangeCallbacks = [];\n\n\t\t\t// Attach to the selectionChange event, so we can check the styles at\n\t\t\t// that point.\n\t\t\tthis.on( 'selectionChange', function( ev ) {\n\t\t\t\t// Loop throw all registered callbacks.\n\t\t\t\tfor ( var i = 0; i < styleStateChangeCallbacks.length; i++ ) {\n\t\t\t\t\tvar callback = styleStateChangeCallbacks[ i ];\n\n\t\t\t\t\t// Check the current state for the style defined for that callback.\n\t\t\t\t\tvar currentState = callback.style.checkActive( ev.data.path, this ) ?\n\t\t\t\t\t\tCKEDITOR.TRISTATE_ON : CKEDITOR.TRISTATE_OFF;\n\n\t\t\t\t\t// Call the callback function, passing the current state to it.\n\t\t\t\t\tcallback.fn.call( this, currentState );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\t// Save the callback info, so it can be checked on the next occurrence of\n\t\t// selectionChange.\n\t\tstyleStateChangeCallbacks.push( { style: style, fn: callback } );\n\t},\n\n\t/**\n\t * Applies the style upon the editor's current selection. Shorthand for\n\t * {@link CKEDITOR.style#apply}.\n\t *\n\t * @member CKEDITOR.editor\n\t * @param {CKEDITOR.style} style\n\t */\n\tapplyStyle: function( style ) {\n\t\tstyle.apply( this );\n\t},\n\n\t/**\n\t * Removes the style from the editor's current selection. Shorthand for\n\t * {@link CKEDITOR.style#remove}.\n\t *\n\t * @member CKEDITOR.editor\n\t * @param {CKEDITOR.style} style\n\t */\n\tremoveStyle: function( style ) {\n\t\tstyle.remove( this );\n\t},\n\n\t/**\n\t * Gets the current `stylesSet` for this instance.\n\t *\n\t *\t\teditor.getStylesSet( function( stylesDefinitions ) {} );\n\t *\n\t * See also {@link CKEDITOR.editor#stylesSet} event.\n\t *\n\t * @member CKEDITOR.editor\n\t * @param {Function} callback The function to be called with the styles data.\n\t */\n\tgetStylesSet: function( callback ) {\n\t\tif ( !this._.stylesDefinitions ) {\n\t\t\tvar editor = this,\n\t\t\t\t// Respect the backwards compatible definition entry\n\t\t\t\tconfigStyleSet = editor.config.stylesCombo_stylesSet || editor.config.stylesSet;\n\n\t\t\t// The false value means that none styles should be loaded.\n\t\t\tif ( configStyleSet === false ) {\n\t\t\t\tcallback( null );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// #5352 Allow to define the styles directly in the config object\n\t\t\tif ( configStyleSet instanceof Array ) {\n\t\t\t\teditor._.stylesDefinitions = configStyleSet;\n\t\t\t\tcallback( configStyleSet );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Default value is 'default'.\n\t\t\tif ( !configStyleSet )\n\t\t\t\tconfigStyleSet = 'default';\n\n\t\t\tvar partsStylesSet = configStyleSet.split( ':' ),\n\t\t\t\tstyleSetName = partsStylesSet[ 0 ],\n\t\t\t\texternalPath = partsStylesSet[ 1 ];\n\n\t\t\tCKEDITOR.stylesSet.addExternal( styleSetName, externalPath ? partsStylesSet.slice( 1 ).join( ':' ) : CKEDITOR.getUrl( 'styles.js' ), '' );\n\n\t\t\tCKEDITOR.stylesSet.load( styleSetName, function( stylesSet ) {\n\t\t\t\teditor._.stylesDefinitions = stylesSet[ styleSetName ];\n\t\t\t\tcallback( editor._.stylesDefinitions );\n\t\t\t} );\n\t\t} else {\n\t\t\tcallback( this._.stylesDefinitions );\n\t\t}\n\t}\n} );\n\n/**\n * Indicates that fully selected read-only elements will be included when\n * applying the style (for inline styles only).\n *\n * @since 3.5\n * @property {Boolean} [includeReadonly=false]\n * @member CKEDITOR.style\n */\n\n/**\n * Indicates that any matches element of this style will be eventually removed\n * when calling {@link CKEDITOR.editor#removeStyle}.\n *\n * @since 4.0\n * @property {Boolean} [alwaysRemoveElement=false]\n * @member CKEDITOR.style\n */\n\n/**\n * Disables inline styling on read-only elements.\n *\n * @since 3.5\n * @cfg {Boolean} [disableReadonlyStyling=false]\n * @member CKEDITOR.config\n */\n\n/**\n * The \"styles definition set\" to use in the editor. They will be used in the\n * styles combo and the style selector of the div container.\n *\n * The styles may be defined in the page containing the editor, or can be\n * loaded on demand from an external file. In the second case, if this setting\n * contains only a name, the `styles.js` file will be loaded from the\n * CKEditor root folder (what ensures backward compatibility with CKEditor 4.0).\n *\n * Otherwise, this setting has the `name:url` syntax, making it\n * possible to set the URL from which the styles file will be loaded.\n * Note that the `name` has to be equal to the name used in\n * {@link CKEDITOR.stylesSet#add} while registering the styles set.\n *\n * **Note**: Since 4.1 it is possible to set `stylesSet` to `false`\n * to prevent loading any styles set.\n *\n * Read more in the [documentation](#!/guide/dev_styles)\n * and see the [SDK sample](http://sdk.ckeditor.com/samples/styles.html).\n *\n *\t\t// Do not load any file. The styles set is empty.\n *\t\tconfig.stylesSet = false;\n *\n *\t\t// Load the 'mystyles' styles set from the styles.js file.\n *\t\tconfig.stylesSet = 'mystyles';\n *\n *\t\t// Load the 'mystyles' styles set from a relative URL.\n *\t\tconfig.stylesSet = 'mystyles:/editorstyles/styles.js';\n *\n *\t\t// Load the 'mystyles' styles set from a full URL.\n *\t\tconfig.stylesSet = 'mystyles:http://www.example.com/editorstyles/styles.js';\n *\n *\t\t// Load from a list of definitions.\n *\t\tconfig.stylesSet = [\n *\t\t\t{ name: 'Strong Emphasis', element: 'strong' },\n *\t\t\t{ name: 'Emphasis', element: 'em' },\n *\t\t\t...\n *\t\t];\n *\n * @since 3.3\n * @cfg {String/Array/Boolean} [stylesSet='default']\n * @member CKEDITOR.config\n */\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/style.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Defines the {@link CKEDITOR.dom.comment} class, which represents\n *\t\ta DOM comment node.\n */\n\n/**\n * Represents a DOM comment node.\n *\n *\t\tvar nativeNode = document.createComment( 'Example' );\n *\t\tvar comment = new CKEDITOR.dom.comment( nativeNode );\n *\n *\t\tvar comment = new CKEDITOR.dom.comment( 'Example' );\n *\n * @class\n * @extends CKEDITOR.dom.node\n * @constructor Creates a comment class instance.\n * @param {Object/String} comment A native DOM comment node or a string containing\n * the text to use to create a new comment node.\n * @param {CKEDITOR.dom.document} [ownerDocument] The document that will contain\n * the node in case of new node creation. Defaults to the current document.\n */\nCKEDITOR.dom.comment = function( comment, ownerDocument ) {\n\tif ( typeof comment == 'string' )\n\t\tcomment = ( ownerDocument ? ownerDocument.$ : document ).createComment( comment );\n\n\tCKEDITOR.dom.domObject.call( this, comment );\n};\n\nCKEDITOR.dom.comment.prototype = new CKEDITOR.dom.node();\n\nCKEDITOR.tools.extend( CKEDITOR.dom.comment.prototype, {\n\t/**\n\t * The node type. This is a constant value set to {@link CKEDITOR#NODE_COMMENT}.\n\t *\n\t * @readonly\n\t * @property {Number} [=CKEDITOR.NODE_COMMENT]\n\t */\n\ttype: CKEDITOR.NODE_COMMENT,\n\n\t/**\n\t * Gets the outer HTML of this comment.\n\t *\n\t * @returns {String} The HTML `<!-- comment value -->`.\n\t */\n\tgetOuterHtml: function() {\n\t\treturn '<!--' + this.$.nodeValue + '-->';\n\t}\n} );\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/dom/comment.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n'use strict';\n\n( function() {\n\n\tvar pathBlockLimitElements = {},\n\t\tpathBlockElements = {},\n\t\ttag;\n\n\t// Elements that are considered the \"Block limit\" in an element path.\n\tfor ( tag in CKEDITOR.dtd.$blockLimit ) {\n\t\t// Exclude from list roots.\n\t\tif ( !( tag in CKEDITOR.dtd.$list ) )\n\t\t\tpathBlockLimitElements[ tag ] = 1;\n\t}\n\n\t// Elements that are considered the \"End level Block\" in an element path.\n\tfor ( tag in CKEDITOR.dtd.$block ) {\n\t\t// Exclude block limits, and empty block element, e.g. hr.\n\t\tif ( !( tag in CKEDITOR.dtd.$blockLimit || tag in CKEDITOR.dtd.$empty ) )\n\t\t\tpathBlockElements[ tag ] = 1;\n\t}\n\n\t// Check if an element contains any block element.\n\tfunction checkHasBlock( element ) {\n\t\tvar childNodes = element.getChildren();\n\n\t\tfor ( var i = 0, count = childNodes.count(); i < count; i++ ) {\n\t\t\tvar child = childNodes.getItem( i );\n\n\t\t\tif ( child.type == CKEDITOR.NODE_ELEMENT && CKEDITOR.dtd.$block[ child.getName() ] )\n\t\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t * Retrieve the list of nodes walked from the start node up to the editable element of the editor.\n\t *\n\t * @class\n\t * @constructor Creates an element path class instance.\n\t * @param {CKEDITOR.dom.element} startNode From which the path should start.\n\t * @param {CKEDITOR.dom.element} root To which element the path should stop, defaults to the `body` element.\n\t */\n\tCKEDITOR.dom.elementPath = function( startNode, root ) {\n\t\tvar block = null,\n\t\t\tblockLimit = null,\n\t\t\telements = [],\n\t\t\te = startNode,\n\t\t\telementName;\n\n\t\t// Backward compact.\n\t\troot = root || startNode.getDocument().getBody();\n\n\t\tdo {\n\t\t\tif ( e.type == CKEDITOR.NODE_ELEMENT ) {\n\t\t\t\telements.push( e );\n\n\t\t\t\tif ( !this.lastElement ) {\n\t\t\t\t\tthis.lastElement = e;\n\n\t\t\t\t\t// If an object or non-editable element is fully selected at the end of the element path,\n\t\t\t\t\t// it must not become the block limit.\n\t\t\t\t\tif ( e.is( CKEDITOR.dtd.$object ) || e.getAttribute( 'contenteditable' ) == 'false' )\n\t\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif ( e.equals( root ) )\n\t\t\t\t\tbreak;\n\n\t\t\t\tif ( !blockLimit ) {\n\t\t\t\t\telementName = e.getName();\n\n\t\t\t\t\t// First editable element becomes a block limit, because it cannot be split.\n\t\t\t\t\tif ( e.getAttribute( 'contenteditable' ) == 'true' )\n\t\t\t\t\t\tblockLimit = e;\n\t\t\t\t\t// \"Else\" because element cannot be both - block and block levelimit.\n\t\t\t\t\telse if ( !block && pathBlockElements[ elementName ] )\n\t\t\t\t\t\tblock = e;\n\n\t\t\t\t\tif ( pathBlockLimitElements[ elementName ] ) {\n\t\t\t\t\t\t// End level DIV is considered as the block, if no block is available. (#525)\n\t\t\t\t\t\t// But it must NOT be the root element (checked above).\n\t\t\t\t\t\tif ( !block && elementName == 'div' && !checkHasBlock( e ) )\n\t\t\t\t\t\t\tblock = e;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tblockLimit = e;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\twhile ( ( e = e.getParent() ) );\n\n\t\t// Block limit defaults to root.\n\t\tif ( !blockLimit )\n\t\t\tblockLimit = root;\n\n\t\t/**\n\t\t * First non-empty block element which:\n\t\t *\n\t\t * * is not a {@link CKEDITOR.dtd#$blockLimit},\n\t\t * * or is a `div` which does not contain block elements and is not a `root`.\n\t\t *\n\t\t * This means a first, splittable block in elements path.\n\t\t *\n\t\t * @readonly\n\t\t * @property {CKEDITOR.dom.element}\n\t\t */\n\t\tthis.block = block;\n\n\t\t/**\n\t\t * See the {@link CKEDITOR.dtd#$blockLimit} description.\n\t\t *\n\t\t * @readonly\n\t\t * @property {CKEDITOR.dom.element}\n\t\t */\n\t\tthis.blockLimit = blockLimit;\n\n\t\t/**\n\t\t * The root of the elements path - `root` argument passed to class constructor or a `body` element.\n\t\t *\n\t\t * @readonly\n\t\t * @property {CKEDITOR.dom.element}\n\t\t */\n\t\tthis.root = root;\n\n\t\t/**\n\t\t * An array of elements (from `startNode` to `root`) in the path.\n\t\t *\n\t\t * @readonly\n\t\t * @property {CKEDITOR.dom.element[]}\n\t\t */\n\t\tthis.elements = elements;\n\n\t\t/**\n\t\t * The last element of the elements path - `startNode` or its parent.\n\t\t *\n\t\t * @readonly\n\t\t * @property {CKEDITOR.dom.element} lastElement\n\t\t */\n\t};\n\n} )();\n\nCKEDITOR.dom.elementPath.prototype = {\n\t/**\n\t * Compares this element path with another one.\n\t *\n\t * @param {CKEDITOR.dom.elementPath} otherPath The elementPath object to be\n\t * compared with this one.\n\t * @returns {Boolean} `true` if the paths are equal, containing the same\n\t * number of elements and the same elements in the same order.\n\t */\n\tcompare: function( otherPath ) {\n\t\tvar thisElements = this.elements;\n\t\tvar otherElements = otherPath && otherPath.elements;\n\n\t\tif ( !otherElements || thisElements.length != otherElements.length )\n\t\t\treturn false;\n\n\t\tfor ( var i = 0; i < thisElements.length; i++ ) {\n\t\t\tif ( !thisElements[ i ].equals( otherElements[ i ] ) )\n\t\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t},\n\n\t/**\n\t * Search the path elements that meets the specified criteria.\n\t *\n\t * @param {String/Array/Function/Object/CKEDITOR.dom.element} query The criteria that can be\n\t * either a tag name, list (array and object) of tag names, element or an node evaluator function.\n\t * @param {Boolean} [excludeRoot] Not taking path root element into consideration.\n\t * @param {Boolean} [fromTop] Search start from the topmost element instead of bottom.\n\t * @returns {CKEDITOR.dom.element} The first matched dom element or `null`.\n\t */\n\tcontains: function( query, excludeRoot, fromTop ) {\n\t\tvar evaluator;\n\t\tif ( typeof query == 'string' )\n\t\t\tevaluator = function( node ) {\n\t\t\t\treturn node.getName() == query;\n\t\t\t};\n\t\tif ( query instanceof CKEDITOR.dom.element )\n\t\t\tevaluator = function( node ) {\n\t\t\t\treturn node.equals( query );\n\t\t\t};\n\t\telse if ( CKEDITOR.tools.isArray( query ) )\n\t\t\tevaluator = function( node ) {\n\t\t\t\treturn CKEDITOR.tools.indexOf( query, node.getName() ) > -1;\n\t\t\t};\n\t\telse if ( typeof query == 'function' )\n\t\t\tevaluator = query;\n\t\telse if ( typeof query == 'object' )\n\t\t\tevaluator = function( node ) {\n\t\t\t\treturn node.getName() in query;\n\t\t\t};\n\n\t\tvar elements = this.elements,\n\t\t\tlength = elements.length;\n\t\texcludeRoot && length--;\n\n\t\tif ( fromTop ) {\n\t\t\telements = Array.prototype.slice.call( elements, 0 );\n\t\t\telements.reverse();\n\t\t}\n\n\t\tfor ( var i = 0; i < length; i++ ) {\n\t\t\tif ( evaluator( elements[ i ] ) )\n\t\t\t\treturn elements[ i ];\n\t\t}\n\n\t\treturn null;\n\t},\n\n\t/**\n\t * Check whether the elements path is the proper context for the specified\n\t * tag name in the DTD.\n\t *\n\t * @param {String} tag The tag name.\n\t * @returns {Boolean}\n\t */\n\tisContextFor: function( tag ) {\n\t\tvar holder;\n\n\t\t// Check for block context.\n\t\tif ( tag in CKEDITOR.dtd.$block ) {\n\t\t\t// Indeterminate elements which are not subjected to be splitted or surrounded must be checked first.\n\t\t\tvar inter = this.contains( CKEDITOR.dtd.$intermediate );\n\t\t\tholder = inter || ( this.root.equals( this.block ) && this.block ) || this.blockLimit;\n\t\t\treturn !!holder.getDtd()[ tag ];\n\t\t}\n\n\t\treturn true;\n\t},\n\n\t/**\n\t * Retrieve the text direction for this elements path.\n\t *\n\t * @returns {'ltr'/'rtl'}\n\t */\n\tdirection: function() {\n\t\tvar directionNode = this.block || this.blockLimit || this.root;\n\t\treturn directionNode.getDirection( 1 );\n\t}\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/dom/elementpath.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Defines the {@link CKEDITOR.dom.text} class, which represents\n *\t\ta DOM text node.\n */\n\n/**\n * Represents a DOM text node.\n *\n *\t\tvar nativeNode = document.createTextNode( 'Example' );\n *\t\tvar text = new CKEDITOR.dom.text( nativeNode );\n *\n *\t\tvar text = new CKEDITOR.dom.text( 'Example' );\n *\n * @class\n * @extends CKEDITOR.dom.node\n * @constructor Creates a text class instance.\n * @param {Object/String} text A native DOM text node or a string containing\n * the text to use to create a new text node.\n * @param {CKEDITOR.dom.document} [ownerDocument] The document that will contain\n * the node in case of new node creation. Defaults to the current document.\n */\nCKEDITOR.dom.text = function( text, ownerDocument ) {\n\tif ( typeof text == 'string' )\n\t\ttext = ( ownerDocument ? ownerDocument.$ : document ).createTextNode( text );\n\n\t// Theoretically, we should call the base constructor here\n\t// (not CKEDITOR.dom.node though). But, IE doesn't support expando\n\t// properties on text node, so the features provided by domObject will not\n\t// work for text nodes (which is not a big issue for us).\n\t//\n\t// CKEDITOR.dom.domObject.call( this, element );\n\n\tthis.$ = text;\n};\n\nCKEDITOR.dom.text.prototype = new CKEDITOR.dom.node();\n\nCKEDITOR.tools.extend( CKEDITOR.dom.text.prototype, {\n\t/**\n\t * The node type. This is a constant value set to {@link CKEDITOR#NODE_TEXT}.\n\t *\n\t * @readonly\n\t * @property {Number} [=CKEDITOR.NODE_TEXT]\n\t */\n\ttype: CKEDITOR.NODE_TEXT,\n\n\t/**\n\t * Gets length of node's value.\n\t *\n\t * @returns {Number}\n\t */\n\tgetLength: function() {\n\t\treturn this.$.nodeValue.length;\n\t},\n\n\t/**\n\t * Gets node's value.\n\t *\n\t * @returns {String}\n\t */\n\tgetText: function() {\n\t\treturn this.$.nodeValue;\n\t},\n\n\t/**\n\t * Sets node's value.\n\t *\n\t * @param {String} text\n\t */\n\tsetText: function( text ) {\n\t\tthis.$.nodeValue = text;\n\t},\n\n\t/**\n\t * Breaks this text node into two nodes at the specified offset,\n\t * keeping both in the tree as siblings. This node then only contains\n\t * all the content up to the offset point. A new text node, which is\n\t * inserted as the next sibling of this node, contains all the content\n\t * at and after the offset point. When the offset is equal to the\n\t * length of this node, the new node has no data.\n\t *\n\t * @param {Number} The position at which to split, starting from zero.\n\t * @returns {CKEDITOR.dom.text} The new text node.\n\t */\n\tsplit: function( offset ) {\n\n\t\t// Saved the children count and text length beforehand.\n\t\tvar parent = this.$.parentNode,\n\t\t\tcount = parent.childNodes.length,\n\t\t\tlength = this.getLength();\n\n\t\tvar doc = this.getDocument();\n\t\tvar retval = new CKEDITOR.dom.text( this.$.splitText( offset ), doc );\n\n\t\tif ( parent.childNodes.length == count ) {\n\t\t\t// If the offset is after the last char, IE creates the text node\n\t\t\t// on split, but don't include it into the DOM. So, we have to do\n\t\t\t// that manually here.\n\t\t\tif ( offset >= length ) {\n\t\t\t\tretval = doc.createText( '' );\n\t\t\t\tretval.insertAfter( this );\n\t\t\t} else {\n\t\t\t\t// IE BUG: IE8+ does not update the childNodes array in DOM after splitText(),\n\t\t\t\t// we need to make some DOM changes to make it update. (#3436)\n\t\t\t\tvar workaround = doc.createText( '' );\n\t\t\t\tworkaround.insertAfter( retval );\n\t\t\t\tworkaround.remove();\n\t\t\t}\n\t\t}\n\n\t\treturn retval;\n\t},\n\n\t/**\n\t * Extracts characters from indexA up to but not including `indexB`.\n\t *\n\t * @param {Number} indexA An integer between `0` and one less than the\n\t * length of the text.\n\t * @param {Number} [indexB] An integer between `0` and the length of the\n\t * string. If omitted, extracts characters to the end of the text.\n\t */\n\tsubstring: function( indexA, indexB ) {\n\t\t// We need the following check due to a Firefox bug\n\t\t// https://bugzilla.mozilla.org/show_bug.cgi?id=458886\n\t\tif ( typeof indexB != 'number' )\n\t\t\treturn this.$.nodeValue.substr( indexA );\n\t\telse\n\t\t\treturn this.$.nodeValue.substring( indexA, indexB );\n\t}\n} );\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/dom/text.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n( function() {\n\t/**\n\t * Represents a list os CKEDITOR.dom.range objects, which can be easily\n\t * iterated sequentially.\n\t *\n\t * @class\n\t * @extends Array\n\t * @constructor Creates a rangeList class instance.\n\t * @param {CKEDITOR.dom.range/CKEDITOR.dom.range[]} [ranges] The ranges contained on this list.\n\t * Note that, if an array of ranges is specified, the range sequence\n\t * should match its DOM order. This class will not help to sort them.\n\t */\n\tCKEDITOR.dom.rangeList = function( ranges ) {\n\t\tif ( ranges instanceof CKEDITOR.dom.rangeList )\n\t\t\treturn ranges;\n\n\t\tif ( !ranges )\n\t\t\tranges = [];\n\t\telse if ( ranges instanceof CKEDITOR.dom.range )\n\t\t\tranges = [ ranges ];\n\n\t\treturn CKEDITOR.tools.extend( ranges, mixins );\n\t};\n\n\tvar mixins = {\n\t\t/**\n\t\t * Creates an instance of the rangeList iterator, it should be used\n\t\t * only when the ranges processing could be DOM intrusive, which\n\t\t * means it may pollute and break other ranges in this list.\n\t\t * Otherwise, it's enough to just iterate over this array in a for loop.\n\t\t *\n\t\t * @returns {CKEDITOR.dom.rangeListIterator}\n\t\t */\n\t\tcreateIterator: function() {\n\t\t\tvar rangeList = this,\n\t\t\t\tbookmark = CKEDITOR.dom.walker.bookmark(),\n\t\t\t\tbookmarks = [],\n\t\t\t\tcurrent;\n\n\t\t\treturn {\n\t\t\t\t/**\n\t\t\t\t * Retrieves the next range in the list.\n\t\t\t\t *\n\t\t\t\t * @member CKEDITOR.dom.rangeListIterator\n\t\t\t\t * @param {Boolean} [mergeConsequent=false] Whether join two adjacent\n\t\t\t\t * ranges into single, e.g. consequent table cells.\n\t\t\t\t */\n\t\t\t\tgetNextRange: function( mergeConsequent ) {\n\t\t\t\t\tcurrent = current === undefined ? 0 : current + 1;\n\n\t\t\t\t\tvar range = rangeList[ current ];\n\n\t\t\t\t\t// Multiple ranges might be mangled by each other.\n\t\t\t\t\tif ( range && rangeList.length > 1 ) {\n\t\t\t\t\t\t// Bookmarking all other ranges on the first iteration,\n\t\t\t\t\t\t// the range correctness after it doesn't matter since we'll\n\t\t\t\t\t\t// restore them before the next iteration.\n\t\t\t\t\t\tif ( !current ) {\n\t\t\t\t\t\t\t// Make sure bookmark correctness by reverse processing.\n\t\t\t\t\t\t\tfor ( var i = rangeList.length - 1; i >= 0; i-- )\n\t\t\t\t\t\t\t\tbookmarks.unshift( rangeList[ i ].createBookmark( true ) );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( mergeConsequent ) {\n\t\t\t\t\t\t\t// Figure out how many ranges should be merged.\n\t\t\t\t\t\t\tvar mergeCount = 0;\n\t\t\t\t\t\t\twhile ( rangeList[ current + mergeCount + 1 ] ) {\n\t\t\t\t\t\t\t\tvar doc = range.document,\n\t\t\t\t\t\t\t\t\tfound = 0,\n\t\t\t\t\t\t\t\t\tleft = doc.getById( bookmarks[ mergeCount ].endNode ),\n\t\t\t\t\t\t\t\t\tright = doc.getById( bookmarks[ mergeCount + 1 ].startNode ),\n\t\t\t\t\t\t\t\t\tnext;\n\n\t\t\t\t\t\t\t\t// Check subsequent range.\n\t\t\t\t\t\t\t\twhile ( 1 ) {\n\t\t\t\t\t\t\t\t\tnext = left.getNextSourceNode( false );\n\t\t\t\t\t\t\t\t\tif ( !right.equals( next ) ) {\n\t\t\t\t\t\t\t\t\t\t// This could be yet another bookmark or\n\t\t\t\t\t\t\t\t\t\t// walking across block boundaries.\n\t\t\t\t\t\t\t\t\t\tif ( bookmark( next ) || ( next.type == CKEDITOR.NODE_ELEMENT && next.isBlockBoundary() ) ) {\n\t\t\t\t\t\t\t\t\t\t\tleft = next;\n\t\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tfound = 1;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif ( !found )\n\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\tmergeCount++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\trange.moveToBookmark( bookmarks.shift() );\n\n\t\t\t\t\t\t// Merge ranges finally after moving to bookmarks.\n\t\t\t\t\t\twhile ( mergeCount-- ) {\n\t\t\t\t\t\t\tnext = rangeList[ ++current ];\n\t\t\t\t\t\t\tnext.moveToBookmark( bookmarks.shift() );\n\t\t\t\t\t\t\trange.setEnd( next.endContainer, next.endOffset );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn range;\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\n\t\t/**\n\t\t * Create bookmarks for all ranges. See {@link CKEDITOR.dom.range#createBookmark}.\n\t\t *\n\t\t * @param {Boolean} [serializable=false] See {@link CKEDITOR.dom.range#createBookmark}.\n\t\t * @returns {Array} Array of bookmarks.\n\t\t */\n\t\tcreateBookmarks: function( serializable ) {\n\t\t\tvar retval = [],\n\t\t\t\tbookmark;\n\t\t\tfor ( var i = 0; i < this.length; i++ ) {\n\t\t\t\tretval.push( bookmark = this[ i ].createBookmark( serializable, true ) );\n\n\t\t\t\t// Updating the container & offset values for ranges\n\t\t\t\t// that have been touched.\n\t\t\t\tfor ( var j = i + 1; j < this.length; j++ ) {\n\t\t\t\t\tthis[ j ] = updateDirtyRange( bookmark, this[ j ] );\n\t\t\t\t\tthis[ j ] = updateDirtyRange( bookmark, this[ j ], true );\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn retval;\n\t\t},\n\n\t\t/**\n\t\t * Create \"unobtrusive\" bookmarks for all ranges. See {@link CKEDITOR.dom.range#createBookmark2}.\n\t\t *\n\t\t * @param {Boolean} [normalized=false] See {@link CKEDITOR.dom.range#createBookmark2}.\n\t\t * @returns {Array} Array of bookmarks.\n\t\t */\n\t\tcreateBookmarks2: function( normalized ) {\n\t\t\tvar bookmarks = [];\n\n\t\t\tfor ( var i = 0; i < this.length; i++ )\n\t\t\t\tbookmarks.push( this[ i ].createBookmark2( normalized ) );\n\n\t\t\treturn bookmarks;\n\t\t},\n\n\t\t/**\n\t\t * Move each range in the list to the position specified by a list of bookmarks.\n\t\t *\n\t\t * @param {Array} bookmarks The list of bookmarks, each one matching a range in the list.\n\t\t */\n\t\tmoveToBookmarks: function( bookmarks ) {\n\t\t\tfor ( var i = 0; i < this.length; i++ )\n\t\t\t\tthis[ i ].moveToBookmark( bookmarks[ i ] );\n\t\t}\n\t};\n\n\t// Update the specified range which has been mangled by previous insertion of\n\t// range bookmark nodes.(#3256)\n\tfunction updateDirtyRange( bookmark, dirtyRange, checkEnd ) {\n\t\tvar serializable = bookmark.serializable,\n\t\t\tcontainer = dirtyRange[ checkEnd ? 'endContainer' : 'startContainer' ],\n\t\t\toffset = checkEnd ? 'endOffset' : 'startOffset';\n\n\t\tvar bookmarkStart = serializable ? dirtyRange.document.getById( bookmark.startNode ) : bookmark.startNode;\n\n\t\tvar bookmarkEnd = serializable ? dirtyRange.document.getById( bookmark.endNode ) : bookmark.endNode;\n\n\t\tif ( container.equals( bookmarkStart.getPrevious() ) ) {\n\t\t\tdirtyRange.startOffset = dirtyRange.startOffset - container.getLength() - bookmarkEnd.getPrevious().getLength();\n\t\t\tcontainer = bookmarkEnd.getNext();\n\t\t} else if ( container.equals( bookmarkEnd.getPrevious() ) ) {\n\t\t\tdirtyRange.startOffset = dirtyRange.startOffset - container.getLength();\n\t\t\tcontainer = bookmarkEnd.getNext();\n\t\t}\n\n\t\tcontainer.equals( bookmarkStart.getParent() ) && dirtyRange[ offset ]++;\n\t\tcontainer.equals( bookmarkEnd.getParent() ) && dirtyRange[ offset ]++;\n\n\t\t// Update and return this range.\n\t\tdirtyRange[ checkEnd ? 'endContainer' : 'startContainer' ] = container;\n\t\treturn dirtyRange;\n\t}\n} )();\n\n/**\n * (Virtual Class) Do not call this constructor. This class is not really part\n * of the API. It just describes the return type of {@link CKEDITOR.dom.rangeList#createIterator}.\n *\n * @class CKEDITOR.dom.rangeListIterator\n */\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/dom/rangelist.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Defines the {@link CKEDITOR.skin} class that is used to manage skin parts.\n */\n\n( function() {\n\tvar cssLoaded = {};\n\n\tfunction getName() {\n\t\t// CKEDITOR.skinName = \"moono\";\n\t\t\n\t\treturn CKEDITOR.skinName.split( ',' )[ 0 ];\n\t}\n\n\tfunction getConfigPath() {\n\t\treturn CKEDITOR.getUrl( CKEDITOR.skinName.split( ',' )[ 1 ] || ( 'skins/' + getName() + '/' ) );\n\t}\n\n\t/**\n\t * Manages the loading of skin parts among all editor instances.\n\t *\n\t * @class\n\t * @singleton\n\t */\n\tCKEDITOR.skin = {\n\t\t/**\n\t\t * Returns the root path to the skin directory.\n\t\t *\n\t\t * @method\n\t\t * @todo\n\t\t */\n\t\tpath: getConfigPath,\n\n\t\t/**\n\t\t * Loads a skin part into the page. Does nothing if the part has already been loaded.\n\t\t *\n\t\t * **Note:** The \"editor\" part is always auto loaded upon instance creation,\n\t\t * thus this function is mainly used to **lazy load** other parts of the skin\n\t\t * that do not have to be displayed until requested.\n\t\t *\n\t\t *\t\t// Load the dialog part.\n\t\t *\t\teditor.skin.loadPart( 'dialog' );\n\t\t *\n\t\t * @param {String} part The name of the skin part CSS file that resides in the skin directory.\n\t\t * @param {Function} fn The provided callback function which is invoked after the part is loaded.\n\t\t */\n\t\tloadPart: function( part, fn ) {\n\t\t\tif ( CKEDITOR.skin.name != getName() ) {\n\t\t\t\tCKEDITOR.scriptLoader.load( CKEDITOR.getUrl( getConfigPath() + 'skin.js' ), function() {\n\t\t\t\t\tloadCss( part, fn );\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\tloadCss( part, fn );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Retrieves the real URL of a (CSS) skin part.\n\t\t *\n\t\t * @param {String} part\n\t\t */\n\t\tgetPath: function( part ) {\n\t\t\treturn CKEDITOR.getUrl( getCssPath( part ) );\n\t\t},\n\n\t\t/**\n\t\t * The list of registered icons. To add new icons to this list, use {@link #addIcon}.\n\t\t */\n\t\ticons: {},\n\n\t\t/**\n\t\t * Registers an icon.\n\t\t *\n\t\t * @param {String} name The icon name.\n\t\t * @param {String} path The path to the icon image file.\n\t\t * @param {Number} [offset] The vertical offset position of the icon, if\n\t\t * available inside a strip image.\n\t\t * @param {String} [bgsize] The value of the CSS \"background-size\" property to\n\t\t * use for this icon\n\t\t */\n\t\taddIcon: function( name, path, offset, bgsize ) {\n\t\t\tname = name.toLowerCase();\n\t\t\tif ( !this.icons[ name ] ) {\n\t\t\t\tthis.icons[ name ] = {\n\t\t\t\t\tpath: path,\n\t\t\t\t\toffset: offset || 0,\n\t\t\t\t\tbgsize: bgsize || '16px'\n\t\t\t\t};\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Gets the CSS background styles to be used to render a specific icon.\n\t\t *\n\t\t * @param {String} name The icon name, as registered with {@link #addIcon}.\n\t\t * @param {Boolean} [rtl] Indicates that the RTL version of the icon is\n\t\t * to be used, if available.\n\t\t * @param {String} [overridePath] The path to the icon image file. It\n\t\t * overrides the path defined by the named icon, if available, and is\n\t\t * used if the named icon was not registered.\n\t\t * @param {Number} [overrideOffset] The vertical offset position of the\n\t\t * icon. It overrides the offset defined by the named icon, if\n\t\t * available, and is used if the named icon was not registered.\n\t\t * @param {String} [overrideBgsize] The value of the CSS \"background-size\" property\n\t\t * to use for the icon. It overrides the value defined by the named icon,\n\t\t * if available, and is used if the named icon was not registered.\n\t\t */\n\t\tgetIconStyle: function( name, rtl, overridePath, overrideOffset, overrideBgsize ) {\n\t\t\tvar icon, path, offset, bgsize;\n\n\t\t\tif ( name ) {\n\t\t\t\tname = name.toLowerCase();\n\t\t\t\t// If we're in RTL, try to get the RTL version of the icon.\n\t\t\t\tif ( rtl )\n\t\t\t\t\ticon = this.icons[ name + '-rtl' ];\n\n\t\t\t\t// If not in LTR or no RTL version available, get the generic one.\n\t\t\t\tif ( !icon )\n\t\t\t\t\ticon = this.icons[ name ];\n\t\t\t}\n\n\t\t\tpath = overridePath || ( icon && icon.path ) || '';\n\t\t\toffset = overrideOffset || ( icon && icon.offset );\n\t\t\tbgsize = overrideBgsize || ( icon && icon.bgsize ) || '16px';\n\n\t\t\t// If we use apostrophes in background-image, we must escape apostrophes in path (just to be sure). (#13361)\n\t\t\tif ( path )\n\t\t\t\tpath = path.replace( /'/g, '\\\\\\'' );\n\n\t\t\treturn path &&\n\t\t\t\t( 'background-image:url(\\'' + CKEDITOR.getUrl( path ) + '\\');background-position:0 ' + offset + 'px;background-size:' + bgsize + ';' );\n\t\t}\n\t};\n\n\tfunction getCssPath( part ) {\n\t\t// Check for ua-specific version of skin part.\n\t\tvar uas = CKEDITOR.skin[ 'ua_' + part ], env = CKEDITOR.env;\n\t\tif ( uas ) {\n\n\t\t\t// Having versioned UA checked first.\n\t\t\tuas = uas.split( ',' ).sort( function( a, b ) {\n\t\t\t\treturn a > b ? -1 : 1;\n\t\t\t} );\n\n\t\t\t// Loop through all ua entries, checking is any of them match the current ua.\n\t\t\tfor ( var i = 0, ua; i < uas.length; i++ ) {\n\t\t\t\tua = uas[ i ];\n\n\t\t\t\tif ( env.ie ) {\n\t\t\t\t\tif ( ( ua.replace( /^ie/, '' ) == env.version ) || ( env.quirks && ua == 'iequirks' ) )\n\t\t\t\t\t\tua = 'ie';\n\t\t\t\t}\n\n\t\t\t\tif ( env[ ua ] ) {\n\t\t\t\t\tpart += '_' + uas[ i ];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn CKEDITOR.getUrl( getConfigPath() + part + '.css' );\n\t}\n\n\tfunction loadCss( part, callback ) {\n\t\t// Avoid reload.\n\t\tif ( !cssLoaded[ part ] ) {\n\t\t\tCKEDITOR.document.appendStyleSheet( getCssPath( part ) );\n\t\t\tcssLoaded[ part ] = 1;\n\t\t}\n\n\t\t// CSS loading should not be blocking.\n\t\tcallback && callback();\n\t}\n\n\tCKEDITOR.tools.extend( CKEDITOR.editor.prototype, {\n\t\t/** Gets the color of the editor user interface.\n\t\t *\n\t\t *\t\tCKEDITOR.instances.editor1.getUiColor();\n\t\t *\n\t\t * @method\n\t\t * @member CKEDITOR.editor\n\t\t * @returns {String} uiColor The editor UI color or `undefined` if the UI color is not set.\n\t\t */\n\t\tgetUiColor: function() {\n\t\t\treturn this.uiColor;\n\t\t},\n\n\t\t/** Sets the color of the editor user interface. This method accepts a color value in\n\t\t * hexadecimal notation, with a `#` character (e.g. #ffffff).\n\t\t *\n\t\t * \t\tCKEDITOR.instances.editor1.setUiColor( '#ff00ff' );\n\t\t *\n\t\t * @method\n\t\t * @member CKEDITOR.editor\n\t\t * @param {String} color The desired editor UI color in hexadecimal notation.\n\t\t */\n\t\tsetUiColor: function( color ) {\n\t\t\tvar uiStyle = getStylesheet( CKEDITOR.document );\n\n\t\t\treturn ( this.setUiColor = function( color ) {\n\t\t\t\tthis.uiColor = color;\n\n\t\t\t\tvar chameleon = CKEDITOR.skin.chameleon,\n\t\t\t\t\teditorStyleContent = '',\n\t\t\t\t\tpanelStyleContent = '';\n\n\t\t\t\tif ( typeof chameleon == 'function' ) {\n\t\t\t\t\teditorStyleContent = chameleon( this, 'editor' );\n\t\t\t\t\tpanelStyleContent = chameleon( this, 'panel' );\n\t\t\t\t}\n\n\t\t\t\tvar replace = [ [ uiColorRegexp, color ] ];\n\n\t\t\t\t// Update general style.\n\t\t\t\tupdateStylesheets( [ uiStyle ], editorStyleContent, replace );\n\n\t\t\t\t// Update panel styles.\n\t\t\t\tupdateStylesheets( uiColorMenus, panelStyleContent, replace );\n\t\t\t} ).call( this, color );\n\t\t}\n\t} );\n\n\tvar uiColorStylesheetId = 'cke_ui_color',\n\t\tuiColorMenus = [],\n\t\tuiColorRegexp = /\\$color/g;\n\n\tfunction getStylesheet( document ) {\n\t\tvar node = document.getById( uiColorStylesheetId );\n\t\tif ( !node ) {\n\t\t\tnode = document.getHead().append( 'style' );\n\t\t\tnode.setAttribute( 'id', uiColorStylesheetId );\n\t\t\tnode.setAttribute( 'type', 'text/css' );\n\t\t}\n\t\treturn node;\n\t}\n\n\tfunction updateStylesheets( styleNodes, styleContent, replace ) {\n\t\tvar r, i, content;\n\n\t\t// We have to split CSS declarations for webkit.\n\t\tif ( CKEDITOR.env.webkit ) {\n\t\t\tstyleContent = styleContent.split( '}' ).slice( 0, -1 );\n\t\t\tfor ( i = 0; i < styleContent.length; i++ )\n\t\t\t\tstyleContent[ i ] = styleContent[ i ].split( '{' );\n\t\t}\n\n\t\tfor ( var id = 0; id < styleNodes.length; id++ ) {\n\t\t\tif ( CKEDITOR.env.webkit ) {\n\t\t\t\tfor ( i = 0; i < styleContent.length; i++ ) {\n\t\t\t\t\tcontent = styleContent[ i ][ 1 ];\n\t\t\t\t\tfor ( r = 0; r < replace.length; r++ )\n\t\t\t\t\t\tcontent = content.replace( replace[ r ][ 0 ], replace[ r ][ 1 ] );\n\n\t\t\t\t\tstyleNodes[ id ].$.sheet.addRule( styleContent[ i ][ 0 ], content );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcontent = styleContent;\n\t\t\t\tfor ( r = 0; r < replace.length; r++ )\n\t\t\t\t\tcontent = content.replace( replace[ r ][ 0 ], replace[ r ][ 1 ] );\n\n\t\t\t\tif ( CKEDITOR.env.ie && CKEDITOR.env.version < 11 )\n\t\t\t\t\tstyleNodes[ id ].$.styleSheet.cssText += content;\n\t\t\t\telse\n\t\t\t\t\tstyleNodes[ id ].$.innerHTML += content;\n\t\t\t}\n\t\t}\n\t}\n\n\tCKEDITOR.on( 'instanceLoaded', function( evt ) {\n\t\t// The chameleon feature is not for IE quirks.\n\t\tif ( CKEDITOR.env.ie && CKEDITOR.env.quirks )\n\t\t\treturn;\n\n\t\tvar editor = evt.editor,\n\t\t\tshowCallback = function( event ) {\n\t\t\t\tvar panel = event.data[ 0 ] || event.data;\n\t\t\t\tvar iframe = panel.element.getElementsByTag( 'iframe' ).getItem( 0 ).getFrameDocument();\n\n\t\t\t\t// Add stylesheet if missing.\n\t\t\t\tif ( !iframe.getById( 'cke_ui_color' ) ) {\n\t\t\t\t\tvar node = getStylesheet( iframe );\n\t\t\t\t\tuiColorMenus.push( node );\n\n\t\t\t\t\tvar color = editor.getUiColor();\n\t\t\t\t\t// Set uiColor for new panel.\n\t\t\t\t\tif ( color )\n\t\t\t\t\t\tupdateStylesheets( [ node ], CKEDITOR.skin.chameleon( editor, 'panel' ), [ [ uiColorRegexp, color ] ] );\n\n\t\t\t\t}\n\t\t\t};\n\n\t\teditor.on( 'panelShow', showCallback );\n\t\teditor.on( 'menuShow', showCallback );\n\n\t\t// Apply UI color if specified in config.\n\t\tif ( editor.config.uiColor )\n\t\t\teditor.setUiColor( editor.config.uiColor );\n\t} );\n} )();\n\n/**\n * The list of file names matching the browser user agent string from\n * {@link CKEDITOR.env}. This is used to load the skin part file in addition\n * to the \"main\" skin file for a particular browser.\n *\n * **Note:** For each of the defined skin parts the corresponding\n * CSS file with the same name as the user agent must exist inside\n * the skin directory.\n *\n * @property ua\n * @todo type?\n */\n\n/**\n * The name of the skin that is currently used.\n *\n * @property {String} name\n * @todo\n */\n\n/**\n * The editor skin name. Note that it is not possible to have editors with\n * different skin settings in the same page. In such case just one of the\n * skins will be used for all editors.\n *\n * This is a shortcut to {@link CKEDITOR#skinName}.\n *\n * It is possible to install skins outside the default `skin` folder in the\n * editor installation. In that case, the absolute URL path to that folder\n * should be provided, separated by a comma (`'skin_name,skin_path'`).\n *\n *\t\tconfig.skin = 'moono';\n *\n *\t\tconfig.skin = 'myskin,/customstuff/myskin/';\n *\n * @cfg {String} skin\n * @member CKEDITOR.config\n */\n\n/**\n * A function that supports the chameleon (skin color switch) feature, providing\n * the skin color style updates to be applied in runtime.\n *\n * **Note:** The embedded `$color` variable is to be substituted with a specific UI color.\n *\n * @method chameleon\n * @param {String} editor The editor instance that the color changes apply to.\n * @param {String} part The name of the skin part where the color changes take place.\n */\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/skin.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview API initialization code.\n */\n\n( function() {\n\t// Disable HC detection in WebKit. (#5429)\n\tif ( CKEDITOR.env.webkit )\n\t\tCKEDITOR.env.hc = false;\n\telse {\n\t\t// Check whether high contrast is active by creating a colored border.\n\t\tvar hcDetect = CKEDITOR.dom.element.createFromHtml( '<div style=\"width:0;height:0;position:absolute;left:-10000px;' +\n\t\t\t'border:1px solid;border-color:red blue\"></div>', CKEDITOR.document );\n\n\t\thcDetect.appendTo( CKEDITOR.document.getHead() );\n\n\t\t// Update CKEDITOR.env.\n\t\t// Catch exception needed sometimes for FF. (#4230)\n\t\ttry {\n\t\t\tvar top = hcDetect.getComputedStyle( 'border-top-color' ),\n\t\t\t\tright = hcDetect.getComputedStyle( 'border-right-color' );\n\n\t\t\t// We need to check if getComputedStyle returned any value, because on FF\n\t\t\t// it returnes empty string if CKEditor is loaded in hidden iframe. (#11121)\n\t\t\tCKEDITOR.env.hc = !!( top && top == right );\n\t\t} catch ( e ) {\n\t\t\tCKEDITOR.env.hc = false;\n\t\t}\n\n\t\thcDetect.remove();\n\t}\n\n\tif ( CKEDITOR.env.hc )\n\t\tCKEDITOR.env.cssClass += ' cke_hc';\n\n\t// Initially hide UI spaces when relevant skins are loading, later restored by skin css.\n\tCKEDITOR.document.appendStyleText( '.cke{visibility:hidden;}' );\n\n\t// Mark the editor as fully loaded.\n\tCKEDITOR.status = 'loaded';\n\tCKEDITOR.fireOnce( 'loaded' );\n\n\t// Process all instances created by the \"basic\" implementation.\n\tvar pending = CKEDITOR._.pending;\n\tif ( pending ) {\n\t\tdelete CKEDITOR._.pending;\n\n\t\tfor ( var i = 0; i < pending.length; i++ ) {\n\t\t\tCKEDITOR.editor.prototype.constructor.apply( pending[ i ][ 0 ], pending[ i ][ 1 ] );\n\t\t\tCKEDITOR.add( pending[ i ][ 0 ] );\n\t\t}\n\t}\n} )();\n\n/**\n * Indicates that CKEditor is running on a High Contrast environment.\n *\n *\t\tif ( CKEDITOR.env.hc )\n *\t\t\talert( 'You\\'re running on High Contrast mode. The editor interface will get adapted to provide you a better experience.' );\n *\n * @property {Boolean} hc\n * @member CKEDITOR.env\n */\n\n/**\n * Fired when a CKEDITOR core object is fully loaded and ready for interaction.\n *\n * @event loaded\n * @member CKEDITOR\n */\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/_bootstrap.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\nCKEDITOR.editorConfig = function( config ) {\n\t// Define changes to default configuration here. For example:\n\tconfig.language = 'zh-cn';\n\t// config.uiColor = '#AADC6E';\n\tconfig.skin = 'moono';//原来是在ckeditor中设置的\n\t// %REMOVE_START%\n\tconfig.plugins =\n\t\t'about,' +\n\t\t'a11yhelp,' +\n\t\t'basicstyles,' +\n\t\t'bidi,' +\n\t\t'blockquote,' +\n\t\t'clipboard,' +\n\t\t'colorbutton,' +\n\t\t'colordialog,' +\n\t\t'contextmenu,' +\n\t\t'dialogadvtab,' +\n\t\t'div,' +\n\t\t'elementspath,' +\n\t\t'enterkey,' +\n\t\t'entities,' +\n\t\t'filebrowser,' +\n\t\t'find,' +\n\t\t'flash,' +\n\t\t'floatingspace,' +\n\t\t'font,' +\n\t\t'format,' +\n\t\t'forms,' +\n\t\t'horizontalrule,' +\n\t\t'htmlwriter,' +\n\t\t'image,' +\n\t\t'iframe,' +\n\t\t'indentlist,' +\n\t\t'indentblock,' +\n\t\t'justify,' +\n\t\t'language,' +\n\t\t'link,' +\n\t\t'list,' +\n\t\t'liststyle,' +\n\t\t'magicline,' +\n\t\t'maximize,' +\n\t\t'newpage,' +\n\t\t'pagebreak,' +\n\t\t'pastefromword,' +\n\t\t'pastetext,' +\n\t\t'preview,' +\n\t\t'print,' +\n\t\t'removeformat,' +\n\t\t'resize,' +\n\t\t'save,' +\n\t\t'selectall,' +\n\t\t'showblocks,' +\n\t\t'showborders,' +\n\t\t'smiley,' +\n\t\t'sourcearea,' +\n\t\t'specialchar,' +\n\t\t'stylescombo,' +\n\t\t'tab,' +\n\t\t'table,' +\n\t\t'tabletools,' +\n\t\t'templates,' +\n\t\t'toolbar,' +\n\t\t'undo,' +\n\t\t'wysiwygarea';\n\t// %REMOVE_END%\n};\n\n// %LEAVE_UNMINIFIED% %REMOVE_LINE%\n\n\n\n/** WEBPACK FOOTER **\n ** ./config.js\n **/","/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview Defines the {@link CKEDITOR.lang} object, for the\n * Chinese Simplified language.\n */\n\n/**#@+\n   @type String\n   @example\n*/\n\n/**\n * Contains the dictionary of language entries.\n * @namespace\n */\nCKEDITOR.lang[ 'zh-cn' ] = {\n\t// ARIA description.\n\teditor: '所见即所得编辑器',\n\teditorPanel: '所见即所得编辑器面板',\n\n\t// Common messages and labels.\n\tcommon: {\n\t\t// Screenreader titles. Please note that screenreaders are not always capable\n\t\t// of reading non-English words. So be careful while translating it.\n\t\teditorHelp: '按 ALT+0 获得帮助',\n\n\t\tbrowseServer: '浏览服务器',\n\t\turl: 'URL',\n\t\tprotocol: '协议',\n\t\tupload: '上传',\n\t\tuploadSubmit: '上传到服务器',\n\t\timage: '图像',\n\t\tflash: 'Flash',\n\t\tform: '表单',\n\t\tcheckbox: '复选框',\n\t\tradio: '单选按钮',\n\t\ttextField: '单行文本',\n\t\ttextarea: '多行文本',\n\t\thiddenField: '隐藏域',\n\t\tbutton: '按钮',\n\t\tselect: '列表/菜单',\n\t\timageButton: '图像按钮',\n\t\tnotSet: '<没有设置>',\n\t\tid: 'ID',\n\t\tname: '名称',\n\t\tlangDir: '语言方向',\n\t\tlangDirLtr: '从左到右 (LTR)',\n\t\tlangDirRtl: '从右到左 (RTL)',\n\t\tlangCode: '语言代码',\n\t\tlongDescr: '详细说明 URL',\n\t\tcssClass: '样式类名称',\n\t\tadvisoryTitle: '标题',\n\t\tcssStyle: '行内样式',\n\t\tok: '确定',\n\t\tcancel: '取消',\n\t\tclose: '关闭',\n\t\tpreview: '预览',\n\t\tresize: '拖拽以改变大小',\n\t\tgeneralTab: '常规',\n\t\tadvancedTab: '高级',\n\t\tvalidateNumberFailed: '需要输入数字格式',\n\t\tconfirmNewPage: '当前文档内容未保存，是否确认新建文档？',\n\t\tconfirmCancel: '部分修改尚未保存，是否确认关闭对话框？',\n\t\toptions: '选项',\n\t\ttarget: '目标窗口',\n\t\ttargetNew: '新窗口 (_blank)',\n\t\ttargetTop: '整页 (_top)',\n\t\ttargetSelf: '本窗口 (_self)',\n\t\ttargetParent: '父窗口 (_parent)',\n\t\tlangDirLTR: '从左到右 (LTR)',\n\t\tlangDirRTL: '从右到左 (RTL)',\n\t\tstyles: '样式',\n\t\tcssClasses: '样式类',\n\t\twidth: '宽度',\n\t\theight: '高度',\n\t\talign: '对齐方式',\n\t\talignLeft: '左对齐',\n\t\talignRight: '右对齐',\n\t\talignCenter: '居中',\n\t\talignJustify: '两端对齐',\n\t\talignTop: '顶端',\n\t\talignMiddle: '居中',\n\t\talignBottom: '底部',\n\t\talignNone: '无',\n\t\tinvalidValue\t: '无效的值。',\n\t\tinvalidHeight: '高度必须为数字格式',\n\t\tinvalidWidth: '宽度必须为数字格式',\n\t\tinvalidCssLength: '此“%1”字段的值必须为正数，可以包含或不包含一个有效的 CSS 长度单位(px, %, in, cm, mm, em, ex, pt 或 pc)',\n\t\tinvalidHtmlLength: '此“%1”字段的值必须为正数，可以包含或不包含一个有效的 HTML 长度单位(px 或 %)',\n\t\tinvalidInlineStyle: '内联样式必须为格式是以分号分隔的一个或多个“属性名 : 属性值”。',\n\t\tcssLengthTooltip: '输入一个表示像素值的数字，或加上一个有效的 CSS 长度单位(px, %, in, cm, mm, em, ex, pt 或 pc)。',\n\n\t\t// Put the voice-only part of the label in the span.\n\t\tunavailable: '%1<span class=\"cke_accessibility\">，不可用</span>'\n\t}\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./lang/zh-cn.js\n **/"],"sourceRoot":""}